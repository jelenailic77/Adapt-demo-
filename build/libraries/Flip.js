import{getGlobalMatrix as getGlobalMatrix,_getDocScrollTop as _getDocScrollTop,_getDocScrollLeft as _getDocScrollLeft,Matrix2D as Matrix2D,_setDoc as _setDoc,_getCTM as _getCTM}from"./utils/matrix.js";var _toArray,gsap,_batch,_batchAction,_body,_closestTenth,_bodyLocked,_id=1,_forEachBatch=function(t,e){return t.actions.forEach(function(t){return t.vars[e]&&t.vars[e](t)})},_batchLookup={},_RAD2DEG=180/Math.PI,_DEG2RAD=Math.PI/180,_emptyObj={},_dashedNameLookup={},_memoizedRemoveProps={},_listToArray=function(t){return"string"==typeof t?t.split(" ").join("").split(","):t},_callbacks=_listToArray("onStart,onUpdate,onComplete,onReverseComplete,onInterrupt"),_removeProps=_listToArray("transform,transformOrigin,width,height,position,top,left,opacity,zIndex,maxWidth,maxHeight,minWidth,minHeight"),_getEl=function(t){return _toArray(t)[0]||console.warn("Element not found:",t)},_round=function(t){return Math.round(1e4*t)/1e4||0},_toggleClass=function(t,e,i){return t.forEach(function(t){return t.classList[i](e)})},_reserved={zIndex:1,kill:1,simple:1,spin:1,clearProps:1,targets:1,toggleClass:1,onComplete:1,onUpdate:1,onInterrupt:1,onStart:1,delay:1,repeat:1,repeatDelay:1,yoyo:1,scale:1,fade:1,absolute:1,props:1,onEnter:1,onLeave:1,custom:1,paused:1,nested:1,prune:1,absoluteOnLeave:1},_fitReserved={zIndex:1,simple:1,clearProps:1,scale:1,absolute:1,fitChild:1,getVars:1,props:1},_camelToDashed=function(t){return t.replace(/([A-Z])/g,"-$1").toLowerCase()},_copy=function(t,e){var i,n={};for(i in t)e[i]||(n[i]=t[i]);return n},_memoizedProps={},_memoizeProps=function(t){var e=_memoizedProps[t]=_listToArray(t);return _memoizedRemoveProps[t]=e.concat(_removeProps),e},_getInverseGlobalMatrix=function(t){var e=t._gsap||gsap.core.getCache(t);return e.gmCache===gsap.ticker.frame?e.gMatrix:(e.gmCache=gsap.ticker.frame,e.gMatrix=getGlobalMatrix(t,!0,!1,!0))},_getDOMDepth=function t(e,i,n){void 0===n&&(n=0);for(var r=e.parentNode,a=1e3*Math.pow(10,n)*(i?-1:1),o=i?900*-a:0;e;)o+=a,e=e.previousSibling;return r?o+t(r,i,n+1):o},_orderByDOMDepth=function(t,e,i){return t.forEach(function(t){return t.d=_getDOMDepth(i?t.element:t.t,e)}),t.sort(function(t,e){return t.d-e.d}),t},_recordInlineStyles=function(t,e){for(var i,n,r=t.element.style,a=t.css=t.css||[],o=e.length;o--;)n=r[i=e[o]]||r.getPropertyValue(i),a.push(n?i:_dashedNameLookup[i]||(_dashedNameLookup[i]=_camelToDashed(i)),n);return r},_applyInlineStyles=function(t){var e=t.css,i=t.element.style,n=0;for(t.cache.uncache=1;n<e.length;n+=2)e[n+1]?i[e[n]]=e[n+1]:i.removeProperty(e[n])},_setFinalStates=function(t,e){t.forEach(function(t){return t.a.cache.uncache=1}),e||t.finalStates.forEach(_applyInlineStyles)},_absoluteProps="paddingTop,paddingRight,paddingBottom,paddingLeft,gridArea,transition".split(","),_makeAbsolute=function(t,e,i){var n,r,a=t.element,o=t.width,s=t.height,l=t.uncache,c=t.getProp,p=a.style,h=4;if("object"!=typeof e&&(e=t),_batch&&1!==i)return _batch._abs.push({t:a,b:t,a:t,sd:0}),_batch._final.push(function(){return t.cache.uncache=1,_applyInlineStyles(t)}),a;for(c="none"===c("display"),t.isVisible&&!c||(c&&(_recordInlineStyles(t,["display"]).display=e.display),t.matrix=e.matrix,t.width=o=t.width||e.width,t.height=s=t.height||e.height),_recordInlineStyles(t,_absoluteProps),n=window.getComputedStyle(a);h--;)p[_absoluteProps[h]]=n[_absoluteProps[h]];return p.gridArea="1 / 1 / 1 / 1",p.transition="none",p.position="absolute",p.width=o+"px",p.height=s+"px",p.top||(p.top="0px"),p.left||(p.left="0px"),l?r=new ElementState(a):((r=_copy(t,_emptyObj)).position="absolute",t.simple?(l=a.getBoundingClientRect(),r.matrix=new Matrix2D(1,0,0,1,l.left+_getDocScrollLeft(),l.top+_getDocScrollTop())):r.matrix=getGlobalMatrix(a,!1,!1,!0)),r=_fit(r,t,!0),t.x=_closestTenth(r.x,.01),t.y=_closestTenth(r.y,.01),a},_filterComps=function(t,e){return!0!==e&&(e=_toArray(e),t=t.filter(function(t){return-1!==e.indexOf((t.sd<0?t.b:t.a).element)||(t.t._gsap.renderTransform(1),t.t.style.width=t.b.width+"px",void(t.t.style.height=t.b.height+"px"))})),t},_makeCompsAbsolute=function(t){return _orderByDOMDepth(t,!0).forEach(function(t){return(t.a.isVisible||t.b.isVisible)&&_makeAbsolute(t.sd<0?t.b:t.a,t.b,1)})},_findElStateInState=function(t,e){return e&&t.idLookup[_parseElementState(e).id]||t.elementStates[0]},_parseElementState=function(t,e,i,n){return t instanceof ElementState?t:t instanceof FlipState?_findElStateInState(t,n):new ElementState("string"==typeof t?_getEl(t)||console.warn(t+" not found"):t,e,i)},_recordProps=function(t,e){for(var i=gsap.getProperty(t.element,null,"native"),n=t.props={},r=e.length;r--;)n[e[r]]=(i(e[r])+"").trim();return n.zIndex&&(n.zIndex=parseFloat(n.zIndex)||0),t},_applyProps=function(t,e){var i,n=t.style||t;for(i in e)n[i]=e[i]},_getID=function(t){var e=t.getAttribute("data-flip-id");return e||t.setAttribute("data-flip-id",e="auto-"+_id++),e},_elementsFromElementStates=function(t){return t.map(function(t){return t.element})},_handleCallback=function(t,e,i){return t&&e.length&&i.add(t(_elementsFromElementStates(e),i,new FlipState(e,0,!0)),0)},_fit=function(t,e,i,n,r,a){var o,s,l,c,p=t.element,h=t.cache,u=t.parent,d=t.x,f=t.y,m=e.width,_=e.height,g=e.scaleX,b=e.scaleY,y=e.rotation,x=e.bounds,v=a&&p.style.cssText,S=a&&p.getBBox&&p.getAttribute("transform"),w=t,k=e.matrix,E=k.e,M=k.f,D=t.bounds.width!==x.width||t.bounds.height!==x.height||t.scaleX!==g||t.scaleY!==b||t.rotation!==y,P=!D&&t.simple&&e.simple&&!r;return P||!u?(g=b=1,y=o=0):(c=(l=_getInverseGlobalMatrix(u)).clone().multiply(e.ctm?e.matrix.clone().multiply(e.ctm):e.matrix),y=_round(Math.atan2(c.b,c.a)*_RAD2DEG),o=_round(Math.atan2(c.c,c.d)*_RAD2DEG+y)%360,g=Math.sqrt(Math.pow(c.a,2)+Math.pow(c.b,2)),b=Math.sqrt(Math.pow(c.c,2)+Math.pow(c.d,2))*Math.cos(o*_DEG2RAD),r&&(r=_toArray(r)[0],k=gsap.getProperty(r),x=r.getBBox&&"function"==typeof r.getBBox&&r.getBBox(),w={scaleX:k("scaleX"),scaleY:k("scaleY"),width:x?x.width:Math.ceil(parseFloat(k("width","px"))),height:x?x.height:parseFloat(k("height","px"))}),h.rotation=y+"deg",h.skewX=o+"deg"),i?(g*=m!==w.width&&w.width?m/w.width:1,b*=_!==w.height&&w.height?_/w.height:1,h.scaleX=g,h.scaleY=b):(m=_closestTenth(m*g/w.scaleX,0),_=_closestTenth(_*b/w.scaleY,0),p.style.width=m+"px",p.style.height=_+"px"),n&&_applyProps(p,e.props),P||!u?(d+=E-t.matrix.e,f+=M-t.matrix.f):D||u!==e.parent?(h.renderTransform(1,h),c=getGlobalMatrix(r||p,!1,!1,!0),c=l.apply({x:c.e,y:c.f}),d+=(s=l.apply({x:E,y:M})).x-c.x,f+=s.y-c.y):(l.e=l.f=0,d+=(s=l.apply({x:E-t.matrix.e,y:M-t.matrix.f})).x,f+=s.y),d=_closestTenth(d,.02),f=_closestTenth(f,.02),!a||a instanceof ElementState?(h.x=d+"px",h.y=f+"px",h.renderTransform(1,h)):(p.style.cssText=v,p.getBBox&&p.setAttribute("transform",S||""),h.uncache=1),a&&(a.x=d,a.y=f,a.rotation=y,a.skewX=o,i?(a.scaleX=g,a.scaleY=b):(a.width=m,a.height=_)),a||h},_parseState=function(t,e){return t instanceof FlipState?t:new FlipState(t,e)},_getChangingElState=function(t,e,i){var n=t.idLookup[i],i=t.alt[i];return!i.isVisible||(e.getElementState(i.element)||i).isVisible&&n.isVisible?n:i},_bodyMetrics=[],_bodyProps="width,height,overflowX,overflowY".split(","),_lockBodyScroll=function(t){if(t!==_bodyLocked){var e=_body.style,i=_body.clientWidth===window.outerWidth,n=_body.clientHeight===window.outerHeight,r=4;if(t&&(i||n)){for(;r--;)_bodyMetrics[r]=e[_bodyProps[r]];i&&(e.width=_body.clientWidth+"px",e.overflowY="hidden"),n&&(e.height=_body.clientHeight+"px",e.overflowX="hidden"),_bodyLocked=t}else if(_bodyLocked){for(;r--;)_bodyMetrics[r]?e[_bodyProps[r]]=_bodyMetrics[r]:e.removeProperty(_camelToDashed(_bodyProps[r]));_bodyLocked=t}}},_fromTo=function(t,e,r,i){t instanceof FlipState&&e instanceof FlipState||console.warn("Not a valid state object.");var a,o,s,l,c,p,h,u,d,n,f,m,_,g=(r=r||{}).clearProps,b=r.onEnter,y=r.onLeave,x=r.absolute,v=r.absoluteOnLeave,S=r.custom,w=r.delay,k=r.paused,E=r.repeat,M=r.repeatDelay,D=r.yoyo,P=r.toggleClass,C=r.nested,L=r.zIndex,A=r.scale,B=r.fade,T=r.stagger,F=r.spin,V=r.prune,I=("props"in r?r:t).props,O=_copy(r,_reserved),R=gsap.timeline({delay:w,paused:k,repeat:E,repeatDelay:M,yoyo:D}),z=O,X=[],G=[],Y=[],N=[],j=!0===F?1:F||0,H="function"==typeof F?F:function(){return j},W=t.interrupted||e.interrupted,q=R[1!==i?"to":"from"];for(o in e.idLookup)f=e.alt[o]?_getChangingElState(e,t,o):e.idLookup[o],c=f.element,n=t.idLookup[o],(n=t.alt[o]&&c===n.element&&(t.alt[o].isVisible||!f.isVisible)?t.alt[o]:n)?(p={t:c,b:n,a:f,sd:n.element===c?0:f.isVisible?1:-1},Y.push(p),p.sd&&(p.sd<0&&(p.b=f,p.a=n),W&&_recordInlineStyles(p.b,I?_memoizedRemoveProps[I]:_removeProps),B&&Y.push(p.swap={t:n.element,b:p.b,a:p.a,sd:-p.sd,swap:p})),c._flip=n.element._flip=_batch?_batch.timeline:R):f.isVisible&&(Y.push({t:c,b:_copy(f,{isVisible:1}),a:f,sd:0,entering:1}),c._flip=_batch?_batch.timeline:R);return I&&(_memoizedProps[I]||_memoizeProps(I)).forEach(function(e){return O[e]=function(t){return Y[t].a.props[e]}}),Y.finalStates=d=[],i=function(){for(_orderByDOMDepth(Y),_lockBodyScroll(!0),l=0;l<Y.length;l++)p=Y[l],m=p.a,_=p.b,!V||m.isDifferent(_)||p.entering?(c=p.t,!C||p.sd<0||!l||(m.matrix=getGlobalMatrix(c,!1,!1,!0)),p.sd||_.isVisible&&m.isVisible?(p.sd<0?(h=new ElementState(c,I,t.simple),_fit(h,m,A,0,0,h),h.matrix=getGlobalMatrix(c,!1,!1,!0),h.css=p.b.css,p.a=m=h,B&&(c.style.opacity=(W?_:m).opacity),T&&N.push(c)):0<p.sd&&B&&(c.style.opacity=W?m.opacity-_.opacity:"0"),_fit(m,_,A,I)):_.isVisible!==m.isVisible&&(_.isVisible?m.isVisible||(_.css=m.css,G.push(_),Y.splice(l--,1),x&&C&&_fit(m,_,A,I)):(m.isVisible&&X.push(m),Y.splice(l--,1))),A||(c.style.maxWidth=Math.max(m.width,_.width)+"px",c.style.maxHeight=Math.max(m.height,_.height)+"px",c.style.minWidth=Math.min(m.width,_.width)+"px",c.style.minHeight=Math.min(m.height,_.height)+"px"),C&&P&&c.classList.add(P)):Y.splice(l--,1),d.push(m);var e,i;if(P&&(e=d.map(function(t){return t.element}),C&&e.forEach(function(t){return t.classList.remove(P)})),_lockBodyScroll(!1),A?(O.scaleX=function(t){return Y[t].a.scaleX},O.scaleY=function(t){return Y[t].a.scaleY}):(O.width=function(t){return Y[t].a.width+"px"},O.height=function(t){return Y[t].a.height+"px"},O.autoRound=r.autoRound||!1),O.x=function(t){return Y[t].a.x+"px"},O.y=function(t){return Y[t].a.y+"px"},O.rotation=function(t){return Y[t].a.rotation+(F?360*H(t,u[t],u):0)},O.skewX=function(t){return Y[t].a.skewX},u=Y.map(function(t){return t.t}),!L&&0!==L||(O.modifiers={zIndex:function(){return L}},O.zIndex=L,O.immediateRender=!1!==r.immediateRender),B&&(O.opacity=function(t){return Y[t].sd<0?0:0<Y[t].sd?Y[t].a.opacity:"+=0"}),N.length&&(T=gsap.utils.distribute(T),i=u.slice(N.length),O.stagger=function(t,e){return T(~N.indexOf(e)?u.indexOf(Y[t].swap.t):t,e,i)}),_callbacks.forEach(function(t){return r[t]&&R.eventCallback(t,r[t],r[t+"Params"])}),S&&u.length)for(o in z=_copy(O,_reserved),"scale"in S&&(S.scaleX=S.scaleY=S.scale,delete S.scale),S)(a=_copy(S[o],_fitReserved))[o]=O[o],!("duration"in a)&&"duration"in O&&(a.duration=O.duration),a.stagger=O.stagger,q.call(R,u,a,0),delete z[o];(u.length||G.length||X.length)&&(P&&R.add(function(){return _toggleClass(e,P,R._zTime<0?"remove":"add")},0)&&!k&&_toggleClass(e,P,"add"),u.length&&q.call(R,u,z,0)),_handleCallback(b,X,R),_handleCallback(y,G,R);var n=_batch&&_batch.timeline;n&&(n.add(R,0),_batch._final.push(function(){return _setFinalStates(Y,!g)})),s=R.duration(),R.call(function(){var t=R.time()>=s;t&&!n&&_setFinalStates(Y,!g),P&&_toggleClass(e,P,t?"remove":"add")})},v&&(x=Y.filter(function(t){return!t.sd&&!t.a.isVisible&&t.b.isVisible}).map(function(t){return t.a.element})),_batch?(x&&(v=_batch._abs).push.apply(v,_filterComps(Y,x)),_batch._run.push(i)):(x&&_makeCompsAbsolute(_filterComps(Y,x)),i()),_batch?_batch.timeline:R},_interrupt=function t(e){e.vars.onInterrupt&&e.vars.onInterrupt.apply(e,e.vars.onInterruptParams||[]),e.getChildren(!0,!1,!0).forEach(t)},_killFlip=function(t,e){if(t&&t.progress()<1&&!t.paused())return e&&(_interrupt(t),e<2&&t.progress(1),t.kill()),!0},_createLookup=function(t){for(var e,i=t.idLookup={},n=t.alt={},r=t.elementStates,a=r.length;a--;)i[(e=r[a]).id]?n[e.id]=e:i[e.id]=e},FlipState=function(){function t(t,e,i){this.props=e&&e.props,this.simple=!(!e||!e.simple),i?(this.targets=_elementsFromElementStates(t),this.elementStates=t,_createLookup(this)):(this.targets=_toArray(t),e=e&&(!1===e.kill||e.batch&&!e.kill),_batch&&!e&&_batch._kill.push(this),this.update(e||!!_batch))}var e=t.prototype;return e.update=function(t){var e=this;return this.elementStates=this.targets.map(function(t){return new ElementState(t,e.props,e.simple)}),_createLookup(this),this.interrupt(t),this.recordInlineStyles(),this},e.clear=function(){return this.targets.length=this.elementStates.length=0,_createLookup(this),this},e.fit=function(t,e,i){for(var n,r,a=_orderByDOMDepth(this.elementStates.slice(0),!1,!0),o=(t||this).idLookup,s=0;s<a.length;s++)n=a[s],i&&(n.matrix=getGlobalMatrix(n.element,!1,!1,!0)),(r=o[n.id])&&_fit(n,r,e,!0,0,n),n.matrix=getGlobalMatrix(n.element,!1,!1,!0);return this},e.getProperty=function(t,e){t=this.getElementState(t)||_emptyObj;return(e in t?t:t.props||_emptyObj)[e]},e.add=function(t){for(var e,i,n=t.targets.length,r=this.idLookup,a=this.alt;n--;)(i=r[(e=t.elementStates[n]).id])&&(e.element===i.element||a[e.id]&&a[e.id].element===e.element)?(i=this.elementStates.indexOf(e.element===i.element?i:a[e.id]),this.targets.splice(i,1,t.targets[n]),this.elementStates.splice(i,1,e)):(this.targets.push(t.targets[n]),this.elementStates.push(e));return t.interrupted&&(this.interrupted=!0),t.simple||(this.simple=!1),_createLookup(this),this},e.compare=function(t){function n(t,e,i){return(t.isVisible!==e.isVisible?t.isVisible?m:_:t.isVisible?f:d).push(i)&&g.push(i)}function e(t,e,i){return g.indexOf(i)<0&&n(t,e,i)}var i,r,a,o,s,l,c,p,h=t.idLookup,u=this.idLookup,d=[],f=[],m=[],_=[],g=[],b=t.alt,y=this.alt;for(a in h)s=b[a],l=y[a],o=(i=s?_getChangingElState(t,this,a):h[a]).element,r=u[a],l?(p=r.isVisible||!l.isVisible&&o===r.element?r:l,(c=!s||i.isVisible||s.isVisible||p.element!==s.element?i:s).isVisible&&p.isVisible&&c.element!==p.element?((c.isDifferent(p)?f:d).push(c.element,p.element),g.push(c.element,p.element)):n(c,p,c.element),s&&c.element===s.element&&(s=h[a]),e(c.element!==r.element&&s?s:c,r,r.element),e(s&&s.element===l.element?s:c,l,l.element),s&&e(s,l.element===s.element?l:r,s.element)):(r?r.isDifferent(i)?n(i,r,o):d.push(o):m.push(o),s&&e(s,r,s.element));for(a in u)h[a]||(_.push(u[a].element),y[a]&&_.push(y[a].element));return{changed:f,unchanged:d,enter:m,leave:_}},e.recordInlineStyles=function(){for(var t=_memoizedRemoveProps[this.props]||_removeProps,e=this.elementStates.length;e--;)_recordInlineStyles(this.elementStates[e],t)},e.interrupt=function(i){var n=this,r=[];this.targets.forEach(function(t){var e=t._flip,t=_killFlip(e,i?0:1);i&&t&&r.indexOf(e)<0&&e.add(function(){return n.updateVisibility()}),t&&r.push(e)}),!i&&r.length&&this.updateVisibility(),this.interrupted||(this.interrupted=!!r.length)},e.updateVisibility=function(){this.elementStates.forEach(function(t){var e=t.element.getBoundingClientRect();t.isVisible=!!(e.width||e.height||e.top||e.left),t.uncache=1})},e.getElementState=function(t){return this.elementStates[this.targets.indexOf(_getEl(t))]},e.makeAbsolute=function(){return _orderByDOMDepth(this.elementStates.slice(0),!0,!0).map(_makeAbsolute)},t}(),ElementState=function(){function t(t,e,i){this.element=t,this.update(e,i)}var e=t.prototype;return e.isDifferent=function(t){var e=this.bounds,i=t.bounds;return e.top!==i.top||e.left!==i.left||e.width!==i.width||e.height!==i.height||!this.matrix.equals(t.matrix)||this.opacity!==t.opacity||this.props&&t.props&&JSON.stringify(this.props)!==JSON.stringify(t.props)},e.update=function(t,e){var i=this,n=i.element,r=gsap.getProperty(n),a=gsap.core.getCache(n),o=n.getBoundingClientRect(),s=n.getBBox&&"function"==typeof n.getBBox&&"svg"!==n.nodeName.toLowerCase()&&n.getBBox(),l=e?new Matrix2D(1,0,0,1,o.left+_getDocScrollLeft(),o.top+_getDocScrollTop()):getGlobalMatrix(n,!1,!1,!0);i.getProp=r,i.element=n,i.id=_getID(n),i.matrix=l,i.cache=a,i.bounds=o,i.isVisible=!!(o.width||o.height||o.left||o.top),i.display=r("display"),i.position=r("position"),i.parent=n.parentNode,i.x=r("x"),i.y=r("y"),i.scaleX=a.scaleX,i.scaleY=a.scaleY,i.rotation=r("rotation"),i.skewX=r("skewX"),i.opacity=r("opacity"),i.width=s?s.width:_closestTenth(r("width","px"),.04),i.height=s?s.height:_closestTenth(r("height","px"),.04),t&&_recordProps(i,_memoizedProps[t]||_memoizeProps(t)),i.ctm=n.getCTM&&"svg"===n.nodeName.toLowerCase()&&_getCTM(n).inverse(),i.simple=e||1===_round(l.a)&&!_round(l.b)&&!_round(l.c)&&1===_round(l.d),i.uncache=0},t}(),FlipAction=function(){function t(t,e){this.vars=t,this.batch=e,this.states=[],this.timeline=e.timeline}var e=t.prototype;return e.getStateById=function(t){for(var e=this.states.length;e--;)if(this.states[e].idLookup[t])return this.states[e]},e.kill=function(){this.batch.remove(this)},t}(),FlipBatch=function(){function t(t){this.id=t,this.actions=[],this._kill=[],this._final=[],this._abs=[],this._run=[],this.data={},this.state=new FlipState,this.timeline=gsap.timeline()}var e=t.prototype;return e.add=function(e){var t=this.actions.filter(function(t){return t.vars===e});return t.length?t[0]:(t=new FlipAction("function"==typeof e?{animate:e}:e,this),this.actions.push(t),t)},e.remove=function(t){t=this.actions.indexOf(t);return 0<=t&&this.actions.splice(t,1),this},e.getState=function(e){var i=this,t=_batch,n=_batchAction;return(_batch=this).state.clear(),this._kill.length=0,this.actions.forEach(function(t){t.vars.getState&&(t.states.length=0,(_batchAction=t).state=t.vars.getState(t)),e&&t.states.forEach(function(t){return i.state.add(t)})}),_batchAction=n,_batch=t,this.killConflicts(),this},e.animate=function(){var t,e,i=this,n=_batch,r=this.timeline,a=this.actions.length;for(_batch=this,r.clear(),this._abs.length=this._final.length=this._run.length=0,this.actions.forEach(function(t){t.vars.animate&&t.vars.animate(t);var e,i=t.vars.onEnter,n=t.vars.onLeave,r=t.targets;r&&r.length&&(i||n)&&(e=new FlipState,t.states.forEach(function(t){return e.add(t)}),(r=e.compare(Flip.getState(r))).enter.length&&i&&i(r.enter),r.leave.length&&n&&n(r.leave))}),_makeCompsAbsolute(this._abs),this._run.forEach(function(t){return t()}),e=r.duration(),t=this._final.slice(0),r.add(function(){e<=r.time()&&(t.forEach(function(t){return t()}),_forEachBatch(i,"onComplete"))}),_batch=n;a--;)this.actions[a].vars.once&&this.actions[a].kill();return _forEachBatch(this,"onStart"),r.restart(),this},e.loadState=function(r){r=r||function(){return 0};var a=[];return this.actions.forEach(function(i){var n,t;i.vars.loadState&&(t=function t(e){e&&(i.targets=e),~(n=a.indexOf(t))&&(a.splice(n,1),a.length||r())},a.push(t),i.vars.loadState(t))}),a.length||r(),this},e.setState=function(){return this.actions.forEach(function(t){return t.targets=t.vars.setState&&t.vars.setState(t)}),this},e.killConflicts=function(e){return this.state.interrupt(e),this._kill.forEach(function(t){return t.interrupt(e)}),this},e.run=function(t,e){var i=this;return this!==_batch&&(t||this.getState(e),this.loadState(function(){i._killed||(i.setState(),i.animate())})),this},e.clear=function(t){this.state.clear(),t||(this.actions.length=0)},e.getStateById=function(t){for(var e,i=this.actions.length;i--;)if(e=this.actions[i].getStateById(t))return e;return this.state.idLookup[t]&&this.state},e.kill=function(){this._killed=1,this.clear(),delete _batchLookup[this.id]},t}(),Flip=function(){function i(){}return i.getState=function(t,e){t=_parseState(t,e);return _batchAction&&_batchAction.states.push(t),e&&e.batch&&i.batch(e.batch).state.add(t),t},i.from=function(t,e){return"clearProps"in(e=e||{})||(e.clearProps=!0),_fromTo(t,_parseState(e.targets||t.targets,{props:e.props||t.props,simple:e.simple,kill:!!e.kill}),e,-1)},i.to=function(t,e){return _fromTo(t,_parseState(e.targets||t.targets,{props:e.props||t.props,simple:e.simple,kill:!!e.kill}),e,1)},i.fromTo=function(t,e,i){return _fromTo(t,e,i)},i.fit=function(t,e,i){var n=i?_copy(i,_fitReserved):{},r=i||n,a=r.absolute,o=r.scale,s=r.getVars,l=r.props,c=r.runBackwards,p=r.onComplete,r=r.simple,i=i&&i.fitChild&&_getEl(i.fitChild),e=_parseElementState(e,l,r,t),h=_parseElementState(t,0,r,e),r=l?_memoizedRemoveProps[l]:_removeProps;return l&&_applyProps(n,e.props),c&&(_recordInlineStyles(h,r),"immediateRender"in n||(n.immediateRender=!0),n.onComplete=function(){_applyInlineStyles(h),p&&p.apply(this,arguments)}),a&&_makeAbsolute(h,e),n=_fit(h,e,o||i,l,i,n.duration||s?n:0),s?n:n.duration?gsap.to(h.element,n):null},i.makeAbsolute=function(t,e){return(t instanceof FlipState?t:new FlipState(t,e)).makeAbsolute()},i.batch=function(t){return _batchLookup[t=t||"default"]||(_batchLookup[t]=new FlipBatch(t))},i.killFlipsOf=function(t,e){(t instanceof FlipState?t.targets:_toArray(t)).forEach(function(t){return t&&_killFlip(t._flip,!1!==e?1:2)})},i.isFlipping=function(t){t=i.getByTarget(t);return!!t&&t.isActive()},i.getByTarget=function(t){return(_getEl(t)||_emptyObj)._flip},i.getElementState=function(t,e){return new ElementState(_getEl(t),e)},i.convertCoordinates=function(t,e,i){t=getGlobalMatrix(e,!0,!0).multiply(getGlobalMatrix(t));return i?t.apply(i):t},i.register=function(t){var i;(_body="undefined"!=typeof document&&document.body)&&(gsap=t,_setDoc(_body),_toArray=gsap.utils.toArray,i=gsap.utils.snap(.1),_closestTenth=function(t,e){return i(parseFloat(t)+e)})},i}();Flip.version="3.10.3","undefined"!=typeof window&&window.gsap&&window.gsap.registerPlugin(Flip);export{Flip as Flip,Flip as default};