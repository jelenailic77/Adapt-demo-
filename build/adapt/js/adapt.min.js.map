{"version":3,"file":"adapt.min.js","sources":["../../core/js/wait.js","../../core/js/models/lockingModel.js","../../core/js/adapt.js","../../core/js/offlineStorage.js","../../core/js/device.js","../../core/js/location.js","../../core/js/a11y/browserFocus.js","../../core/js/a11y/focusOptions.js","../../core/js/a11y/keyboardFocusOutline.js","../../core/js/enums/logLevelEnum.js","../../core/js/logging.js","../../core/js/a11y/log.js","../../core/js/a11y/scroll.js","../../core/js/a11y/wrapFocus.js","../../core/js/a11y/popup.js","../../core/js/enums/defaultAriaLevels.js","../../core/js/a11y/deprecated.js","../../core/js/components.js","../../core/js/collections/adaptCollection.js","../../core/js/models/buildModel.js","../../core/js/models/configModel.js","../../core/js/data.js","../../core/js/a11y.js","../../core/js/views/drawerItemView.js","../../core/js/views/drawerView.js","../../core/js/drawer.js","../../core/js/collections/adaptSubsetCollection.js","../../core/js/modelEvent.js","../../core/js/models/adaptModel.js","../../core/js/models/contentObjectModel.js","../../core/js/models/articleModel.js","../../core/js/models/blockModel.js","../../core/js/models/componentModel.js","../../core/js/models/menuModel.js","../../core/js/models/courseModel.js","../../core/js/models/pageModel.js","../../core/js/childEvent.js","../../core/js/templateRenderEvent.js","../../core/js/reactHelpers.js","../../core/js/views/adaptView.js","../../core/js/views/contentObjectView.js","../../core/js/views/pageView.js","../../core/js/views/articleView.js","../../core/js/views/blockView.js","../../core/js/mpabc.js","../../core/js/views/notifyPushView.js","../../core/js/models/notifyModel.js","../../core/js/collections/notifyPushCollection.js","../../core/js/views/notifyPopupView.js","../../core/js/views/notifyView.js","../../core/js/notify.js","../../core/js/models/routerModel.js","../../core/js/router.js","../../core/js/scrolling.js","../../core/js/startController.js","../../core/js/enums/completionStateEnum.js","../../core/js/tracking.js","../../core/js/deprecated.js","../../core/js/templates.js","../../core/js/fixes/img.lazyload.js","../../core/js/fixes/reactHelpers.html.js","../../core/js/helpers.js","../../core/js/views/headingView.js","../../core/js/headings.js","../../core/js/views/navigationView.js","../../core/js/navigation.js","../../core/js/models/itemModel.js","../../core/js/models/itemsComponentModel.js","../../components/adapt-cards/js/CardsModel.js","../../core/js/views/componentView.js","../../components/adapt-cards/js/CardsView.js","../../components/adapt-cards/js/adapt-cards.js","../../core/js/enums/buttonStateEnum.js","../../core/js/views/buttonsView.js","../../core/js/models/questionModel.js","../../core/js/views/questionView.js","../../components/adapt-choose/js/chooseView.js","../../components/adapt-choose/js/chooseModel.js","../../components/adapt-choose/js/adapt-choose.js","../../components/adapt-contrib-accordion/js/AccordionModel.js","../../components/adapt-contrib-accordion/js/AccordionView.js","../../components/adapt-contrib-accordion/js/adapt-contrib-accordion.js","../../components/adapt-contrib-assessmentResults/js/assessmentResultsModel.js","../../components/adapt-contrib-assessmentResults/js/assessmentResultsView.js","../../components/adapt-contrib-assessmentResults/js/adapt-contrib-assessmentResults.js","../../components/adapt-contrib-blank/js/blankView.js","../../components/adapt-contrib-blank/js/adapt-contrib-blank.js","../../components/adapt-contrib-flipcard/js/adapt-contrib-flipcard.js","../../components/adapt-contrib-mcq/js/McqView.js","../../components/adapt-contrib-gmcq/js/GmcqView.js","../../core/js/models/itemsQuestionModel.js","../../components/adapt-contrib-mcq/js/McqModel.js","../../components/adapt-contrib-gmcq/js/GmcqModel.js","../../components/adapt-contrib-gmcq/js/adapt-contrib-gmcq.js","../../components/adapt-contrib-graphic/js/GraphicView.js","../../components/adapt-contrib-graphic/js/GraphicModel.js","../../components/adapt-contrib-graphic/js/adapt-contrib-graphic.js","../../components/adapt-contrib-hotgraphic/js/hotgraphicPopupView.js","../../components/adapt-contrib-hotgraphic/js/hotgraphicView.js","../../components/adapt-contrib-hotgraphic/js/adapt-contrib-hotgraphic.js","../../components/adapt-contrib-matching/js/MatchingView.js","../../components/adapt-contrib-matching/js/MatchingItemModel.js","../../components/adapt-contrib-matching/js/MatchingModel.js","../../components/adapt-contrib-matching/js/adapt-contrib-matching.js","../../components/adapt-contrib-mcq/js/adapt-contrib-mcq.js","../../components/adapt-contrib-media/libraries/mediaelement-fullscreen-hook.js","../../components/adapt-contrib-media/js/mediaView.js","../../components/adapt-contrib-media/js/adapt-contrib-media.js","../../components/adapt-contrib-narrative/js/NarrativeModel.js","../../components/adapt-contrib-narrative/js/modeEnum.js","../../components/adapt-contrib-narrative/js/NarrativeView.js","../../components/adapt-contrib-narrative/js/adapt-contrib-narrative.js","../../components/adapt-contrib-slider/js/sliderView.js","../../components/adapt-contrib-slider/js/sliderModel.js","../../components/adapt-contrib-slider/js/adapt-contrib-slider.js","../../components/adapt-contrib-text/js/TextView.js","../../components/adapt-contrib-text/js/TextModel.js","../../components/adapt-contrib-text/js/adapt-contrib-text.js","../../components/adapt-contrib-textInput/js/textInputView.js","../../components/adapt-contrib-textInput/js/textInputModel.js","../../components/adapt-contrib-textInput/js/adapt-contrib-textInput.js","../../components/adapt-flex/js/FlexModel.js","../../components/adapt-flex/js/FlexView.js","../../components/adapt-flex/js/adapt-flex.js","../../components/adapt-flipper/js/adapt-flipper.js","../../components/adapt-graphicCompare/js/GraphicCompareView.js","../../components/adapt-graphicCompare/js/GraphicCompareModel.js","../../components/adapt-graphicCompare/js/adapt-graphicCompare.js","../../components/adapt-lottieInteractivity/js/LottieInteractivityView.js","../../components/adapt-lottieInteractivity/js/LottieInteractivityModel.js","../../components/adapt-lottieInteractivity/js/adapt-lottieInteractivity.js","../../components/adapt-pageNav/js/model.js","../../components/adapt-pageNav/js/tooltip.js","../../components/adapt-pageNav/js/view.js","../../components/adapt-pageNav/js/adapt-pageNav.js","../../components/adapt-selectchoice/js/selectchoiceView.js","../../components/adapt-selectchoice/js/selectchoiceModel.js","../../components/adapt-selectchoice/js/adapt-selectchoice.js","../../components/adapt-tabs/js/TabsView.js","../../components/adapt-tabs/js/adapt-tabs.js","../../components/adapt-talk/js/TalkModel.js","../../components/adapt-talk/js/TalkView.js","../../components/adapt-talk/js/adapt-talk.js","../../components/adapt-verticalItems/js/VerticalItemsModel.js","../../components/adapt-verticalItems/js/VerticalItemsView.js","../../components/adapt-verticalItems/js/adapt-verticalItems.js","../../extensions/adapt-animate/js/animate-menuView.js","../../extensions/adapt-animate/js/animate-articleView.js","../../extensions/adapt-animate/js/animate-blockView.js","../../extensions/adapt-animate/js/animate-componentView.js","../../extensions/adapt-animate/js/adapt-animate.js","../../extensions/adapt-backgroundSwitcher/js/BackgroundSwitcherBlockView.js","../../extensions/adapt-backgroundSwitcher/js/BackgroundSwitcherPageView.js","../../extensions/adapt-backgroundSwitcher/js/adapt-backgroundSwitcher.js","../../extensions/adapt-backgroundVideo/js/backgroundVideoView.js","../../extensions/adapt-backgroundVideo/js/adapt-backgroundVideo.js","../../extensions/adapt-certificate/js/adapt-certificate.js","../../extensions/adapt-contrib-assessment/js/adapt-assessmentArticleView.js","../../extensions/adapt-contrib-assessment/js/adapt-assessmentQuestionBank.js","../../extensions/adapt-contrib-assessment/js/adapt-assessmentArticleModel.js","../../extensions/adapt-contrib-assessment/js/assessment.js","../../extensions/adapt-contrib-assessment/js/adapt-assessmentArticleExtension.js","../../extensions/adapt-contrib-bookmarking/js/adapt-contrib-bookmarking.js","../../extensions/adapt-contrib-languagePicker/js/languagePickerNavigationView.js","../../extensions/adapt-contrib-languagePicker/js/languagePickerView.js","../../extensions/adapt-contrib-languagePicker/js/languagePickerDrawerView.js","../../extensions/adapt-contrib-languagePicker/js/languagePickerNavView.js","../../extensions/adapt-contrib-languagePicker/js/languagePickerModel.js","../../extensions/adapt-contrib-languagePicker/js/adapt-languagePicker.js","../../extensions/adapt-contrib-pageLevelProgress/js/completionCalculations.js","../../extensions/adapt-contrib-pageLevelProgress/js/PageLevelProgressIndicatorView.js","../../extensions/adapt-contrib-pageLevelProgress/js/PageLevelProgressItemView.js","../../extensions/adapt-contrib-pageLevelProgress/js/PageLevelProgressView.js","../../extensions/adapt-contrib-pageLevelProgress/js/PageLevelProgressNavigationView.js","../../extensions/adapt-contrib-pageLevelProgress/js/PageLevelProgressCollection.js","../../extensions/adapt-contrib-pageLevelProgress/js/adapt-contrib-pageLevelProgress.js","../../extensions/adapt-contrib-resources/js/ResourcesView.js","../../extensions/adapt-contrib-resources/js/ResourcesHelpers.js","../../extensions/adapt-contrib-resources/js/adapt-contrib-resources.js","../../extensions/adapt-contrib-spoor/js/scorm/logger.js","../../extensions/adapt-contrib-spoor/js/scorm/error.js","../../extensions/adapt-contrib-spoor/js/scorm/wrapper.js","../../extensions/adapt-contrib-spoor/js/serializers/SCORMSuspendData.js","../../extensions/adapt-contrib-spoor/js/serializers/ComponentSerializer.js","../../extensions/adapt-contrib-spoor/js/adapt-stateful-session.js","../../extensions/adapt-contrib-spoor/js/adapt-offlineStorage-scorm.js","../../extensions/adapt-contrib-spoor/js/adapt-contrib-spoor.js","../../extensions/adapt-contrib-trickle/js/models.js","../../extensions/adapt-contrib-trickle/js/controller.js","../../extensions/adapt-contrib-trickle/js/TrickleButtonView.js","../../extensions/adapt-contrib-trickle/js/TrickleButtonModel.js","../../extensions/adapt-contrib-trickle/js/trickleButton.js","../../extensions/adapt-contrib-trickle/js/adapt-contrib-trickle.js","../../extensions/adapt-logo/js/logoView.js","../../extensions/adapt-logo/js/adapt-logo.js","../../extensions/adapt-scrollTop/js/ScrollTopView.js","../../extensions/adapt-scrollTop/js/adapt-scrollTop.js","../../extensions/adapt-splashScreen/js/splashScreenView.js","../../extensions/adapt-splashScreen/js/adapt-splashScreen.js","../../core/js/views/menuItemView.js","../../core/js/views/menuView.js","../../menu/adapt-contrib-boxMenu/js/BoxMenuItemView.js","../../menu/adapt-contrib-boxMenu/js/BoxMenuGroupView.js","../../menu/adapt-contrib-boxMenu/js/BoxMenuView.js","../../menu/adapt-contrib-boxMenu/js/adapt-contrib-boxMenu.js","../../theme/adapt-contrib-vanilla/js/themeView.js","../../theme/adapt-contrib-vanilla/js/themePageView.js","../../theme/adapt-contrib-vanilla/js/themeArticleView.js","../../theme/adapt-contrib-vanilla/js/themeBlockView.js","../../theme/adapt-contrib-vanilla/js/theme.js","../../core/templates/header.jsx","../../core/templates/image.jsx","../../components/adapt-cards/templates/cards.jsx","../../components/adapt-choose/templates/choose.jsx","../../components/adapt-contrib-accordion/templates/accordion.jsx","../../components/adapt-contrib-gmcq/templates/gmcq.jsx","../../components/adapt-contrib-graphic/templates/graphic.jsx","../../components/adapt-contrib-matching/templates/matching.jsx","../../components/adapt-contrib-matching/templates/matchingDropDown.jsx","../../components/adapt-contrib-mcq/templates/mcq.jsx","../../components/adapt-contrib-text/templates/text.jsx","../../components/adapt-contrib-textInput/templates/textinput.jsx","../../components/adapt-flex/templates/flex.jsx","../../components/adapt-graphicCompare/templates/graphicCompare.jsx","../../components/adapt-lottieInteractivity/templates/lottieInteractivity.jsx","../../components/adapt-selectchoice/templates/selectchoice.jsx","../../components/adapt-tabs/templates/tabs.jsx","../../components/adapt-talk/templates/talk.jsx","../../components/adapt-verticalItems/templates/vertical-items.jsx","../../extensions/adapt-backgroundVideo/templates/backgroundvideo.jsx","../../extensions/adapt-scrollTop/templates/scrollTop.jsx","../../core/js/app.js"],"sourcesContent":["class Wait extends Backbone.Controller {\r\n\r\n  initialize() {\r\n    this._waitCount = 0;\r\n    this._callbackHandle = null;\r\n    this.being = this.begin.bind(this);\r\n    this.end = this.end.bind(this);\r\n  }\r\n\r\n  /**\r\n   * Returns true if there are items in the waiting count.\r\n   *\r\n   * @return {Boolean}\r\n   */\r\n  isWaiting() {\r\n    return (this._waitCount !== 0);\r\n  }\r\n\r\n  /**\r\n   * Add one item to the waiting count.\r\n   *\r\n   * @return {Object}\r\n   */\r\n  begin() {\r\n    if (!this.isWaiting()) this.trigger('wait');\r\n\r\n    this._waitCount++;\r\n\r\n    if (this._callbackHandle) {\r\n      clearTimeout(this._callbackHandle);\r\n      this._callbackHandle = null;\r\n    }\r\n\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * Remove an item from the waiting count and trigger ready asynchronously if no more items are waiting.\r\n   *\r\n   * @return {Object}\r\n   */\r\n  end() {\r\n    if (!this.isWaiting()) return this;\r\n\r\n    this._waitCount--;\r\n\r\n    if (this.isWaiting() || this._callbackHandle) return this;\r\n\r\n    this._callbackHandle = setTimeout(function() {\r\n      this._callbackHandle = null;\r\n      this.trigger('ready');\r\n    }.bind(this), 0);\r\n\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * Queue this function until all open waits have been ended.\r\n   *\r\n   * @param  {Function} [callback]\r\n   * @return {Object|Promise}\r\n   */\r\n  queue(callback) {\r\n    if (!callback) {\r\n      this.begin();\r\n\r\n      return new Promise(resolve => {\r\n        this.once('ready', resolve);\r\n        this.end();\r\n      });\r\n    }\r\n\r\n    this.begin();\r\n    this.once('ready', callback);\r\n    this.end();\r\n\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * Wait for this asynchronous function to execute before triggering ready event.\r\n   *\r\n   * @param  {Function} callback   [ Function to execute whilst holding queued callback. Once complete run first argument, done(). ]\r\n   * @return {Object}\r\n   */\r\n  for(callback) {\r\n    this.begin();\r\n    _.defer(() => callback(_.once(this.end)));\r\n    return this;\r\n  }\r\n\r\n}\r\n\r\nconst wait = new Wait();\r\n\r\nexport default wait;\r\n","export default class LockingModel extends Backbone.Model {\r\n\r\n  set(attrName, attrVal, options = {}) {\r\n    const stopProcessing = (typeof attrName === 'object' || typeof attrVal !== 'boolean' || !this.isLocking(attrName));\r\n    if (stopProcessing) return super.set(...arguments);\r\n\r\n    const isSettingValueForSpecificPlugin = options?.pluginName;\r\n    if (!isSettingValueForSpecificPlugin) {\r\n      console.error('Must supply a pluginName to change a locked attribute');\r\n      options.pluginName = 'compatibility';\r\n    }\r\n\r\n    const pluginName = options.pluginName;\r\n    if (this.defaults[attrName] !== undefined) {\r\n      this._lockedAttributes[attrName] = !this.defaults[attrName];\r\n    }\r\n    const lockingValue = this._lockedAttributes[attrName];\r\n    const isAttemptingToLock = (lockingValue === attrVal);\r\n\r\n    if (isAttemptingToLock) {\r\n      this.setLockState(attrName, true, { pluginName: pluginName, skipcheck: true });\r\n      return super.set(attrName, lockingValue);\r\n    }\r\n\r\n    this.setLockState(attrName, false, { pluginName: pluginName, skipcheck: true });\r\n\r\n    const totalLockValue = this.getLockCount(attrName, { skipcheck: true });\r\n    if (totalLockValue === 0) {\r\n      return super.set(attrName, !lockingValue);\r\n    }\r\n\r\n    return this;\r\n\r\n  }\r\n\r\n  setLocking(attrName, defaultLockValue) {\r\n    if (this.isLocking(attrName)) return;\r\n    if (!this._lockedAttributes) this._lockedAttributes = {};\r\n    this._lockedAttributes[attrName] = defaultLockValue;\r\n  }\r\n\r\n  unsetLocking(attrName) {\r\n    if (!this.isLocking(attrName)) return;\r\n    if (!this._lockedAttributes) return;\r\n    delete this._lockedAttributes[attrName];\r\n    delete this._lockedAttributesValues[attrName];\r\n    if (Object.keys(this._lockedAttributes).length === 0) {\r\n      delete this._lockedAttributes;\r\n      delete this._lockedAttributesValues;\r\n    }\r\n  }\r\n\r\n  isLocking(attrName) {\r\n    const isCheckingGeneralLockingState = (attrName === undefined);\r\n    const isUsingLockedAttributes = Boolean(this.lockedAttributes || this._lockedAttributes);\r\n\r\n    if (isCheckingGeneralLockingState) {\r\n      return isUsingLockedAttributes;\r\n    }\r\n\r\n    if (!isUsingLockedAttributes) return false;\r\n\r\n    if (!this._lockedAttributes) {\r\n      this._lockedAttributes = _.result(this, 'lockedAttributes');\r\n    }\r\n\r\n    const isAttributeALockingAttribute = this._lockedAttributes.hasOwnProperty(attrName);\r\n    if (!isAttributeALockingAttribute) return false;\r\n\r\n    if (!this._lockedAttributesValues) {\r\n      this._lockedAttributesValues = {};\r\n    }\r\n\r\n    if (!this._lockedAttributesValues[attrName]) {\r\n      this._lockedAttributesValues[attrName] = {};\r\n    }\r\n\r\n    return true;\r\n  }\r\n\r\n  isLocked(attrName, options) {\r\n    const shouldSkipCheck = options?.skipcheck;\r\n    if (!shouldSkipCheck) {\r\n      const stopProcessing = !this.isLocking(attrName);\r\n      if (stopProcessing) return;\r\n    }\r\n\r\n    return this.getLockCount(attrName) > 0;\r\n  }\r\n\r\n  getLockCount(attrName, options) {\r\n    const shouldSkipCheck = options?.skipcheck;\r\n    if (!shouldSkipCheck) {\r\n      const stopProcessing = !this.isLocking(attrName);\r\n      if (stopProcessing) return;\r\n    }\r\n\r\n    const isGettingValueForSpecificPlugin = options?.pluginName;\r\n    if (isGettingValueForSpecificPlugin) {\r\n      return this._lockedAttributesValues[attrName][options.pluginName] ? 1 : 0;\r\n    }\r\n\r\n    const lockingAttributeValues = Object.values(this._lockedAttributesValues[attrName]);\r\n    const lockingAttributeValuesSum = lockingAttributeValues.reduce((sum, value) => sum + (value ? 1 : 0), 0);\r\n\r\n    return lockingAttributeValuesSum;\r\n  }\r\n\r\n  setLockState(attrName, value, options) {\r\n    const shouldSkipCheck = options?.skipcheck;\r\n    if (!shouldSkipCheck) {\r\n      const stopProcessing = !this.isLocking(attrName);\r\n      if (stopProcessing) return this;\r\n    }\r\n\r\n    const isSettingValueForSpecificPlugin = options?.pluginName;\r\n    if (!isSettingValueForSpecificPlugin) {\r\n      console.error('Must supply a pluginName to set a locked attribute lock value');\r\n      options.pluginName = 'compatibility';\r\n    }\r\n\r\n    if (value) {\r\n      this._lockedAttributesValues[attrName][options.pluginName] = value;\r\n    } else {\r\n      delete this._lockedAttributesValues[attrName][options.pluginName];\r\n    }\r\n\r\n    return this;\r\n\r\n  }\r\n\r\n}\r\n","import wait from 'core/js/wait';\r\nimport LockingModel from 'core/js/models/lockingModel';\r\n\r\nclass AdaptSingleton extends LockingModel {\r\n\r\n  initialize() {\r\n    this.loadScript = window.__loadScript;\r\n  }\r\n\r\n  defaults() {\r\n    return {\r\n      _canScroll: true, // to stop scrollTo behaviour,\r\n      _outstandingCompletionChecks: 0,\r\n      _pluginWaitCount: 0,\r\n      _isStarted: false,\r\n      _shouldDestroyContentObjects: true\r\n    };\r\n  }\r\n\r\n  lockedAttributes() {\r\n    return {\r\n      _canScroll: false\r\n    };\r\n  }\r\n\r\n  async init() {\r\n    this.addDirection();\r\n    this.disableAnimation();\r\n    this.trigger('adapt:preInitialize');\r\n    await wait.queue();\r\n\r\n    // wait until no more completion checking\r\n    this.deferUntilCompletionChecked(async () => {\r\n\r\n      // start adapt in a full restored state\r\n      this.trigger('adapt:start');\r\n      await wait.queue();\r\n\r\n      if (!Backbone.History.started) {\r\n        Backbone.history.start();\r\n      }\r\n\r\n      this.set('_isStarted', true);\r\n\r\n      this.trigger('adapt:initialize');\r\n      await wait.queue();\r\n\r\n    });\r\n  }\r\n\r\n  /**\r\n   * call when entering an asynchronous completion check\r\n   */\r\n  checkingCompletion() {\r\n    const outstandingChecks = this.get('_outstandingCompletionChecks');\r\n    this.set('_outstandingCompletionChecks', outstandingChecks + 1);\r\n  }\r\n\r\n  /**\r\n   * call when exiting an asynchronous completion check\r\n   */\r\n  checkedCompletion() {\r\n    const outstandingChecks = this.get('_outstandingCompletionChecks');\r\n    this.set('_outstandingCompletionChecks', outstandingChecks - 1);\r\n  }\r\n\r\n  /**\r\n   * wait until there are no outstanding completion checks\r\n   * @param {Function} [callback] Function to be called after all completion checks have been completed\r\n   */\r\n  async deferUntilCompletionChecked(callback = () => {}) {\r\n    if (this.get('_outstandingCompletionChecks') === 0) return callback();\r\n    return new Promise(resolve => {\r\n      const checkIfAnyChecksOutstanding = (model, outstandingChecks) => {\r\n        if (outstandingChecks !== 0) return;\r\n        this.off('change:_outstandingCompletionChecks', checkIfAnyChecksOutstanding);\r\n        callback();\r\n        resolve();\r\n      };\r\n      this.on('change:_outstandingCompletionChecks', checkIfAnyChecksOutstanding);\r\n    });\r\n  }\r\n\r\n  isWaitingForPlugins() {\r\n    this.log.deprecated('Use wait.isWaiting() as Adapt.isWaitingForPlugins() will be removed in the future');\r\n    return wait.isWaiting();\r\n  }\r\n\r\n  checkPluginsReady() {\r\n    this.log.deprecated('Use wait.isWaiting() as Adapt.checkPluginsReady() will be removed in the future');\r\n    if (this.isWaitingForPlugins()) {\r\n      return;\r\n    }\r\n    this.trigger('plugins:ready');\r\n  }\r\n\r\n  /**\r\n   * Relative strings describe the number and type of hops in the model hierarchy\r\n   * @param {string} relativeString \"@component +1\" means to move one component forward from the current model\r\n   * This function would return the following:\r\n   * {\r\n   *     type: \"component\",\r\n   *     offset: 1\r\n   * }\r\n   * Trickle uses this function to determine where it should scrollTo after it unlocks\r\n   */\r\n  parseRelativeString(relativeString) {\r\n    let splitIndex = relativeString.search(/[ +\\-\\d]{1}/);\r\n    if (splitIndex === -1) splitIndex = relativeString.length;\r\n    const type = relativeString.slice(0, splitIndex).replace(/^@/, '');\r\n    const offset = parseInt(relativeString.slice(splitIndex).trim() || 0);\r\n    return {\r\n      type: type,\r\n      offset: offset\r\n    };\r\n  }\r\n\r\n  addDirection() {\r\n    const defaultDirection = this.config.get('_defaultDirection');\r\n\r\n    $('html')\r\n      .addClass('dir-' + defaultDirection)\r\n      .attr('dir', defaultDirection);\r\n  }\r\n\r\n  disableAnimation() {\r\n    const disableAnimationArray = this.config.get('_disableAnimationFor');\r\n    const disableAnimation = this.config.get('_disableAnimation');\r\n\r\n    // Check if animations should be disabled\r\n    if (disableAnimationArray) {\r\n      for (let i = 0, l = disableAnimationArray.length; i < l; i++) {\r\n        if (!$('html').is(disableAnimationArray[i])) continue;\r\n        this.config.set('_disableAnimation', true);\r\n        $('html').addClass('disable-animation');\r\n        console.log('Animation disabled.');\r\n      }\r\n      return;\r\n    }\r\n\r\n    $('html').toggleClass('disable-animation', (disableAnimation === true));\r\n  }\r\n\r\n  async remove() {\r\n    const currentView = this.parentView;\r\n    if (currentView) {\r\n      currentView.model.setOnChildren({\r\n        _isReady: false,\r\n        _isRendered: false\r\n      });\r\n    }\r\n    this.trigger('preRemove', currentView);\r\n    await wait.queue();\r\n    // Facilitate contentObject transitions\r\n    if (currentView && this.get('_shouldDestroyContentObjects')) {\r\n      currentView.destroy();\r\n    }\r\n    this.trigger('remove', currentView);\r\n    _.defer(this.trigger.bind(this), 'postRemove', currentView);\r\n  }\r\n\r\n  /**\r\n   * @deprecated Please use core/js/a11y instead\r\n   */\r\n  get a11y() {}\r\n\r\n  /**\r\n   * @deprecated Please use core/js/components instead\r\n   */\r\n  get componentStore() {}\r\n\r\n  /**\r\n   * @deprecated Please use core/js/data instead\r\n   */\r\n  get data() {}\r\n\r\n  /**\r\n   * @deprecated Please use core/js/device instead\r\n   */\r\n  get device() {}\r\n\r\n  /**\r\n   * @deprecated Please use core/js/drawer instead\r\n   */\r\n  get drawer() {}\r\n\r\n  /**\r\n   * @deprecated Please use core/js/location instead\r\n   */\r\n  get location() {}\r\n\r\n  /**\r\n   * @deprecated Please use core/js/notify instead\r\n   */\r\n  get notify() {}\r\n\r\n  /**\r\n   * @deprecated Please use core/js/offlineStorage instead\r\n   */\r\n  get offlineStorage() {}\r\n\r\n  /**\r\n   * @deprecated Please use core/js/router instead\r\n   */\r\n  get router() {}\r\n\r\n  /**\r\n   * @deprecated Please use core/js/scrolling instead\r\n   */\r\n  get scrolling() {}\r\n\r\n  /**\r\n   * @deprecated Please use core/js/startController instead\r\n   */\r\n  get startController() {}\r\n\r\n  /**\r\n   * @deprecated Please use core/js/components instead\r\n   */\r\n  get store() {}\r\n\r\n  /**\r\n   * @deprecated Please use core/js/tracking instead\r\n   */\r\n  get tracking() {}\r\n\r\n  /**\r\n   * @deprecated Please use core/js/wait instead\r\n   */\r\n  get wait() {}\r\n\r\n  /**\r\n   * Allows a selector to be passed in and Adapt will navigate to this element. Resolves\r\n   * asynchronously when the element has been navigated to.  /**\r\n   * @deprecated Please use router.navigateToElement instead.\r\n   * @param {string} selector CSS selector of the Adapt element you want to navigate to e.g. `\".co-05\"`\r\n   * @param {Object} [settings] The settings for the `$.scrollTo` function (See https://github.com/flesler/jquery.scrollTo#settings).\r\n   * @param {Object} [settings.replace=false] Set to `true` if you want to update the URL without creating an entry in the browser's history.\r\n   */\r\n  async navigateToElement() {}\r\n\r\n  /**\r\n   * Allows a selector to be passed in and Adapt will scroll to this element. Resolves\r\n   * asynchronously when the element has been navigated/scrolled to.\r\n   * @deprecated Please use router.navigateToElement instead.\r\n   * @param {string} selector CSS selector of the Adapt element you want to navigate to e.g. `\".co-05\"`\r\n   * @param {Object} [settings={}] The settings for the `$.scrollTo` function (See https://github.com/flesler/jquery.scrollTo#settings).\r\n   * @param {Object} [settings.replace=false] Set to `true` if you want to update the URL without creating an entry in the browser's history.\r\n   */\r\n  async scrollTo() {}\r\n\r\n  /**\r\n   * Used to register models and views with `store`\r\n   * @deprecated Please use components.register instead.\r\n   * @param {string|Array} name The name(s) of the model/view to be registered\r\n   * @param {object} object Object containing properties `model` and `view` or (legacy) an object representing the view\r\n   */\r\n  register(name, object) {}\r\n\r\n  /**\r\n   * Parses a view class name.\r\n   * @deprecated Please use components.getViewName instead.\r\n   * @param {string|Backbone.Model|Backbone.View|object} nameModelViewOrData The name of the view class you want to fetch e.g. `\"hotgraphic\"` or its model or its json data\r\n   */\r\n  getViewName() {}\r\n\r\n  /**\r\n   * Fetches a view class from the store. For a usage example, see either HotGraphic or Narrative\r\n   * @deprecated Please use components.getViewClass instead.\r\n   * @param {string|Backbone.Model|Backbone.View|object} nameModelViewOrData The name of the view class you want to fetch e.g. `\"hotgraphic\"` or its model or its json data\r\n   * @returns {Backbone.View} Reference to the view class\r\n   */\r\n  getViewClass() {}\r\n\r\n  /**\r\n   * Parses a model class name.\r\n   * @deprecated Please use components.getModelName instead.\r\n   * @param {string|Backbone.Model|object} name The name of the model you want to fetch e.g. `\"hotgraphic\"`, the model to process or its json data\r\n   */\r\n  getModelName() {}\r\n\r\n  /**\r\n   * Fetches a model class from the store. For a usage example, see either HotGraphic or Narrative\r\n   * @deprecated Please use components.getModelClass instead.\r\n   * @param {string|Backbone.Model|object} name The name of the model you want to fetch e.g. `\"hotgraphic\"` or its json data\r\n   * @returns {Backbone.Model} Reference to the view class\r\n   */\r\n  getModelClass() {}\r\n\r\n  /**\r\n   * Looks up a model by its `_id` property\r\n   * @deprecated Please use data.findById instead.\r\n   * @param {string} id The id of the item e.g. \"co-05\"\r\n   * @return {Backbone.Model}\r\n   */\r\n  findById() {}\r\n\r\n  /**\r\n   * Looks up a view by its model `_id` property\r\n   * @deprecated Please use data.findViewByModelId instead.\r\n   * @param {string} id The id of the item e.g. \"co-05\"\r\n   * @return {Backbone.View}\r\n   */\r\n  findViewByModelId() {}\r\n\r\n  /**\r\n   * Returns the model represented by the trackingPosition.\r\n   * @deprecated Please use data.findByTrackingPosition instead.\r\n   * @param {Array<Number, Number>} trackingPosition Represents the relative location of a model to a _trackingId\r\n   * @returns {Backbone.Model}\r\n   */\r\n  findByTrackingPosition() {}\r\n\r\n}\r\n\r\nconst Adapt = new AdaptSingleton();\r\n\r\nexport default Adapt;\r\n","import Adapt from 'core/js/adapt';\r\n\r\n// Basic API for setting and getting name+value pairs\r\n// Allows registration of a single handler.\r\n\r\nclass OfflineStorage extends Backbone.Controller {\r\n\r\n  /**\r\n   * set .ready to false if an offlineStorage handler is being attached - we'll need to wait until the handler lets us know\r\n   * it's ready before we can safely use offlineStorage\r\n   */\r\n  initialize(handler) {\r\n    /**\r\n     * set to true initially so that if there are no offlineStorage handlers (i.e. if contrib-spoor is not installed)\r\n     * this can still be accessed OK\r\n     */\r\n    this.ready = true;\r\n    this._handler = undefined;\r\n\r\n    if (!handler) {\r\n      return;\r\n    }\r\n\r\n    this.ready = false;\r\n    this._handler = handler;\r\n  }\r\n\r\n  /**\r\n   * Flag to indicate if an offlineStorage handler has been defined.\r\n   * @returns {boolean} true if an offlineStorage handler has been defined, false otherwise\r\n   */\r\n  hasHandler() {\r\n    return this._handler !== undefined;\r\n  }\r\n\r\n  /**\r\n   * Causes state to be serialized and saved.\r\n   */\r\n  save() {\r\n    Adapt.trigger('tracking:save');\r\n    return this._handler?.save?.(...arguments);\r\n  }\r\n\r\n  /**\r\n   * Serializes nested arrays, booleans and numbers into an encoded string.\r\n   * @param {Array|boolean|number} value\r\n   * @returns {string}\r\n   */\r\n  serialize(value) {\r\n    if (this._handler?.serialize) {\r\n      return this._handler.serialize(...arguments);\r\n    }\r\n    return JSON.stringify(value);\r\n  }\r\n\r\n  /**\r\n   * Deserializes encoded strings back into nested arrays, booleans and numbers.\r\n   * @param {string} value\r\n   * @returns {Array|boolean|number}\r\n   */\r\n  deserialize(value) {\r\n    if (this._handler?.deserialize) {\r\n      return this._handler.deserialize(...arguments);\r\n    }\r\n    return JSON.parse(value);\r\n  }\r\n\r\n  set(name, value) {\r\n    if (this._handler?.set) {\r\n      return this._handler.set(...arguments);\r\n    }\r\n    // if no handler has been defined, just store the data locally\r\n    this[name] = value;\r\n  }\r\n\r\n  get(name) {\r\n    if (this._handler?.get) {\r\n      return this._handler.get(...arguments);\r\n    }\r\n    // if no handler has been defined, check local data store\r\n    return this[name];\r\n  }\r\n\r\n  clear() {\r\n    if (this._handler?.clear) {\r\n      return this._handler.clear(...arguments);\r\n    }\r\n    return false;\r\n  }\r\n\r\n  /**\r\n   * Some forms of offlineStorage could take time to initialise, this allows us to let plugins know when it's ready to be used\r\n   */\r\n  setReadyStatus() {\r\n    this.ready = true;\r\n    Adapt.trigger('offlineStorage:ready');\r\n  }\r\n\r\n}\r\n\r\nconst offlineStorage = new OfflineStorage();\r\nexport default offlineStorage;\r\n","import Adapt from 'core/js/adapt';\r\nimport Bowser from 'bowser';\r\nimport _ from 'underscore';\r\n\r\nclass Device extends Backbone.Controller {\r\n\r\n  initialize() {\r\n    _.bindAll(this, 'onWindowResize', 'calculateResize');\r\n    this.bowser = Bowser.parse(window.navigator.userAgent);\r\n    this.$html = $('html');\r\n    this.$window = $(window);\r\n    this.touch = Modernizr.touchevents;\r\n    this.screenWidth = this.getScreenWidth();\r\n    this.screenHeight = this.getScreenHeight();\r\n    this.browser = (this.bowser.browser.name || '').toLowerCase();\r\n    this.version = (this.bowser.browser.version || '').toLowerCase();\r\n    this.OS = this.getOperatingSystem().toLowerCase();\r\n    this.osVersion = this.bowser.os.version || '';\r\n    this.renderingEngine = this.getRenderingEngine();\r\n    this.listenTo(Adapt, {\r\n      'configModel:dataLoaded': this.onConfigDataLoaded\r\n    });\r\n    const browser = this.browser.toLowerCase();\r\n    // Convert 'msie' and 'internet explorer' to 'ie'.\r\n    let browserString = browser.replace(/msie|internet explorer/, 'ie');\r\n    browserString += ` version-${this.version} OS-${this.OS} ${this.getAppleDeviceType()}`;\r\n    // Legacy bad code, missing space after getAppleDevice and string replace is not global\r\n    browserString += browserString.replace('.', '-').toLowerCase();\r\n    browserString += ` ${browserString.replace(/\\./g, '-').toLowerCase()}`;\r\n    browserString += ` pixel-density-${this.pixelDensity()}`;\r\n    this.$html.addClass(browserString);\r\n  }\r\n\r\n  get orientation() {\r\n    return (this.screenWidth >= this.screenHeight) ? 'landscape' : 'portrait';\r\n  }\r\n\r\n  get aspectRatio() {\r\n    return this.screenWidth / this.screenHeight;\r\n  }\r\n\r\n  onConfigDataLoaded() {\r\n    this.screenSize = this.checkScreenSize();\r\n    this.$html.addClass('size-' + this.screenSize);\r\n    if (this.orientation) {\r\n      this.$html.addClass('orientation-' + this.orientation);\r\n    }\r\n    // As Adapt.config is available it's ok to bind the 'resize'.\r\n    this.$window.on('resize orientationchange', this.onWindowResize);\r\n  }\r\n\r\n  /**\r\n   * Compares the calculated screen width to the breakpoints defined in config.json.\r\n   *\r\n   * @returns {string} 'large', 'medium' or 'small'\r\n   */\r\n  checkScreenSize() {\r\n    const screenSizeConfig = Adapt.config.get('screenSize');\r\n    let screenSize;\r\n\r\n    const screensizeEmThreshold = 300;\r\n    const baseFontSize = 16;\r\n\r\n    // Check to see if the screen size value is larger than the em threshold\r\n    // If value is larger than em threshold, convert value (assumed px) to ems\r\n    // Otherwise assume value is in ems\r\n    const mediumEmBreakpoint = screenSizeConfig.medium > screensizeEmThreshold\r\n      ? screenSizeConfig.medium / baseFontSize\r\n      : screenSizeConfig.medium;\r\n    const smallEmBreakpoint = screenSizeConfig.small > screensizeEmThreshold\r\n      ? screenSizeConfig.small / baseFontSize\r\n      : screenSizeConfig.small;\r\n\r\n    const fontSize = parseFloat($('html').css('font-size'));\r\n    const screenSizeEmWidth = (window.innerWidth / fontSize);\r\n\r\n    // Check to see if client screen width is larger than medium em breakpoint\r\n    // If so apply large, otherwise check to see if client screen width is\r\n    // larger than small em breakpoint. If so apply medium, otherwise apply small\r\n    if (screenSizeEmWidth >= mediumEmBreakpoint) {\r\n      screenSize = 'large';\r\n    } else if (screenSizeEmWidth >= smallEmBreakpoint) {\r\n      screenSize = 'medium';\r\n    } else {\r\n      screenSize = 'small';\r\n    }\r\n\r\n    return screenSize;\r\n  }\r\n\r\n  getScreenWidth() {\r\n    return this.isAppleDevice()\r\n      ? this.getAppleScreenWidth()\r\n      : window.innerWidth || this.$window.width();\r\n  }\r\n\r\n  getScreenHeight() {\r\n    return this.isAppleDevice()\r\n      ? this.getAppleScreenHeight()\r\n      : window.innerHeight || this.$window.height();\r\n  }\r\n\r\n  getOperatingSystem() {\r\n    let os = this.bowser.os.name.toLowerCase() || '';\r\n\r\n    if (os === '') {\r\n      // Fall back to using navigator.platform in case Bowser can't detect the OS.\r\n      const platform = navigator.platform.toLowerCase();\r\n      const match = platform.match(/win|mac|linux/);\r\n      if (match) os = match[0];\r\n      // Set consistency with the Bowser flags.\r\n      if (os === 'win') os = 'windows';\r\n      if (!os) os = '';\r\n    }\r\n\r\n    if (!os) os = 'platformunknown';\r\n\r\n    return os;\r\n  }\r\n\r\n  getRenderingEngine() {\r\n    return this.bowser.engine.name || '';\r\n  }\r\n\r\n  onWindowResize() {\r\n    if (this.hasWindowResized) return;\r\n    requestAnimationFrame(this.calculateResize);\r\n    this.hasWindowResized = true;\r\n  }\r\n\r\n  calculateResize() {\r\n    this.hasWindowResized = false;\r\n    // Calculate the screen properties.\r\n    const previousWidth = this.screenWidth;\r\n    const previousHeight = this.screenHeight;\r\n\r\n    this.screenWidth = this.getScreenWidth();\r\n    this.screenHeight = this.getScreenHeight();\r\n\r\n    if (previousWidth === this.screenWidth && previousHeight === this.screenHeight) {\r\n      // Do not trigger a change if the viewport hasn't actually changed.  Scrolling on iOS will trigger a resize.\r\n      return;\r\n    }\r\n\r\n    if (this.orientation) {\r\n      this.$html.toggleClass('orientation-landscape', this.orientation === 'landscape');\r\n      this.$html.toggleClass('orientation-portrait', this.orientation === 'portrait');\r\n    }\r\n\r\n    const newScreenSize = this.checkScreenSize();\r\n    if (newScreenSize !== this.screenSize) {\r\n      this.screenSize = newScreenSize;\r\n      this.$html.toggleClass('size-small', this.screenSize === 'small');\r\n      this.$html.toggleClass('size-medium', this.screenSize === 'medium');\r\n      this.$html.toggleClass('size-large', this.screenSize === 'large');\r\n      Adapt.trigger('device:changed', this.screenSize);\r\n    }\r\n\r\n    Adapt.trigger('device:preResize device:resize device:postResize', this.screenWidth);\r\n  }\r\n\r\n  isAppleDevice() {\r\n    return (/iPad|iPhone|iPod/.test(navigator.userAgent) && !window.MSStream) || (navigator.userAgent.match(/Mac/) && navigator?.maxTouchPoints > 2);\r\n  }\r\n\r\n  get shouldReportInvertedAppleScreenSize() {\r\n    const windowRatio = (window.innerWidth / window.innerHeight);\r\n    const screenRatio = (window.screen.width / window.screen.height);\r\n    const isWindowPortrait = (windowRatio < 1);\r\n    const isScreenPortrait = (screenRatio < 1);\r\n    const isDeviceBadlyReportingScreenOrientation = (isWindowPortrait !== isScreenPortrait);\r\n    return isDeviceBadlyReportingScreenOrientation;\r\n  }\r\n\r\n  getAppleScreenWidth() {\r\n    return this.shouldReportInvertedAppleScreenSize ? window.screen.height : window.screen.width;\r\n  }\r\n\r\n  getAppleScreenHeight() {\r\n    return this.shouldReportInvertedAppleScreenSize ? window.screen.width : window.screen.height;\r\n  }\r\n\r\n  getAppleDeviceType() {\r\n    const platformType = this.bowser.platform.type?.toLowerCase() || '';\r\n    const browserName = this.bowser.browser.name?.toLowerCase() || '';\r\n    const isIPhone = (platformType === 'mobile' && browserName === 'safari');\r\n    const isIPad = (platformType === 'tablet' && browserName === 'safari');\r\n    if (isIPhone) return 'iphone';\r\n    if (isIPad) return 'ipad';\r\n    return '';\r\n  }\r\n\r\n  pixelDensity() {\r\n    const pixelDensity = (window.devicePixelRatio || 1);\r\n\r\n    if (pixelDensity >= 3) {\r\n      return 'ultra-high';\r\n    } else if (pixelDensity >= 2) {\r\n      return 'high';\r\n    } else if (pixelDensity >= 1.5) {\r\n      return 'medium';\r\n    } else {\r\n      return 'low';\r\n    }\r\n  }\r\n\r\n}\r\n\r\nconst device = new Device();\r\nexport default device;\r\n","import Backbone from 'backbone';\r\n\r\nclass Location extends Backbone.Controller {\r\n\r\n  initialize() {\r\n    /**\r\n     * _id of previous contentobject\r\n     * @type {string}\r\n     */\r\n    this._previousId = null;\r\n    /**\r\n     * _type of previous contentobject\r\n     * @type {string}\r\n     */\r\n    this._previousContentType = null;\r\n    /**\r\n     * Model of previous contentobject\r\n     * @type {Backbone.Model}\r\n     */\r\n    this._previousModel = null;\r\n    /**\r\n     * _htmlClasses of previous contentobject\r\n     * @type {string}\r\n     */\r\n    this._previousClasses = null;\r\n    /**\r\n     * Alias for _previousContentType\r\n     * @type {string}\r\n     */\r\n    this._lastVisitedType = null;\r\n    /**\r\n     * _id of last menu\r\n     * @type {string}\r\n     * */\r\n    this._lastVisitedMenu = null;\r\n    /**\r\n     * _id of last page\r\n     * @type {string}\r\n     * */\r\n    this._lastVisitedPage = null;\r\n    /**\r\n     * _id of current contentobject\r\n     * @type {string}\r\n     */\r\n    this._currentId = null;\r\n    /**\r\n     * Model of current contentobject\r\n     * @type {Backbone.Model}\r\n     */\r\n    this._currentModel = null;\r\n    /**\r\n     * Current url querystring\r\n     * @type {string}\r\n     */\r\n    this._currentLocation = null;\r\n    /**\r\n     * Current contentobject type\r\n     * @type {string}\r\n     */\r\n    this._contentType = null;\r\n  }\r\n\r\n}\r\n\r\nconst location = new Location();\r\nexport default location;\r\n","import Adapt from 'core/js/adapt';\r\n\r\n/**\r\n * Browser modifications to focus handling.\r\n * @class\r\n */\r\nexport default class BrowserFocus extends Backbone.Controller {\r\n\r\n  initialize({ a11y }) {\r\n    this.a11y = a11y;\r\n    this._onBlur = this._onBlur.bind(this);\r\n    this._onClick = this._onClick.bind(this);\r\n    this.$body = $('body');\r\n    this.listenTo(Adapt, {\r\n      'accessibility:ready': this._attachEventListeners\r\n    });\r\n  }\r\n\r\n  _attachEventListeners() {\r\n    this.$body\r\n      .on('blur', '*', this._onBlur)\r\n      .on('blur', this._onBlur);\r\n    // 'Capture' event attachment for click\r\n    this.$body[0].addEventListener('click', this._onClick, true);\r\n  }\r\n\r\n  /**\r\n   * When any element in the document receives a blur event,\r\n   * check to see if it needs the `data-a11y-force-focus` attribute removing\r\n   * and check to see if it was blurred because a disabled attribute was added.\r\n   * If a disabled attribute was added, the focus will be moved forward.\r\n   *\r\n   * @param {JQuery.Event} event\r\n   */\r\n  _onBlur(event) {\r\n    const config = this.a11y.config;\r\n    if (!config._isEnabled || !config._options._isFocusNextOnDisabled) {\r\n      return;\r\n    }\r\n    const $element = $(event.target);\r\n    if ($element.is('[data-a11y-force-focus]')) {\r\n      $element.removeAttr('tabindex data-a11y-force-focus');\r\n    }\r\n    // From here, only check source elements\r\n    if (event.target !== event.currentTarget) {\r\n      return;\r\n    }\r\n    // Check if element losing focus is losing focus\r\n    // due to the addition of a disabled class\r\n    if (!$element.is('[disabled]') && $element.css('display') !== 'none' && $element.css('visibility') !== 'hidden') {\r\n      return;\r\n    }\r\n    // Move focus to next readable element\r\n    this.a11y.focusNext($element);\r\n  }\r\n\r\n  /**\r\n   * Force focus when clicked on a tabbable element,\r\n   * making sure `document.activeElement` is updated.\r\n   * Stop event handling on aria-disabled elements.\r\n   *\r\n   * @param {JQuery.Event} event\r\n   */\r\n  _onClick(event) {\r\n    const $element = $(event.target);\r\n    // search element and parents for aria-disabled - see https://github.com/adaptlearning/adapt_framework/issues/3097\r\n    const isAriaDisabled = $element.closest('[aria-disabled=true]').length === 1;\r\n    if (isAriaDisabled) {\r\n      event.preventDefault();\r\n      event.stopImmediatePropagation();\r\n    }\r\n    const config = this.a11y.config;\r\n    if (!config._isEnabled || !config._options._isFocusOnClickEnabled) {\r\n      return;\r\n    }\r\n    const $stack = $([...$element.toArray(), ...$element.parents().toArray()]);\r\n    const $focusable = $stack.filter(config._options._tabbableElements);\r\n    if (!$focusable.length) {\r\n      return;\r\n    }\r\n    // Force focus for screen reader enter / space press\r\n    $focusable[0].focus();\r\n  }\r\n\r\n}\r\n","export default class FocusOptions {\r\n\r\n  /**\r\n   * Options parser for focus functions.\r\n   * @param {Object} options\r\n   * @param {boolean} [options.preventScroll=false] Stops the browser from scrolling to the focused point. https://developer.mozilla.org/en-US/docs/Web/API/HTMLElement/focus\r\n   * @param {boolean} [options.defer=false] Add a defer to the focus call, allowing for user interface settling.\r\n   */\r\n  constructor({\r\n    preventScroll = false,\r\n    defer = false\r\n  } = {}) {\r\n    /**\r\n    * Stops the browser from scrolling to the focused point.\r\n    * https://developer.mozilla.org/en-US/docs/Web/API/HTMLElement/focus\r\n    * @type {boolean}\r\n    */\r\n    this.preventScroll = preventScroll;\r\n    /**\r\n     * Add a defer to the focus call, allowing for user interface settling.\r\n     * @type {boolean}\r\n     */\r\n    this.defer = defer;\r\n  }\r\n\r\n}\r\n","import Adapt from 'core/js/adapt';\r\n\r\n/**\r\n * Manages whether or not the focus outline should be entirely removed\r\n * or removed until a key is pressed on a tabbable element.\r\n * @class\r\n */\r\nexport default class KeyboardFocusOutline extends Backbone.Controller {\r\n\r\n  initialize({ a11y }) {\r\n    this.a11y = a11y;\r\n    this._onKeyDown = this._onKeyDown.bind(this);\r\n    this.$html = $('html');\r\n    this.showOnKeys = {\r\n      9: true, // tab\r\n      13: true, // enter\r\n      32: true, // space\r\n      37: true, // arrow left\r\n      38: true, // arrow up\r\n      39: true, // arrow right\r\n      40: true // arrow down\r\n    };\r\n    this.listenTo(Adapt, {\r\n      'accessibility:ready': this._attachEventListeners\r\n    });\r\n  }\r\n\r\n  _attachEventListeners() {\r\n    document.addEventListener('keydown', this._onKeyDown);\r\n    this._start();\r\n  }\r\n\r\n  /**\r\n   * Add styling classes if required.\r\n   */\r\n  _start() {\r\n    const config = this.a11y.config;\r\n    if (config._options._isFocusOutlineDisabled) {\r\n      this.$html.addClass('a11y-disable-focusoutline');\r\n      return;\r\n    }\r\n    if (!config._isEnabled || !config._options._isFocusOutlineKeyboardOnlyEnabled) {\r\n      return;\r\n    }\r\n    this.$html.addClass('a11y-disable-focusoutline');\r\n  }\r\n\r\n  /**\r\n   * Handle key down events for on a tabbable element.\r\n   *\r\n   * @param {JQuery.Event} event\r\n   */\r\n  _onKeyDown(event) {\r\n    const config = this.a11y.config;\r\n    if (config._options._isFocusOutlineDisabled) {\r\n      this.$html.addClass('a11y-disable-focusoutline');\r\n      return;\r\n    }\r\n    if (!config._isEnabled || !config._options._isFocusOutlineKeyboardOnlyEnabled || !this.showOnKeys[event.keyCode]) {\r\n      return;\r\n    }\r\n    const $element = $(event.target);\r\n    if (!$element.is(config._options._tabbableElements) || $element.is(config._options._focusOutlineKeyboardOnlyIgnore)) {\r\n      return;\r\n    }\r\n    this.$html.removeClass('a11y-disable-focusoutline');\r\n  }\r\n\r\n}\r\n","// Used to determine if log call should be printed based on log level\r\nconst LOG_LEVEL = ENUM([\r\n  'DEBUG',\r\n  'INFO',\r\n  'WARN',\r\n  'ERROR',\r\n  'FATAL'\r\n]);\r\n\r\nexport default LOG_LEVEL;\r\n","import Adapt from 'core/js/adapt';\r\nimport LOG_LEVEL from 'core/js/enums/logLevelEnum';\r\n\r\nclass Logging extends Backbone.Controller {\r\n\r\n  initialize() {\r\n    this._config = {\r\n      _isEnabled: true,\r\n      _level: LOG_LEVEL.INFO.asLowerCase, // Default log level\r\n      _console: true, // Log to console\r\n      _warnFirstOnly: true // Show only first of identical removed and deprecated warnings\r\n    };\r\n    this._warned = {};\r\n    this.listenToOnce(Adapt, 'configModel:dataLoaded', this.onLoadConfigData);\r\n  }\r\n\r\n  onLoadConfigData() {\r\n\r\n    this.loadConfig();\r\n\r\n    this.debug('Logging config loaded');\r\n\r\n    this.trigger('log:ready');\r\n\r\n  }\r\n\r\n  loadConfig() {\r\n\r\n    if (Adapt.config.has('_logging')) {\r\n      this._config = Adapt.config.get('_logging');\r\n    }\r\n\r\n    this.checkQueryStringOverride();\r\n\r\n  }\r\n\r\n  checkQueryStringOverride() {\r\n\r\n    // Override default log level with level present in query string\r\n    const matches = window.location.search.match(/[?&]loglevel=([a-z]*)/i);\r\n    if (!matches || matches.length < 2) return;\r\n\r\n    const override = LOG_LEVEL(matches[1].toUpperCase());\r\n    if (!override) return;\r\n\r\n    this._config._level = override.asLowerCase;\r\n    this.debug('Loglevel override in query string:', this._config._level);\r\n\r\n  }\r\n\r\n  debug(...args) {\r\n    this._log(LOG_LEVEL.DEBUG, args);\r\n  }\r\n\r\n  info(...args) {\r\n    this._log(LOG_LEVEL.INFO, args);\r\n  }\r\n\r\n  warn(...args) {\r\n    this._log(LOG_LEVEL.WARN, args);\r\n  }\r\n\r\n  error(...args) {\r\n    this._log(LOG_LEVEL.ERROR, args);\r\n  }\r\n\r\n  fatal(...args) {\r\n    this._log(LOG_LEVEL.FATAL, args);\r\n  }\r\n\r\n  removed(...args) {\r\n    args = ['REMOVED'].concat(args);\r\n    this.warnOnce(...args);\r\n  }\r\n\r\n  deprecated(...args) {\r\n    args = ['DEPRECATED'].concat(args);\r\n    this.warnOnce(...args);\r\n  }\r\n\r\n  warnOnce(...args) {\r\n    if (this._hasWarned(args)) {\r\n      return;\r\n    }\r\n    this._log(LOG_LEVEL.WARN, args);\r\n  }\r\n\r\n  _log(level, data) {\r\n\r\n    const isEnabled = (this._config._isEnabled);\r\n    if (!isEnabled) return;\r\n\r\n    const configLevel = LOG_LEVEL(this._config._level.toUpperCase());\r\n\r\n    const isLogLevelAllowed = (level >= configLevel);\r\n    if (!isLogLevelAllowed) return;\r\n\r\n    this._logToConsole(level, data);\r\n\r\n    // Allow error reporting plugins to hook and report to logging systems\r\n    this.trigger('log', level, data);\r\n    this.trigger('log:' + level.asLowerCase, level, data);\r\n\r\n  }\r\n\r\n  _logToConsole(level, data) {\r\n\r\n    const shouldLogToConsole = (this._config._console);\r\n    if (!shouldLogToConsole) return;\r\n\r\n    const log = [level.asUpperCase + ':'];\r\n    data && log.push(...data);\r\n\r\n    // is there a matching console method we can use e.g. console.error()?\r\n    if (console[level.asLowerCase]) {\r\n      console[level.asLowerCase](...log);\r\n    } else {\r\n      console.log(...log);\r\n    }\r\n  }\r\n\r\n  _hasWarned(args) {\r\n    if (!this._config._warnFirstOnly) {\r\n      return false;\r\n    }\r\n    const hash = args.map(String).join(':');\r\n    if (this._warned[hash]) {\r\n      return true;\r\n    }\r\n    this._warned[hash] = true;\r\n    return false;\r\n  }\r\n\r\n}\r\n\r\nconst logging = new Logging();\r\nexport default logging;\r\n","import logging from 'core/js/logging';\r\n\r\n/**\r\n * Controller for managing accessibilty logging, specifically used for\r\n * controlling the display of removed or deprecated API warnings.\r\n */\r\nexport default class Log extends Backbone.Controller {\r\n\r\n  initialize({ a11y }) {\r\n    this.a11y = a11y;\r\n    this._warned = {};\r\n  }\r\n\r\n  _hasWarned(args) {\r\n    const config = this.a11y.config;\r\n    if (!config._options._warnFirstOnly) {\r\n      return false;\r\n    }\r\n    const hash = args.map(String).join(':');\r\n    if (this._warned[hash]) {\r\n      return true;\r\n    }\r\n    this._warned[hash] = true;\r\n    return false;\r\n  }\r\n\r\n  _canWarn() {\r\n    const config = this.a11y.config;\r\n    return Boolean(config._options._warn);\r\n  }\r\n\r\n  removed(...args) {\r\n    if (!this._canWarn) {\r\n      return;\r\n    }\r\n    args = ['A11Y'].concat(args);\r\n    if (this._hasWarned(args)) {\r\n      return;\r\n    }\r\n    logging.removed(...args);\r\n    return this;\r\n  }\r\n\r\n  deprecated(...args) {\r\n    if (!this._canWarn) {\r\n      return;\r\n    }\r\n    args = ['A11Y'].concat(args);\r\n    if (this._hasWarned(args)) {\r\n      return;\r\n    }\r\n    logging.deprecated(...args);\r\n    return this;\r\n  }\r\n\r\n}\r\n","/**\r\n * Controller for blocking scroll events on specified elements.\r\n * @class\r\n */\r\nexport default class Scroll extends Backbone.Controller {\r\n\r\n  initialize() {\r\n    this._onTouchStart = this._onTouchStart.bind(this);\r\n    this._onTouchEnd = this._onTouchEnd.bind(this);\r\n    this._onScrollEvent = this._onScrollEvent.bind(this);\r\n    this._onKeyDown = this._onKeyDown.bind(this);\r\n    this._scrollDisabledElements = $([]);\r\n    this.$window = $(window);\r\n    this.$body = $('body');\r\n    this._preventScrollOnKeys = {\r\n      37: true, // left\r\n      38: true, // up\r\n      39: true, // right\r\n      40: true // down\r\n    };\r\n    this._ignoreKeysOnElementsMatching = 'textarea, input, select';\r\n    this._isRunning = false;\r\n    this._touchStartEventObject = null;\r\n  }\r\n\r\n  /**\r\n   * Block scrolling on the given elements.\r\n   *\r\n   * @param {Object|string|Array} $elements\r\n   */\r\n  disable($elements) {\r\n    $elements = $($elements);\r\n    this._scrollDisabledElements = this._scrollDisabledElements.add($elements);\r\n    this._checkRunning();\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * Stop blocking scrolling on the given elements.\r\n   *\r\n   * @param {Object|string|Array} $items\r\n   */\r\n  enable($elements) {\r\n    $elements = $($elements);\r\n    if (!$elements.length) {\r\n      this.clear();\r\n      return this;\r\n    }\r\n    this._scrollDisabledElements = this._scrollDisabledElements.not($elements);\r\n    this._checkRunning();\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * Stop blocking all scrolling.\r\n   */\r\n  clear() {\r\n    this._scrollDisabledElements = $([]);\r\n    this._checkRunning();\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * Start or stop listening for events to block if and when needed.\r\n   */\r\n  _checkRunning() {\r\n    if (!this._scrollDisabledElements.length) {\r\n      this._stop();\r\n      return;\r\n    }\r\n    this._start();\r\n  }\r\n\r\n  /**\r\n   * Start listening for events to block.\r\n   */\r\n  _start() {\r\n    if (this._isRunning) {\r\n      return;\r\n    }\r\n    this._isRunning = true;\r\n    window.addEventListener('touchstart', this._onTouchStart); // mobile\r\n    window.addEventListener('touchend', this._onTouchEnd); // mobile\r\n    window.addEventListener('touchmove', this._onScrollEvent, { passive: false }); // mobile\r\n    window.addEventListener('wheel', this._onScrollEvent, { passive: false });\r\n    document.addEventListener('wheel', this._onScrollEvent, { passive: false });\r\n    document.addEventListener('keydown', this._onKeyDown);\r\n  }\r\n\r\n  /**\r\n   * Capture the touchstart event object for deltaY calculations.\r\n   *\r\n   * @param {JQuery.Event} event\r\n   */\r\n  _onTouchStart(event) {\r\n    event = $.event.fix(event);\r\n    this._touchStartEventObject = event;\r\n    return true;\r\n  }\r\n\r\n  /**\r\n   * Clear touchstart event object.\r\n   */\r\n  _onTouchEnd() {\r\n    this._touchStartEventObject = null;\r\n    return true;\r\n  }\r\n\r\n  /**\r\n   * Process a native scroll event.\r\n   *\r\n   * @param {JQuery.Event} event\r\n   */\r\n  _onScrollEvent(event) {\r\n    event = $.event.fix(event);\r\n    return this._preventScroll(event);\r\n  }\r\n\r\n  /**\r\n   * Process a native keydown event.\r\n   *\r\n   * @param {JQuery.Event} event\r\n   */\r\n  _onKeyDown(event) {\r\n    event = $.event.fix(event);\r\n    if (!this._preventScrollOnKeys[event.keyCode]) {\r\n      return;\r\n    }\r\n    const $target = $(event.target);\r\n    if ($target.is(this._ignoreKeysOnElementsMatching)) {\r\n      return;\r\n    }\r\n    return this._preventScroll(event);\r\n  }\r\n\r\n  /**\r\n   * Process jquery event object.\r\n   *\r\n   * @param {JQuery.Event} event\r\n   */\r\n  _preventScroll(event) {\r\n    const isGesture = (event.touches?.length > 1);\r\n    if (isGesture) {\r\n      // allow multiple finger gestures through\r\n      // this will unfortunately allow two finger background scrolling on mobile devices\r\n      // one finger background scrolling will still be disabled\r\n      return;\r\n    }\r\n    const $target = $(event.target);\r\n    if (this._scrollDisabledElements.length) {\r\n      const scrollingParent = this._getScrollingParent(event, $target);\r\n      if (scrollingParent.filter(this._scrollDisabledElements).length === 0) {\r\n        this.$window.scroll();\r\n        return;\r\n      }\r\n    }\r\n    event.preventDefault();\r\n    return false;\r\n  }\r\n\r\n  /**\r\n   * Return the parent which will be scrolling from the current scroll event.\r\n   *\r\n   * @param {JQuery.Event} event\r\n   * @param {Object} $target jQuery element object.\r\n   */\r\n  _getScrollingParent(event, $target) {\r\n    const isTouchEvent = event.type === 'touchmove';\r\n    const hasTouchStartEvent = this._touchStartEventObject?.originalEvent;\r\n    if (isTouchEvent && !hasTouchStartEvent) {\r\n      return $target;\r\n    }\r\n    const directionY = this._getScrollDirection(event);\r\n    if (directionY === 'none') {\r\n      return this.$body;\r\n    }\r\n    // Make sure to check the element on which the scroll event was triggered\r\n    const parents = [$target[0], ...$target.parents()];\r\n    for (let i = 0, l = parents.length; i < l; i++) {\r\n      const $parent = $(parents[i]);\r\n      if ($parent.is('body')) {\r\n        return this.$body;\r\n      }\r\n      if (!this._isScrollable($parent)) {\r\n        continue;\r\n      }\r\n      if (!this._isScrolling($parent, directionY)) {\r\n        continue;\r\n      }\r\n      return $parent;\r\n    }\r\n    return this.$body;\r\n  }\r\n\r\n  /**\r\n   * Returns true if the specified target is scrollable.\r\n   *\r\n   * @param {Object} $target jQuery element object.\r\n   * @returns {boolean}\r\n   */\r\n  _isScrollable($target) {\r\n    const scrollType = $target.css('overflow-y');\r\n    if (scrollType !== 'auto' && scrollType !== 'scroll') {\r\n      return false;\r\n    }\r\n    const pointerEvents = $target.css('pointer-events');\r\n    if (pointerEvents === 'none') {\r\n      return false;\r\n    }\r\n    return true;\r\n  }\r\n\r\n  /**\r\n   * Returns true if the specified target is the scrolling target.\r\n   *\r\n   * @param {Object} $target jQuery element object.\r\n   * @param {string} directionY 'none' | 'up' | 'down'\r\n   *\r\n   * @returns {boolean}\r\n   */\r\n  _isScrolling($target, directionY) {\r\n    const scrollTop = Math.ceil($target.scrollTop());\r\n    const innerHeight = $target.outerHeight();\r\n    const scrollHeight = $target[0].scrollHeight;\r\n    let hasScrollingSpace = false;\r\n    switch (directionY) {\r\n      case 'down':\r\n        hasScrollingSpace = scrollTop + innerHeight < scrollHeight;\r\n        if (hasScrollingSpace) {\r\n          return true;\r\n        }\r\n        break;\r\n      case 'up':\r\n        hasScrollingSpace = scrollTop > 0;\r\n        if (hasScrollingSpace) {\r\n          return true;\r\n        }\r\n        break;\r\n    }\r\n    return false;\r\n  }\r\n\r\n  /**\r\n   * Returns the vertical direction of scroll.\r\n   *\r\n   * @param {JQuery.Event} event\r\n   * @returns {string} 'none' | 'up' | 'down'\r\n   */\r\n  _getScrollDirection(event) {\r\n    const deltaY = this._getScrollDelta(event);\r\n    if (deltaY === 0) {\r\n      return 'none';\r\n    }\r\n    return deltaY > 0 ? 'up' : 'down';\r\n  }\r\n\r\n  /**\r\n   * Returns the number of pixels which is intended to be scrolled.\r\n   *\r\n   * @param {JQuery.Event} event\r\n   * @returns {number}\r\n   */\r\n  _getScrollDelta(event) {\r\n    let deltaY = 0;\r\n    const isTouchEvent = event.type === 'touchmove';\r\n    const originalEvent = event.originalEvent;\r\n    if (isTouchEvent) {\r\n      // Touch events\r\n      // iOS previous + current scroll pos\r\n      const startOriginalEvent = this._touchStartEventObject.originalEvent;\r\n      let currentY = originalEvent.pageY;\r\n      let previousY = startOriginalEvent.pageY;\r\n      if (currentY === 0 || currentY === previousY) {\r\n        // Android chrome current scroll pos\r\n        currentY = originalEvent.touches[0].pageY;\r\n        previousY = startOriginalEvent.touches[0].pageY;\r\n      }\r\n      // Touch: delta calculated from touchstart pos vs touchmove pos\r\n      deltaY = currentY - previousY;\r\n    } else {\r\n      // Mouse events\r\n      const hasDeltaY = (originalEvent.wheelDeltaY || originalEvent.deltaY !== undefined);\r\n      if (hasDeltaY) {\r\n        // Desktop: Firefox & IE delta inverted\r\n        deltaY = -originalEvent.deltaY;\r\n      } else {\r\n        // Desktop: Chrome & Safari wheel delta\r\n        deltaY = (originalEvent.wheelDelta || 0);\r\n      }\r\n    }\r\n    return deltaY;\r\n  }\r\n\r\n  /**\r\n   * Stop listening for events to block.\r\n   */\r\n  _stop() {\r\n    if (!this._isRunning) {\r\n      return;\r\n    }\r\n    this._isRunning = false;\r\n    window.removeEventListener('touchstart', this._onTouchStart); // mobile\r\n    window.removeEventListener('touchend', this._onTouchEnd); // mobile\r\n    // shouldn't need to supply 3rd arg when removing, but IE11 won't remove the event listener if you don't - see https://github.com/adaptlearning/adapt_framework/issues/2466\r\n    window.removeEventListener('touchmove', this._onScrollEvent, { passive: false }); // mobile\r\n    window.removeEventListener('wheel', this._onScrollEvent, { passive: false });\r\n    document.removeEventListener('wheel', this._onScrollEvent, { passive: false });\r\n    document.removeEventListener('keydown', this._onKeyDown);\r\n  }\r\n\r\n}\r\n","import Adapt from 'core/js/adapt';\r\n\r\n/**\r\n * Controller for managing tab wrapping for popups.\r\n * @class\r\n */\r\nexport default class WrapFocus extends Backbone.Controller {\r\n\r\n  initialize({ a11y }) {\r\n    this.a11y = a11y;\r\n    _.bindAll(this, '_onWrapAround');\r\n    this.listenTo(Adapt, {\r\n      'accessibility:ready': this._attachEventListeners\r\n    });\r\n  }\r\n\r\n  _attachEventListeners() {\r\n    const config = this.a11y.config;\r\n    $('body').on('click focus', config._options._focusguard, this._onWrapAround);\r\n  }\r\n\r\n  /**\r\n   * If click or focus is received on any element with the focusguard class,\r\n   * loop focus around to the top of the document.\r\n   *\r\n   * @param {JQuery.Event} event\r\n   */\r\n  _onWrapAround(event) {\r\n    const config = this.a11y.config;\r\n    if (!config._isEnabled || !config._options._isPopupWrapFocusEnabled) {\r\n      return;\r\n    }\r\n    event.preventDefault();\r\n    event.stopPropagation();\r\n    this.a11y.focusFirst('body', { defer: false });\r\n  }\r\n\r\n}\r\n","import Adapt from 'core/js/adapt';\r\n\r\n/**\r\n * Tabindex and aria-hidden manager for popups.\r\n * @class\r\n */\r\nexport default class Popup extends Backbone.Controller {\r\n\r\n  initialize({ a11y }) {\r\n    this.a11y = a11y;\r\n    /**\r\n     * List of elements which form the base at which elements are generally tabbale\r\n     * and aria-hidden='false'.\r\n     *\r\n     * @type {Array<Object>}\r\n     */\r\n    this._floorStack = [$('body')];\r\n    /**\r\n     * List of elements to return the focus to once leaving each stack.\r\n     *\r\n     * @type {Array<Object>}\r\n     */\r\n    this._focusStack = [];\r\n    /**\r\n     * Hash of tabindex states for each tabbable element in the popup stack.\r\n     *\r\n     * @type {Object}\r\n     */\r\n    this._tabIndexes = {};\r\n    /**\r\n     * Hash of aria-hidden states for each tabbable element in the popup stack.\r\n     *\r\n     * @type {Object}\r\n     */\r\n    this._ariaHiddens = {};\r\n    /**\r\n     * Incremented unique ids for elements belonging to a popup stack with saved\r\n     * states,\r\n     */\r\n    this._elementUIDIndex = 0;\r\n    this.listenTo(Adapt, {\r\n      'popup:opened'($element, ignoreInternalTrigger) {\r\n        if (ignoreInternalTrigger) {\r\n          return;\r\n        }\r\n        this.a11y.log.deprecated('Adapt.trigger(\"popup:opened\", $element) is replaced with a11y.popupOpened($element);');\r\n        this.opened($element, true);\r\n      },\r\n      'popup:closed'($target, ignoreInternalTrigger) {\r\n        if (ignoreInternalTrigger) {\r\n          return;\r\n        }\r\n        this.a11y.log.deprecated('Adapt.trigger(\"popup:closed\", $target) is replaced with a11y.popupClosed($target);');\r\n        this.closed($target, true);\r\n      }\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Reorganise the tabindex and aria-hidden attributes in the document to\r\n   * restrict user interaction to the element specified.\r\n   *\r\n   * @param {Object} [$popupElement] Element encapulating the popup.\r\n   * @returns {Object} Returns `a11y._popup`.\r\n   */\r\n  opened($popupElement, silent) {\r\n    // Capture currently active element or element specified\r\n    $popupElement = $popupElement || $(document.activeElement);\r\n    this._addPopupLayer($popupElement);\r\n    if (!silent) {\r\n      Adapt.trigger('popup:opened', $popupElement, true);\r\n    }\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * Restrict tabbing and screen reader access to selected element only.\r\n   *\r\n   * @param {Object} $popupElement Element encapulating the popup.\r\n   */\r\n  _addPopupLayer($popupElement) {\r\n    $popupElement = $($popupElement);\r\n    const config = this.a11y.config;\r\n    if (!config._isEnabled || !config._options._isPopupManagementEnabled || $popupElement.length === 0) {\r\n      return $popupElement;\r\n    }\r\n    this._floorStack.push($popupElement);\r\n    this._focusStack.push($(document.activeElement));\r\n    let $elements = $(config._options._tabbableElements).filter(config._options._tabbableElementsExcludes);\r\n    const $branch = $popupElement.add($popupElement.parents());\r\n    const $siblings = $branch.siblings().filter(config._options._tabbableElementsExcludes);\r\n    $elements = $elements.add($siblings);\r\n    $elements.each((index, item) => {\r\n      const $item = $(item);\r\n      if (typeof item.a11y_uid === 'undefined') {\r\n        item.a11y_uid = 'UID' + ++this._elementUIDIndex;\r\n      }\r\n      const elementUID = item.a11y_uid;\r\n      if (this._tabIndexes[elementUID] === undefined) {\r\n        this._tabIndexes[elementUID] = [];\r\n      }\r\n      if (this._ariaHiddens[elementUID] === undefined) {\r\n        this._ariaHiddens[elementUID] = [];\r\n      }\r\n      const tabindex = $item.attr('tabindex');\r\n      const ariaHidden = $item.attr('aria-hidden');\r\n      this._tabIndexes[elementUID].push(tabindex === undefined ? '' : tabindex);\r\n      this._ariaHiddens[elementUID].push(ariaHidden === undefined ? '' : ariaHidden);\r\n      if (config._options._isPopupTabIndexManagementEnabled) {\r\n        $item.attr('tabindex', -1);\r\n      }\r\n      if (config._options._isPopupAriaHiddenManagementEnabled) {\r\n        $item.attr('aria-hidden', true);\r\n      }\r\n    });\r\n    const $items = $popupElement.find(config._options._tabbableElements).filter(config._options._tabbableElementsExcludes);\r\n    if (config._options._isPopupTabIndexManagementEnabled) {\r\n      $items.attr('tabindex', 0);\r\n    }\r\n    if (config._options._isPopupAriaHiddenManagementEnabled) {\r\n      $items\r\n        .removeAttr('aria-hidden')\r\n        .removeClass('aria-hidden')\r\n        .parents(config._options._ariaHiddenExcludes)\r\n        .removeAttr('aria-hidden')\r\n        .removeClass('aria-hidden');\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Close the last popup on the stack, restoring tabindex and aria-hidden\r\n   * attributes.\r\n   *\r\n   * @param {Object} [$focusElement] Element at which to move focus.\r\n   * @returns {Object} Returns `a11y._popup`.\r\n   */\r\n  closed($focusElement, silent) {\r\n    const $previousFocusElement = this._removeLastPopupLayer();\r\n    $focusElement = $focusElement || $previousFocusElement || $('body');\r\n    if (!silent) {\r\n      Adapt.trigger('popup:closed', $focusElement, true);\r\n    }\r\n    this.a11y.focusFirst($($focusElement), { preventScroll: true });\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * Restores tabbing and screen reader access to the state before the last\r\n   * `_addPopupLayer` call.\r\n   *\r\n   * @returns {Object} Returns previously active element.\r\n   */\r\n  _removeLastPopupLayer() {\r\n    const config = this.a11y.config;\r\n    if (!config._isEnabled || !config._options._isPopupManagementEnabled) {\r\n      return $(document.activeElement);\r\n    }\r\n    // the body layer is the first element and must always exist\r\n    if (this._floorStack.length <= 1) {\r\n      return;\r\n    }\r\n    this._floorStack.pop();\r\n    $(config._options._tabbableElements).filter(config._options._tabbableElementsExcludes).each((index, item) => {\r\n      const $item = $(item);\r\n      let previousTabIndex = '';\r\n      let previousAriaHidden = '';\r\n      if (typeof item.a11y_uid === 'undefined') {\r\n        // assign element a unique id\r\n        item.a11y_uid = 'UID' + ++this._elementUIDIndex;\r\n      }\r\n      const elementUID = item.a11y_uid;\r\n      if (this._tabIndexes[elementUID]?.length) {\r\n        // get previous tabindex if saved\r\n        previousTabIndex = this._tabIndexes[elementUID].pop();\r\n        previousAriaHidden = this._ariaHiddens[elementUID].pop();\r\n      }\r\n      if (this._tabIndexes[elementUID]?.length) {\r\n        // delete element tabindex store if empty\r\n        delete this._tabIndexes[elementUID];\r\n        delete this._ariaHiddens[elementUID];\r\n      }\r\n      if (config._options._isPopupTabIndexManagementEnabled) {\r\n        if (previousTabIndex === '') {\r\n          $item.removeAttr('tabindex');\r\n        } else {\r\n          $item.attr({\r\n            tabindex: previousTabIndex\r\n          });\r\n        }\r\n      }\r\n      if (config._options._isPopupAriaHiddenManagementEnabled) {\r\n        if (previousAriaHidden === '') {\r\n          $item.removeAttr('aria-hidden');\r\n        } else {\r\n          $item.attr({\r\n            'aria-hidden': previousAriaHidden\r\n          });\r\n        }\r\n      }\r\n    });\r\n    return this._focusStack.pop();\r\n  }\r\n\r\n  /**\r\n   * When a popup is open, this function makes it possible to swap the element\r\n   * that should receive focus on popup close.\r\n   *\r\n   * @param {Object} $focusElement Set a new element to focus on.\r\n   * @returns {Object} Returns previously set focus element.\r\n   */\r\n  setCloseTo($focusElement) {\r\n    const $original = this._focusStack.pop();\r\n    this._focusStack.push($focusElement);\r\n    return $original;\r\n  }\r\n\r\n}\r\n","export default {\r\n  _menu: 1,\r\n  _menuGroup: 2,\r\n  _menuItem: 2,\r\n  _page: 1,\r\n  _article: 2,\r\n  _block: 3,\r\n  _component: 4,\r\n  _componentItem: 5,\r\n  _notify: 1\r\n};\r\n","export default function(a11y) {\r\n\r\n  /**\r\n   * The old API is rerouted to the new API with warnings.\r\n   */\r\n\r\n  Object.assign($.fn, {\r\n\r\n    isFixedPostion() {\r\n      a11y.log.removed('$(\"..\").isFixedPostion was unneeded and has been removed, let us know if you need it back.');\r\n      return false;\r\n    },\r\n\r\n    a11y_aria_label() {\r\n      a11y.log.removed('$(\"..\").a11y_aria_label was incorrect behaviour.');\r\n      return this;\r\n    },\r\n\r\n    limitedScrollTo() {\r\n      a11y.log.removed('$.limitedScrollTo had no impact on the screen reader cursor.');\r\n      return this;\r\n    },\r\n\r\n    a11y_text() {\r\n      a11y.log.removed('a11y_text is no longer required. https://tink.uk/understanding-screen-reader-interaction-modes/');\r\n      return this;\r\n    },\r\n\r\n    a11y_selected() {\r\n      a11y.log.removed('$(\"..\").a11y_selected is removed. Please use aria-live instead.');\r\n      return this;\r\n    },\r\n\r\n    a11y_on(isOn) {\r\n      a11y.log.deprecated('$(\"..\").a11y_on, use a11y.findTabbable($element); and a11y.toggleAccessible($elements, isAccessible); instead.');\r\n      const $tabbable = a11y.findTabbable(this);\r\n      a11y.toggleAccessible($tabbable, isOn);\r\n      return this;\r\n    },\r\n\r\n    a11y_only() {\r\n      a11y.log.removed('$(\"..\").a11y_only, use a11y.popupOpened($popupElement); instead.');\r\n      return this;\r\n    },\r\n\r\n    scrollDisable() {\r\n      if (a11y.config._options._isScrollDisableEnabled === false) {\r\n        return this;\r\n      }\r\n      a11y.log.deprecated('$(\"..\").scrollDisable, use a11y.scrollDisable($elements); instead.');\r\n      a11y.scrollDisable(this);\r\n      return this;\r\n    },\r\n\r\n    scrollEnable() {\r\n      if (a11y.config._options._isScrollDisableEnabled === false) {\r\n        return this;\r\n      }\r\n      a11y.log.deprecated('$(\"..\").scrollEnable, use a11y.scrollEnable($elements); instead.');\r\n      a11y.scrollEnable(this);\r\n      return this;\r\n    },\r\n\r\n    a11y_popup() {\r\n      a11y.log.deprecated('$(\"..\").a11y_popup, use a11y.popupOpened($popupElement); instead.');\r\n      return a11y.popupOpened(this);\r\n    },\r\n\r\n    a11y_cntrl(isOn, withDisabled) {\r\n      a11y.log.deprecated('$(\"..\").a11y_cntrl, use a11y.toggleAccessible($elements, isAccessible); and if needed a11y.toggleEnabled($elements, isEnabled); instead.');\r\n      a11y.toggleAccessible(this, isOn);\r\n      if (withDisabled) a11y.toggleEnabled(this, isOn);\r\n      return this;\r\n    },\r\n\r\n    a11y_cntrl_enabled(isOn) {\r\n      a11y.log.deprecated('$(\"..\").a11y_cntrl_enabled, use a11y.toggleAccessibleEnabled($elements, isAccessibleEnabled); instead.');\r\n      a11y.toggleAccessibleEnabled(this, isOn);\r\n      return this;\r\n    },\r\n\r\n    isReadable() {\r\n      a11y.log.deprecated('$(\"..\").isReadable, use a11y.isReadable($element); instead.');\r\n      return a11y.isReadable(this);\r\n    },\r\n\r\n    findForward(selector) {\r\n      a11y.log.removed('$(\"..\").findForward has been removed as the use cases are very small, let us know if you need it back.');\r\n      return a11y._findFirstForward(this, selector);\r\n    },\r\n\r\n    findWalk(selector) {\r\n      a11y.log.removed('$(\"..\").findWalk has been removed as the use cases are very small, let us know if you need it back.');\r\n      return a11y._findFindForwardDescendant(this, selector);\r\n    },\r\n\r\n    focusNoScroll() {\r\n      a11y.log.deprecated('$(\"..\").focusNoScroll, use a11y.focus($element); instead.');\r\n      return a11y.focus(this);\r\n    },\r\n\r\n    focusNext(returnOnly) {\r\n      a11y.log.deprecated('$(\"..\").focusNext, use a11y.focusNext($element); or if needed a11y.findFirstReadable($element); instead.');\r\n      if (returnOnly) {\r\n        return a11y.findFirstReadable(this);\r\n      }\r\n      return a11y.focusNext(this);\r\n    },\r\n\r\n    focusOrNext(returnOnly) {\r\n      a11y.log.deprecated('$(\"..\").focusOrNext, use a11y.focusFirst($element); or if needed a11y.findFirstReadable($element); or a11y.isReadable($element); instead.');\r\n      if (returnOnly) {\r\n        if (a11y.isReadable(this)) return this;\r\n        return a11y.findFirstReadable(this);\r\n      }\r\n      return a11y.focusFirst(this);\r\n    },\r\n\r\n    a11y_focus(dontDefer) {\r\n      a11y.log.deprecated('$(\"..\").a11y_focus, use a11y.focusFirst($element, { defer: true }); instead.');\r\n      a11y.focusFirst(this, { defer: !dontDefer });\r\n      return this;\r\n    }\r\n\r\n  });\r\n\r\n  Object.assign($, {\r\n\r\n    a11y_alert() {\r\n      a11y.log.removed('$.a11y_alert is removed. Please use aria-live instead.');\r\n      return this;\r\n    },\r\n\r\n    a11y_update() {\r\n      a11y.log.removed('a11y_update is no longer required.');\r\n      return this;\r\n    },\r\n\r\n    a11y_text(text) {\r\n      a11y.log.removed('a11y_text is no longer required. https://tink.uk/understanding-screen-reader-interaction-modes/');\r\n      return text;\r\n    },\r\n\r\n    a11y_on(isOn, selector) {\r\n      a11y.log.deprecated('$(\"..\").a11y_on, use a11y.toggleHidden($elements, isHidden); instead.');\r\n      return a11y.toggleHidden(selector, !isOn);\r\n    },\r\n\r\n    a11y_popdown($focusTarget) {\r\n      a11y.log.removed('$.a11y_popdown, use a11y.popupClosed($focusTarget); instead.');\r\n      return a11y.popupClosed($focusTarget);\r\n    },\r\n\r\n    a11y_focus(dontDefer) {\r\n      a11y.log.deprecated('$.a11y_focus, use a11y.focusFirst(\"body\", { defer: true }); instead.');\r\n      a11y.focusFirst('body', { defer: !dontDefer });\r\n      return this;\r\n    },\r\n\r\n    a11y_normalize(html) {\r\n      a11y.log.deprecated('$.a11y_normalize, use a11y.normalize(\"html\"); instead.');\r\n      return a11y.normalize(html);\r\n    },\r\n\r\n    a11y_remove_breaks(html) {\r\n      a11y.log.deprecated('$.a11y_remove_breaks, use a11y.removeBreaks(\"html\"); instead.');\r\n      return a11y.removeBreaks(html);\r\n    }\r\n\r\n  });\r\n}\r\n","import Backbone from 'backbone';\r\nimport logging from 'core/js/logging';\r\n\r\nclass Components extends Backbone.Controller {\r\n\r\n  initialize() {\r\n    this._register = {};\r\n    this.register = this.register.bind(this);\r\n    this.getViewName = this.getViewName.bind(this);\r\n    this.getViewClass = this.getViewClass.bind(this);\r\n    this.getModelName = this.getModelName.bind(this);\r\n    this.getModelClass = this.getModelClass.bind(this);\r\n  }\r\n\r\n  /**\r\n   * Used to register models and views\r\n   * @param {string|Array} name The name(s) of the model/view to be registered\r\n   * @param {object} object Object containing properties `model` and `view` or (legacy) an object representing the view\r\n   */\r\n  register(name, object) {\r\n    if (Array.isArray(name)) {\r\n      // if an array is passed, iterate by recursive call\r\n      name.forEach(name => this.register(name, object));\r\n      return object;\r\n    }\r\n\r\n    if (name.split(' ').length > 1) {\r\n      // if name with spaces is passed, split and pass as array\r\n      this.register(name.split(' '), object);\r\n      return object;\r\n    }\r\n\r\n    if ((!object.view && !object.model) || object instanceof Backbone.View) {\r\n      logging.deprecated('View-only registrations are no longer supported');\r\n      object = { view: object };\r\n    }\r\n\r\n    if (object.view && !object.view.template) {\r\n      object.view.template = name;\r\n    }\r\n\r\n    const isModelSetAndInvalid = (object.model &&\r\n      !(object.model.prototype instanceof Backbone.Model) &&\r\n      !(object.model instanceof Function));\r\n    if (isModelSetAndInvalid) {\r\n      throw new Error('The registered model is not a Backbone.Model or Function');\r\n    }\r\n\r\n    const isViewSetAndInvalid = (object.view &&\r\n      !(object.view.prototype instanceof Backbone.View) &&\r\n      !(object.view instanceof Function));\r\n    if (isViewSetAndInvalid) {\r\n      throw new Error('The registered view is not a Backbone.View or Function');\r\n    }\r\n\r\n    this._register[name] = Object.assign({}, this._register[name], object);\r\n\r\n    return object;\r\n  }\r\n\r\n  /**\r\n   * Parses a view class name.\r\n   * @param {string|Backbone.Model|Backbone.View|object} nameModelViewOrData The name of the view class you want to fetch e.g. `\"hotgraphic\"` or its model or its json data\r\n   */\r\n  getViewName(nameModelViewOrData) {\r\n    if (typeof nameModelViewOrData === 'string') {\r\n      return nameModelViewOrData;\r\n    }\r\n    if (nameModelViewOrData instanceof Backbone.Model) {\r\n      nameModelViewOrData = nameModelViewOrData.toJSON();\r\n    }\r\n    if (nameModelViewOrData instanceof Backbone.View) {\r\n      let foundName;\r\n      Object.entries(this._register).forEach(([key, entry]) => {\r\n        if (!entry?.view) return;\r\n        if (!(nameModelViewOrData instanceof entry.view)) return;\r\n        foundName = key;\r\n        return true;\r\n      });\r\n      return foundName;\r\n    }\r\n    if (nameModelViewOrData instanceof Object) {\r\n      const names = [\r\n        typeof nameModelViewOrData._view === 'string' && nameModelViewOrData._view,\r\n        typeof nameModelViewOrData._component === 'string' && nameModelViewOrData._component,\r\n        typeof nameModelViewOrData._type === 'string' && nameModelViewOrData._type\r\n      ].filter(Boolean);\r\n      if (names.length) {\r\n        // find first fitting view name\r\n        const name = names.find(name => this._register[name]?.view);\r\n        return name || names.pop(); // return last available if none found\r\n      }\r\n    }\r\n    throw new Error('Cannot derive view class name from input');\r\n  }\r\n\r\n  /**\r\n   * Fetches a view class from the components. For a usage example, see either HotGraphic or Narrative\r\n   * @param {string|Backbone.Model|Backbone.View|object} nameModelViewOrData The name of the view class you want to fetch e.g. `\"hotgraphic\"` or its model or its json data\r\n   * @returns {Backbone.View} Reference to the view class\r\n   */\r\n  getViewClass(nameModelViewOrData) {\r\n    const name = this.getViewName(nameModelViewOrData);\r\n    const object = this._register[name];\r\n    if (!object) {\r\n      logging.error(`A view for '${name}' isn't registered in your project`);\r\n      return;\r\n    }\r\n    const isBackboneView = (object.view?.prototype instanceof Backbone.View);\r\n    if (!isBackboneView && object.view instanceof Function) {\r\n      return object.view();\r\n    }\r\n    return object.view;\r\n  }\r\n\r\n  /**\r\n   * Parses a model class name.\r\n   * @param {string|Backbone.Model|object} name The name of the model you want to fetch e.g. `\"hotgraphic\"`, the model to process or its json data\r\n   */\r\n  getModelName(nameModelOrData) {\r\n    if (typeof nameModelOrData === 'string') {\r\n      return nameModelOrData;\r\n    }\r\n    if (nameModelOrData instanceof Backbone.Model) {\r\n      nameModelOrData = nameModelOrData.toJSON();\r\n    }\r\n    if (nameModelOrData instanceof Object) {\r\n      const name = nameModelOrData._component;\r\n      const entry = this._register[name];\r\n      const isViewOnlyQuestion = entry && !entry.model && entry.view?._isQuestionType;\r\n      if (isViewOnlyQuestion) {\r\n        // Use question model by default\r\n        logging.deprecated(`Assuming a question model for a view-only question: ${name}`);\r\n        return 'question';\r\n      }\r\n      const names = [\r\n        typeof nameModelOrData._model === 'string' && nameModelOrData._model,\r\n        typeof nameModelOrData._component === 'string' && nameModelOrData._component,\r\n        typeof nameModelOrData._type === 'string' && nameModelOrData._type\r\n      ].filter(Boolean);\r\n      if (names.length) {\r\n        // find first fitting model name\r\n        const name = names.find(name => this._register[name]?.model);\r\n        return name || names.pop(); // return last available if none found\r\n      }\r\n    }\r\n    throw new Error('Cannot derive model class name from input');\r\n  }\r\n\r\n  /**\r\n   * Fetches a model class from the components. For a usage example, see either HotGraphic or Narrative\r\n   * @param {string|Backbone.Model|object} name The name of the model you want to fetch e.g. `\"hotgraphic\"` or its json data\r\n   * @returns {Backbone.Model} Reference to the view class\r\n   */\r\n  getModelClass(nameModelOrData) {\r\n    const name = this.getModelName(nameModelOrData);\r\n    const object = this._register[name];\r\n    if (!object) {\r\n      logging.error(`A model for '${name}' isn't registered in your project`);\r\n      return;\r\n    }\r\n    const isBackboneModel = (object.model?.prototype instanceof Backbone.Model);\r\n    if (!isBackboneModel && object.model instanceof Function) {\r\n      return object.model();\r\n    }\r\n    return object.model;\r\n  }\r\n\r\n}\r\n\r\nconst components = new Components();\r\nexport default components;\r\n","import Adapt from 'core/js/adapt';\r\n\r\nexport default class AdaptCollection extends Backbone.Collection {\r\n\r\n  initialize(models, options) {\r\n    this.once('reset', this.loadedData, this);\r\n  }\r\n\r\n  loadedData() {\r\n    Adapt.trigger('adaptCollection:dataLoaded');\r\n  }\r\n\r\n}\r\n","import Adapt from 'core/js/adapt';\r\nimport LockingModel from 'core/js/models/lockingModel';\r\nimport 'core/js/logging';\r\nimport semver from 'semver';\r\n\r\nexport default class BuildModel extends LockingModel {\r\n\r\n  defaults() {\r\n    return {\r\n      jsonext: 'json'\r\n    };\r\n  }\r\n\r\n  initialize(attrs, options) {\r\n    this.url = options.url;\r\n    // Fetch data & if successful trigger event to enable plugins to stop course files loading\r\n    // Then check if course files can load\r\n    // 'configModel:loadCourseData' event starts the core content collections and models being fetched\r\n    this.fetch({\r\n      success: () => {\r\n        this.isLoaded = true;\r\n        Adapt.trigger('buildModel:dataLoaded');\r\n      },\r\n      error: () => {\r\n        console.log('Unable to load adapt/js/build.js');\r\n        Adapt.trigger('buildModel:dataLoaded');\r\n      }\r\n    });\r\n  }\r\n\r\n  isFrameworkVersion(version) {\r\n    return semver.satisfies(this.get('package').version, version, { includePrerelease: true });\r\n  }\r\n\r\n  isPluginInstalled(name, version = '*') {\r\n    const plugin = this.get('plugins').find(plugin => {\r\n      if (plugin.name !== name) return false;\r\n      return semver.satisfies(plugin.version, version, { includePrerelease: true });\r\n    });\r\n    return Boolean(plugin);\r\n  }\r\n\r\n  whenReady() {\r\n    if (this.isLoaded) return Promise.resolve();\r\n    return new Promise(resolve => {\r\n      Adapt.once('buildModel:dataLoaded', resolve);\r\n    });\r\n  }\r\n\r\n}\r\n","import Adapt from 'core/js/adapt';\r\nimport wait from 'core/js/wait';\r\nimport LockingModel from 'core/js/models/lockingModel';\r\nimport logging from 'core/js/logging';\r\n\r\nexport default class ConfigModel extends LockingModel {\r\n\r\n  defaults() {\r\n    return {\r\n      screenSize: {\r\n        large: 900,\r\n        medium: 760,\r\n        small: 520\r\n      },\r\n      _forceRouteLocking: false,\r\n      _canLoadData: true,\r\n      _disableAnimation: false\r\n    };\r\n  }\r\n\r\n  /**\r\n   * Parse the incoming search queries for certain parameter values to use as defaults\r\n   */\r\n  setValuesFromURLParams() {\r\n    const paramMappings = {\r\n      dir: '_defaultDirection',\r\n      lang: '_defaultLanguage'\r\n    };\r\n\r\n    const params = new URLSearchParams(window.location.search);\r\n\r\n    Object.entries(paramMappings).forEach(([key, value]) => {\r\n      const passedVal = params.get(key);\r\n      if (!passedVal) return;\r\n      if (key === 'lang' && Adapt.build.get('availableLanguageNames')?.includes(passedVal) === false) return;\r\n      this.set(value, passedVal);\r\n    });\r\n  }\r\n\r\n  initialize(attrs, options) {\r\n    this.url = options.url;\r\n    // Fetch data & if successful trigger event to enable plugins to stop course files loading\r\n    // Then check if course files can load\r\n    // 'configModel:loadCourseData' event starts the core content collections and models being fetched\r\n    this.fetch({\r\n      success: () => {\r\n        this.setValuesFromURLParams();\r\n\r\n        Adapt.trigger('offlineStorage:prepare');\r\n        wait.queue(() => {\r\n          Adapt.trigger('configModel:dataLoaded');\r\n          if (!this.get('_canLoadData')) return;\r\n          Adapt.trigger('configModel:loadCourseData');\r\n        });\r\n      },\r\n      error: () => logging.error('Unable to load course/config.json')\r\n    });\r\n  }\r\n\r\n  loadData() {}\r\n\r\n}\r\n","import Adapt from 'core/js/adapt';\r\nimport offlineStorage from 'core/js/offlineStorage';\r\nimport wait from 'core/js/wait';\r\nimport components from 'core/js/components';\r\nimport AdaptCollection from 'core/js/collections/adaptCollection';\r\nimport BuildModel from 'core/js/models/buildModel';\r\nimport ConfigModel from 'core/js/models/configModel';\r\nimport LockingModel from 'core/js/models/lockingModel';\r\nimport logging from 'core/js/logging';\r\nimport location from 'core/js/location';\r\nimport _ from 'underscore';\r\n\r\nclass Data extends AdaptCollection {\r\n\r\n  model(json) {\r\n    const ModelClass = components.getModelClass(json);\r\n    if (!ModelClass) {\r\n      return new LockingModel(json);\r\n    }\r\n    return new ModelClass(json, { parse: true });\r\n  }\r\n\r\n  initialize() {\r\n    super.initialize();\r\n    this.findById = this.findById.bind(this);\r\n    this.findViewByModelId = this.findViewByModelId.bind(this);\r\n    this.findByTrackingPosition = this.findByTrackingPosition.bind(this);\r\n    this.on({\r\n      add: this.onAdded,\r\n      remove: this.onRemoved\r\n    });\r\n  }\r\n\r\n  async init () {\r\n    this.reset();\r\n    this._byAdaptID = {};\r\n    Adapt.build = new BuildModel(null, { url: 'adapt/js/build.min.js', reset: true });\r\n    await Adapt.build.whenReady();\r\n    $('html').attr('data-adapt-framework-version', Adapt.build.get('package').version);\r\n    this.loadConfigData();\r\n  }\r\n\r\n  onAdded(model) {\r\n    this._byAdaptID[model.get('_id')] = model;\r\n  }\r\n\r\n  onRemoved(model) {\r\n    delete this._byAdaptID[model.get('_id')];\r\n  }\r\n\r\n  loadConfigData() {\r\n    Adapt.config = new ConfigModel(null, { url: Adapt.build.get('coursedir') + '/config.' + Adapt.build.get('jsonext'), reset: true });\r\n    this.listenToOnce(Adapt, 'configModel:loadCourseData', this.onLoadCourseData);\r\n    this.listenTo(Adapt.config, {\r\n      'change:_activeLanguage': this.onLanguageChange,\r\n      'change:_defaultDirection': this.onDirectionChange\r\n    });\r\n  }\r\n\r\n  onDirectionChange(model, direction) {\r\n    if (direction === 'rtl') {\r\n      $('html').removeClass('dir-ltr').addClass('dir-rtl').attr('dir', 'rtl');\r\n    } else {\r\n      $('html').removeClass('dir-rtl').addClass('dir-ltr').attr('dir', 'ltr');\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Before we actually go to load the course data, we first need to check to see if a language has been set\r\n   * If it has we can go ahead and start loading; if it hasn't, apply the defaultLanguage from config.json\r\n   */\r\n  onLoadCourseData() {\r\n    if (!Adapt.config.get('_activeLanguage')) {\r\n      Adapt.config.set('_activeLanguage', Adapt.config.get('_defaultLanguage'));\r\n      return;\r\n    }\r\n    this.loadCourseData();\r\n  }\r\n\r\n  async onLanguageChange(model, language) {\r\n    await wait.queue();\r\n    offlineStorage.set('lang', language);\r\n    // set `_isStarted` back to `false` when changing language so that the learner's answers\r\n    // to questions get restored in the new language when `_restoreStateOnLanguageChange: true`\r\n    // see https://github.com/adaptlearning/adapt_framework/issues/2977\r\n    if (Adapt.get('_isStarted')) {\r\n      Adapt.set('_isStarted', false);\r\n    }\r\n    this.loadCourseData(language);\r\n  }\r\n\r\n  async loadCourseData(newLanguage) {\r\n\r\n    // All code that needs to run before adapt starts should go here\r\n    const language = Adapt.config.get('_activeLanguage');\r\n\r\n    const courseFolder = Adapt.build.get('coursedir') + '/' + language + '/';\r\n\r\n    $('html').attr('lang', language);\r\n\r\n    await this.loadManifestFiles(courseFolder);\r\n    await this.triggerDataLoaded();\r\n    await this.triggerDataReady(newLanguage);\r\n    this.triggerInit();\r\n\r\n  }\r\n\r\n  getJSON(path) {\r\n    return new Promise((resolve, reject) => {\r\n      $.getJSON(path, data => {\r\n        // Add path to data in case it's necessary later\r\n        data.__path__ = path;\r\n        resolve(data);\r\n      }).fail(() => {\r\n        reject(new Error(`Unable to load ${path}`));\r\n      });\r\n    });\r\n  }\r\n\r\n  async loadManifestFiles(languagePath) {\r\n    this.trigger('loading');\r\n    this.reset();\r\n    const manifestPath = languagePath + 'language_data_manifest.js';\r\n    let manifest;\r\n    try {\r\n      manifest = await this.getJSON(manifestPath);\r\n    } catch (err) {\r\n      manifest = ['course.json', 'contentObjects.json', 'articles.json', 'blocks.json', 'components.json'];\r\n      logging.error(`Manifest path '${manifestPath} not found. Using traditional files: ${manifest.join(', ')}`);\r\n    }\r\n    let allFileData;\r\n    try {\r\n      allFileData = await Promise.all(manifest.map(filePath => {\r\n        return this.getJSON(`${languagePath}${filePath}`);\r\n      }));\r\n    } catch (error) {\r\n      logging.error(error);\r\n      return;\r\n    }\r\n    // Flatten all file data into a single array of model data\r\n    const allModelData = allFileData.reduce((result, fileData) => {\r\n      if (Array.isArray(fileData)) {\r\n        fileData.forEach((datum, index) => {\r\n          datum.__path__ = fileData.__path__;\r\n          datum.__index__ = index;\r\n      });\r\n        result.push(...fileData);\r\n      } else if (fileData instanceof Object) {\r\n        result.push(fileData);\r\n      } else {\r\n        logging.warnOnce(`File data isn't an array or object: ${fileData.__path__}`);\r\n      }\r\n      return result;\r\n    }, []);\r\n    // Add course model first to allow other model/views to utilize its settings\r\n    const course = allModelData.find(modelData => modelData._type === 'course');\r\n    if (!course) {\r\n      throw new Error('Expected a model data with \"_type\": \"course\", none found.');\r\n    }\r\n    Adapt.trigger('courseModel:dataLoading');\r\n    Adapt.course = this.push(course);\r\n    Adapt.trigger('courseModel:dataLoaded');\r\n    // Add other models\r\n    allModelData.forEach(modelData => {\r\n      if (modelData._type === 'course') {\r\n        return;\r\n      }\r\n      try {\r\n        components.getModelName(modelData);\r\n      } catch (error) {\r\n        logging.error(`Failed to load object ${modelData.__path__}${Object.prototype.hasOwnProperty.call(modelData, '__index__') ? `[${modelData.__index__}]` : ''}`)\r\n        logging.error(error);\r\n        return;\r\n      }\r\n      this.push(modelData);\r\n    });\r\n    this.checkData();\r\n    this.trigger('reset');\r\n    this.trigger('loaded');\r\n    await wait.queue();\r\n  }\r\n\r\n  async triggerDataLoaded() {\r\n    logging.debug('Firing app:dataLoaded');\r\n    try {\r\n      // Setup the newly added models\r\n      this.forEach(model => model.setupModel?.());\r\n      Adapt.trigger('app:dataLoaded');\r\n    } catch (e) {\r\n      logging.error('Error during app:dataLoading trigger', e);\r\n    }\r\n    await wait.queue();\r\n  }\r\n\r\n  async triggerDataReady(newLanguage) {\r\n    if (newLanguage) {\r\n      Adapt.trigger('app:languageChanged', newLanguage);\r\n      await wait.queue();\r\n    }\r\n    logging.debug('Firing app:dataReady');\r\n    try {\r\n      Adapt.trigger('app:dataReady');\r\n    } catch (e) {\r\n      logging.error('Error during app:dataReady trigger', e);\r\n    }\r\n    await wait.queue();\r\n  }\r\n\r\n  triggerInit() {\r\n    this.isReady = true;\r\n    this.trigger('ready');\r\n  }\r\n\r\n  whenReady() {\r\n    if (this.isReady) return Promise.resolve();\r\n    return new Promise(resolve => {\r\n      this.once('ready', resolve);\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Checks if a model _id exists\r\n   * @param {string} id The id of the item e.g. \"co-05\"\r\n   * @returns {boolean}\r\n   */\r\n  hasId(id) {\r\n    return Boolean(this._byAdaptID[id]);\r\n  }\r\n\r\n  /**\r\n   * Looks up a model by its `_id` property\r\n   * @param {string} id The id of the item e.g. \"co-05\"\r\n   * @return {Backbone.Model}\r\n   */\r\n  findById(id) {\r\n    const model = this._byAdaptID[id];\r\n    if (!model) {\r\n      console.warn(`data.findById() unable to find id: ${id}`);\r\n      return;\r\n    }\r\n    return model;\r\n  }\r\n\r\n  /**\r\n   * Looks up a view by its model `_id` property\r\n   * @param {string} id The id of the item e.g. \"co-05\"\r\n   * @return {Backbone.View}\r\n   */\r\n  findViewByModelId(id) {\r\n    const model = this.findById(id);\r\n    if (!model) return;\r\n\r\n    if (model === Adapt.parentView.model) return Adapt.parentView;\r\n\r\n    const idPathToView = [id];\r\n    const currentLocationId = location._currentId;\r\n    const currentLocationModel = model.getAncestorModels().find(model => {\r\n      const modelId = model.get('_id');\r\n      if (modelId === currentLocationId) return true;\r\n      idPathToView.unshift(modelId);\r\n      return false;\r\n    });\r\n\r\n    if (!currentLocationModel) {\r\n      return console.warn(`data.findViewByModelId() unable to find view for model id: ${id}`);\r\n    }\r\n\r\n    const foundView = idPathToView.reduce((view, currentId) => {\r\n      if (!view) return null;\r\n      const childViews = view.getChildViews();\r\n      return childViews?.find(view => view.model.get('_id') === currentId);\r\n    }, Adapt.parentView);\r\n\r\n    return foundView;\r\n  }\r\n\r\n  /**\r\n   * Returns the model represented by the trackingPosition.\r\n   * @param {Array<Number, Number>} trackingPosition Represents the relative location of a model to a _trackingId\r\n   * @returns {Backbone.Model}\r\n   */\r\n  findByTrackingPosition(trackingPosition) {\r\n    const [ trackingId, indexInTrackingIdDescendants ] = trackingPosition;\r\n    const trackingIdModel = this.find(model => model.get('_trackingId') === trackingId);\r\n    if (!trackingIdModel) {\r\n      console.warn(`data.findByTrackingPosition() unable to find trackingPosition: ${trackingPosition}`);\r\n      return;\r\n    }\r\n    if (indexInTrackingIdDescendants >= 0) {\r\n      // Model is either the trackingId model or a descendant\r\n      let trackingIdDescendants = [trackingIdModel].concat(trackingIdModel.getAllDescendantModels(true));\r\n      trackingIdDescendants = trackingIdDescendants.filter(model => !(model.isTypeGroup('component') && model.get('_isTrackable') === false));\r\n      return trackingIdDescendants[indexInTrackingIdDescendants];\r\n    }\r\n    // Model is an ancestor of the trackingId model\r\n    const trackingIdAncestors = trackingIdModel.getAncestorModels();\r\n    const ancestorDistance = Math.abs(indexInTrackingIdDescendants) - 1;\r\n    return trackingIdAncestors[ancestorDistance];\r\n  }\r\n\r\n  logReadyError(view) {\r\n    const notReadyDescendants = view.model.getAllDescendantModels(true).filter(model => !model.get('_isReady'));\r\n    logging.error(`View ${notReadyDescendants.map(model => `${model.get('_id')} (${model.get('_component') ?? model.get('_type')})`).join(', ')} failed to become ready, forcing ready status.`);\r\n    notReadyDescendants.reverse().forEach(model => model.set('_isReady', true));\r\n  }\r\n\r\n  checkData() {\r\n    this.checkIds();\r\n    this.checkTrackingIds();\r\n  }\r\n\r\n  checkIds() {\r\n    const items = this.toJSON();\r\n    // Index and group\r\n    const idIndex = _.indexBy(items, '_id');\r\n    const idGroups = _.groupBy(items, '_id');\r\n    const parentIdGroups = _.groupBy(items, '_parentId');\r\n    // Setup error collection arrays\r\n    let orphanedIds = {};\r\n    let emptyIds = {};\r\n    let duplicateIds = {};\r\n    let missingIds = {};\r\n    items.forEach((o) => {\r\n      const isCourseType = (o._type === 'course');\r\n      const isComponentType = (o._type === 'component');\r\n      if (idGroups[o._id].length > 1) {\r\n        duplicateIds[o._id] = true; // Id has more than one item\r\n      }\r\n      if (!isComponentType && !parentIdGroups[o._id]) {\r\n        emptyIds[o._id] = true; // Course has no children\r\n      }\r\n      if (!isCourseType && (!o._parentId || !idIndex[o._parentId])) {\r\n        orphanedIds[o._id] = true; // Item has no defined parent id or the parent id doesn't exist\r\n      }\r\n      if (!isCourseType && o._parentId && !idIndex[o._parentId]) {\r\n        missingIds[o._parentId] = true; // Referenced parent item does not exist\r\n      }\r\n    });\r\n    orphanedIds = Object.keys(orphanedIds);\r\n    emptyIds = Object.keys(emptyIds);\r\n    duplicateIds = Object.keys(duplicateIds);\r\n    missingIds = Object.keys(missingIds);\r\n    // Output for each type of error\r\n    const hasErrored = orphanedIds.length || emptyIds.length || duplicateIds.length || missingIds.length;\r\n    if (orphanedIds.length) {\r\n      logging.error(`Orphaned _ids: ${orphanedIds.join(', ')}`);\r\n    }\r\n    if (missingIds.length) {\r\n      logging.error(`Missing _ids: ${missingIds.join(', ')}`);\r\n    }\r\n    if (emptyIds.length) {\r\n      logging.error(`Empty _ids: ${emptyIds.join(', ')}`);\r\n    }\r\n    if (duplicateIds.length) {\r\n      logging.error(`Duplicate _ids: ${duplicateIds.join(', ')}`);\r\n    }\r\n    // If any error has occured, stop processing.\r\n    if (hasErrored) {\r\n      const err = new Error('Oops, looks like you have some json errors.');\r\n      err.number = 10011;\r\n      throw err;\r\n    }\r\n  }\r\n\r\n  checkTrackingIds() {\r\n    const items = this.toJSON();\r\n    const trackingIdType = Adapt.build.get('trackingIdType') || 'block';\r\n    const trackingIdCounts = _.groupBy(items.filter(item => item._type === trackingIdType), '_trackingId');\r\n    const missingTrackingIds = items.filter(item => item._type === trackingIdType && item._trackingId === undefined).map(item => item._id);\r\n    if (missingTrackingIds.length) {\r\n      logging.error(`Missing _trackingIds: ${missingTrackingIds.join(', ')}`);\r\n    }\r\n    const duplicateTrackingIds = Object.entries(trackingIdCounts)\r\n      .filter(([id, group]) => group.length > 1)\r\n      .map(([id, group]) => `${id}:[${group.map(item => item._id).join(', ')}]`);\r\n    if (duplicateTrackingIds.length) {\r\n      logging.error(`Duplicate _trackingIds: ${duplicateTrackingIds.join(', ')}`);\r\n    }\r\n    const hasErrored = missingTrackingIds.length || duplicateTrackingIds.length;\r\n    // If any error has occured, stop processing.\r\n    if (hasErrored) {\r\n      const err = new Error('Oops, looks like you have some json errors with trackingIds.');\r\n      err.number = 10011;\r\n      throw err;\r\n    }\r\n  }\r\n\r\n}\r\n\r\nconst data = new Data();\r\nexport default data;\r\n","import Adapt from 'core/js/adapt';\r\nimport offlineStorage from 'core/js/offlineStorage';\r\nimport device from 'core/js/device';\r\nimport location from 'core/js/location';\r\nimport BrowserFocus from 'core/js/a11y/browserFocus';\r\nimport FocusOptions from 'core/js/a11y/focusOptions';\r\nimport KeyboardFocusOutline from 'core/js/a11y/keyboardFocusOutline';\r\nimport Log from 'core/js/a11y/log';\r\nimport Scroll from 'core/js/a11y/scroll';\r\nimport WrapFocus from 'core/js/a11y/wrapFocus';\r\nimport Popup from 'core/js/a11y/popup';\r\nimport defaultAriaLevels from 'core/js/enums/defaultAriaLevels';\r\nimport deprecated from 'core/js/a11y/deprecated';\r\nimport logging from 'core/js/logging';\r\nimport data from './data';\r\n\r\nclass A11y extends Backbone.Controller {\r\n\r\n  defaults() {\r\n    return {\r\n      _isFocusOutlineKeyboardOnlyEnabled: true,\r\n      /**\r\n       * `_isFocusOutlineDisabled` ignores `_isEnabled` and can be used when all other\r\n       * accessibility features have been disabled.\r\n       */\r\n      _isFocusOutlineDisabled: false,\r\n      _isFocusAssignmentEnabled: true,\r\n      _isFocusOnClickEnabled: true,\r\n      _isFocusNextOnDisabled: true,\r\n      _isScrollDisableEnabled: true,\r\n      _isAriaHiddenManagementEnabled: true,\r\n      _isPopupManagementEnabled: true,\r\n      _isPopupWrapFocusEnabled: true,\r\n      _isPopupAriaHiddenManagementEnabled: true,\r\n      _isPopupTabIndexManagementEnabled: true,\r\n      /**\r\n       * Do not change aria-hidden on these elements.\r\n       */\r\n      _ariaHiddenExcludes: ':not(#wrapper):not(body)',\r\n      _tabbableElements: 'a,button,input,select,textarea,[tabindex]:not([data-a11y-force-focus])',\r\n      _focusOutlineKeyboardOnlyIgnore: 'input,textarea',\r\n      /**\r\n       * Designate these elements as not tabbable.\r\n       */\r\n      _tabbableElementsExcludes: ':not(.a11y-ignore):not([data-a11y-force-focus])',\r\n      _focusableElements: 'a,button,input,select,textarea,[tabindex],label',\r\n      _readableElements: '[role=heading],[aria-label],[aria-labelledby],[alt]',\r\n      /**\r\n       * Prevent adapt from focusing forward onto these elements.\r\n       */\r\n      _focusForwardElementsExcludes: ':not([aria-labelledby][role=dialog],[aria-labelledby][role=main],[aria-labelledby][role=region],[aria-labelledby][role=radiogroup],[aria-labelledby][role=group],[aria-labelledby][role=tablist],[aria-labelledby][role=list],[aria-labelledby][role=tree],[aria-labelledby][role=treegrid],[aria-labelledby][role=table],[aria-labelledby][role=grid][aria-labelledby],[role=menu],[aria-labelledby][role=rowgroup])',\r\n      /**\r\n       * Selector for elements which cause tab wrapping.\r\n       */\r\n      _focusguard: '.a11y-focusguard',\r\n      /**\r\n       * Specifies all stylistic elements.\r\n       */\r\n      _wrapStyleElements: 'b,i,abbr,strong,em,small,sub,sup,ins,del,mark,zw,nb',\r\n\r\n      /**\r\n       * Logging settings\r\n       */\r\n      _warnFirstOnly: true,\r\n      _warn: true\r\n    };\r\n  }\r\n\r\n  initialize() {\r\n    this.isFocusable = this.isFocusable.bind(this);\r\n    this.isReadable = this.isReadable.bind(this);\r\n    this.isTabbable = this.isTabbable.bind(this);\r\n    this.$html = $('html');\r\n    this._htmlCharRegex = /&.*;/g;\r\n    /** @type {Object} */\r\n    this.config = null;\r\n    this._browserFocus = new BrowserFocus({ a11y: this });\r\n    this._keyboardFocusOutline = new KeyboardFocusOutline({ a11y: this });\r\n    this._wrapFocus = new WrapFocus({ a11y: this });\r\n    this._popup = new Popup({ a11y: this });\r\n    this._scroll = new Scroll({ a11y: this });\r\n    this.log = new Log({ a11y: this });\r\n    deprecated(this);\r\n\r\n    this._removeLegacyElements();\r\n    this.listenToOnce(Adapt, {\r\n      'configModel:dataLoaded': this._onConfigDataLoaded,\r\n      'navigationView:postRender': this._removeLegacyElements\r\n    }, this);\r\n    Adapt.on('device:changed', this._setupNoSelect);\r\n    this.listenTo(Adapt, {\r\n      'router:location': this._onNavigationStart,\r\n      'contentObjectView:ready router:plugin': this._onNavigationEnd\r\n    });\r\n  }\r\n\r\n  _onConfigDataLoaded() {\r\n    this.config = Adapt.config.get('_accessibility');\r\n    this.config._isActive = false;\r\n    this.config._options = _.defaults(this.config._options || {}, this.defaults());\r\n    offlineStorage.set('a11y', false);\r\n    this.$html.toggleClass('has-accessibility', this.isEnabled());\r\n    this._setupNoSelect();\r\n    this._addFocuserDiv();\r\n    if (this._isReady) {\r\n      return;\r\n    }\r\n    this._isReady = true;\r\n    Adapt.trigger('accessibility:ready');\r\n  }\r\n\r\n  _setupNoSelect() {\r\n    if (!this.config?._disableTextSelectOnClasses) {\r\n      return;\r\n    }\r\n    const classes = this.config._disableTextSelectOnClasses.split(' ');\r\n    const isMatch = classes.some(className => this.$html.is(className));\r\n    this.$html.toggleClass('u-no-select', isMatch);\r\n  }\r\n\r\n  _addFocuserDiv() {\r\n    if ($('#a11y-focuser').length) {\r\n      return;\r\n    }\r\n    $('body').append($('<div id=\"a11y-focuser\" class=\"a11y-ignore\" tabindex=\"-1\">&nbsp;</div>'));\r\n  }\r\n\r\n  _removeLegacyElements() {\r\n    const $legacyElements = $('body').children('#accessibility-toggle, #accessibility-instructions');\r\n    const $navigationElements = $('.nav').find('#accessibility-toggle, #accessibility-instructions');\r\n    if (!$legacyElements.length && !$navigationElements.length) {\r\n      return;\r\n    }\r\n    logging.warn('REMOVED: #accessibility-toggle and #accessibility-instructions have been removed. Please remove them from all of your .html files.');\r\n    $legacyElements.remove();\r\n    $navigationElements.remove();\r\n  }\r\n\r\n  _onNavigationStart() {\r\n    if (!this.isEnabled()) {\r\n      return;\r\n    }\r\n    // Stop document reading\r\n    _.defer(() => this.toggleHidden('.contentobject', true));\r\n  }\r\n\r\n  _onNavigationEnd(view) {\r\n    // Prevent sub-menu items provoking behaviour\r\n    if ((view?.model?.get('_id') !== location._currentId) || !this.isEnabled()) {\r\n      return;\r\n    }\r\n    // Allow document to be read\r\n    this.toggleHidden('.contentobject', false);\r\n  }\r\n\r\n  isActive() {\r\n    this.log.removed('Accessibility is now always active when enabled. Please unify your user experiences.');\r\n    return false;\r\n  }\r\n\r\n  isEnabled() {\r\n    return this.config?._isEnabled;\r\n  }\r\n\r\n  /**\r\n   * Calculate the aria level for a heading\r\n   * @param {object} [options]\r\n   * @param {string|number} [options.id] Used to automate the heading level when relative increments are used\r\n   * @param {string|number} [options.level] Specify a default level, \"component\" / \"menu\" / \"componentItem\" etc\r\n   * @param {string|number} [options.override] Override with a default level, an absolute value or a relative increment\r\n   * @returns {number}\r\n   * @notes\r\n   * Default levels come from config.json:_accessibility._ariaLevels attribute names, they are:\r\n   *  \"menu\", \"menuGroup\", \"menuItem\", \"page\", \"article\", \"block\", \"component\", \"componentItem\" and \"notify\"\r\n   * An absolute value would be \"1\" or \"2\" etc.\r\n   * A relative increment would be \"@page+1\" or \"@block+1\". They are calculated from ancestor values,\r\n   * respecting both _ariaLevel overrides and not incrementing for missing displayTitle values.\r\n   */\r\n  ariaLevel({\r\n    id = null,\r\n    level = \"1\",\r\n    override = null\r\n  } = {}) {\r\n    if (arguments.length === 2) {\r\n      // backward compatibility\r\n      level = arguments[0];\r\n      override =  arguments[1];\r\n      id = null;\r\n    }\r\n    // get the global configuration from config.json\r\n    const ariaLevels = Adapt.config.get('_accessibility')?._ariaLevels ?? defaultAriaLevels;\r\n    /**\r\n     * Recursive function to calculate aria-level\r\n     * @param {string} id Model id\r\n     * @param {string} level Default name, relative increment or absolute level\r\n     * @param {number} [offset=0] Total offset count from first absolute value\r\n     * @returns\r\n     */\r\n    function calculateLevel(id = null, level, offset = 0) {\r\n      const isNumber =  !isNaN(level);\r\n      const isTypeName = /[a-zA-z]/.test(level);\r\n      if (!isTypeName && isNumber) {\r\n        // if an absolute value is found, use it, adding the accumulated offset\r\n        return parseInt(level) + offset;\r\n      }\r\n      // parse the level value as a relative string\r\n      const relativeDescriptor = Adapt.parseRelativeString(level);\r\n      // lookup the default value from `config.json:_accessibility._ariaLevels`\r\n      const nextLevel = ariaLevels?.['_' + relativeDescriptor.type];\r\n      const hasModelId = Boolean(id);\r\n      if (!hasModelId) {\r\n        logging.warnOnce('Cannot calculate appropriate heading level, no model id was specified');\r\n        return calculateLevel(id, nextLevel, offset + relativeDescriptor.offset);\r\n      }\r\n      // try to find the next relevant ancestor, or use the specified model\r\n      const nextModel =  data.findById(id)?.findAncestor(relativeDescriptor.type?.toLowerCase()) ?? data.findById(id);\r\n      const nextModelId = nextModel?.get('_id') ?? id;\r\n      // check overrides, check title existence, adjust offset accordingly\r\n      const hasNextTitle = Boolean(nextModel.get('displayTitle'));\r\n      const nextModelOverride = nextModel.get('_ariaLevel');\r\n      const accumulatedOffset = offset + (hasNextTitle ? relativeDescriptor.offset : 0);\r\n      const resolvedLevel = nextModelOverride ?? nextLevel;\r\n      // move towards the parents until an absolute value is found\r\n      return calculateLevel(nextModelId, resolvedLevel, accumulatedOffset);\r\n    }\r\n    return calculateLevel(id, override ?? level)\r\n  }\r\n\r\n  /**\r\n   * Adds or removes `aria-hidden` attribute to elements.\r\n   *\r\n   * @param {Object|string|Array} $elements\r\n   * @param {boolean} [isHidden=true]\r\n   * @returns {Object} Chainable\r\n   */\r\n  toggleHidden($elements, isHidden = true) {\r\n    $elements = $($elements);\r\n    const config = this.config;\r\n    if (!config._isEnabled || !config._options._isAriaHiddenManagementEnabled) {\r\n      return this;\r\n    }\r\n    if (isHidden === true) {\r\n      $elements.attr('aria-hidden', true);\r\n    } else {\r\n      $elements.removeAttr('aria-hidden');\r\n    }\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * Adds or removes `aria-hidden` and `disabled` attributes and `disabled`\r\n   * classes to elements.\r\n   *\r\n   * @param {Object|string|Array} $elements\r\n   * @param {boolean} [isHidden=true]\r\n   * @returns {Object} Chainable\r\n   */\r\n  toggleAccessibleEnabled($elements, isAccessibleEnabled) {\r\n    this.toggleAccessible($elements, isAccessibleEnabled);\r\n    this.toggleEnabled($elements, isAccessibleEnabled);\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * Adds or removes `aria-hidden` attribute and disables `tabindex` on elements.\r\n   *\r\n   * @param {Object|string|Array} $elements\r\n   * @param {boolean} [isReadable=true]\r\n   * @returns {Object} Chainable\r\n   */\r\n  toggleAccessible($elements, isReadable = true) {\r\n    $elements = $($elements);\r\n    const config = this.config;\r\n    if (!config._isEnabled || !config._options._isAriaHiddenManagementEnabled || $elements.length === 0) {\r\n      return this;\r\n    }\r\n    if (!isReadable) {\r\n      $elements.attr({\r\n        tabindex: '-1',\r\n        'aria-hidden': 'true'\r\n      }).addClass('aria-hidden');\r\n    } else {\r\n      $elements.removeAttr('aria-hidden tabindex').removeClass('aria-hidden');\r\n      $elements.parents(config._options._ariaHiddenExcludes).removeAttr('aria-hidden').removeClass('aria-hidden');\r\n    }\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * Adds or removes `disabled` attribute and `disabled` class.\r\n   *\r\n   * @param {Object|string|Array} $elements\r\n   * @param {boolean} [isEnabled=true]\r\n   * @returns {Object} Chainable\r\n   */\r\n  toggleEnabled($elements, isEnabled = true) {\r\n    $elements = $($elements);\r\n    if ($elements.length === 0) {\r\n      return this;\r\n    }\r\n    if (!isEnabled) {\r\n      $elements.attr({\r\n        tabindex: '-1',\r\n        'aria-disabled': 'true'\r\n      }).addClass('is-disabled');\r\n    } else {\r\n      $elements.removeAttr('aria-disabled tabindex').removeClass('is-disabled');\r\n    }\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * Toggles tabindexes off and on all tabbable descendants.\r\n   * @param {Object|string|Array} $element\r\n   * @param {boolean} isTabbable\r\n   * @returns {Object} Chainable\r\n   */\r\n  toggleTabbableDescendants($element, isTabbable = true) {\r\n    const $tabbable = this.findTabbable($element);\r\n    if (!isTabbable) {\r\n      $tabbable.each((index, element) => {\r\n        if (element.isAdaptTabHidden) return;\r\n        const $element = $(element);\r\n        element.isAdaptTabHidden = true;\r\n        element.adaptPreviousTabIndex = $element.attr('tabindex') ?? null;\r\n        $element.attr('tabindex', -1);\r\n      });\r\n      return this;\r\n    }\r\n    $tabbable.each((index, element) => {\r\n      if (!element.isAdaptTabHidden) return;\r\n      const $element = $(element);\r\n      if (element.adaptPreviousTabIndex === null) $element.removeAttr('tabindex');\r\n      else $element.attr('tabindex', element.adaptPreviousTabIndex);\r\n      delete element.isAdaptTabHidden;\r\n      delete element.adaptPreviousTabIndex;\r\n    });\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * Find the first tabbable element after the specified element.\r\n   *\r\n   * @param {Object|string|Array} $element\r\n   * @returns {Object}\r\n   */\r\n  findFirstTabbable($element) {\r\n    $element = $($element).first();\r\n    return this._findFirstForward($element, this.isTabbable);\r\n  }\r\n\r\n  /**\r\n   * Find the first readable element after the specified element.\r\n   *\r\n   * @param {Object|string|Array} $element\r\n   * @returns {Object}\r\n   */\r\n  findFirstReadable($element) {\r\n    $element = $($element).first();\r\n    return this._findFirstForward($element, this.isReadable);\r\n  }\r\n\r\n  /**\r\n   * Find the first focusable element after the specified element.\r\n   *\r\n   * @param {Object|string|Array} $element\r\n   * @returns {Object}\r\n   */\r\n  findFirstFocusable($element) {\r\n    $element = $($element).first();\r\n    return this._findFirstForward($element, this.isFocusable);\r\n  }\r\n\r\n  /**\r\n   * Find all tabbable elements in the specified element.\r\n   *\r\n   * @param {Object|string|Array} $element\r\n   * @returns {Object}\r\n   */\r\n  findTabbable($element) {\r\n    const config = this.config;\r\n    return $($element).find(config._options._tabbableElements).filter(config._options._tabbableElementsExcludes);\r\n  }\r\n\r\n  /**\r\n   * Find all readable elements in the specified element.\r\n   *\r\n   * @param {Object|string|Array} $element\r\n   */\r\n  findReadable($element) {\r\n    return $($element).find('*').filter((index, element) => this.isReadable(element));\r\n  }\r\n\r\n  /**\r\n   * Find all focusable elements in the specified element.\r\n   *\r\n   * @param {Object|string|Array} $element\r\n   */\r\n  findFocusable($element) {\r\n    return $($element).find('*').filter((index, element) => this.isFocusable(element));\r\n  }\r\n\r\n  /**\r\n   * Check if the element is natively or explicitly tabbable.\r\n   *\r\n   * @param {Object|string|Array} $element\r\n   * @returns {boolean|undefined}\r\n   */\r\n  isTabbable($element) {\r\n    const config = this.config;\r\n    const value = $($element).is(config._options._tabbableElements).is(config._options._tabbableElementsExcludes);\r\n    if (!value) {\r\n      return null; // Allow _findForward to descend\r\n    }\r\n    return value;\r\n  }\r\n\r\n  /**\r\n   * Check if the first item is readable by a screen reader.\r\n   *\r\n   * @param {Object|string|Array} $element\r\n   * @param {boolean} [checkParents=true] Check if parents are inaccessible.\r\n   * @returns {boolean}\r\n   */\r\n  isReadable($element, checkParents = true) {\r\n    const config = this.config;\r\n    $element = $($element).first();\r\n\r\n    const $branch = checkParents\r\n      ? $element.add($element.parents())\r\n      : $element;\r\n\r\n    const isNotVisible = $branch.toArray().some(item => {\r\n      const $item = $(item);\r\n      // make sure item is not explicitly invisible\r\n      return $item.css('display') === 'none' ||\r\n        $item.css('visibility') === 'hidden' ||\r\n        $item.attr('aria-hidden') === 'true';\r\n    });\r\n    if (isNotVisible) {\r\n      return false;\r\n    }\r\n\r\n    // check that the component is natively tabbable or\r\n    // will be knowingly read by a screen reader\r\n    const hasReadableContent = (!/^\\s*$/.test($element.text()) ||\r\n      !/^\\s*$/.test($element.attr('aria-label') ?? '') ||\r\n      !/^\\s*$/.test($element.attr('aria-labelledby') ?? ''));\r\n    const hasNativeFocusOrIsScreenReadable = ($element.is(config._options._focusableElements) ||\r\n      $element.is(config._options._readableElements)) && hasReadableContent;\r\n    if (hasNativeFocusOrIsScreenReadable) {\r\n      return true;\r\n    }\r\n    const childNodes = $element[0].childNodes;\r\n    for (let c = 0, cl = childNodes.length; c < cl; c++) {\r\n      const childNode = childNodes[c];\r\n      const isTextNode = (childNode.nodeType === 3);\r\n      if (!isTextNode) {\r\n        continue;\r\n      }\r\n      const isOnlyWhiteSpace = /^\\s*$/.test(childNode.nodeValue);\r\n      if (isOnlyWhiteSpace) {\r\n        continue;\r\n      }\r\n      return true;\r\n    }\r\n    return null; // Allows _findForward to decend.\r\n  }\r\n\r\n  /**\r\n   * Check if the first item is readable by a screen reader.\r\n   *\r\n   * @param {Object|string|Array} $element\r\n   * @param {boolean} [checkParents=true] Check if parents are inaccessible.\r\n   * @returns {boolean}\r\n   */\r\n  isFocusable($element, checkParents = true) {\r\n    const config = this.config;\r\n    $element = $($element).first();\r\n    if (!$element.is(config._options._focusForwardElementsExcludes)) return null;\r\n    return this.isReadable($element, checkParents);\r\n  }\r\n\r\n  /**\r\n   * Find forward in the DOM, descending and ascending to move forward\r\n   * as appropriate.\r\n   *\r\n   * If the selector is a function it should returns true, false or undefined.\r\n   * Returning true matches the item and returns it. Returning false means do\r\n   * not match or descend into this item, returning undefined means do not match,\r\n   * but descend into this item.\r\n   *\r\n   * @param {Object|string|Array} $element\r\n   * @param {string|function|undefined} selector\r\n   * @returns {Object} Returns found descendant.\r\n   */\r\n  _findFirstForward($element, selector) {\r\n    $element = $($element).first();\r\n\r\n    // make sure iterator is correct, use boolean or selector comparison\r\n    // appropriately\r\n    let iterator;\r\n    switch (typeof selector) {\r\n      case 'string':\r\n        // make selector iterator\r\n        iterator = function($tag) {\r\n          return $tag.is(selector) || undefined;\r\n        };\r\n        break;\r\n      case 'function':\r\n        iterator = selector;\r\n        break;\r\n      case 'undefined':\r\n        // find first next element\r\n        iterator = Boolean;\r\n    }\r\n\r\n    if ($element.length === 0) {\r\n      return $element.not('*');\r\n    }\r\n\r\n    // check children by walking the tree\r\n    let $found = this._findFirstForwardDescendant($element, iterator);\r\n    if ($found.length) {\r\n      return $found;\r\n    }\r\n\r\n    // check subsequent siblings\r\n    $element.nextAll().toArray().some(sibling => {\r\n      const $sibling = $(sibling);\r\n      const value = iterator($sibling);\r\n\r\n      // skip this sibling if explicitly instructed\r\n      if (value === false) {\r\n        return false;\r\n      }\r\n\r\n      if (value) {\r\n        // sibling matched\r\n        $found = $sibling;\r\n        return true;\r\n      }\r\n\r\n      // check parent sibling children by walking the tree\r\n      $found = this._findFirstForwardDescendant($sibling, iterator);\r\n      return Boolean($found.length);\r\n    });\r\n    if ($found.length) {\r\n      return $found;\r\n    }\r\n\r\n    // move through parents towards the body element\r\n    $element.add($element.parents()).toArray().reverse().some(parent => {\r\n      const $parent = $(parent);\r\n      if (iterator($parent) === false) {\r\n        // skip this parent if explicitly instructed\r\n        return false;\r\n      }\r\n\r\n      // move through parents nextAll siblings\r\n      return $parent.nextAll().toArray().some(sibling => {\r\n        const $sibling = $(sibling);\r\n        const value = iterator($sibling);\r\n\r\n        // skip this sibling if explicitly instructed\r\n        if (value === false) {\r\n          return false;\r\n        }\r\n\r\n        if (value) {\r\n          // sibling matched\r\n          $found = $sibling;\r\n          return true;\r\n        }\r\n\r\n        // check parent sibling children by walking the tree\r\n        $found = this._findFirstForwardDescendant($sibling, iterator);\r\n        return Boolean($found.length);\r\n      });\r\n    });\r\n\r\n    if (!$found.length) {\r\n      return $element.not('*');\r\n    }\r\n    return $found;\r\n  }\r\n\r\n  /**\r\n   * Find descendant in a DOM tree, work from selected to branch-end, through allowed\r\n   * branch structures in hierarchy order\r\n   *\r\n   * If the selector is a function it should returns true, false or undefined.\r\n   * Returning true matches the item and returns it. Returning false means do\r\n   * not match or descend into this item, returning undefined means do not match,\r\n   * but descend into this item.\r\n   *\r\n   * @param {Object|string|Array} $element jQuery element to start from.\r\n   * @param {string|function|undefined} selector\r\n   * @returns {Object} Returns found descendant.\r\n   */\r\n  _findFirstForwardDescendant($element, selector) {\r\n    $element = $($element).first();\r\n\r\n    // make sure iterator is correct, use boolean or selector comparison\r\n    // appropriately\r\n    let iterator;\r\n    switch (typeof selector) {\r\n      case 'string':\r\n        // make selector iterator\r\n        iterator = function($tag) {\r\n          return $tag.is(selector) || undefined;\r\n        };\r\n        break;\r\n      case 'function':\r\n        iterator = selector;\r\n        break;\r\n      case 'undefined':\r\n        // find first next element\r\n        iterator = Boolean;\r\n    }\r\n\r\n    const $notFound = $element.not('*');\r\n    if ($element.length === 0) {\r\n      return $notFound;\r\n    }\r\n\r\n    // keep walked+passed children in a stack\r\n    const stack = [{\r\n      item: $element[0],\r\n      value: undefined\r\n    }];\r\n    let stackIndexPosition = 0;\r\n    let childIndexPosition = stackIndexPosition + 1;\r\n    do {\r\n\r\n      const stackEntry = stack[stackIndexPosition];\r\n      const $stackItem = $(stackEntry.item);\r\n\r\n      // check current item\r\n      switch (stackEntry.value) {\r\n        case true:\r\n          return $stackItem;\r\n        case false:\r\n          return $notFound;\r\n      }\r\n\r\n      // get i stack children\r\n      $stackItem.children().toArray().forEach(item => {\r\n        const $item = $(item);\r\n        const value = iterator($item);\r\n\r\n        // item explicitly not allowed, don't add to stack,\r\n        // skip children\r\n        if (value === false) {\r\n          return;\r\n        }\r\n\r\n        // item passed or readable, add to stack before any parent\r\n        // siblings\r\n        stack.splice(childIndexPosition++, 0, {\r\n          item: item,\r\n          value: value\r\n        });\r\n      });\r\n\r\n      // move to next stack item\r\n      stackIndexPosition++;\r\n      // keep place to inject children\r\n      childIndexPosition = stackIndexPosition + 1;\r\n    } while (stackIndexPosition < stack.length);\r\n\r\n    return $notFound;\r\n  }\r\n\r\n  /**\r\n   * Assign focus to the next readable element.\r\n   *\r\n   * @param {Object|string|Array} $element\r\n   * @param {FocusOptions} options\r\n   * @returns {Object} Chainable\r\n   */\r\n  focusNext($element, options) {\r\n    options = new FocusOptions(options);\r\n    $element = $($element).first();\r\n    $element = this.findFirstFocusable($element);\r\n    this.focus($element, options);\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * Assign focus to either the specified element if it is readable or the\r\n   * next readable element.\r\n   *\r\n   * @param {Object|string|Array} $element\r\n   * @param {FocusOptions} options\r\n   * @returns {Object}\r\n   */\r\n  focusFirst($element, options) {\r\n    options = new FocusOptions(options);\r\n    $element = $($element).first();\r\n    if (this.isReadable($element)) {\r\n      this.focus($element, options);\r\n      return $element;\r\n    }\r\n    $element = this.findFirstFocusable($element);\r\n    this.focus($element, options);\r\n    return $element;\r\n  }\r\n\r\n  /**\r\n   * Force focus to the specified element with/without a defer or scroll.\r\n   *\r\n   * @param {Object|string|Array} $element\r\n   * @param {FocusOptions} options\r\n   * @returns {Object} Chainable\r\n   */\r\n  focus($element, options) {\r\n    options = new FocusOptions(options);\r\n    $element = $($element).first();\r\n    const config = this.config;\r\n    if (!config._isEnabled || !config._options._isFocusAssignmentEnabled || $element.length === 0) {\r\n      return this;\r\n    }\r\n    function perform() {\r\n      if ($element.attr('tabindex') === undefined) {\r\n        $element.attr({\r\n          // JAWS reads better with 0, do not use -1\r\n          tabindex: '0',\r\n          'data-a11y-force-focus': 'true'\r\n        });\r\n      }\r\n      if (options.preventScroll) {\r\n        const y = $(window).scrollTop();\r\n        try {\r\n          $element[0].focus({\r\n            preventScroll: true\r\n          });\r\n        } catch (e) {\r\n          // Drop focus errors as only happens when the element\r\n          // isn't attached to the DOM.\r\n        }\r\n        switch (device.browser) {\r\n          case 'internet explorer':\r\n          case 'microsoft edge':\r\n          case 'safari':\r\n            // return to previous scroll position due to no support for preventScroll\r\n            window.scrollTo(null, y);\r\n        }\r\n      } else {\r\n        $element[0].focus();\r\n      }\r\n    }\r\n    if (options.defer) {\r\n      _.defer(perform);\r\n    } else {\r\n      perform();\r\n    }\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * Used to convert html to text aria-labels.\r\n   *\r\n   * @param {string} htmls Any html strings.\r\n   * @returns {string} Returns text without markup or html encoded characters.\r\n   */\r\n  normalize(htmls) {\r\n    htmls = [...arguments].filter(Boolean).filter(_.isString).join(' ');\r\n    const text = $('<div>' + htmls + '</div>').text();\r\n    // Remove all html encoded characters, such as &apos;\r\n    return text.replace(this._htmlCharRegex, '');\r\n  }\r\n\r\n  /**\r\n   * Removes all html tags except stylistic elements.\r\n   * Useful for producing uninterrupted text for screen readers from\r\n   * any html.\r\n   *\r\n   * @param  {string} htmls Any html strings.\r\n   * @return {string} Returns html string without markup which would cause screen reader to pause.\r\n   */\r\n  removeBreaks(htmls) {\r\n    htmls = [...arguments].filter(Boolean).filter(_.isString).join(' ');\r\n    const $div = $('<div>' + htmls + '</div>');\r\n    const stack = [ $div[0] ];\r\n    let stackIndex = 0;\r\n    const outputs = [];\r\n    do {\r\n      if (stack[stackIndex].childNodes.length) {\r\n        const nodes = stack[stackIndex].childNodes;\r\n        const usable = nodes.filter(node => {\r\n          const isTextNode = (node.nodeType === 3);\r\n          if (isTextNode) {\r\n            return true;\r\n          }\r\n          const isStyleElement = $(node).is(this.config._options._wrapStyleElements);\r\n          if (isStyleElement) {\r\n            return true;\r\n          }\r\n          return false;\r\n        });\r\n        outputs.push.apply(outputs, usable);\r\n        stack.push.apply(stack, nodes);\r\n      }\r\n      stackIndex++;\r\n    } while (stackIndex < stack.length);\r\n    let rtnText = '';\r\n    outputs.forEach(function(item) {\r\n      rtnText += item.outerHTML || item.textContent;\r\n    });\r\n    return rtnText;\r\n  }\r\n\r\n  /**\r\n   * @param {Object|string|Array} $elements\r\n   * @returns {Object} Chainable\r\n   */\r\n  scrollEnable($elements) {\r\n    this._scroll.enable($elements);\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * @param {Object|string|Array} $elements\r\n   * @returns {Object} Chainable\r\n   */\r\n  scrollDisable($elements) {\r\n    this._scroll.disable($elements);\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * To apply accessibilty handling to a tag, isolating the user.\r\n   *\r\n   * @param {Object} $popupElement Element encapsulating the popup.\r\n   * @returns {Object} Chainable\r\n   */\r\n  popupOpened($popupElement) {\r\n    this._popup.opened($popupElement);\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * Remove the isolation applied with a call to `popupOpened`.\r\n   *\r\n   * @param {Object} [$focusElement] Element to move focus to.\r\n   * @returns {Object} Chainable\r\n   */\r\n  popupClosed($focusElement) {\r\n    this._popup.closed($focusElement);\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * When a popup is open, this function makes it possible to swap the element\r\n   * that should receive focus on popup close.\r\n   *\r\n   * @param {Object} $focusElement Set a new element to focus on.\r\n   * @returns {Object} Returns previously set focus element.\r\n   */\r\n  setPopupCloseTo($focusElement) {\r\n    return this._popup.setCloseTo($focusElement);\r\n  }\r\n\r\n}\r\n\r\nconst a11y = new A11y();\r\nexport default a11y;\r\n","import Adapt from 'core/js/adapt';\r\n\r\nclass DrawerItemView extends Backbone.View {\r\n\r\n  className() {\r\n    return 'drawer__menu drawer__item';\r\n  }\r\n\r\n  attributes() {\r\n    return {\r\n      role: 'listitem'\r\n    };\r\n  }\r\n\r\n  initialize() {\r\n    this.listenTo(Adapt, 'drawer:empty', this.remove);\r\n    this.render();\r\n  }\r\n\r\n  events() {\r\n    return {\r\n      'click .drawer__item-btn': 'onDrawerItemClicked'\r\n    };\r\n  }\r\n\r\n  render() {\r\n    const data = this.model.toJSON();\r\n    const template = Handlebars.templates['drawerItem'];\r\n    $(this.el).html(template(data)).appendTo('.drawer__holder');\r\n    return this;\r\n  }\r\n\r\n  onDrawerItemClicked(event) {\r\n    event.preventDefault();\r\n    const eventCallback = this.model.get('eventCallback');\r\n    Adapt.trigger(eventCallback);\r\n  }\r\n\r\n}\r\n\r\nDrawerItemView.type = 'drawerItem';\r\n\r\nexport default DrawerItemView;\r\n","import Adapt from 'core/js/adapt';\r\nimport a11y from 'core/js/a11y';\r\nimport DrawerItemView from 'core/js/views/drawerItemView';\r\n\r\nclass DrawerView extends Backbone.View {\r\n\r\n  className() {\r\n    return 'drawer u-display-none';\r\n  }\r\n\r\n  attributes() {\r\n    return {\r\n      role: 'dialog',\r\n      'aria-modal': 'true',\r\n      'aria-labelledby': 'drawer-heading',\r\n      'aria-hidden': 'true'\r\n    };\r\n  }\r\n\r\n  initialize() {\r\n    this._isVisible = false;\r\n    this.disableAnimation = Adapt.config.has('_disableAnimation') ? Adapt.config.get('_disableAnimation') : false;\r\n    this.drawerDir = Adapt.config.get('_defaultDirection') === 'rtl' ? 'left' : 'right';\r\n    this.drawerDuration = Adapt.config.get('_drawer')?._duration ?? 400;\r\n    this.setupEventListeners();\r\n    this.render();\r\n  }\r\n\r\n  setupEventListeners() {\r\n    this.listenTo(Adapt, {\r\n      'navigation:toggleDrawer': this.toggleDrawer,\r\n      'drawer:triggerCustomView': this.openCustomView,\r\n      'drawer:closeDrawer': this.onCloseDrawer,\r\n      remove: this.onRemove,\r\n      'drawer:remove': this.remove\r\n    });\r\n\r\n    this.onKeyUp = this.onKeyUp.bind(this);\r\n    this.setupEscapeKey();\r\n  }\r\n\r\n  setupEscapeKey() {\r\n    $(window).on('keyup', this.onKeyUp);\r\n  }\r\n\r\n  onKeyUp(event) {\r\n    if (event.which !== 27) return;\r\n    event.preventDefault();\r\n\r\n    this.onCloseDrawer();\r\n  }\r\n\r\n  events() {\r\n    return {\r\n      'click .drawer__back': 'onBackButtonClicked',\r\n      'click .drawer__close': 'onCloseClicked'\r\n    };\r\n  }\r\n\r\n  render() {\r\n    const template = Handlebars.templates.drawer;\r\n    $(this.el).html(template({ _globals: Adapt.course.get('_globals') })).prependTo('body');\r\n    const shadowTemplate = Handlebars.templates.shadow;\r\n    $(shadowTemplate()).prependTo('body');\r\n    _.defer(this.postRender.bind(this));\r\n    return this;\r\n  }\r\n\r\n  postRender() {\r\n    this.$('a, button, input, select, textarea').attr('tabindex', -1);\r\n\r\n    this.checkIfDrawerIsAvailable();\r\n  }\r\n\r\n  openCustomView(view, hasBackButton) {\r\n    this.$('.js-drawer-holder').removeAttr('role');\r\n    this._hasBackButton = hasBackButton;\r\n    this._isCustomViewVisible = true;\r\n    Adapt.trigger('drawer:empty');\r\n    this.showDrawer();\r\n    this.$('.drawer__holder').html(view);\r\n  }\r\n\r\n  checkIfDrawerIsAvailable() {\r\n    const isEmptyDrawer = (this.collection.length === 0);\r\n    $('.js-nav-drawer-btn').toggleClass('u-display-none', isEmptyDrawer);\r\n    if (isEmptyDrawer) {\r\n      Adapt.trigger('drawer:noItems');\r\n    }\r\n  }\r\n\r\n  onBackButtonClicked(event) {\r\n    event.preventDefault();\r\n    this.showDrawer(true);\r\n  }\r\n\r\n  onCloseClicked(event) {\r\n    event.preventDefault();\r\n    this.hideDrawer();\r\n  }\r\n\r\n  onCloseDrawer($toElement) {\r\n    this.hideDrawer($toElement);\r\n  }\r\n\r\n  onRemove() {\r\n    this.hideDrawer();\r\n  }\r\n\r\n  toggleDrawer() {\r\n    if (this._isVisible && this._isCustomViewVisible === false) {\r\n      this.hideDrawer();\r\n      return;\r\n    }\r\n    this.showDrawer(true);\r\n  }\r\n\r\n  showDrawer(emptyDrawer) {\r\n    this.$el.removeClass('u-display-none').removeAttr('aria-hidden');\r\n    // Only trigger popup:opened if drawer is visible, pass popup manager drawer element\r\n    if (!this._isVisible) {\r\n      a11y.popupOpened(this.$el);\r\n      a11y.scrollDisable('body');\r\n      this._isVisible = true;\r\n    }\r\n\r\n    // Sets tab index to 0 for all tabbable elements in Drawer\r\n    this.$('a, button, input, select, textarea').attr('tabindex', 0);\r\n\r\n    if (emptyDrawer) {\r\n      this.$('.drawer__back').addClass('u-display-none');\r\n      this._isCustomViewVisible = false;\r\n      this.emptyDrawer();\r\n      if (this.collection.models.length === 1) {\r\n        // This callback triggers openCustomView() and sets\r\n        // _isCustomViewVisible to true, causing toggleDrawer()\r\n        // to re-render the drawer on every toggle button press\r\n        Adapt.trigger(this.collection.models[0].get('eventCallback'));\r\n        // Set _isCustomViewVisible to false to prevent re-rendering\r\n        // the drawer and fix the toggle functionality on toggle button press\r\n        this._isCustomViewVisible = false;\r\n      } else {\r\n        this.renderItems();\r\n        Adapt.trigger('drawer:openedItemView');\r\n      }\r\n    } else {\r\n      const hideDrawerBackButton = (!this._hasBackButton || this.collection.models.length <= 1);\r\n      this.$('.drawer__back').toggleClass('u-display-none', hideDrawerBackButton);\r\n      Adapt.trigger('drawer:openedCustomView');\r\n    }\r\n\r\n    const complete = () => {\r\n      this.addShadowEvent();\r\n      Adapt.trigger('drawer:opened');\r\n\r\n      // focus on first tabbable element in drawer\r\n      a11y.focusFirst(this.$el, { defer: true });\r\n    };\r\n\r\n    // delay drawer animation until after background fadeout animation is complete\r\n    const direction = {};\r\n    if (this.disableAnimation) {\r\n      $('.js-shadow').removeClass('u-display-none');\r\n      $('.js-drawer-holder').scrollTop(0);\r\n\r\n      direction[this.drawerDir] = 0;\r\n      this.$el.css(direction);\r\n      complete();\r\n    } else {\r\n      $('.js-shadow').velocity({ opacity: 1 }, {\r\n        duration: this.drawerDuration,\r\n        begin: () => {\r\n          $('.js-shadow').removeClass('u-display-none');\r\n          $('.js-drawer-holder').scrollTop(0);\r\n          complete();\r\n        }\r\n      });\r\n\r\n      const easing = Adapt.config.get('_drawer')?._showEasing || 'easeOutQuart';\r\n      direction[this.drawerDir] = 0;\r\n      this.$el.velocity(direction, this.drawerDuration, easing);\r\n    }\r\n\r\n  }\r\n\r\n  emptyDrawer() {\r\n    this.$('.drawer__holder').empty();\r\n  }\r\n\r\n  renderItems() {\r\n    Adapt.trigger('drawer:empty');\r\n    this.emptyDrawer();\r\n    const isList = (this.collection.length > 1);\r\n    if (isList) this.$('.js-drawer-holder').attr('role', 'list');\r\n    else this.$('.js-drawer-holder').removeAttr('role');\r\n    this.collection.forEach(model => new DrawerItemView({ model }));\r\n  }\r\n\r\n  hideDrawer($toElement) {\r\n    if (!this._isVisible) return;\r\n\r\n    const direction = {};\r\n    a11y.popupClosed($toElement);\r\n    this._isVisible = false;\r\n    a11y.scrollEnable('body');\r\n\r\n    if (this.disableAnimation) {\r\n\r\n      direction[this.drawerDir] = -this.$el.width();\r\n      this.$el\r\n        .css(direction)\r\n        .addClass('u-display-none')\r\n        .attr('aria-hidden', 'true');\r\n\r\n      $('.js-shadow').addClass('u-display-none');\r\n      this.$('.js-drawer-holder').removeAttr('role');\r\n      Adapt.trigger('drawer:closed');\r\n\r\n    } else {\r\n      const easing = Adapt.config.get('_drawer')?._hideEasing || 'easeInQuart';\r\n\r\n      direction[this.drawerDir] = -this.$el.width();\r\n      this.$el.velocity(direction, this.drawerDuration, easing, () => {\r\n        this.$el\r\n          .addClass('u-display-none')\r\n          .attr('aria-hidden', 'true');\r\n        this.$('.js-drawer-holder').removeAttr('role');\r\n        Adapt.trigger('drawer:closed');\r\n      });\r\n\r\n      $('.js-shadow').velocity({ opacity: 0 }, {\r\n        duration: this.drawerDuration,\r\n        complete() {\r\n          $('.js-shadow').addClass('u-display-none');\r\n        }\r\n      });\r\n\r\n    }\r\n\r\n    this._isCustomViewVisible = false;\r\n    this.removeShadowEvent();\r\n\r\n  }\r\n\r\n  addShadowEvent() {\r\n    $('.js-shadow').one('click touchstart', () => this.onCloseDrawer());\r\n  }\r\n\r\n  removeShadowEvent() {\r\n    $('.js-shadow').off('click touchstart');\r\n  }\r\n\r\n  remove() {\r\n    super.remove();\r\n    $(window).off('keyup', this.onKeyUp);\r\n\r\n    Adapt.trigger('drawer:empty');\r\n    this.collection.reset();\r\n    $('.js-shadow').remove();\r\n  }\r\n\r\n}\r\n\r\nObject.assign(DrawerView, {\r\n  childContainer: '.js-drawer-holder',\r\n  childView: DrawerItemView\r\n});\r\n\r\nexport default DrawerView;\r\n","import Adapt from 'core/js/adapt';\r\nimport DrawerView from 'core/js/views/drawerView';\r\n\r\nconst DrawerCollection = new Backbone.Collection(null, { comparator: 'drawerOrder' });\r\nconst Drawer = {};\r\n\r\nDrawer.addItem = function(drawerObject, eventCallback) {\r\n  drawerObject.eventCallback = eventCallback;\r\n  DrawerCollection.add(drawerObject);\r\n};\r\n\r\nDrawer.triggerCustomView = function(view, hasBackButton) {\r\n  if (hasBackButton !== false) {\r\n    hasBackButton = true;\r\n  }\r\n  Adapt.trigger('drawer:triggerCustomView', view, hasBackButton);\r\n};\r\n\r\nAdapt.on({\r\n  'adapt:start'() {\r\n    new DrawerView({ collection: DrawerCollection });\r\n  },\r\n  'app:languageChanged'() {\r\n    Adapt.trigger('drawer:remove');\r\n  }\r\n});\r\n\r\nexport default Drawer;\r\n","import AdaptCollection from 'core/js/collections/adaptCollection';\r\n\r\nexport default class AdaptSubsetCollection extends AdaptCollection {\r\n\r\n  initialize(models, options) {\r\n    super.initialize(models, options);\r\n    this.parent = options.parent;\r\n    this.listenTo(this.parent, 'reset', this.loadSubset);\r\n  }\r\n\r\n  loadSubset() {\r\n    this.set(this.parent.filter(model => model instanceof this.model));\r\n    this._byAdaptID = this.groupBy('_id');\r\n  }\r\n\r\n}\r\n","export default class ModelEvent extends Backbone.Controller {\r\n\r\n  /**\r\n   * @param {string} type Event name / type\r\n   * @param {Backbone.Model} target Origin model\r\n   * @param {*} [value] Any value that should be carried through on the event\r\n   */\r\n  initialize(type, target, value) {\r\n    this.type = type;\r\n    this.target = target;\r\n    this.value = value;\r\n    this.canBubble = true;\r\n    this.deepPath = [target];\r\n    this.timeStamp = null;\r\n  }\r\n\r\n  stopPropagation() {\r\n    this.canBubble = false;\r\n  }\r\n\r\n  addPath(target) {\r\n    this.deepPath.unshift(target);\r\n  }\r\n\r\n}\r\n","import Adapt from 'core/js/adapt';\r\nimport data from 'core/js/data';\r\nimport ModelEvent from 'core/js/modelEvent';\r\nimport LockingModel from 'core/js/models/lockingModel';\r\nimport logging from 'core/js/logging';\r\n\r\nexport default class AdaptModel extends LockingModel {\r\n\r\n  toJSON() {\r\n    // Perform shallow clone\r\n    const json = { ...this.attributes };\r\n    // Remove deprecated values as they are not true json\r\n    delete json._children;\r\n    delete json._parent;\r\n    // Perform deep clone\r\n    return $.extend(true, {}, json);\r\n  }\r\n\r\n  get(name) {\r\n    switch (name) {\r\n      case '_parent':\r\n      case '_children':\r\n        logging.deprecated('Use model.getChildren() or model.getParent() instead of model.get(\\'_children\\') or model.get(\\'_parent\\')');\r\n    }\r\n    return super.get(name);\r\n  }\r\n\r\n  defaults() {\r\n    return {\r\n      _canShowFeedback: true,\r\n      _classes: '',\r\n      _canReset: true,\r\n      _canRequestChild: false,\r\n      _isComplete: false,\r\n      _isInteractionComplete: false,\r\n      _isA11yRegionEnabled: false,\r\n      _isA11yCompletionDescriptionEnabled: true,\r\n      _requireCompletionOf: -1,\r\n      _isEnabled: true,\r\n      _isResetOnRevisit: false,\r\n      _isAvailable: true,\r\n      _isOptional: false,\r\n      _isRendered: false,\r\n      _isReady: false,\r\n      _isVisible: true,\r\n      _isVisited: false,\r\n      _isLocked: false,\r\n      _isHidden: false\r\n    };\r\n  }\r\n\r\n  /**\r\n   * Fetch an array representing the relative location of the model to the nearest _trackingId\r\n   * @returns {Array<Number, Number>}\r\n   */\r\n  get trackingPosition() {\r\n    const firstDescendant = this.getAllDescendantModels(false).concat([this])[0];\r\n    const nearestTrackingIdModel = [firstDescendant].concat(firstDescendant.getAncestorModels()).find(model => model.has('_trackingId'));\r\n    if (!nearestTrackingIdModel) return;\r\n    const trackingId = nearestTrackingIdModel.get('_trackingId');\r\n    let trackingIdDescendants = [nearestTrackingIdModel].concat(nearestTrackingIdModel.getAllDescendantModels(true));\r\n    trackingIdDescendants = trackingIdDescendants.filter(model => !(model.isTypeGroup('component') && model.get('_isTrackable') === false));\r\n    const indexInTrackingIdDescendants = trackingIdDescendants.findIndex(descendant => descendant === this);\r\n    if (indexInTrackingIdDescendants >= 0) {\r\n      // Is either the nearestTrackingIdModel (0) or one of its flattened descendants (>0)\r\n      return [ trackingId, indexInTrackingIdDescendants ];\r\n    }\r\n    // Is an ancestor of the nearestTrackingIdModel\r\n    const trackingIdAncestors = nearestTrackingIdModel.getAncestorModels();\r\n    const ancestorDistance = trackingIdAncestors.findIndex(ancestor => ancestor === this);\r\n    return [ trackingId, -(ancestorDistance + 1) ];\r\n  }\r\n\r\n  /**\r\n   * The AAT always sets the value of `_isResetOnRevisit` to a String\r\n   * which is fine for the 'soft' and 'hard' values - but 'false' needs\r\n   * converting to Boolean - see #2825\r\n   */\r\n  parse(data) {\r\n    if (data._isResetOnRevisit === 'false') {\r\n      data._isResetOnRevisit = false;\r\n    }\r\n    return data;\r\n  }\r\n\r\n  trackable() {\r\n    return [\r\n      '_id',\r\n      '_isComplete',\r\n      '_isInteractionComplete',\r\n      '_isVisited'\r\n    ];\r\n  }\r\n\r\n  trackableType() {\r\n    return [\r\n      String,\r\n      Boolean,\r\n      Boolean,\r\n      Boolean\r\n    ];\r\n  }\r\n\r\n  bubblingEvents() {\r\n    return [\r\n      'change:_isComplete',\r\n      'change:_isInteractionComplete',\r\n      'change:_isActive',\r\n      'change:_isVisited'\r\n    ];\r\n  }\r\n\r\n  setupModel() {\r\n    if (this.hasManagedChildren) {\r\n      this.setupChildListeners();\r\n    }\r\n    this.init();\r\n    _.defer(() => {\r\n      if (this.hasManagedChildren) {\r\n        this.checkCompletionStatus();\r\n        this.checkInteractionCompletionStatus();\r\n        this.checkLocking();\r\n        this.checkVisitedStatus();\r\n      }\r\n      this.setupTrackables();\r\n    });\r\n  }\r\n\r\n  setupTrackables() {\r\n\r\n    // Limit state trigger calls and make state change callbacks batched-asynchronous\r\n    const originalTrackableStateFunction = this.triggerTrackableState;\r\n    this.triggerTrackableState = _.compose(\r\n      () => {\r\n\r\n        // Flag that the function is awaiting trigger\r\n        this.triggerTrackableState.isQueued = true;\r\n\r\n      },\r\n      _.debounce(() => {\r\n\r\n        // Trigger original function\r\n        originalTrackableStateFunction.apply(this);\r\n\r\n        // Unset waiting flag\r\n        this.triggerTrackableState.isQueued = false;\r\n\r\n      }, 17)\r\n    );\r\n\r\n    // Listen to model changes, trigger trackable state change when appropriate\r\n    this.listenTo(this, 'change', ({ changed }) => {\r\n\r\n      // Skip if trigger queued or adapt hasn't started yet\r\n      if (this.triggerTrackableState.isQueued || !Adapt.attributes._isStarted) {\r\n        return;\r\n      }\r\n\r\n      // Check that property is trackable\r\n      const trackablePropertyNames = _.result(this, 'trackable', []);\r\n      const changedPropertyNames = Object.keys(changed);\r\n      const isTrackable = changedPropertyNames.find(item => {\r\n        return trackablePropertyNames.includes(item);\r\n      });\r\n\r\n      if (isTrackable) {\r\n        // Trigger trackable state change\r\n        this.triggerTrackableState();\r\n      }\r\n    });\r\n  }\r\n\r\n  setupChildListeners() {\r\n    const children = this.getChildren();\r\n    if (!children.length) {\r\n      return;\r\n    }\r\n\r\n    this.listenTo(children, {\r\n      all: this.onAll,\r\n      bubble: this.bubble,\r\n      'change:_isVisited': this.checkVisitedStatus,\r\n      'change:_isReady': this.checkReadyStatus,\r\n      'change:_isComplete': this.onIsComplete,\r\n      'change:_isInteractionComplete': this.checkInteractionCompletionStatus\r\n    });\r\n  }\r\n\r\n  init() {}\r\n\r\n  getTrackableState() {\r\n\r\n    const trackable = this.resultExtend('trackable', []);\r\n    const json = this.toJSON();\r\n\r\n    const args = trackable;\r\n    args.unshift(json);\r\n\r\n    return _.pick(...args);\r\n\r\n  }\r\n\r\n  setTrackableState(state) {\r\n\r\n    const trackable = this.resultExtend('trackable', []);\r\n\r\n    const args = trackable;\r\n    args.unshift(state);\r\n\r\n    state = _.pick(...args);\r\n\r\n    this.set(state);\r\n\r\n    return this;\r\n\r\n  }\r\n\r\n  triggerTrackableState() {\r\n\r\n    Adapt.trigger('state:change', this, this.getTrackableState());\r\n\r\n  }\r\n\r\n  /**\r\n   * @param {string} [type] 'hard' resets _isComplete and _isInteractionComplete, 'soft' resets _isInteractionComplete only.\r\n   * @param {boolean} [canReset] Defaults to this.get('_canReset')\r\n   * @returns {boolean}\r\n   */\r\n  reset(type = 'hard', canReset = this.get('_canReset')) {\r\n    if (!canReset) return false;\r\n    switch (type) {\r\n      case 'hard':\r\n      case true:\r\n        this.set({\r\n          _isEnabled: true,\r\n          _isComplete: false,\r\n          _isInteractionComplete: false\r\n        });\r\n        return true;\r\n      case 'soft':\r\n        this.set({\r\n          _isEnabled: true,\r\n          _isInteractionComplete: false\r\n        });\r\n        return true;\r\n    }\r\n    return false;\r\n  }\r\n\r\n  /**\r\n   * Checks if any child models which have been _isRendered are not _isReady.\r\n   * If all rendered child models are marked ready then this model will be\r\n   * marked _isReady: true as well.\r\n   * @param {AdaptModel} [model]\r\n   * @param {boolean} [value]\r\n   * @returns {boolean}\r\n   */\r\n  checkReadyStatus(model, value) {\r\n    if (value === false) {\r\n      // Do not respond to _isReady: false as _isReady is unset throughout\r\n      // the rendering process\r\n      return false;\r\n    }\r\n    // Filter children based upon whether they are available\r\n    // Check if any _isRendered: true children return _isReady: false\r\n    // If not - set this model to _isReady: true\r\n    const children = this.getAvailableChildModels();\r\n    if (children.find(child => child.get('_isReady') === false && child.get('_isRendered'))) {\r\n      return false;\r\n    }\r\n\r\n    this.set('_isReady', true);\r\n    return true;\r\n  }\r\n\r\n  setReadyStatus() {\r\n    this.set('_isReady', true);\r\n  }\r\n\r\n  checkVisitedStatus() {\r\n    const children = this.getAvailableChildModels();\r\n    const isVisited = children.some(child => child.get('_isVisited') || child.get('_isComplete') || child.get('_isInteractionComplete'));\r\n    if (isVisited) this.set('_isVisited', true);\r\n    return isVisited;\r\n  }\r\n\r\n  setVisitedStatus() {\r\n    if (!this.get('_isReady') || !this.get('_isRendered')) return;\r\n    this.set('_isVisited', true);\r\n  }\r\n\r\n  setCompletionStatus() {\r\n    if (!this.get('_isVisible')) return;\r\n\r\n    this.set({\r\n      _isComplete: true,\r\n      _isInteractionComplete: true,\r\n      _isVisited: true\r\n    });\r\n  }\r\n\r\n  checkCompletionStatus() {\r\n    // defer to allow other change:_isComplete handlers to fire before cascading to parent\r\n    Adapt.checkingCompletion();\r\n    _.defer(this.checkCompletionStatusFor.bind(this), '_isComplete');\r\n  }\r\n\r\n  checkInteractionCompletionStatus() {\r\n    // defer to allow other change:_isInteractionComplete handlers to fire before cascading to parent\r\n    Adapt.checkingCompletion();\r\n    _.defer(this.checkCompletionStatusFor.bind(this), '_isInteractionComplete');\r\n  }\r\n\r\n  /**\r\n   * Function for checking whether the supplied completion attribute should be set to true or false.\r\n   * It iterates over our immediate children, checking the same completion attribute on any mandatory child\r\n   * to see if enough/all of them them have been completed. If enough/all have, we set our attribute to true;\r\n   * if not, we set it to false.\r\n   * @param {string} [completionAttribute] Either '_isComplete' or '_isInteractionComplete'. Defaults to '_isComplete' if not supplied.\r\n   */\r\n\r\n  checkCompletionStatusFor(completionAttribute = '_isComplete') {\r\n    let completed = false;\r\n    const children = this.getAvailableChildModels();\r\n    const requireCompletionOf = this.get('_requireCompletionOf');\r\n\r\n    if (requireCompletionOf === -1) { // a value of -1 indicates that ALL mandatory children must be completed\r\n      completed = children.every(child => {\r\n        return child.get(completionAttribute) || child.get('_isOptional');\r\n      });\r\n    } else {\r\n      completed = (children.filter(child => {\r\n        return child.get(completionAttribute) && !child.get('_isOptional');\r\n      }).length >= requireCompletionOf);\r\n    }\r\n\r\n    this.set(completionAttribute, completed);\r\n\r\n    Adapt.checkedCompletion();\r\n  }\r\n\r\n  /**\r\n   * Returns a string describing the type group of this model.\r\n   * Strings should be lowercase and not plurlaized.\r\n   * i.e. 'page', 'menu', 'contentobject', 'component', 'article', 'block'\r\n   * Override in inheritance chain.\r\n   * @returns {string}\r\n   */\r\n  getTypeGroup() {}\r\n\r\n  /**\r\n   * Returns true if this model is of the type group described.\r\n   * Automatically manages pluralization typeGroup and matches lowercase only.\r\n   * Pluralized typeGroups and uppercase characters in typeGroups are discouraged.\r\n   * @param {string} type Type group name i.e. course, contentobject, article, block, component\r\n   * @returns {boolean}\r\n   */\r\n  isTypeGroup(typeGroup) {\r\n    const hasUpperCase = /[A-Z]+/.test(typeGroup);\r\n    const isPluralized = typeGroup.slice(-1) === 's';\r\n    const lowerCased = typeGroup.toLowerCase();\r\n    const singular = isPluralized && lowerCased.slice(0, -1); // remove pluralization if ending in s\r\n    const singularLowerCased = (singular || lowerCased).toLowerCase();\r\n    if (isPluralized || hasUpperCase) {\r\n      logging.deprecated(`'${typeGroup}' appears pluralized or contains uppercase characters, suggest using the singular, lowercase type group '${singularLowerCased}'.`);\r\n    }\r\n    const pluralizedLowerCaseTypes = [\r\n      singularLowerCased,\r\n      !isPluralized && `${lowerCased}s` // pluralize if not ending in s\r\n    ].filter(Boolean);\r\n    const typeGroups = this.getTypeGroups();\r\n    if (_.intersection(pluralizedLowerCaseTypes, typeGroups).length) {\r\n      return true;\r\n    }\r\n    return false;\r\n  }\r\n\r\n  /**\r\n   * Returns an array of strings describing the model type groups.\r\n   * All strings are lowercase and should not be pluralized.\r\n   * i.e. ['course', 'menu', 'contentobject'], ['page', 'contentobject'], ['component']\r\n   * @returns {[string]}\r\n   */\r\n  getTypeGroups() {\r\n    if (this._typeGroups) return this._typeGroups;\r\n    const typeGroups = [ this.get('_type') ];\r\n    let parentClass = this;\r\n    while ((parentClass = Object.getPrototypeOf(parentClass))) {\r\n      if (!Object.prototype.hasOwnProperty.call(parentClass, 'getTypeGroup')) continue;\r\n      typeGroups.push(parentClass.getTypeGroup.call(this));\r\n    }\r\n    return (this._typeGroups = _.uniq(typeGroups.filter(Boolean).map(s => s.toLowerCase())));\r\n  }\r\n\r\n  /**\r\n   * Searches the model's ancestors to find the first instance of the specified ancestor type\r\n   * @param {string} [ancestorType] Valid values are 'course', 'pages', 'contentObjects', 'articles' or 'blocks'.\r\n   * If left blank, the immediate ancestor (if there is one) is returned\r\n   * @return {object} Reference to the model of the first ancestor of the specified type that's found - or `undefined` if none found\r\n   */\r\n  findAncestor(ancestorType) {\r\n    const parent = this.getParent();\r\n    if (!parent) return;\r\n    if (!ancestorType || parent.isTypeGroup(ancestorType)) {\r\n      return parent;\r\n    }\r\n    return parent.findAncestor(ancestorType);\r\n  }\r\n\r\n  /**\r\n   * Returns all the descendant models of a specific type\r\n   * @param {string} descendants Valid values are 'contentobject', 'page', 'menu', 'article', 'block', 'component', 'question'\r\n   * @param {object} options an object that defines the search type and the properties/values to search on. Currently only the `where` search type (equivalent to `Backbone.Collection.where()`) is supported.\r\n   * @param {object} options.where\r\n   * @return {array}\r\n   * @example\r\n   * //find all available, non-optional components\r\n   * this.findDescendantModels('component', { where: { _isAvailable: true, _isOptional: false }});\r\n   */\r\n  findDescendantModels(descendants, options) {\r\n    const allDescendantsModels = this.getAllDescendantModels();\r\n    const returnedDescendants = allDescendantsModels.filter(model => {\r\n      return model.isTypeGroup(descendants);\r\n    });\r\n\r\n    if (!options) {\r\n      return returnedDescendants;\r\n    }\r\n\r\n    if (options.where) {\r\n      return returnedDescendants.filter(descendant => {\r\n        for (const property in options.where) {\r\n          const value = options.where[property];\r\n          if (descendant.get(property) !== value) {\r\n            return false;\r\n          }\r\n        }\r\n        return true;\r\n      });\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Fetches the sub structure of a model as a flattened array\r\n   *\r\n   * Such that the tree:\r\n   *  { a1: { b1: [ c1, c2 ], b2: [ c3, c4 ] }, a2: { b3: [ c5, c6 ] } }\r\n   *\r\n   * will become the array (parent first = false):\r\n   *  [ c1, c2, b1, c3, c4, b2, a1, c5, c6, b3, a2 ]\r\n   *\r\n   * or (parent first = true):\r\n   *  [ a1, b1, c1, c2, b2, c3, c4, a2, b3, c5, c6 ]\r\n   *\r\n   * This is useful when sequential operations are performed on the menu/page/article/block/component hierarchy.\r\n   * @param {boolean} [isParentFirst]\r\n   * @return {array}\r\n   */\r\n  getAllDescendantModels(isParentFirst) {\r\n\r\n    const descendants = [];\r\n\r\n    if (!this.hasManagedChildren) {\r\n      return descendants;\r\n    }\r\n\r\n    const children = this.getChildren();\r\n\r\n    children.models.forEach(child => {\r\n\r\n      if (!child.hasManagedChildren) {\r\n        descendants.push(child);\r\n        return;\r\n      }\r\n\r\n      const subDescendants = child.getAllDescendantModels(isParentFirst);\r\n      if (isParentFirst === true) {\r\n        descendants.push(child);\r\n      }\r\n\r\n      descendants.push(...subDescendants);\r\n\r\n      if (isParentFirst !== true) {\r\n        descendants.push(child);\r\n      }\r\n    });\r\n\r\n    return descendants;\r\n\r\n  }\r\n\r\n  /**\r\n   * Returns a relative model from the Adapt hierarchy\r\n   *\r\n   * Such that in the tree:\r\n   *  { a1: { b1: [ c1, c2 ], b2: [ c3, c4 ] }, a2: { b3: [ c5, c6 ] } }\r\n   *\r\n   *  c1.findRelativeModel('@block +1') = b2;\r\n   *  c1.findRelativeModel('@component +4') = c5;\r\n   *\r\n   * @see Adapt.parseRelativeString for a description of relativeStrings\r\n   * @param {string} relativeString\r\n   * @param {object} options Search configuration settings\r\n   * @param {boolean} options.limitParentId\r\n   * @param {function} options.filter\r\n   * @param {boolean} options.loop\r\n   * @return {array}\r\n   */\r\n  findRelativeModel(relativeString, options = {}) {\r\n    // return a model relative to the specified one if opinionated\r\n    const rootModel = options.limitParentId ?\r\n      data.findById(options.limitParentId) :\r\n      Adapt.course;\r\n\r\n    const relativeDescriptor = Adapt.parseRelativeString(relativeString);\r\n    const searchBackwards = (relativeDescriptor.offset < 0);\r\n    let moveBy = Math.abs(relativeDescriptor.offset);\r\n    let movementCount = 0;\r\n\r\n    const hasDescendantsOfType = Boolean(this.findDescendantModels(relativeDescriptor.type).length);\r\n    if (hasDescendantsOfType) {\r\n      // move by one less as first found is considered next\r\n      // will find descendants on either side but not inside\r\n      moveBy--;\r\n    }\r\n\r\n    let pageDescendants;\r\n    if (searchBackwards) {\r\n      // parents first [p1,a1,b1,c1,c2,a2,b2,c3,c4,p2,a3,b3,c6,c7,a4,b4,c8,c9]\r\n      pageDescendants = [rootModel];\r\n      pageDescendants.push(...rootModel.getAllDescendantModels(true));\r\n\r\n      // reverse so that we don't need a forward and a backward iterating loop\r\n      // reversed [c9,c8,b4,a4,c7,c6,b3,a3,p2,c4,c3,b2,a2,c2,c1,b1,a1,p1]\r\n      pageDescendants.reverse();\r\n    } else {\r\n      // children first [c1,c2,b1,a1,c3,c4,b2,a2,p1,c6,c7,b3,a3,c8,c9,b4,a4,p2]\r\n      pageDescendants = rootModel.getAllDescendantModels(false);\r\n      pageDescendants.push(rootModel);\r\n    }\r\n\r\n    // find current index in array\r\n    const modelId = this.get('_id');\r\n    const modelIndex = pageDescendants.findIndex(pageDescendant => {\r\n      if (pageDescendant.get('_id') === modelId) {\r\n        return true;\r\n      }\r\n      return false;\r\n    });\r\n    const isFilterFunction = (typeof options.filter === 'function');\r\n\r\n    if (options.loop) {\r\n      // normalize offset position to allow for overflow looping\r\n      const totalOfType = pageDescendants.reduce((count, model) => {\r\n        if (!model.isTypeGroup(relativeDescriptor.type)) return count;\r\n        return ++count;\r\n      }, 0);\r\n      // take the remainder after removing whole units of the type count\r\n      moveBy = moveBy % totalOfType;\r\n      // double up entries to allow for overflow looping\r\n      pageDescendants = pageDescendants.concat(pageDescendants.slice(0));\r\n    }\r\n\r\n    for (let i = modelIndex, l = pageDescendants.length; i < l; i++) {\r\n      const descendant = pageDescendants[i];\r\n      if (!descendant.isTypeGroup(relativeDescriptor.type)) continue;\r\n      const isSelf = (i === modelIndex);\r\n      // https://github.com/adaptlearning/adapt_framework/issues/3031\r\n      if (!isSelf && isFilterFunction && !options.filter(descendant)) continue;\r\n      if (movementCount > moveBy) {\r\n        // there is no descendant which matches this relativeString\r\n        // probably looking for the descendant 0 in a parent\r\n        break;\r\n      }\r\n      if (movementCount === moveBy) {\r\n        return data.findById(descendant.get('_id'));\r\n      }\r\n      movementCount++;\r\n    }\r\n\r\n  }\r\n\r\n  get hasManagedChildren() {\r\n    return true;\r\n  }\r\n\r\n  getChildren() {\r\n    if (this._childrenCollection) {\r\n      return this._childrenCollection;\r\n    }\r\n\r\n    let childrenCollection;\r\n\r\n    if (!this.hasManagedChildren) {\r\n      childrenCollection = new Backbone.Collection();\r\n    } else {\r\n      const id = this.get('_id');\r\n      // Look up child by _parentId from data\r\n      const children = data.filter(model => model.get('_parentId') === id);\r\n      childrenCollection = new Backbone.Collection(children);\r\n    }\r\n\r\n    if (this.get('_type') === 'block' &&\r\n      childrenCollection.length === 2 &&\r\n      childrenCollection.models[0].get('_layout') !== 'left') {\r\n      // Components may have a 'left' or 'right' _layout,\r\n      // so ensure they appear in the correct order\r\n      // Re-order component models to correct it\r\n      childrenCollection.comparator = '_layout';\r\n      childrenCollection.sort();\r\n    }\r\n\r\n    this.setChildren(childrenCollection);\r\n    return this._childrenCollection;\r\n  }\r\n\r\n  setChildren(children) {\r\n    this._childrenCollection = children;\r\n    // Setup deprecated reference\r\n    this.set('_children', children);\r\n  }\r\n\r\n  getAvailableChildModels() {\r\n    return this.getChildren().where({\r\n      _isAvailable: true\r\n    });\r\n  }\r\n\r\n  getParent() {\r\n    if (this._parentModel) {\r\n      return this._parentModel;\r\n    }\r\n    const parentId = this.get('_parentId');\r\n    if (!parentId) return;\r\n    // Look up parent by id from data\r\n    this.setParent(data.findById(parentId));\r\n    return this._parentModel;\r\n  }\r\n\r\n  setParent(parent) {\r\n    this._parentModel = parent;\r\n    this.set('_parentId', this._parentModel.get('_id'));\r\n    // Set up deprecated reference\r\n    this.set('_parent', this._parentModel);\r\n  }\r\n\r\n  getAncestorModels(shouldIncludeChild) {\r\n    const parents = [];\r\n    let context = this;\r\n\r\n    if (shouldIncludeChild) parents.push(context);\r\n\r\n    while (context.has('_parentId')) {\r\n      context = context.getParent();\r\n      parents.push(context);\r\n    }\r\n\r\n    return parents.length ? parents : null;\r\n  }\r\n\r\n  getSiblings(passSiblingsAndIncludeSelf) {\r\n    const id = this.get('_id');\r\n    const parentId = this.get('_parentId');\r\n    let siblings;\r\n    if (!passSiblingsAndIncludeSelf) {\r\n      // returns a collection of siblings excluding self\r\n      if (this._hasSiblingsAndSelf === false) {\r\n        return this.get('_siblings');\r\n      }\r\n      siblings = data.filter(model => {\r\n        return model.get('_parentId') === parentId &&\r\n          model.get('_id') !== id;\r\n      });\r\n\r\n      this._hasSiblingsAndSelf = false;\r\n\r\n    } else {\r\n      // returns a collection of siblings including self\r\n      if (this._hasSiblingsAndSelf) {\r\n        return this.get('_siblings');\r\n      }\r\n\r\n      siblings = data.filter(model => {\r\n        return model.get('_parentId') === parentId;\r\n      });\r\n      this._hasSiblingsAndSelf = true;\r\n    }\r\n\r\n    const siblingsCollection = new Backbone.Collection(siblings);\r\n    this.set('_siblings', siblingsCollection);\r\n    return siblingsCollection;\r\n  }\r\n\r\n  /**\r\n   * @param  {string} key\r\n   * @param  {any} value\r\n   * @param  {Object} options\r\n   */\r\n  setOnChildren(...args) {\r\n\r\n    this.set(...args);\r\n\r\n    if (!this.hasManagedChildren) return;\r\n\r\n    const children = this.getChildren();\r\n    children.models.forEach(child => child.setOnChildren(...args));\r\n\r\n  }\r\n\r\n  /**\r\n   * @deprecated since v3.2.3 - please use `model.set('_isOptional', value)` instead\r\n   */\r\n  setOptional(value) {\r\n    logging.deprecated('Use model.set(\\'_isOptional\\', value) as setOptional() may be removed in the future');\r\n    this.set({ _isOptional: value });\r\n  }\r\n\r\n  checkLocking() {\r\n    const lockType = this.get('_lockType');\r\n\r\n    if (!lockType) return;\r\n\r\n    switch (lockType) {\r\n      case 'sequential':\r\n        this.setSequentialLocking();\r\n        break;\r\n      case 'unlockFirst':\r\n        this.setUnlockFirstLocking();\r\n        break;\r\n      case 'lockLast':\r\n        this.setLockLastLocking();\r\n        break;\r\n      case 'custom':\r\n        this.setCustomLocking();\r\n        break;\r\n      default:\r\n        console.warn(`AdaptModel.checkLocking: unknown _lockType '${lockType}' found on ${this.get('_id')}`);\r\n    }\r\n  }\r\n\r\n  setSequentialLocking() {\r\n    const children = this.getAvailableChildModels();\r\n    // Start from second child\r\n    children.slice(1).forEach((child, index) => {\r\n      const previousChild = children[index];\r\n      // If previous was locked, all subsequent will be locked.\r\n      const isLockedByPreviousChild = previousChild.get('_isLocked') ||\r\n        (\r\n          !previousChild.get('_isComplete') &&\r\n          !previousChild.get('_isOptional')\r\n        );\r\n      child.set('_isLocked', isLockedByPreviousChild);\r\n    }, false);\r\n  }\r\n\r\n  setUnlockFirstLocking() {\r\n    const children = this.getAvailableChildModels();\r\n    const firstChild = children.shift();\r\n    const isLockedByFirstChild = (!firstChild.get('_isComplete') && !firstChild.get('_isOptional'));\r\n    children.forEach(child => child.set('_isLocked', isLockedByFirstChild));\r\n  }\r\n\r\n  setLockLastLocking() {\r\n    const children = this.getAvailableChildModels();\r\n    const lastChild = children.pop();\r\n    const isLockedByChildren = children.some(child => (!child.get('_isComplete') && !child.get('_isOptional')));\r\n    lastChild.set('_isLocked', isLockedByChildren);\r\n  }\r\n\r\n  setCustomLocking() {\r\n    const children = this.getAvailableChildModels();\r\n    children.forEach(child => child.set('_isLocked', this.shouldLock(child)));\r\n  }\r\n\r\n  shouldLock(child) {\r\n    const lockedBy = child.get('_lockedBy');\r\n    if (!lockedBy) return false;\r\n    return lockedBy.some(id => {\r\n      try {\r\n        const anotherModel = data.findById(id);\r\n        return anotherModel.get('_isAvailable') &&\r\n          (\r\n            anotherModel.get('_isLocked') ||\r\n            (\r\n              !anotherModel.get('_isComplete') &&\r\n              !anotherModel.get('_isOptional')\r\n            )\r\n          );\r\n      } catch (e) {\r\n        console.warn(`AdaptModel.shouldLock: unknown _lockedBy ID '${id}' found on ${child.get('_id')}`);\r\n        return false;\r\n      }\r\n    });\r\n  }\r\n\r\n  onIsComplete() {\r\n    this.checkCompletionStatus();\r\n\r\n    this.checkLocking();\r\n  }\r\n\r\n  /**\r\n   * Used before a model is rendered to determine if it should be reset to its\r\n   * default values.\r\n   */\r\n  checkIfResetOnRevisit() {\r\n    const isResetOnRevisit = this.get('_isResetOnRevisit');\r\n    this.reset(isResetOnRevisit);\r\n  }\r\n\r\n  /**\r\n   * Clones this model and all managed children returning a new branch.\r\n   * Assign new unique ids to each cloned model.\r\n   * @param {Function} [modifier] A callback function for each child to allow for custom modifications\r\n   * @returns {AdaptModel}\r\n   */\r\n  deepClone(modifier = null) {\r\n    // Fetch the class\r\n    const ModelClass = this.constructor;\r\n    // Clone the model\r\n    const clonedModel = new ModelClass(this.toJSON());\r\n    // Run the custom modifier on the clone\r\n    if (modifier) {\r\n      modifier(clonedModel, this);\r\n    }\r\n    let clonedId = clonedModel.get('_id');\r\n    const hasId = Boolean(clonedId);\r\n    const shouldAssignUniqueId = (this.get('_id') === clonedId);\r\n    if (hasId && shouldAssignUniqueId) {\r\n      // Create a unique id if none was set by the modifier\r\n      const cid = _.uniqueId(ModelClass.prototype.cidPrefix || 'c');\r\n      clonedId = `${clonedId}_${cid}`;\r\n      clonedModel.set('_id', clonedId);\r\n    }\r\n    // Add the cloned model to data for data.findById resolution\r\n    if (hasId) {\r\n      data.add(clonedModel);\r\n    }\r\n    // Clone any children\r\n    if (this.hasManagedChildren) {\r\n      this.getChildren().each(child => {\r\n        if (!child.deepClone) {\r\n          throw new Error('Cannot deepClone child.');\r\n        }\r\n        child.deepClone((clone, child) => {\r\n          if (hasId) {\r\n            // Set the cloned child parent id\r\n            clone.set('_parentId', clonedId);\r\n          }\r\n          if (modifier) {\r\n            // Run the custom modifier function on the cloned child\r\n            modifier(clone, child);\r\n          }\r\n        });\r\n      });\r\n    }\r\n    // Add the cloned model to its parent for model.findDescendants resolution\r\n    clonedModel.getParent().getChildren().add(clonedModel);\r\n    // Setup the cloned model after setting the id, the parent and adding any children\r\n    clonedModel.setupModel();\r\n    return clonedModel;\r\n  }\r\n\r\n  /**\r\n   * Internal event handler for all module events. Triggers event bubbling\r\n   * through the module hierarchy when the event is included in\r\n   * `this.bubblingEvents`.\r\n   * @param {string} type Event name / type\r\n   * @param {Backbone.Model} model Origin backbone model\r\n   * @param {*} value New property value\r\n   */\r\n  onAll(type, model, value) {\r\n    if (!_.result(this, 'bubblingEvents').includes(type)) return;\r\n    const event = new ModelEvent(type, model, value);\r\n    this.bubble(event);\r\n  }\r\n\r\n  /**\r\n   * Internal event handler for bubbling events.\r\n   * @param {ModelEvent} event\r\n   */\r\n  bubble(event) {\r\n    if (!event.canBubble) return;\r\n    event.addPath(this);\r\n    this.trigger(`bubble:${event.type} bubble`, event);\r\n  }\r\n\r\n}\r\n","import Adapt from 'core/js/adapt';\r\nimport logging from 'core/js/logging';\r\nimport AdaptModel from 'core/js/models/adaptModel';\r\n\r\nexport default class ContentObjectModel extends AdaptModel {\r\n\r\n  get _parent() {\r\n    logging.deprecated('contentObjectModel._parent, use contentObjectModel.getParent() instead, parent models are defined by the JSON');\r\n    const isParentCourse = (this.get('_parentId') === Adapt.course.get('_id'));\r\n    if (isParentCourse) {\r\n      return 'course';\r\n    }\r\n    return 'contentObjects';\r\n  }\r\n\r\n  get _siblings() {\r\n    logging.deprecated('contentObjectModel._siblings, use contentObjectModel.getSiblings() instead, sibling models are defined by the JSON');\r\n    return 'contentObjects';\r\n  }\r\n\r\n  get _children() {\r\n    logging.deprecated('contentObjectModel._children, use contentObjectModel.hasManagedChildren instead, child models are defined by the JSON');\r\n    return null;\r\n  }\r\n\r\n  /**\r\n   * Returns a string of the model type group.\r\n   * @returns {string}\r\n   */\r\n  getTypeGroup() {\r\n    return 'contentobject';\r\n  }\r\n\r\n}\r\n","import components from 'core/js/components';\r\nimport logging from 'core/js/logging';\r\nimport AdaptModel from 'core/js/models/adaptModel';\r\n\r\nclass ArticleModel extends AdaptModel {\r\n\r\n  get _parent() {\r\n    logging.deprecated('articleModel._parent, use articleModel.getParent() instead, parent models are defined by the JSON');\r\n    return 'contentObjects';\r\n  }\r\n\r\n  get _siblings() {\r\n    logging.deprecated('articleModel._siblings, use articleModel.getSiblings() instead, sibling models are defined by the JSON');\r\n    return 'articles';\r\n  }\r\n\r\n  get _children() {\r\n    logging.deprecated('articleModel._children, use articleModel.hasManagedChildren instead, child models are defined by the JSON');\r\n    return 'blocks';\r\n  }\r\n\r\n  /**\r\n   * Returns a string of the model type group.\r\n   * @returns {string}\r\n   */\r\n  getTypeGroup() {\r\n    return 'article';\r\n  }\r\n\r\n}\r\n\r\ncomponents.register('article', { model: ArticleModel });\r\n\r\nexport default ArticleModel;\r\n","import components from 'core/js/components';\r\nimport logging from 'core/js/logging';\r\nimport AdaptModel from 'core/js/models/adaptModel';\r\n\r\nclass BlockModel extends AdaptModel {\r\n\r\n  get _parent() {\r\n    logging.deprecated('blockModel._parent, use blockModel.getParent() instead, parent models are defined by the JSON');\r\n    return 'articles';\r\n  }\r\n\r\n  get _siblings() {\r\n    logging.deprecated('blockModel._siblings, use blockModel.getSiblings() instead, sibling models are defined by the JSON');\r\n    return 'blocks';\r\n  }\r\n\r\n  get _children() {\r\n    logging.deprecated('blockModel._children, use blockModel.hasManagedChildren instead, child models are defined by the JSON');\r\n    return 'components';\r\n  }\r\n\r\n  /**\r\n   * Returns a string of the model type group.\r\n   * @returns {string}\r\n   */\r\n  getTypeGroup() {\r\n    return 'block';\r\n  }\r\n\r\n}\r\n\r\ncomponents.register('block', { model: BlockModel });\r\n\r\nexport default BlockModel;\r\n","import components from 'core/js/components';\r\nimport Adapt from 'core/js/adapt';\r\nimport logging from 'core/js/logging';\r\nimport AdaptModel from 'core/js/models/adaptModel';\r\n\r\nclass ComponentModel extends AdaptModel {\r\n\r\n  get _parent() {\r\n    logging.deprecated('componentModel._parent, use componentModel.getParent() instead, parent models are defined by the JSON');\r\n    return 'blocks';\r\n  }\r\n\r\n  get _siblings() {\r\n    logging.deprecated('componentModel._siblings, use componentModel.getSiblings() instead, sibling models are defined by the JSON');\r\n    return 'components';\r\n  }\r\n\r\n  /**\r\n   * Returns a string of the model type group.\r\n   * @returns {string}\r\n   */\r\n  getTypeGroup() {\r\n    return 'component';\r\n  }\r\n\r\n  defaults() {\r\n    return AdaptModel.resultExtend('defaults', {\r\n      _isA11yComponentDescriptionEnabled: true,\r\n      _shouldStoreAttempts: true,\r\n      _userAnswer: null,\r\n      _attemptStates: null\r\n    });\r\n  }\r\n\r\n  trackable() {\r\n    return AdaptModel.resultExtend('trackable', [\r\n      '_userAnswer',\r\n      '_attemptStates'\r\n    ]);\r\n  }\r\n\r\n  trackableType() {\r\n    return AdaptModel.resultExtend('trackableType', [\r\n      Array,\r\n      Array\r\n    ]);\r\n  }\r\n\r\n  get hasManagedChildren() {\r\n    return false;\r\n  }\r\n\r\n  init() {\r\n    if (Adapt.get('_isStarted')) {\r\n      this.onAdaptInitialize();\r\n      return;\r\n    }\r\n    this.listenToOnce(Adapt, 'adapt:initialize', this.onAdaptInitialize);\r\n  }\r\n\r\n  onAdaptInitialize() {\r\n    this.restoreUserAnswers();\r\n  }\r\n\r\n  /**\r\n   * Restore the user's answer from the _userAnswer property.\r\n   * The _userAnswer value must be in the form of arrays containing\r\n   * numbers, booleans or arrays only.\r\n   */\r\n  restoreUserAnswers() {}\r\n\r\n  /**\r\n   * Store the user's answer in the _userAnswer property.\r\n   * The _userAnswer value must be in the form of arrays containing\r\n   * numbers, booleans or arrays only.\r\n   */\r\n  storeUserAnswer() {}\r\n\r\n  resetUserAnswer() {\r\n    this.set('_userAnswer', null);\r\n  }\r\n\r\n  /**\r\n   * @param {string} [type] 'hard' resets _isComplete and _isInteractionComplete, 'soft' resets _isInteractionComplete only.\r\n   * @param {boolean} [canReset] Defaults to this.get('_canReset')\r\n   * @returns {boolean}\r\n   */\r\n  reset(type = 'hard', canReset = this.get('_canReset')) {\r\n    const wasReset = super.reset(type, canReset);\r\n    if (!wasReset) return false;\r\n    this.resetUserAnswer();\r\n    return true;\r\n  }\r\n\r\n  /**\r\n   * Returns the current attempt state raw data or the raw data from the supplied attempt state object.\r\n   * @param {Object} [object] JSON object representing the component state. Defaults to current JSON.\r\n   * @returns {Array}\r\n   */\r\n  getAttemptState(object = this.toJSON()) {\r\n    const trackables = this.trackable();\r\n    const types = this.trackableType();\r\n    trackables.find((name, index) => {\r\n      // Exclude _attemptStates as it's trackable but isn't needed here\r\n      if (name !== '_attemptStates') return false;\r\n      trackables.splice(index, 1);\r\n      types.splice(index, 1);\r\n      return true;\r\n    });\r\n    const values = trackables.map(n => object[n]);\r\n    const booleans = values.filter((v, i) => types[i] === Boolean).map(Boolean);\r\n    const numbers = values.filter((v, i) => types[i] === Number).map(v => Number(v) || 0);\r\n    const arrays = values.filter((v, i) => types[i] === Array);\r\n    return [\r\n      numbers,\r\n      booleans,\r\n      arrays\r\n    ];\r\n  }\r\n\r\n  /**\r\n   * Returns an attempt object representing the current state or a formatted version of the raw state object supplied.\r\n   * @param {Array} [state] JSON object representing the component state, defaults to current state returned from getAttemptState().\r\n   * @returns {Object}\r\n   */\r\n  getAttemptObject(state = this.getAttemptState()) {\r\n    const trackables = this.trackable();\r\n    const types = this.trackableType();\r\n    trackables.find((name, index) => {\r\n      // Exclude _attemptStates as it's trackable but isn't needed here\r\n      if (name !== '_attemptStates') return false;\r\n      trackables.splice(index, 1);\r\n      types.splice(index, 1);\r\n      return true;\r\n    });\r\n    const numbers = (state[0] || []).slice(0);\r\n    const booleans = (state[1] || []).slice(0);\r\n    const arrays = (state[2] || []).slice(0);\r\n    const object = {};\r\n    trackables.forEach((n, i) => {\r\n      if (n === '_id') return;\r\n      switch (types[i]) {\r\n        case Number:\r\n          object[n] = numbers.shift();\r\n          break;\r\n        case Boolean:\r\n          object[n] = booleans.shift();\r\n          break;\r\n        case Array:\r\n          object[n] = arrays.shift();\r\n          break;\r\n      }\r\n    });\r\n    return object;\r\n  }\r\n\r\n  /**\r\n   * Sets the current attempt state from the supplied attempt state object.\r\n   * @param {Object} object JSON object representing the component state.\r\n   * @param {boolean} silent Stops change events from triggering\r\n   */\r\n  setAttemptObject(object, silent = true) {\r\n    this.set(object, { silent });\r\n  }\r\n\r\n  /**\r\n   * Adds the current attempt state object or the supplied state object to the attempts store.\r\n   * @param {Object} [object] JSON object representing the component state. Defaults to current JSON.\r\n   */\r\n  addAttemptObject(object = this.getAttemptObject()) {\r\n    const attemptStates = this.get('_attemptStates') || [];\r\n    const state = this.getAttemptState(object);\r\n    attemptStates.push(state);\r\n    this.set('_attemptStates', attemptStates);\r\n  }\r\n\r\n  /**\r\n   * Returns an array of the previous state objects. The most recent state is last in the list.\r\n   * @returns {Array}\r\n   */\r\n  getAttemptObjects() {\r\n    const states = this.get('_attemptStates') || [];\r\n    return states.map(state => this.getAttemptObject(state));\r\n  }\r\n\r\n}\r\n\r\n// This abstract model needs to registered to support deprecated view-only components\r\ncomponents.register('component', { model: ComponentModel });\r\n\r\nexport default ComponentModel;\r\n","import components from 'core/js/components';\r\nimport logging from 'core/js/logging';\r\nimport ContentObjectModel from 'core/js/models/contentObjectModel';\r\n\r\nclass MenuModel extends ContentObjectModel {\r\n\r\n  get _children() {\r\n    logging.deprecated('menuModel._children, use menuModel.hasManagedChildren instead, child models are defined by the JSON');\r\n    return 'contentObjects';\r\n  }\r\n\r\n  /**\r\n   * Returns a string of the model type group.\r\n   * @returns {string}\r\n   */\r\n  getTypeGroup() {\r\n    return 'menu';\r\n  }\r\n\r\n  setCustomLocking() {\r\n    const children = this.getAvailableChildModels();\r\n    children.forEach(child => {\r\n      child.set('_isLocked', this.shouldLock(child));\r\n      if (!(child instanceof MenuModel)) return;\r\n      child.checkLocking();\r\n    });\r\n  }\r\n\r\n}\r\n\r\ncomponents.register('menu', { model: MenuModel });\r\n\r\nexport default MenuModel;\r\n","import components from 'core/js/components';\r\nimport logging from 'core/js/logging';\r\nimport MenuModel from 'core/js/models/menuModel';\r\n\r\nclass CourseModel extends MenuModel {\r\n\r\n  get _parent() {\r\n    logging.deprecated('courseModel._parent, use courseModel.getParent() instead, parent models are defined by the JSON');\r\n    return null;\r\n  }\r\n\r\n  get _siblings() {\r\n    logging.deprecated('courseModel._siblings, use courseModel.getSiblings() instead, sibling models are defined by the JSON');\r\n    return null;\r\n  }\r\n\r\n  /**\r\n   * Returns a string of the model type group.\r\n   * @returns {string}\r\n   */\r\n  getTypeGroup() {\r\n    return 'course';\r\n  }\r\n\r\n}\r\n\r\ncomponents.register('course', { model: CourseModel });\r\n\r\nexport default CourseModel;\r\n","import components from 'core/js/components';\r\nimport logging from 'core/js/logging';\r\nimport ContentObjectModel from 'core/js/models/contentObjectModel';\r\n\r\nclass PageModel extends ContentObjectModel {\r\n\r\n  get _children() {\r\n    logging.deprecated('pageModel._children, use menuModel.hasManagedChildren instead, child models are defined by the JSON');\r\n    return 'articles';\r\n  }\r\n\r\n  /**\r\n   * Returns a string of the model type group.\r\n   * @returns {string}\r\n   */\r\n  getTypeGroup() {\r\n    return 'page';\r\n  }\r\n\r\n}\r\n\r\ncomponents.register('page', { model: PageModel });\r\n\r\nexport default PageModel;\r\n","import logging from 'core/js/logging';\r\n\r\n/**\r\n * Event object triggered for controlling child view rendering.\r\n * Sent with 'view:addChild' and 'view:requestChild' events.\r\n * All plugins receive the same object reference in their event handler and\r\n * as such, this object becomes a place of consensus for plugins to decide how\r\n * to handle rendering for this child.\r\n */\r\nexport default class ChildEvent extends Backbone.Controller {\r\n\r\n  /**\r\n   * @param {string} type Event type\r\n   * @param {AdaptView} target Parent view\r\n   * @param {AdaptModel} model Child model\r\n   */\r\n  initialize(type, target, model) {\r\n    /** @type {string} */\r\n    this.type = type;\r\n    /** @type {AdaptView} */\r\n    this.target = target;\r\n    /** @type {boolean} Force the child model to render */\r\n    this.isForced = false;\r\n    /** @type {boolean} Stop rendering before the child model */\r\n    this.isStoppedImmediate = false;\r\n    /** @type {boolean} Stop rendering after the child model */\r\n    this.isStoppedNext = false;\r\n    /** @type {boolean} Contains a model to render in response to a requestChild event */\r\n    this.hasRequestChild = false;\r\n    this._model = model;\r\n  }\r\n\r\n  /**\r\n   * Get the model to be rendered.\r\n   * @returns {AdaptModel}\r\n   */\r\n  get model() {\r\n    return this._model;\r\n  }\r\n\r\n  /**\r\n   * Set the model to render in response to a 'view:requestChild' event.\r\n   * @param {AdaptModel}\r\n   */\r\n  set model(model) {\r\n    if (this.type !== 'requestChild') {\r\n      logging.warn(`Cannot change model in ${this.type} event.`);\r\n      return;\r\n    }\r\n    if (this._model) {\r\n      logging.warn(`Cannot inject two models in one sitting. ${model.get('_id')} attempts to overwrite ${this._model.get('_id')}`);\r\n      return;\r\n    }\r\n    this._model = model;\r\n    this.hasRequestChild = true;\r\n  }\r\n\r\n  /**\r\n   * Reset all render stops.\r\n   */\r\n  reset() {\r\n    this.isStoppedImmediate = false;\r\n    this.isStoppedNext = false;\r\n  }\r\n\r\n  /**\r\n   * Force model to render.\r\n   */\r\n  force() {\r\n    this.isForced = true;\r\n  }\r\n\r\n  /**\r\n   * General stop. Stop immediately or stop next with flag to false.\r\n   * @param {boolean} [immediate=true] Flag to stop immediate or next.\r\n   */\r\n  stop(immediate = true) {\r\n    if (!immediate) {\r\n      return this.stopNext();\r\n    }\r\n    this.isStoppedImmediate = true;\r\n  }\r\n\r\n  /**\r\n   * Shortcut to stop(false). Stop the render after the contained model is rendered.\r\n   */\r\n  stopNext() {\r\n    this.isStoppedNext = true;\r\n  }\r\n\r\n  /**\r\n   * Trigger an event to signify that a final decision has been reached.\r\n   */\r\n  close() {\r\n    this.trigger('closed');\r\n  }\r\n\r\n}\r\n","export default class TemplateRenderEvent extends Backbone.Controller {\r\n\r\n  /**\r\n   * Template render event\r\n   * @param {string} type Event type\r\n   * @param {string} name Template name\r\n   * @param {string} mode \"template\" / \"partial\"\r\n   * @param {string} value Rendered template string\r\n   * @param {[*]} args Arguments passed to template for render\r\n   */\r\n  initialize(type, name, mode, value, args) {\r\n    /** @type {string} Event type */\r\n    this.type = type;\r\n    /** @type {string} Template name */\r\n    this.name = name;\r\n    /** @type {string} \"template\" / \"partial\" */\r\n    this.mode = mode;\r\n    /** @type {string} Rendered template string */\r\n    this.value = value;\r\n    /** @type {[*]} Arguments passed to template for render */\r\n    this.args = args;\r\n  }\r\n\r\n}\r\n","import Adapt from 'core/js/adapt';\r\nimport TemplateRenderEvent from 'core/js/templateRenderEvent';\r\nimport React from 'react';\r\nimport logging from 'core/js/logging';\r\n\r\n/**\r\n * Used by babel plugin babel-plugin-transform-react-templates to inject react templates\r\n */\r\nexport default function register(name, component) {\r\n  templates[name] = (...args) => {\r\n    // Trap render calls to emit preRender and postRender events\r\n    const mode = 'reactTemplate';\r\n    // Send preRender event to allow modification of args\r\n    const preRenderEvent = new TemplateRenderEvent(`${mode}:preRender`, name, mode, null, args);\r\n    Adapt.trigger(preRenderEvent.type, preRenderEvent);\r\n    // Execute template\r\n    const value = component(...preRenderEvent.args);\r\n    // Send postRender event to allow modification of rendered template\r\n    const postRenderEvent = new TemplateRenderEvent(`${mode}:postRender`, name, mode, value, preRenderEvent.args);\r\n    Adapt.trigger(postRenderEvent.type, postRenderEvent);\r\n    // Return rendered, modified template\r\n    return postRenderEvent.value;\r\n  };\r\n};\r\n\r\n/**\r\n * Override React.createElement to allow trapping and modification of react\r\n * template elements.\r\n */\r\n(function () {\r\n  const original = React.createElement;\r\n  React.createElement = (...args) => {\r\n    const name = args[0];\r\n    // Trap render calls to emit preRender and postRender events\r\n    const mode = 'reactElement';\r\n    // Send preRender event to allow modification of args\r\n    const preRenderEvent = new TemplateRenderEvent(`${mode}:preRender`, name, mode, null, args);\r\n    Adapt.trigger(preRenderEvent.type, preRenderEvent);\r\n    // Execute element creation\r\n    const value = original(...preRenderEvent.args);\r\n    // Send postRender event to allow modification of rendered element\r\n    const postRenderEvent = new TemplateRenderEvent(`${mode}:postRender`, name, mode, value, preRenderEvent.args);\r\n    Adapt.trigger(postRenderEvent.type, postRenderEvent);\r\n    // Return rendered, modified element\r\n    return postRenderEvent.value;\r\n  };\r\n})();\r\n\r\n/**\r\n * Storage for react templates\r\n */\r\nexport const templates = {};\r\n\r\n/**\r\n * Convert html strings to react dom, equivalent to handlebars {{{html}}}\r\n * @param {string} html\r\n * @deprecated since v6.0.4, please use react dangerouslySetInnerHTML instead: https://reactjs.org/docs/dom-elements.html#dangerouslysetinnerhtml\r\n */\r\nexport function html(html) {\r\n  if (!html) return;\r\n  logging.deprecated('reactHelpers.html please use react dangerouslySetInnerHTML instead: https://reactjs.org/docs/dom-elements.html#dangerouslysetinnerhtml');\r\n  return { __html: html };\r\n}\r\n\r\n/**\r\n * Handlebars compile integration\r\n * @param {string} name Handlebars template\r\n * @param {...any} args Template arguments\r\n */\r\nexport function compile(template, ...args) {\r\n  const output = Handlebars.compile(template)(...args);\r\n  return output;\r\n};\r\n\r\n/**\r\n * Handlebars partials integration\r\n * @param {string} name Partial name\r\n * @param {...any} args Partial arguments\r\n */\r\nexport function partial(name, ...args) {\r\n  const output = Handlebars.partials[name](...args);\r\n  return output;\r\n};\r\n\r\n/**\r\n * Handlebars helpers integration\r\n * @param {string} name Helper name\r\n * @param {...any} args Helper arguments\r\n */\r\nexport function helper(name, ...args) {\r\n  const output = Handlebars.helpers[name].call(args[0]);\r\n  return (output && output.string) || output;\r\n};\r\n\r\n/**\r\n * Helper for a list of classes, filtering out falsies and duplicates, and joining with spaces\r\n * @param  {...any} args List or arrays of classes\r\n */\r\nexport function classes(...args) {\r\n  return _.uniq(_.flatten(args).filter(Boolean).join(' ').split(' ')).join(' ');\r\n};\r\n\r\n/**\r\n * Helper for prefixing a list of classes, filtering out falsies and duplicates and joining with spaces\r\n * @param  {[...string]} prefixes Array of class prefixes\r\n * @param  {...any} args List or arrays of classes\r\n */\r\nexport function prefixClasses(prefixes, ...args) {\r\n  const classes = _.flatten(args).filter(Boolean);\r\n  const prefixed = _.flatten(prefixes.map(prefix => classes.map(className => `${prefix}${className}`)));\r\n  return _.uniq(prefixed.join(' ').split(' ')).join(' ');\r\n};\r\n","import Adapt from 'core/js/adapt';\r\nimport wait from 'core/js/wait';\r\nimport components from 'core/js/components';\r\nimport ChildEvent from 'core/js/childEvent';\r\nimport { templates } from 'core/js/reactHelpers';\r\nimport React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport location from 'core/js/location';\r\nimport logging from 'core/js/logging';\r\n\r\nclass AdaptView extends Backbone.View {\r\n\r\n  attributes() {\r\n    return {\r\n      'data-adapt-id': this.model.get('_id')\r\n    };\r\n  }\r\n\r\n  initialize() {\r\n    this.listenTo(this.model, {\r\n      'change:_isVisible': this.toggleVisibility,\r\n      'change:_isHidden': this.toggleHidden,\r\n      'change:_isComplete': this.onIsCompleteChange\r\n    });\r\n    this.isJSX = (this.constructor.template || '').includes('.jsx');\r\n    if (this.isJSX) {\r\n      this._classSet = new Set(_.result(this, 'className').trim().split(/\\s+/));\r\n      this.listenTo(this.model, 'all', this.changed);\r\n      const children = this.model?.getChildren?.();\r\n      children && this.listenTo(children, 'all', this.changed);\r\n      // Facilitate adaptive react views\r\n      this.listenTo(Adapt, 'device:changed', this.changed);\r\n    }\r\n    this.model.set({\r\n      _globals: Adapt.course.get('_globals'),\r\n      _isReady: false\r\n    });\r\n    this._isRemoved = false;\r\n\r\n    if (location._currentId === this.model.get('_id')) {\r\n      Adapt.parentView = this;\r\n    }\r\n\r\n    this.preRender();\r\n    this.render();\r\n    this.setupOnScreenHandler();\r\n  }\r\n\r\n  preRender() {}\r\n\r\n  async postRender() {\r\n    await this.addChildren();\r\n  }\r\n\r\n  render() {\r\n    const type = this.constructor.type;\r\n    Adapt.trigger(`${type}View:preRender view:preRender`, this);\r\n\r\n    if (this.isJSX) {\r\n      this.changed();\r\n    } else {\r\n      const data = this.model.toJSON();\r\n      data.view = this;\r\n      const template = Handlebars.templates[this.constructor.template];\r\n      this.$el.html(template(data));\r\n    }\r\n\r\n    Adapt.trigger(`${type}View:render view:render`, this);\r\n\r\n    _.defer(async () => {\r\n      // don't call postRender after remove\r\n      if (this._isRemoved) return;\r\n\r\n      await this.postRender();\r\n      Adapt.trigger(`${type}View:postRender view:postRender`, this);\r\n    });\r\n\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * Re-render a react template\r\n   * @param {string} eventName=null Backbone change event name\r\n   */\r\n  changed(eventName = null) {\r\n    if (!this.isJSX) {\r\n      throw new Error('Cannot call changed on a non-react view');\r\n    }\r\n    if (typeof eventName === 'string' && eventName.startsWith('bubble')) {\r\n      // Ignore bubbling events as they are outside of this view's scope\r\n      return;\r\n    }\r\n    const props = {\r\n      // Add view own properties, bound functions etc\r\n      ...this,\r\n      // Add model json data\r\n      ...this.model.toJSON(),\r\n      // Add globals\r\n      _globals: Adapt.course.get('_globals')\r\n    };\r\n    const Template = templates[this.constructor.template.replace('.jsx', '')];\r\n    this.updateViewProperties();\r\n    ReactDOM.render(<Template {...props} />, this.el);\r\n  }\r\n\r\n  updateViewProperties() {\r\n    const classesToAdd = _.result(this, 'className').trim().split(/\\s+/);\r\n    classesToAdd.forEach(i => this._classSet.add(i));\r\n    const classesToRemove = [ ...this._classSet ].filter(i => !classesToAdd.includes(i));\r\n    classesToRemove.forEach(i => this._classSet.delete(i));\r\n    this._setAttributes({ ..._.result(this, 'attributes'), id: _.result(this, 'id') });\r\n    this.$el.removeClass(classesToRemove).addClass(classesToAdd);\r\n  }\r\n\r\n  setupOnScreenHandler() {\r\n    const onscreen = this.model.get('_onScreen');\r\n\r\n    if (!onscreen?._isEnabled) return;\r\n\r\n    this.$el.addClass(`has-animation ${onscreen._classes}-before`);\r\n    this.$el.on('onscreen.adaptView', (e, m) => {\r\n      if (!m.onscreen) return;\r\n      const minVerticalInview = onscreen._percentInviewVertical || 33;\r\n      if (m.percentInviewVertical < minVerticalInview) return;\r\n      this.$el.addClass(`${onscreen._classes}-after`).off('onscreen.adaptView');\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Add children and descendant views, first-child-first. Wait until all possible\r\n   * views are added before resolving asynchronously.\r\n   * Will trigger 'view:addChild'(ChildEvent), 'view:requestChild'(ChildEvent)\r\n   * and 'view:childAdded'(ParentView, ChildView) accordingly.\r\n   * @returns {number} Count of views added\r\n   */\r\n  async addChildren() {\r\n    this.nthChild = this.nthChild || 0;\r\n    // Check descendants first\r\n    let addedCount = await this.addDescendants(false);\r\n    // Iterate through existing available children and/or request new children\r\n    // if required and allowed\r\n    while (true) {\r\n      const models = this.model.getAvailableChildModels();\r\n      const event = this._getAddChildEvent(models[this.nthChild]);\r\n      if (!event) {\r\n        break;\r\n      }\r\n      if (event.isForced) {\r\n        event.reset();\r\n      }\r\n      if (event.isStoppedImmediate || !event.model) {\r\n        // If addChild has been stopped before it is added then\r\n        // set all subsequent models and their children as not rendered\r\n        const subsequentModels = models.slice(this.nthChild);\r\n        subsequentModels.forEach(model => model.setOnChildren('_isRendered', false));\r\n        break;\r\n      }\r\n      // Set model state\r\n      const model = event.model;\r\n      model.set({\r\n        _isRendered: true,\r\n        _nthChild: ++this.nthChild\r\n      });\r\n      // Create child view\r\n      const ChildView = this.constructor.childView || components.getViewClass(model);\r\n      if (!ChildView) {\r\n        throw new Error(`The component '${model.attributes._id}' ('${model.attributes._component}') has not been installed, and so is not available in your project.`);\r\n      }\r\n      const childView = new ChildView({ model });\r\n      this.addChildView(childView);\r\n      addedCount++;\r\n      if (event.isStoppedNext) {\r\n        break;\r\n      }\r\n    }\r\n\r\n    if (!addedCount) {\r\n      return addedCount;\r\n    }\r\n\r\n    // Children were added, unset _isReady\r\n    this.model.set('_isReady', false);\r\n    return addedCount;\r\n  }\r\n\r\n  /**\r\n   * Child views can be added with '_renderPosition': 'outer-append' or\r\n   * 'inner-append' (default). Each child view will trigger a\r\n   * 'view:childAdded'(ParentView, ChildView) event and be added to the\r\n   * this.getChildViews() array on this parent.\r\n   * @param {AdaptView} childView\r\n   * @returns {AdaptView} Returns this childView\r\n   */\r\n  addChildView(childView) {\r\n    const childViews = this.getChildViews() || [];\r\n    childViews.push(childView);\r\n    this.setChildViews(childViews);\r\n    const $parentContainer = this.$(this.constructor.childContainer);\r\n    switch (childView.model.get('_renderPosition')) {\r\n      case 'outer-append':\r\n        // Useful for trickle buttons, inline feedback etc\r\n        this.$el.append(childView.$el);\r\n        break;\r\n      case 'inner-append':\r\n      default:\r\n        $parentContainer.append(childView.$el);\r\n        break;\r\n    }\r\n    // Signify that a child has been added to the view to enable updates to status bars\r\n    Adapt.trigger('view:childAdded', this, childView);\r\n    return childView;\r\n  }\r\n\r\n  /**\r\n   * Iterates through existing childViews and runs addChildren on them, resolving\r\n   * the total count of views added asynchronously.\r\n   * @returns {number} Count of views added\r\n   */\r\n  async addDescendants() {\r\n    let addedDescendantCount = 0;\r\n    const childViews = this.getChildViews();\r\n    if (!childViews) {\r\n      return addedDescendantCount;\r\n    }\r\n    for (let i = 0, l = childViews.length; i < l; i++) {\r\n      const view = childViews[i];\r\n      addedDescendantCount = view.addChildren ? await view.addChildren() : 0;\r\n      if (addedDescendantCount) {\r\n        break;\r\n      }\r\n    }\r\n    if (!addedDescendantCount) {\r\n      this.model.checkReadyStatus();\r\n      return addedDescendantCount;\r\n    }\r\n    // Descendants were added, unset _isReady\r\n    this.model.set('_isReady', false);\r\n    return addedDescendantCount;\r\n  }\r\n\r\n  /**\r\n   * Resolves after outstanding asynchronous view additions are finished\r\n   * and ready.\r\n   */\r\n  async whenReady() {\r\n    if (this.model.get('_isReady')) return;\r\n    return new Promise(resolve => {\r\n      const onReadyChange = (model, value) => {\r\n        if (!value) return;\r\n        this.stopListening(this.model, 'change:_isReady', onReadyChange);\r\n        resolve();\r\n      };\r\n      this.listenTo(this.model, 'change:_isReady', onReadyChange);\r\n      this.model.checkReadyStatus();\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Triggers and returns a new ChildEvent object for render control.\r\n   * This function is used by addChildren to manage event triggering.\r\n   * @param {AdaptModel} model\r\n   * @returns {ChildEvent}\r\n   */\r\n  _getAddChildEvent(model) {\r\n    const isRequestChild = (!model);\r\n    const event = new ChildEvent(null, this, model);\r\n    if (isRequestChild) {\r\n      // No model has been supplied, we are at the end of the available child list\r\n      const canRequestChild = this.model.get('_canRequestChild');\r\n      if (!canRequestChild) {\r\n        // This model cannot request children\r\n        return;\r\n      }\r\n      event.type = 'requestChild';\r\n      // Send a request asking for a new model\r\n      Adapt.trigger('view:requestChild', event);\r\n      if (!event.hasRequestChild) {\r\n        // No new model was supplied\r\n        // Close the event so that the final state can be scrutinized\r\n        event.close();\r\n        return;\r\n      }\r\n      // A new model has been supplied for the end of the list.\r\n    }\r\n    // Trigger an event to signify that a new model is to be added\r\n    event.type = 'addChild';\r\n    Adapt.trigger('view:addChild', event);\r\n    // Close the event so that the final state can be scrutinized\r\n    event.close();\r\n    return event;\r\n  }\r\n\r\n  /**\r\n   * Return an array of all child and descendant views.\r\n   * @param {boolean} [isParentFirst=false] Array returns with parents before children\r\n   * @returns {[AdaptView]}\r\n   */\r\n  findDescendantViews(isParentFirst) {\r\n    const descendants = [];\r\n    const childViews = this.getChildViews();\r\n    childViews?.forEach(view => {\r\n      if (isParentFirst) descendants.push(view);\r\n      const children = view.findDescendantViews?.(isParentFirst);\r\n      if (children) descendants.push(...children);\r\n      if (!isParentFirst) descendants.push(view);\r\n    });\r\n    return descendants;\r\n  }\r\n\r\n  setReadyStatus() {\r\n    this.model.setReadyStatus();\r\n  }\r\n\r\n  setCompletionStatus() {\r\n    this.model.setCompletionStatus();\r\n  }\r\n\r\n  resetCompletionStatus(type) {\r\n    if (!this.model.get('_canReset')) return;\r\n\r\n    const descendantComponents = this.model.findDescendantModels('component');\r\n    if (descendantComponents.length === 0) {\r\n      this.model.reset(type);\r\n    } else {\r\n      descendantComponents.forEach(model => model.reset(type));\r\n    }\r\n  }\r\n\r\n  preRemove() {\r\n    const type = this.constructor.type;\r\n    Adapt.trigger(`${type}View:preRemove view:preRemove`, this);\r\n  }\r\n\r\n  remove() {\r\n    const type = this.constructor.type;\r\n    this.preRemove();\r\n    Adapt.trigger(`${type}View:remove view:remove`, this);\r\n    this._isRemoved = true;\r\n    this.stopListening();\r\n\r\n    wait.for(end => {\r\n      if (this.isJSX) {\r\n        ReactDOM.unmountComponentAtNode(this.el);\r\n      }\r\n      this.$el.off('onscreen.adaptView');\r\n      super.remove();\r\n      _.defer(() => {\r\n        Adapt.trigger(`${type}View:postRemove view:postRemove`, this);\r\n      });\r\n      end();\r\n    });\r\n\r\n    return this;\r\n  }\r\n\r\n  setVisibility() {\r\n    return this.model.get('_isVisible') ? '' : 'u-visibility-hidden';\r\n  }\r\n\r\n  toggleVisibility() {\r\n    this.$el.toggleClass('u-visibility-hidden', !this.model.get('_isVisible'));\r\n  }\r\n\r\n  setHidden() {\r\n    return this.model.get('_isHidden') ? 'u-display-none' : '';\r\n  }\r\n\r\n  toggleHidden() {\r\n    this.$el.toggleClass('u-display-none', this.model.get('_isHidden'));\r\n  }\r\n\r\n  onIsCompleteChange(model, isComplete) {\r\n    this.$el.toggleClass('is-complete', isComplete);\r\n  }\r\n\r\n  /**\r\n   * @returns {[AdaptView]}\r\n   */\r\n  getChildViews() {\r\n    if (!this._childViews) return this._childViews;\r\n    // Allow both a deprecated id/view map or a new array of child views\r\n    return Object.entries(this._childViews).map(([key, value]) => value);\r\n  }\r\n\r\n  /**\r\n   * @param {[AdaptView]} value\r\n   */\r\n  setChildViews(value) {\r\n    this._childViews = value;\r\n  }\r\n\r\n  /**\r\n   * Returns an indexed by id list of child views.\r\n   * @deprecated since 5.7.0\r\n   * @returns {{<string, AdaptView}}\r\n   */\r\n  get childViews() {\r\n    logging.deprecated('view.childViews use view.getChildViews() and view.setChildViews([])');\r\n    if (Array.isArray(this._childViews)) {\r\n      return _.indexBy(this._childViews, view => view.model.get('_id'));\r\n    }\r\n    return this._childViews;\r\n  }\r\n\r\n  /**\r\n   * Sets an indexed by id list of child views.\r\n   * @deprecated since 5.7.0\r\n   */\r\n  set childViews(value) {\r\n    logging.deprecated('view.childViews use view.getChildViews() and view.setChildViews([])');\r\n    this.setChildViews(value);\r\n  }\r\n\r\n}\r\n\r\nAdaptView.className = '';\r\n\r\nexport default AdaptView;\r\n","import Adapt from 'core/js/adapt';\r\nimport wait from 'core/js/wait';\r\nimport AdaptView from 'core/js/views/adaptView';\r\nimport ReactDOM from 'react-dom';\r\nimport data from 'core/js/data';\r\n\r\nexport default class ContentObjectView extends AdaptView {\r\n\r\n  attributes() {\r\n    return AdaptView.resultExtend('attributes', {\r\n      role: 'main'\r\n    }, this);\r\n  }\r\n\r\n  className() {\r\n    return [\r\n      this.constructor.type,\r\n      'contentobject',\r\n      this.constructor.className,\r\n      this.model.get('_id'),\r\n      this.model.get('_classes'),\r\n      this.setVisibility(),\r\n      (this.model.get('_isComplete') ? 'is-complete' : ''),\r\n      (this.model.get('_isOptional') ? 'is-optional' : '')\r\n    ].filter(Boolean).join(' ');\r\n  }\r\n\r\n  preRender() {\r\n    $.inview.lock(this.constructor.type + 'View');\r\n    this.disableAnimation = Adapt.config.has('_disableAnimation') ? Adapt.config.get('_disableAnimation') : false;\r\n    this.$el.css('opacity', 0);\r\n    this.listenTo(this.model, 'change:_isReady', this.isReady);\r\n    this._loadingErrorTimeout = setTimeout(() => data.logReadyError(this), 10000);\r\n  }\r\n\r\n  render() {\r\n    const type = this.constructor.type;\r\n    Adapt.trigger(`${type}View:preRender contentObjectView:preRender view:preRender`, this);\r\n\r\n    if (this.isReact) {\r\n      this.changed();\r\n    } else {\r\n      const data = this.model.toJSON();\r\n      data.view = this;\r\n      const template = Handlebars.templates[this.constructor.template];\r\n      this.$el.html(template(data));\r\n    }\r\n\r\n    Adapt.trigger(`${type}View:render contentObjectView:render view:render`, this);\r\n\r\n    _.defer(() => {\r\n      // don't call postRender after remove\r\n      if (this._isRemoved) return;\r\n\r\n      this.postRender();\r\n      Adapt.trigger(`${type}View:postRender contentObjectView:postRender view:postRender`, this);\r\n    });\r\n\r\n    return this;\r\n  }\r\n\r\n  async isReady() {\r\n    if (!this.model.get('_isReady') || this._isTriggeredReady) return;\r\n    this._isTriggeredReady = true;\r\n    clearTimeout(this._loadingErrorTimeout);\r\n    delete this._loadingErrorTimeout;\r\n    const type = this.constructor.type;\r\n    const performIsReady = async () => {\r\n      Adapt.trigger(`${type}View:preReady contentObjectView:preReady view:preReady`, this);\r\n      await wait.queue();\r\n      $('.js-loading').hide();\r\n      if (Adapt.get('_shouldContentObjectScrollTop') !== false) {\r\n        $(window).scrollTop(0);\r\n      }\r\n      Adapt.trigger(`${type}View:ready contentObjectView:ready view:ready`, this);\r\n      $.inview.unlock(`${type}View`);\r\n      const styleOptions = { opacity: 1 };\r\n      if (this.disableAnimation) {\r\n        this.$el.css(styleOptions);\r\n        $.inview();\r\n        _.defer(() => {\r\n          Adapt.trigger(`${type}View:postReady contentObjectView:postReady view:postReady`, this);\r\n        });\r\n      } else {\r\n        this.$el.velocity(styleOptions, {\r\n          duration: 'fast',\r\n          complete: () => {\r\n            $.inview();\r\n            Adapt.trigger(`${type}View:postReady contentObjectView:postReady view:postReady`, this);\r\n          }\r\n        });\r\n      }\r\n      $(window).scroll();\r\n    };\r\n\r\n    _.defer(performIsReady);\r\n  }\r\n\r\n  /**\r\n   * Force render up to specified id. Resolves when views are ready.\r\n   * @param {string} id\r\n   */\r\n  async renderTo(id) {\r\n    const isRenderToSelf = (id === this.model.get('_id'));\r\n    if (isRenderToSelf) return;\r\n    let models = this.model.getAllDescendantModels(true).filter(model => model.get('_isAvailable'));\r\n    const index = models.findIndex(model => model.get('_id') === id);\r\n    if (index === -1) {\r\n      throw new Error(`Cannot renderTo \"${id}\" as it isn't a descendant.`);\r\n    }\r\n    // Return early if the model is already rendered and ready\r\n    const model = models[index];\r\n    if (model.get('_isRendered') && model.get('_isReady')) {\r\n      return;\r\n    }\r\n    // Force all models up until the id to render\r\n    models = models.slice(0, index + 1);\r\n    const isLocked = models.some(model => model.get('_isLocked'));\r\n    if (isLocked) throw new Error(`Cannot renderTo ${id} as it is preceded by locked content`);\r\n    const ids = _.indexBy(models, (model) => model.get('_id'));\r\n    const forceUntilId = (event) => {\r\n      const addingId = event.model.get('_id');\r\n      if (!ids[addingId]) return;\r\n      event.force();\r\n      if (addingId !== id) return;\r\n      Adapt.off('view:addChild', forceUntilId);\r\n    };\r\n    Adapt.on('view:addChild', forceUntilId);\r\n    // Trigger addChildren cascade\r\n    await this.addChildren();\r\n    await this.whenReady();\r\n    // Error if model isn't rendered and ready\r\n    if (!model.get('_isRendered') || !model.get('_isReady')) {\r\n      throw new Error(`Cannot renderTo \"${id}\".`);\r\n    }\r\n  }\r\n\r\n  preRemove() {\r\n    const type = this.constructor.type;\r\n    Adapt.trigger(`${type}View:preRemove contentObjectView:preRemove view:preRemove`, this);\r\n  }\r\n\r\n  remove() {\r\n    const type = this.constructor.type;\r\n    this.preRemove();\r\n    Adapt.trigger(`${type}View:remove contentObjectView:remove view:remove`, this);\r\n    this._isRemoved = true;\r\n\r\n    wait.for(end => {\r\n      if (this.isReact) {\r\n        ReactDOM.unmountComponentAtNode(this.el);\r\n      }\r\n      this.$el.off('onscreen.adaptView');\r\n      this.findDescendantViews().reverse().forEach(view => {\r\n        view.remove();\r\n      });\r\n      this.setChildViews(null);\r\n      super.remove();\r\n      _.defer(() => {\r\n        Adapt.trigger(`${type}View:postRemove contentObjectView:postRemove view:postRemove`, this);\r\n        this.trigger('postRemove');\r\n      });\r\n      end();\r\n    });\r\n\r\n    return this;\r\n  }\r\n\r\n  destroy() {\r\n    this.remove();\r\n    if (Adapt.parentView === this) {\r\n      Adapt.parentView = null;\r\n    }\r\n  }\r\n\r\n}\r\n","import components from 'core/js/components';\r\nimport ContentObjectView from 'core/js/views/contentObjectView';\r\n\r\nclass PageView extends ContentObjectView {\r\n\r\n  remove() {\r\n    if (this.$pageLabel) {\r\n      this.$pageLabel.remove();\r\n    }\r\n    super.remove();\r\n  }\r\n\r\n}\r\n\r\nObject.assign(PageView, {\r\n  childContainer: '.article__container',\r\n  type: 'page',\r\n  template: 'page'\r\n});\r\n\r\ncomponents.register('page', { view: PageView });\r\n\r\nexport default PageView;\r\n","import components from 'core/js/components';\r\nimport AdaptView from 'core/js/views/adaptView';\r\n\r\nclass ArticleView extends AdaptView {\r\n\r\n  className() {\r\n    return [\r\n      'article',\r\n      this.model.get('_id'),\r\n      this.model.get('_classes'),\r\n      this.setVisibility(),\r\n      this.setHidden(),\r\n      (this.model.get('_isComplete') ? 'is-complete' : ''),\r\n      (this.model.get('_isOptional') ? 'is-optional' : '')\r\n    ].join(' ');\r\n  }\r\n\r\n}\r\n\r\nObject.assign(ArticleView, {\r\n  childContainer: '.block__container',\r\n  type: 'article',\r\n  template: 'article'\r\n});\r\n\r\ncomponents.register('article', { view: ArticleView });\r\n\r\nexport default ArticleView;\r\n","import components from 'core/js/components';\r\nimport AdaptView from 'core/js/views/adaptView';\r\n\r\nclass BlockView extends AdaptView {\r\n\r\n  className() {\r\n    return [\r\n      'block',\r\n      this.model.get('_id'),\r\n      this.model.get('_classes'),\r\n      this.setVisibility(),\r\n      this.setHidden(),\r\n      (this.model.get('_isComplete') ? 'is-complete' : ''),\r\n      (this.model.get('_isOptional') ? 'is-optional' : '')\r\n    ].join(' ');\r\n  }\r\n\r\n}\r\n\r\nObject.assign(BlockView, {\r\n  childContainer: '.component__container',\r\n  type: 'block',\r\n  template: 'block'\r\n});\r\n\r\ncomponents.register('block', { view: BlockView });\r\n\r\nexport default BlockView;\r\n","import Adapt from 'core/js/adapt';\r\nimport wait from 'core/js/wait';\r\nimport Data from 'core/js/data';\r\nimport AdaptSubsetCollection from 'core/js/collections/adaptSubsetCollection';\r\nimport ContentObjectModel from 'core/js/models/contentObjectModel';\r\nimport ArticleModel from 'core/js/models/articleModel';\r\nimport BlockModel from 'core/js/models/blockModel';\r\nimport ComponentModel from 'core/js/models/componentModel';\r\n\r\nimport 'core/js/models/courseModel';\r\nimport 'core/js/models/menuModel';\r\nimport 'core/js/models/pageModel';\r\nimport 'core/js/views/pageView';\r\nimport 'core/js/views/articleView';\r\nimport 'core/js/views/blockView';\r\n\r\nclass MPABC extends Backbone.Controller {\r\n\r\n  initialize() {\r\n    // Example of how to cause the data loader to wait for another module to setup\r\n    this.listenTo(Data, {\r\n      loading: this.waitForDataLoaded,\r\n      loaded: this.onDataLoaded\r\n    });\r\n    this.setupSubsetCollections();\r\n  }\r\n\r\n  waitForDataLoaded() {\r\n    // Tell the data loader to wait\r\n    wait.begin();\r\n  }\r\n\r\n  onDataLoaded() {\r\n    // Tell the data loader that we have finished\r\n    wait.end();\r\n  }\r\n\r\n  setupSubsetCollections() {\r\n    Adapt.contentObjects = new AdaptSubsetCollection(null, { parent: Data, model: ContentObjectModel });\r\n    Adapt.articles = new AdaptSubsetCollection(null, { parent: Data, model: ArticleModel });\r\n    Adapt.blocks = new AdaptSubsetCollection(null, { parent: Data, model: BlockModel });\r\n    Adapt.components = new AdaptSubsetCollection(null, { parent: Data, model: ComponentModel });\r\n  }\r\n\r\n}\r\n\r\nconst mpabc = new MPABC();\r\nexport default mpabc;\r\n","import Adapt from 'core/js/adapt';\r\n\r\nexport default class NotifyPushView extends Backbone.View {\r\n\r\n  className() {\r\n    let classes = 'notify-push ';\r\n    classes += (this.model.get('_classes') || '');\r\n    return classes;\r\n  }\r\n\r\n  attributes() {\r\n    return {\r\n      role: 'dialog',\r\n      'aria-labelledby': 'notify-push-heading',\r\n      'aria-modal': 'false'\r\n    };\r\n  }\r\n\r\n  initialize() {\r\n    this.listenTo(Adapt, {\r\n      'notify:pushShown notify:pushRemoved': this.updateIndexPosition,\r\n      remove: this.remove\r\n    });\r\n\r\n    this.listenTo(this.model.collection, {\r\n      remove: this.updateIndexPosition,\r\n      'change:_index': this.updatePushPosition\r\n    });\r\n\r\n    this.preRender();\r\n    this.render();\r\n  }\r\n\r\n  events() {\r\n    return {\r\n      'click .js-notify-push-close-btn': 'closePush',\r\n      'click .js-notify-push-inner': 'triggerEvent'\r\n    };\r\n  }\r\n\r\n  preRender() {\r\n    this.hasBeenRemoved = false;\r\n  }\r\n\r\n  render() {\r\n    const data = this.model.toJSON();\r\n    const template = Handlebars.templates.notifyPush;\r\n    this.$el.html(template(data)).appendTo('.notify__push-container');\r\n\r\n    _.defer(this.postRender.bind(this));\r\n\r\n    return this;\r\n  }\r\n\r\n  postRender() {\r\n    this.$el.addClass('is-active');\r\n\r\n    _.delay(this.closePush.bind(this), this.model.get('_timeout'));\r\n\r\n    Adapt.trigger('notify:pushShown');\r\n  }\r\n\r\n  closePush(event) {\r\n    if (event) {\r\n      event.preventDefault();\r\n    }\r\n\r\n    // Check whether this view has been removed as the delay can cause it to be fired twice\r\n    if (this.hasBeenRemoved === false) {\r\n\r\n      this.hasBeenRemoved = true;\r\n\r\n      this.$el.removeClass('is-active');\r\n\r\n      _.delay(() => {\r\n        this.model.collection.remove(this.model);\r\n        Adapt.trigger('notify:pushRemoved', this);\r\n        this.remove();\r\n      }, 600);\r\n    }\r\n  }\r\n\r\n  triggerEvent(event) {\r\n    Adapt.trigger(this.model.get('_callbackEvent'));\r\n    this.closePush();\r\n  }\r\n\r\n  updateIndexPosition() {\r\n    if (this.hasBeenRemoved) return;\r\n    const models = this.model.collection.models;\r\n    models.forEach((model, index) => {\r\n      if (!model.get('_isActive')) return;\r\n      model.set('_index', index);\r\n      this.updatePushPosition();\r\n    });\r\n  }\r\n\r\n  updatePushPosition() {\r\n    if (this.hasBeenRemoved) {\r\n      return;\r\n    }\r\n\r\n    if (typeof this.model.get('_index') !== 'undefined') {\r\n      const elementHeight = this.$el.height();\r\n      const offset = 20;\r\n      const navigationHeight = $('.nav').height();\r\n      const currentIndex = this.model.get('_index');\r\n      let flippedIndex = (currentIndex === 0) ? 1 : 0;\r\n\r\n      if (this.model.collection.where({ _isActive: true }).length === 1) {\r\n        flippedIndex = 0;\r\n      }\r\n\r\n      const positionLowerPush = (elementHeight + offset) * flippedIndex + navigationHeight + offset;\r\n      this.$el.css('top', positionLowerPush);\r\n    }\r\n  }\r\n}\r\n","import LockingModel from 'core/js/models/lockingModel';\r\n\r\nexport default class NotifyModel extends LockingModel {\r\n\r\n  defaults() {\r\n    return {\r\n      _isActive: false,\r\n      _showIcon: false,\r\n      _timeout: 3000\r\n    };\r\n  }\r\n\r\n}\r\n","import Adapt from 'core/js/adapt';\r\nimport NotifyPushView from 'core/js/views/notifyPushView';\r\nimport NotifyModel from 'core/js/models/notifyModel';\r\n\r\n// Build a collection to store push notifications\r\nexport default class NotifyPushCollection extends Backbone.Collection {\r\n\r\n  initialize() {\r\n    this.model = NotifyModel;\r\n    this.listenTo(this, 'add', this.onPushAdded);\r\n    this.listenTo(Adapt, 'notify:pushRemoved', this.onRemovePush);\r\n  }\r\n\r\n  onPushAdded(model) {\r\n    this.checkPushCanShow(model);\r\n  }\r\n\r\n  checkPushCanShow(model) {\r\n    if (!this.canShowPush()) return;\r\n    model.set('_isActive', true);\r\n    this.showPush(model);\r\n  }\r\n\r\n  canShowPush() {\r\n    const availablePushNotifications = this.where({ _isActive: true });\r\n    return (availablePushNotifications.length < 2);\r\n  }\r\n\r\n  showPush(model) {\r\n    new NotifyPushView({\r\n      model: model\r\n    });\r\n  }\r\n\r\n  onRemovePush(view) {\r\n    const inactivePushNotifications = this.where({ _isActive: false });\r\n    if (inactivePushNotifications.length > 0) {\r\n      this.checkPushCanShow(inactivePushNotifications[0]);\r\n    }\r\n  }\r\n\r\n}\r\n","import Adapt from 'core/js/adapt';\r\nimport components from 'core/js/components';\r\nimport data from 'core/js/data';\r\nimport a11y from 'core/js/a11y';\r\nimport AdaptView from 'core/js/views/adaptView';\r\nimport Backbone from 'backbone';\r\n\r\nexport default class NotifyPopupView extends Backbone.View {\r\n\r\n  className() {\r\n    return `notify ${this.model.get('_classes') || ''}`;\r\n  }\r\n\r\n  attributes() {\r\n    return Object.assign({\r\n      role: 'dialog',\r\n      'aria-labelledby': 'notify-heading',\r\n      'aria-modal': 'true'\r\n    }, this.model.get('_attributes'));\r\n  }\r\n\r\n  events() {\r\n    return {\r\n      'click .js-notify-btn-alert': 'onAlertButtonClicked',\r\n      'click .js-notify-btn-prompt': 'onPromptButtonClicked',\r\n      'click .js-notify-close-btn': 'onCloseButtonClicked',\r\n      'click .js-notify-shadow-click': 'onShadowClicked'\r\n    };\r\n  }\r\n\r\n  initialize({ notify }) {\r\n    this.notify = notify;\r\n    _.bindAll(this, 'resetNotifySize', 'onKeyUp');\r\n    this.disableAnimation = Adapt.config.get('_disableAnimation') || false;\r\n    this.isOpen = false;\r\n    this.hasOpened = false;\r\n    this.setupEventListeners();\r\n    this.render();\r\n  }\r\n\r\n  setupEventListeners() {\r\n    this.listenTo(Adapt, {\r\n      remove: this.closeNotify,\r\n      'notify:resize': this.resetNotifySize,\r\n      'notify:cancel': this.cancelNotify,\r\n      'notify:close': this.closeNotify,\r\n      'device:resize': this.resetNotifySize\r\n    });\r\n    this.setupEscapeKey();\r\n  }\r\n\r\n  setupEscapeKey() {\r\n    $(window).on('keyup', this.onKeyUp);\r\n  }\r\n\r\n  onKeyUp(event) {\r\n    if (event.which !== 27) return;\r\n    event.preventDefault();\r\n    this.cancelNotify();\r\n  }\r\n\r\n  render() {\r\n    const data = this.model.toJSON();\r\n    const template = Handlebars.templates.notifyPopup;\r\n    // hide notify container\r\n    this.$el.css('visibility', 'hidden');\r\n    // attach popup + shadow\r\n    this.$el.html(template(data)).appendTo('.notify__popup-container');\r\n    // hide popup\r\n    this.$('.notify__popup').css('visibility', 'hidden');\r\n    // show notify container\r\n    this.$el.css('visibility', 'visible');\r\n    this.showNotify();\r\n    return this;\r\n  }\r\n\r\n  onAlertButtonClicked(event) {\r\n    event.preventDefault();\r\n    // tab index preservation, notify must close before subsequent callback is triggered\r\n    this.closeNotify();\r\n    Adapt.trigger(this.model.get('_callbackEvent'), this);\r\n  }\r\n\r\n  onPromptButtonClicked(event) {\r\n    event.preventDefault();\r\n    // tab index preservation, notify must close before subsequent callback is triggered\r\n    this.closeNotify();\r\n    Adapt.trigger($(event.currentTarget).attr('data-event'), this);\r\n  }\r\n\r\n  onCloseButtonClicked(event) {\r\n    event.preventDefault();\r\n    // tab index preservation, notify must close before subsequent callback is triggered\r\n    this.cancelNotify();\r\n  }\r\n\r\n  onShadowClicked(event) {\r\n    event.preventDefault();\r\n    if (this.model.get('_closeOnShadowClick') === false) return;\r\n    this.cancelNotify();\r\n  }\r\n\r\n  cancelNotify() {\r\n    if (this.model.get('_isCancellable') === false) return;\r\n    // tab index preservation, notify must close before subsequent callback is triggered\r\n    this.closeNotify();\r\n    Adapt.trigger('notify:cancelled', this);\r\n  }\r\n\r\n  resetNotifySize() {\r\n    if (!this.hasOpened) return;\r\n    this.resizeNotify();\r\n  }\r\n\r\n  resizeNotify() {\r\n    const windowHeight = $(window).height();\r\n    const notifyHeight = this.$('.notify__popup-inner').outerHeight();\r\n    const isFullWindow = (notifyHeight >= windowHeight);\r\n    this.$('.notify__popup').css({\r\n      height: isFullWindow ? '100%' : 'auto',\r\n      top: isFullWindow ? 0 : '',\r\n      'margin-top': isFullWindow ? '' : -(notifyHeight / 2),\r\n      'overflow-y': isFullWindow ? 'scroll' : '',\r\n      '-webkit-overflow-scrolling': isFullWindow ? 'touch' : ''\r\n    });\r\n  }\r\n\r\n  async showNotify() {\r\n    this.isOpen = true;\r\n    await this.addSubView();\r\n    // Add to the list of open popups\r\n    this.notify.stack.push(this);\r\n    // Keep focus from previous action\r\n    this.$previousActiveElement = $(document.activeElement);\r\n    Adapt.trigger('notify:opened', this);\r\n    this.$el.imageready(this.onLoaded.bind(this));\r\n  }\r\n\r\n  onLoaded() {\r\n    if (this.disableAnimation) {\r\n      this.$('.notify__shadow').css('display', 'block');\r\n    } else {\r\n      this.$('.notify__shadow').velocity({ opacity: 0 }, { duration: 0 }).velocity({ opacity: 1 }, {\r\n        duration: 400,\r\n        begin: () => {\r\n          this.$('.notify__shadow').css('display', 'block');\r\n        }\r\n      });\r\n    }\r\n    this.resizeNotify();\r\n    if (this.disableAnimation) {\r\n      this.$('.notify__popup').css('visibility', 'visible');\r\n      this.onOpened();\r\n    } else {\r\n      this.$('.notify__popup').velocity({ opacity: 0 }, { duration: 0 }).velocity({ opacity: 1 }, {\r\n        duration: 400,\r\n        begin: () => {\r\n          // Make sure to make the notify visible and then set\r\n          // focus, disabled scroll and manage tabs\r\n          this.$('.notify__popup').css('visibility', 'visible');\r\n          this.onOpened();\r\n        }\r\n      });\r\n    }\r\n  }\r\n\r\n  onOpened() {\r\n    $.inview();\r\n    this.hasOpened = true;\r\n    // Allows popup manager to control focus\r\n    a11y.popupOpened(this.$el);\r\n    a11y.scrollDisable('body');\r\n    $('html').addClass('notify');\r\n    // Set focus to first accessible element\r\n    a11y.focusFirst(this.$('.notify__popup'), { defer: false });\r\n  }\r\n\r\n  async addSubView() {\r\n    this.subView = this.model.get('_view');\r\n    if (this.model.get('_shouldRenderId') && this.model.get('_id')) {\r\n      // Automatically render the specified id\r\n      const model = data.findById(this.model.get('_id'));\r\n      const View = components.getViewClass(model);\r\n      this.subView = new View({ model });\r\n    }\r\n    if (!this.subView) return;\r\n    this.subView.$el.on('resize', this.resetNotifySize);\r\n    this.$('.notify__content-inner').append(this.subView.$el);\r\n    if (!(this.subView instanceof AdaptView) || this.subView.model.get('_isReady')) return;\r\n    // Wait for the AdaptView subview to be ready\r\n    return new Promise(resolve => {\r\n      const check = (model, value) => {\r\n        if (!value) return;\r\n        this.subView.model.off('change:_isReady', check);\r\n        resolve();\r\n      };\r\n      this.subView.model.on('change:_isReady', check);\r\n    });\r\n  }\r\n\r\n  closeNotify() {\r\n    // Make sure that only the top most notify is closed\r\n    const stackItem = this.notify.stack[this.notify.stack.length - 1];\r\n    if (this !== stackItem) return;\r\n    this.notify.stack.pop();\r\n    // Prevent from being invoked multiple times - see https://github.com/adaptlearning/adapt_framework/issues/1659\r\n    if (!this.isOpen) return;\r\n    this.isOpen = false;\r\n    // If closeNotify is called before showNotify has finished then wait\r\n    // until it's open.\r\n    if (this.hasOpened) {\r\n      this.onCloseReady();\r\n      return;\r\n    }\r\n    this.listenToOnce(Adapt, 'popup:opened', () => {\r\n      // Wait for popup:opened to finish processing\r\n      _.defer(this.onCloseReady.bind(this));\r\n    });\r\n  }\r\n\r\n  onCloseReady() {\r\n    if (this.disableAnimation) {\r\n      this.$('.notify__popup').css('visibility', 'hidden');\r\n      this.$el.css('visibility', 'hidden');\r\n      this.remove();\r\n    } else {\r\n      this.$('.notify__popup').velocity({ opacity: 0 }, {\r\n        duration: 400,\r\n        complete: () => {\r\n          this.$('.notify__popup').css('visibility', 'hidden');\r\n        }\r\n      });\r\n      this.$('.notify__shadow').velocity({ opacity: 0 }, {\r\n        duration: 400,\r\n        complete: () => {\r\n          this.$el.css('visibility', 'hidden');\r\n          this.remove();\r\n        }\r\n      });\r\n    }\r\n    a11y.scrollEnable('body');\r\n    $('html').removeClass('notify');\r\n    // Return focus to previous active element\r\n    a11y.popupClosed(this.$previousActiveElement);\r\n    // Return reference to the notify view\r\n    Adapt.trigger('notify:closed', this);\r\n  }\r\n\r\n  remove(...args) {\r\n    this.removeSubView();\r\n    $(window).off('keyup', this.onKeyUp);\r\n    super.remove(...args);\r\n  }\r\n\r\n  removeSubView() {\r\n    if (!this.subView) return;\r\n    this.subView.$el.off('resize', this.resetNotifySize);\r\n    if (this.subView instanceof AdaptView) {\r\n      // Clear up nested views and models\r\n      const views = [...this.subView.findDescendantViews(), this.subView];\r\n      views.forEach(view => {\r\n        view.model.set('_isReady', false);\r\n        view.remove();\r\n      });\r\n    } else {\r\n      this.subView.remove();\r\n    }\r\n    this.subView = null;\r\n  }\r\n\r\n}\r\n","import Adapt from 'core/js/adapt';\r\nimport logging from 'core/js/logging';\r\nimport NotifyPushCollection from 'core/js/collections/notifyPushCollection';\r\nimport NotifyPopupView from 'core/js/views/notifyPopupView';\r\nimport NotifyModel from 'core/js/models/notifyModel';\r\n\r\nexport default class NotifyView extends Backbone.View {\r\n\r\n  className() {\r\n    return 'notify__container';\r\n  }\r\n\r\n  initialize() {\r\n    this._stack = [];\r\n    this.notifyPushes = new NotifyPushCollection();\r\n    this.listenTo(Adapt, {\r\n      'notify:popup': this._deprecated.bind(this, 'popup'),\r\n      'notify:alert': this._deprecated.bind(this, 'alert'),\r\n      'notify:prompt': this._deprecated.bind(this, 'prompt'),\r\n      'notify:push': this._deprecated.bind(this, 'push')\r\n    });\r\n    this.render();\r\n  }\r\n\r\n  get stack() {\r\n    return this._stack;\r\n  }\r\n\r\n  get isOpen() {\r\n    return (this.stack.length > 0);\r\n  }\r\n\r\n  _deprecated(type, notifyObject) {\r\n    logging.deprecated(`NOTIFY DEPRECATED: Adapt.trigger('notify:${type}', notifyObject); is no longer supported, please use notify.${type}(notifyObject);`);\r\n    return this.create(notifyObject, { _type: type });\r\n  }\r\n\r\n  render() {\r\n    const notifyTemplate = Handlebars.templates.notify;\r\n    this.$el.html(notifyTemplate());\r\n    this.$el.appendTo('body');\r\n  }\r\n\r\n  create(notifyObject, defaults) {\r\n    notifyObject = _.defaults({}, notifyObject, defaults, {\r\n      _type: 'popup',\r\n      _shouldRenderId: false,\r\n      _isCancellable: true,\r\n      _showCloseButton: true,\r\n      _closeOnShadowClick: true\r\n    });\r\n\r\n    if (notifyObject._type === 'push') {\r\n      this.notifyPushes.push(notifyObject);\r\n      return;\r\n    }\r\n\r\n    return new NotifyPopupView({\r\n      model: new NotifyModel(notifyObject),\r\n      notify: this\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Creates a 'popup' notify\r\n   * @param {Object} notifyObject An object containing all the settings for the popup\r\n   * @param {string} notifyObject.title Title of the popup\r\n   * @param {string} notifyObject.body Body of the popup\r\n   * @param {Boolean} [notifyObject._showCloseButton=true] If set to `false` the popup will not have a close button. The learner will still be able to dismiss the popup by clicking outside of it or by pressing the Esc key. This setting is typically used mainly for popups that have a subview (where the subview contains the close button)\r\n   * @param {Boolean} [notifyObject._isCancellable=true] If set to `false` the learner will not be able to close the popup - use with caution!\r\n   * @param {string} [notifyObject._classes] A class name or (space separated) list of class names you'd like to be applied to the popup's `<div>`\r\n   * @param {Backbone.View} [notifyObject._view] Subview to display in the popup instead of the standard view\r\n   */\r\n  popup(notifyObject) {\r\n    return this.create(notifyObject, { _type: 'popup' });\r\n  }\r\n\r\n  /**\r\n   * Creates an 'alert' notify popup\r\n   * @param {Object} notifyObject An object containing all the settings for the alert popup\r\n   * @param {string} notifyObject.title Title of the alert popup\r\n   * @param {string} notifyObject.body Body of the alert popup\r\n   * @param {string} notifyObject.confirmText Label for the popup confirm button\r\n   * @param {Boolean} [notifyObject._isCancellable=true] If set to `false` only the confirm button can be used to dismiss/close the popup\r\n   * @param {Boolean} [notifyObject._showIcon=false] If set to `true` an 'alert' icon will be displayed in the popup\r\n   * @param {string} [notifyObject._callbackEvent] Event to trigger when the confirm button is clicked\r\n   * @param {string} [notifyObject._classes] A class name or (space separated) list of class names you'd like to be applied to the popup's `<div>`\r\n   * @param {Backbone.View} [notifyObject._view] Subview to display in the popup instead of the standard view\r\n   */\r\n  alert(notifyObject) {\r\n    return this.create(notifyObject, { _type: 'alert' });\r\n  }\r\n\r\n  /**\r\n   * Creates a 'prompt dialog' notify popup\r\n   * @param {Object} notifyObject An object containing all the settings for the prompt dialog\r\n   * @param {string} notifyObject.title Title of the prompt\r\n   * @param {string} notifyObject.body Body of the prompt\r\n   * @param {Object[]} notifyObject._prompts Array of objects that each define a button (and associated callback event) that you want shown in the prompt\r\n   * @param {string} notifyObject._prompts[].promptText Label for this button\r\n   * @param {string} notifyObject._prompts[]._callbackEvent Event to be triggered when this button is clicked\r\n   * @param {Boolean} [notifyObject._isCancellable=true] If set to `false` only the confirm button can be used to dismiss/close the prompt\r\n   * @param {Boolean} [notifyObject._showIcon=true] If set to `true` a 'query' icon will be displayed in the popup\r\n   * @param {string} [notifyObject._callbackEvent] Event to trigger when the confirm button is clicked\r\n   * @param {string} [notifyObject._classes] A class name or (space separated) list of class names you'd like to be applied to the popup's `<div>`\r\n   * @param {Backbone.View} [notifyObject._view] Subview to display in the popup instead of the standard view\r\n   */\r\n  prompt(notifyObject) {\r\n    return this.create(notifyObject, { _type: 'prompt' });\r\n  }\r\n\r\n  /**\r\n   * Creates a 'push notification'\r\n   * @param {Object} notifyObject An object containing all the settings for the push notification\r\n   * @param {string} notifyObject.title Title of the push notification\r\n   * @param {string} notifyObject.body Body of the push notification\r\n   * @param {Number} [notifyObject._timeout=3000] Length of time (in milliseconds) the notification should left on-screen before automatically fading away\r\n   * @param {string} notifyObject._callbackEvent Event to be triggered if the learner clicks on the push notification (not triggered if they use the close button)\r\n   * @param {string} [notifyObject._classes] A class name or (space separated) list of class names you'd like to be applied to the popup's `<div>`\r\n   */\r\n  push(notifyObject) {\r\n    return this.create(notifyObject, { _type: 'push' });\r\n  }\r\n\r\n}\r\n","import NotifyView from 'core/js/views/notifyView';\r\n\r\nconst notify = new NotifyView();\r\nexport default notify;\r\n","import LockingModel from 'core/js/models/lockingModel';\r\n\r\nexport default class RouterModel extends LockingModel {\r\n\r\n  defaults() {\r\n    return {\r\n      _canNavigate: true,\r\n      _shouldNavigateFocus: true\r\n    };\r\n  }\r\n\r\n  lockedAttributes() {\r\n    return {\r\n      _canNavigate: false,\r\n      _shouldNavigateFocus: false\r\n    };\r\n  }\r\n\r\n}\r\n","import Adapt from 'core/js/adapt';\r\nimport wait from 'core/js/wait';\r\nimport components from 'core/js/components';\r\nimport data from 'core/js/data';\r\nimport a11y from 'core/js/a11y';\r\nimport RouterModel from 'core/js/models/routerModel';\r\nimport logging from 'core/js/logging';\r\nimport location from 'core/js/location';\r\n\r\nclass Router extends Backbone.Router {\r\n\r\n  routes() {\r\n    return {\r\n      '': 'handleRoute',\r\n      'id/:id': 'handleRoute',\r\n      ':pluginName(/*location)(/*action)': 'handleRoute'\r\n    };\r\n  }\r\n\r\n  initialize({ model }) {\r\n    this.navigateToElement = this.navigateToElement.bind(this);\r\n    this._isBackward = false;\r\n    this.model = model;\r\n    this._navigationRoot = null;\r\n    // Flag to indicate if the router has tried to redirect to the current location.\r\n    this._isCircularNavigationInProgress = false;\r\n    this.showLoading();\r\n    // Store #wrapper element and html to cache for later use.\r\n    this.$wrapper = $('#wrapper');\r\n    this.$html = $('html');\r\n    this.listenToOnce(Adapt, 'app:dataReady', this.setDocumentTitle);\r\n    this.listenTo(Adapt, 'router:navigateTo', this.navigateToArguments);\r\n  }\r\n\r\n  get rootModel() {\r\n    return this._navigationRoot || Adapt.course;\r\n  }\r\n\r\n  set rootModel(model) {\r\n    this._navigationRoot = model;\r\n  }\r\n\r\n  showLoading() {\r\n    $('.js-loading').show();\r\n  }\r\n\r\n  hideLoading() {\r\n    $('.js-loading').hide();\r\n  }\r\n\r\n  setDocumentTitle() {\r\n    const currentModel = location._currentModel;\r\n    const hasSubTitle = (currentModel && currentModel !== router.rootModel && currentModel.get('title'));\r\n    const title = [\r\n      this.rootModel.get('title'),\r\n      hasSubTitle && currentModel.get('title')\r\n    ].filter(Boolean).join(' | ');\r\n    this.listenToOnce(Adapt, 'contentObjectView:preRender', () => {\r\n      const escapedTitle = $(`<div>${title}</div>`).text();\r\n      document.title = escapedTitle;\r\n    });\r\n  }\r\n\r\n  navigateToArguments(args) {\r\n    args = args.filter(v => v !== null);\r\n    const options = { trigger: false, replace: false };\r\n    if (args.length === 1 && data.findById(args[0])) {\r\n      this.navigate('#/id/' + args[0], options);\r\n      return;\r\n    }\r\n    if (args.length <= 3) {\r\n      this.navigate('#/' + args.join('/'), options);\r\n      return;\r\n    }\r\n    logging.deprecated('Use Backbone.history.navigate or window.location.href instead of Adapt.trigger(\\'router:navigateTo\\')');\r\n    this.handleRoute(...args);\r\n  }\r\n\r\n  handleRoute(...args) {\r\n    args = args.filter(v => v !== null);\r\n\r\n    if (this.model.get('_canNavigate')) {\r\n      // Reset _isCircularNavigationInProgress protection as code is allowed to navigate away.\r\n      this._isCircularNavigationInProgress = false;\r\n    }\r\n\r\n    // Check if the current page is in the process of navigating to itself.\r\n    // It will redirect to itself if the URL was changed and _canNavigate is false.\r\n    if (this._isCircularNavigationInProgress === false) {\r\n      // Trigger an event pre 'router:location' to allow extensions to stop routing.\r\n      Adapt.trigger('router:navigate', args);\r\n    }\r\n\r\n    // Re-check as _canNavigate can be set to false on 'router:navigate' event.\r\n    if (this.model.get('_canNavigate')) {\r\n      // Disable navigation whilst rendering.\r\n      this.model.set('_canNavigate', false, { pluginName: 'adapt' });\r\n      this._isBackward = false;\r\n      if (args.length <= 1) {\r\n        return this.handleId(...args);\r\n      }\r\n      return this.handlePluginRouter(...args);\r\n    }\r\n\r\n    if (this._isCircularNavigationInProgress) {\r\n      // Navigation correction finished.\r\n      // Router has successfully re-navigated to the current _id as the URL was changed\r\n      // while _canNavigate: false\r\n      this._isCircularNavigationInProgress = false;\r\n      return;\r\n    }\r\n\r\n    // Cancel navigation to stay at the current location.\r\n    this._isCircularNavigationInProgress = true;\r\n    Adapt.trigger('router:navigationCancelled', args);\r\n\r\n    // Reset URL to the current one.\r\n    // https://github.com/adaptlearning/adapt_framework/issues/3061\r\n    Backbone.history.history[this._isBackward ? 'forward' : 'back']();\r\n    this._isBackward = false;\r\n  }\r\n\r\n  async handlePluginRouter(pluginName, location, action) {\r\n    const pluginLocation = [\r\n      pluginName,\r\n      location && `-${location}`,\r\n      action && `-${action}`\r\n    ].filter(Boolean).join('');\r\n    await this.updateLocation(pluginLocation, null, null, null);\r\n\r\n    Adapt.trigger('router:plugin:' + pluginName, pluginName, location, action);\r\n    Adapt.trigger('router:plugin', pluginName, location, action);\r\n    this.model.set('_canNavigate', true, { pluginName: 'adapt' });\r\n  }\r\n\r\n  async handleId(id) {\r\n    const rootModel = router.rootModel;\r\n    let model = (!id) ? rootModel : data.findById(id);\r\n\r\n    if (!model) {\r\n      // Bad id\r\n      this.model.set('_canNavigate', true, { pluginName: 'adapt' });\r\n      return;\r\n    }\r\n\r\n    // Keep the routed id incase it needs to be scrolled to later\r\n    const isContentObject = model.isTypeGroup?.('contentobject');\r\n    const navigateToId = model.get('_id');\r\n\r\n    // Ensure that the router is rendering a contentobject\r\n    model = isContentObject ? model : model.findAncestor('contentobject');\r\n    id = model.get('_id');\r\n\r\n    const isRoot = (model === rootModel);\r\n    if (isRoot && Adapt.course.has('_start')) {\r\n      // Do not allow access to the menu when the start controller is enabled.\r\n      const startController = Adapt.course.get('_start');\r\n      if (startController._isEnabled === true && startController._isMenuDisabled === true) {\r\n        return;\r\n      }\r\n    }\r\n\r\n    if (model.get('_isLocked') && Adapt.config.get('_forceRouteLocking')) {\r\n      // Locked id\r\n      logging.warn('Unable to navigate to locked id: ' + id);\r\n      this.model.set('_canNavigate', true, { pluginName: 'adapt' });\r\n      if (location._previousId === undefined) {\r\n        return this.navigate('#/', { trigger: true, replace: true });\r\n      }\r\n      return this.navigateBack();\r\n    }\r\n\r\n    // Move to a content object\r\n    this.showLoading();\r\n    await Adapt.remove();\r\n\r\n    /**\r\n     * TODO:\r\n     * As the course object has separate location and type rules,\r\n     * it makes it more difficult to update the location object\r\n     * should stop doing this.\r\n     */\r\n    const isCourse = model.isTypeGroup?.('course');\r\n    const type = isCourse ? 'menu' : model.get('_type');\r\n    const newLocation = isCourse ? 'course' : `${type}-${id}`;\r\n\r\n    model.set('_isVisited', true);\r\n    await this.updateLocation(newLocation, type, id, model);\r\n\r\n    Adapt.once('contentObjectView:ready', () => {\r\n      // Allow navigation.\r\n      this.model.set('_canNavigate', true, { pluginName: 'adapt' });\r\n      this.handleNavigationFocus();\r\n    });\r\n    Adapt.trigger(`router:${type} router:contentObject`, model);\r\n\r\n    const ViewClass = components.getViewClass(model);\r\n    const isMenu = model.isTypeGroup?.('menu');\r\n    if (!ViewClass && isMenu) {\r\n      logging.deprecated(`Using event based menu view instantiation for '${components.getViewName(model)}'`);\r\n      return;\r\n    }\r\n\r\n    if (!isMenu) {\r\n      // checkIfResetOnRevisit where exists on descendant models before render\r\n      _.invoke(model.getAllDescendantModels(), 'checkIfResetOnRevisit');\r\n      // wait for completion to settle\r\n      await Adapt.deferUntilCompletionChecked();\r\n    }\r\n\r\n    this.$wrapper.append(new ViewClass({ model }).$el);\r\n\r\n    if (!isContentObject && !this.isScrolling) {\r\n      // Scroll to element if not a content object or not already trying to\r\n      await this.navigateToElement('.' + navigateToId, { replace: true, duration: 400 });\r\n    }\r\n\r\n  }\r\n\r\n  async updateLocation(currentLocation, type, id, currentModel) {\r\n    // Handles updating the location.\r\n    location._previousModel = location._currentModel;\r\n    location._previousId = location._currentId;\r\n    location._previousContentType = location._contentType;\r\n\r\n    location._currentModel = currentModel;\r\n    location._currentId = id;\r\n    location._contentType = type;\r\n    location._currentLocation = currentLocation;\r\n\r\n    /**\r\n     * TODO:\r\n     * this if block should be removed,\r\n     * these properties are unused in the framework\r\n     */\r\n    if (type === 'menu') {\r\n      location._lastVisitedType = 'menu';\r\n      location._lastVisitedMenu = id;\r\n    } else if (type === 'page') {\r\n      location._lastVisitedType = 'page';\r\n      location._lastVisitedPage = id;\r\n    }\r\n\r\n    this.setDocumentTitle();\r\n    this.setGlobalClasses();\r\n\r\n    // Trigger event when location changes.\r\n    Adapt.trigger('router:location', location);\r\n\r\n    await wait.queue();\r\n  }\r\n\r\n  setGlobalClasses() {\r\n    const currentModel = location._currentModel;\r\n\r\n    const htmlClasses = currentModel?.get('_htmlClasses') || '';\r\n    const classes = (location._currentId) ?\r\n      `location-${location._contentType} location-id-${location._currentId}` :\r\n      `location-${location._currentLocation}`;\r\n    const currentClasses = `${classes} ${htmlClasses}`;\r\n\r\n    this.$html\r\n      .removeClass(location._previousClasses)\r\n      .addClass(currentClasses)\r\n      .attr('data-location', location._currentLocation);\r\n\r\n    this.$wrapper\r\n      .removeClass()\r\n      .addClass(classes)\r\n      .attr('data-location', location._currentLocation);\r\n\r\n    location._previousClasses = currentClasses;\r\n  }\r\n\r\n  handleNavigationFocus() {\r\n    if (!this.model.get('_shouldNavigateFocus')) return;\r\n    // Body will be forced to accept focus to start the\r\n    // screen reader reading the page.\r\n    a11y.focus('body');\r\n  }\r\n\r\n  navigateBack() {\r\n    this._isBackward = true;\r\n    Backbone.history.history.back();\r\n  }\r\n\r\n  navigateToCurrentRoute(force) {\r\n    if (!this.model.get('_canNavigate') && !force) {\r\n      return;\r\n    }\r\n    if (!location._currentId) {\r\n      return;\r\n    }\r\n    const currentId = location._currentModel.get('_id');\r\n    const isRoot = (location._currentModel === this.rootModel);\r\n    const route = isRoot ? '#/' : '#/id/' + currentId;\r\n    this.navigate(route, { trigger: true, replace: true });\r\n  }\r\n\r\n  navigateToPreviousRoute(force) {\r\n    // Sometimes a plugin might want to stop the default navigation.\r\n    // Check whether default navigation has changed.\r\n    if (!this.model.get('_canNavigate') && !force) {\r\n      return;\r\n    }\r\n    const currentModel = location._currentModel;\r\n    const previousModel = location._previousModel;\r\n    if (!currentModel) {\r\n      return this.navigateBack();\r\n    }\r\n    if (location._currentModel?.isTypeGroup('menu')) {\r\n      return this.navigateToParent();\r\n    }\r\n    if (previousModel) {\r\n      return this.navigateBack();\r\n    }\r\n    this.navigateToParent();\r\n  }\r\n\r\n  navigateToParent(force) {\r\n    if (!this.model.get('_canNavigate') && !force) {\r\n      return;\r\n    }\r\n    const parentId = location._currentModel.get('_parentId');\r\n    const parentModel = data.findById(parentId);\r\n    const isRoot = (parentModel === this.rootModel);\r\n    const route = isRoot ? '#/' : '#/id/' + parentId;\r\n    this.navigate(route, { trigger: true });\r\n  }\r\n\r\n  navigateToHomeRoute(force) {\r\n    if (!this.model.get('_canNavigate') && !force) {\r\n      return;\r\n    }\r\n    this.navigate('#/', { trigger: true });\r\n  }\r\n\r\n  /**\r\n   * Allows a selector or id to be passed in and Adapt will navigate to this element. Resolves\r\n   * asynchronously when the element has been navigated to.\r\n   * @param {JQuery|string} selector CSS selector or id of the Adapt element you want to navigate to e.g. `\".co-05\"` or `\"co-05\"`\r\n   * @param {Object} [settings] The settings for the `$.scrollTo` function (See https://github.com/flesler/jquery.scrollTo#settings).\r\n   * @param {Object} [settings.replace=false] Set to `true` if you want to update the URL without creating an entry in the browser's history.\r\n   */\r\n  async navigateToElement(selector, settings = {}) {\r\n    const currentModelId = typeof selector === 'string' && selector.replace(/\\./g, '').split(' ')[0];\r\n    const isSelectorAnId = data.hasId(currentModelId);\r\n\r\n    if (isSelectorAnId) {\r\n      const currentModel = data.findById(currentModelId);\r\n      const contentObject = currentModel.isTypeGroup?.('contentobject') ? currentModel : currentModel.findAncestor('contentobject');\r\n      const contentObjectId = contentObject.get('_id');\r\n      const isNotInCurrentContentObject = (contentObjectId !== location._currentId);\r\n\r\n      if (currentModel && (!currentModel.get('_isRendered') || !currentModel.get('_isReady') || isNotInCurrentContentObject)) {\r\n        const shouldReplace = settings.replace || false;\r\n        if (isNotInCurrentContentObject) {\r\n          this.isScrolling = true;\r\n          this.navigate(`#/id/${currentModelId}`, { trigger: true, replace: shouldReplace });\r\n          this.model.set('_shouldNavigateFocus', false, { pluginName: 'adapt' });\r\n          await new Promise(resolve => Adapt.once('contentObjectView:ready', _.debounce(() => {\r\n            this.model.set('_shouldNavigateFocus', true, { pluginName: 'adapt' });\r\n            resolve();\r\n          }, 1)));\r\n          this.isScrolling = false;\r\n        }\r\n        await Adapt.parentView.renderTo(currentModelId);\r\n      }\r\n\r\n      // Correct selector when passed a pure id\r\n      if (currentModel && selector === currentModel.get('_id')) {\r\n        selector = `.${selector}`;\r\n      }\r\n    }\r\n\r\n    const isElementUnavailable = !$(selector).length;\r\n    if (isElementUnavailable) {\r\n      logging.warn(`router.navigateToElement, selector not found in document: ${selector}`);\r\n      return;\r\n    }\r\n\r\n    // Get the current location - this is set in the router\r\n    const newLocation = (location._contentType)\r\n      ? location._contentType\r\n      : location._currentLocation;\r\n    // Trigger initial scrollTo event\r\n    Adapt.trigger(`${newLocation}:scrollTo`, selector);\r\n    // Setup duration variable\r\n    const disableScrollToAnimation = Adapt.config.has('_disableAnimation') ? Adapt.config.get('_disableAnimation') : false;\r\n    if (disableScrollToAnimation) {\r\n      settings.duration = 0;\r\n    } else if (!settings.duration) {\r\n      settings.duration = $.scrollTo.defaults.duration;\r\n    }\r\n\r\n    const $wrapper = $('#wrapper');\r\n    // Work out offset from the top of the wrapper rather than the height of the navigation bar\r\n    let offsetTop = -parseInt($wrapper.css('padding-top'));\r\n    // Prevent scroll issue when component description aria-label coincident with top of component\r\n    if ($(selector).hasClass('component')) {\r\n      offsetTop -= $(selector).find('.aria-label').height() || 0;\r\n    }\r\n\r\n    if (!settings.offset) settings.offset = { top: offsetTop, left: 0 };\r\n    if (settings.offset.top === undefined) settings.offset.top = offsetTop;\r\n    if (settings.offset.left === undefined) settings.offset.left = 0;\r\n\r\n    if (settings.offset.left === 0) settings.axis = 'y';\r\n\r\n    if (Adapt.get('_canScroll') !== false) {\r\n      // Trigger scrollTo plugin\r\n      $.scrollTo(selector, settings);\r\n    }\r\n\r\n    // Trigger an event after animation\r\n    // 300 milliseconds added to make sure queue has finished\r\n    await new Promise(resolve => {\r\n      _.delay(() => {\r\n        a11y.focusNext(selector);\r\n        Adapt.trigger(`${location}:scrolledTo`, selector);\r\n        resolve();\r\n      }, settings.duration + 300);\r\n    });\r\n  }\r\n\r\n  get(...args) {\r\n    logging.deprecated('router.get, please use router.model.get');\r\n    return this.model.get(...args);\r\n  }\r\n\r\n  set(...args) {\r\n    logging.deprecated('router.set, please use router.model.set');\r\n    return this.model.set(...args);\r\n  }\r\n\r\n}\r\n\r\nconst router = new Router({\r\n  model: new RouterModel(null, { reset: true })\r\n});\r\nexport default router;\r\n","import Adapt from 'core/js/adapt';\r\nimport logging from 'core/js/logging';\r\nimport router from 'core/js/router';\r\n\r\n/**\r\n * This allows Adapt to:\r\n * - Be embedded in iframes on ios\r\n *   ios iframes assume the content height and no scrolling\r\n *   https://blog.codepen.io/2017/12/01/stupid-iframes-stupid-ios/\r\n *   https://stackoverflow.com/questions/23083462/how-to-get-an-iframe-to-be-responsive-in-ios-safari\r\n * - Prevent the 44px click region occluding trickle at the bottom of\r\n *   ios safari by keeping the controls always visible\r\n *   https://github.com/adaptlearning/adapt-contrib-trickle/issues/132\r\n *   https://www.eventbrite.com/engineering/mobile-safari-why/\r\n */\r\nclass Scrolling extends Backbone.Controller {\r\n\r\n  initialize() {\r\n    this.scrollTo = this.scrollTo.bind(this);\r\n    this.$html = $('html');\r\n    this.isLegacyScrolling = true;\r\n    Adapt.once('configModel:dataLoaded', this._loadConfig.bind(this));\r\n  }\r\n\r\n  _loadConfig() {\r\n    const config = Adapt.config.get('_scrollingContainer');\r\n    if (!config?._isEnabled) return;\r\n    const limitTo = config._limitToSelector;\r\n    const isIncluded = !limitTo || (this.$html.is(limitTo) || this.$html.hasClass(limitTo));\r\n    if (!isIncluded) return;\r\n    this.isLegacyScrolling = false;\r\n    this._windowScrollFix();\r\n    this._addStyling();\r\n    this._updateScrollbarWidth();\r\n    // Update the scrollbar width on zooming/resize as it changes in chrome and firefox\r\n    this.listenTo(Adapt, 'device:resize', this._updateScrollbarWidth);\r\n  }\r\n\r\n  _addStyling() {\r\n    this.$html.addClass('adapt-scrolling');\r\n  }\r\n\r\n  /**\r\n   * Set the --adapt-scrollbar-width css variable to be used to offset the navigation bar\r\n   * width against the body scrollbar\r\n   * The body scrollbar does not constrain the navigation width in the same way the viewport\r\n   * scrollbar does\r\n   * IE11 always defaults to 18px\r\n   * Chrome and firefox change based on zooming\r\n   * Safari has floating scrollbars, so 0px\r\n   */\r\n  _updateScrollbarWidth() {\r\n    const $tester = $('<div class=\"outer\" style=\"overflow:scroll; visibility: hidden; position:fixed; top: 0; left: 0;\"><div class=\"inner\"> </div></div>\"');\r\n    $('body').append($tester);\r\n    const scrollBarWidth = $tester.outerWidth() - $tester.find('.inner').outerWidth();\r\n    $tester.remove();\r\n    const documentStyle = document.documentElement.style;\r\n    documentStyle.setProperty('--adapt-scrollbar-width', `${scrollBarWidth}px`);\r\n  }\r\n\r\n  /**\r\n   * Correct scrolling to use the body element rather than the html element or viewport\r\n   */\r\n  _windowScrollFix() {\r\n    /** @type {HTMLDivElement} */\r\n    const body = document.body;\r\n    const html = Adapt.scrolling.$html[0];\r\n    const scrollY = {\r\n      get: () => body.scrollTop,\r\n      set: value => (body.scrollTop = value)\r\n    };\r\n    const scrollX = {\r\n      get: () => body.scrollLeft,\r\n      set: value => (body.scrollLeft = value)\r\n    };\r\n    const scrollHeight = {\r\n      get: () => body.scrollHeight,\r\n      set: value => (body.scrollHeight = value)\r\n    };\r\n    const scrollWidth = {\r\n      get: () => body.scrollWidth,\r\n      set: value => (body.scrollWidth = value)\r\n    };\r\n    // Fix window.scrollY, window.scrollX, window.pageYOffset and window.pageXOffset\r\n    Object.defineProperties(window, {\r\n      scrollY,\r\n      scrollX,\r\n      // Note: jQuery uses pageYOffset and pageXOffset instead of scrollY and scrollX\r\n      pageYOffset: scrollY,\r\n      pageXOffset: scrollX\r\n    });\r\n    // Fix html.scrollHeight and html.scrollWidth\r\n    Object.defineProperties(html, {\r\n      // Note: jQuery animate as used in scrollTo library, uses scrollHeight to determine animation maxiumum\r\n      scrollHeight,\r\n      scrollWidth\r\n    });\r\n    // Fix window.scrollTo\r\n    window.scrollTo = (...args) => {\r\n      const isObject = (args.length === 1 && typeof args[0] === 'object' && args[0] !== null);\r\n      const left = (isObject ? args[0].left : args[0]) ?? null;\r\n      const top = (isObject ? args[0].top : args[1]) ?? null;\r\n      left !== null && (body.scrollLeft = left);\r\n      top !== null && (body.scrollTop = top);\r\n    };\r\n    // Fix MouseEvent.prototype.pageX and MouseEvent.prototype.pageY\r\n    const MouseEvent = window.MouseEvent;\r\n    Object.defineProperties(MouseEvent.prototype, {\r\n      pageX: {\r\n        get: function() { return this.clientX + scrollX.get(); }\r\n      },\r\n      pageY: {\r\n        // Note: MediaElementJS uses event.pageY to work out the mouse position for the volume controls\r\n        get: function() { return this.clientY + scrollY.get(); }\r\n      }\r\n    });\r\n    // Trigger scroll events on window when scrolling\r\n    const $window = $(window);\r\n    $(document.body).on('scroll', () => $window.scroll());\r\n  }\r\n\r\n  /**\r\n   * Allows a selector to be passed in and Adapt will scroll to this element. Resolves\r\n   * asynchronously when the element has been navigated/scrolled to.\r\n   * @param {string} selector CSS selector of the Adapt element you want to navigate to e.g. `\".co-05\"`\r\n   * @param {Object} [settings={}] The settings for the `$.scrollTo` function (See https://github.com/flesler/jquery.scrollTo#settings).\r\n   * @param {Object} [settings.replace=false] Set to `true` if you want to update the URL without creating an entry in the browser's history.\r\n   */\r\n  async scrollTo(selector, settings = {}) {\r\n    logging.deprecated('Adapt.scrollTo and Adapt.scrolling.scrollTo, use router.navigateToElement instead.');\r\n    return router.navigateToElement(selector, settings);\r\n  }\r\n\r\n}\r\n\r\nconst scrolling = new Scrolling();\r\nexport default scrolling;\r\n","import Adapt from 'core/js/adapt';\r\nimport wait from 'core/js/wait';\r\nimport LockingModel from 'core/js/models/lockingModel';\r\nimport router from 'core/js/router';\r\nimport data from 'core/js/data';\r\n\r\nclass StartController extends Backbone.Controller {\r\n\r\n  initialize(...args) {\r\n    super.initialize(...args);\r\n    this.model = null;\r\n  }\r\n\r\n  loadCourseData() {\r\n    this.model = new LockingModel(Adapt.course.get('_start'));\r\n  }\r\n\r\n  setStartLocation() {\r\n    if (!this.isEnabled()) return;\r\n    window.history.replaceState('', '', this.getStartHash());\r\n  }\r\n\r\n  returnToStartLocation() {\r\n    const startIds = this.model.get('_startIds');\r\n    if (startIds) {\r\n      // ensure we can return to the start page even if it is completed\r\n      startIds.forEach(startId => (startId._skipIfComplete = false));\r\n    }\r\n    window.location.hash = this.getStartHash(true);\r\n  }\r\n\r\n  /**\r\n   * Returns a string in URL.hash format representing the route that the course should be sent to\r\n   * @param {boolean} [alwaysForce] Ignore any route specified in location.hash and force use of the start page instead\r\n   * @return {string}\r\n   */\r\n  getStartHash(alwaysForce) {\r\n    const startId = this.getStartId();\r\n    const isRouteSpecified = window.location.href.indexOf('#') > -1;\r\n    const shouldForceStartId = alwaysForce || this.model.get('_force');\r\n    const shouldNavigateToStartId = startId && (!isRouteSpecified || shouldForceStartId);\r\n\r\n    if (shouldNavigateToStartId && startId !== Adapt.course.get('_id')) {\r\n      return '#/id/' + startId;\r\n    }\r\n\r\n    // If there's a route specified in location.hash, use that - otherwise go to main menu\r\n    return window.location.hash || '#/';\r\n  }\r\n\r\n  isEnabled() {\r\n    return Boolean(this.model?.get('_isEnabled'));\r\n  }\r\n\r\n  getStartId() {\r\n    let startId = this.model.get('_id');\r\n    const startIds = this.model.get('_startIds');\r\n\r\n    if (!startIds?.length) return startId;\r\n\r\n    const $html = $('html');\r\n    for (let i = 0, l = startIds.length; i < l; i++) {\r\n      const item = startIds[i];\r\n      const className = item._className;\r\n      const skipIfComplete = item._skipIfComplete;\r\n\r\n      const model = data.findById(item._id);\r\n\r\n      if (!model) {\r\n        console.log('startController: cannot find id', item._id);\r\n        continue;\r\n      }\r\n\r\n      if (skipIfComplete) {\r\n        if (model.get('_isComplete')) continue;\r\n      }\r\n\r\n      if (!className || $html.is(className) || $html.hasClass(className)) {\r\n        // See https://github.com/adaptlearning/adapt_framework/issues/1843\r\n        startId = item._id;\r\n        break;\r\n      }\r\n    }\r\n\r\n    return startId;\r\n  }\r\n\r\n}\r\n\r\nAdapt.once('adapt:start', () => {\r\n  startController.loadCourseData();\r\n  startController.setStartLocation();\r\n});\r\n\r\n/*\r\n* allows you to call returnToStartLocation either by calling `Adapt.trigger('navigation:returnToStart')`\r\n* or by including in the top navigation bar a button that has the attribute `data-event=\"returnToStart\"`\r\n*/\r\nAdapt.on('navigation:returnToStart', () => {\r\n  startController.returnToStartLocation();\r\n});\r\n\r\nAdapt.on('app:languageChanged', () => {\r\n  wait.for(done => {\r\n    startController.loadCourseData();\r\n    const hash = startController.isEnabled() ? startController.getStartHash(false) : '#/';\r\n    router.navigate(hash, { trigger: true, replace: true });\r\n    done();\r\n  });\r\n});\r\n\r\nconst startController = new StartController();\r\nexport default startController;\r\n","const COMPLETION_STATE = ENUM([\r\n  'INCOMPLETE',\r\n  'COMPLETED',\r\n  'PASSED',\r\n  'FAILED'\r\n]);\r\n\r\nexport default COMPLETION_STATE;\r\n","import Adapt from 'core/js/adapt';\r\nimport offlineStorage from 'core/js/offlineStorage';\r\nimport logging from 'core/js/logging';\r\nimport COMPLETION_STATE from 'core/js/enums/completionStateEnum';\r\n\r\nclass Tracking extends Backbone.Controller {\r\n\r\n  initialize() {\r\n    this._config = {\r\n      _requireContentCompleted: true,\r\n      _requireAssessmentCompleted: false,\r\n      _shouldSubmitScore: false\r\n    };\r\n    this._assessmentState = null;\r\n\r\n    Adapt.once('configModel:dataLoaded', this.loadConfig.bind(this));\r\n    Adapt.on('app:dataReady', this.setupEventListeners.bind(this));\r\n  }\r\n\r\n  setupEventListeners() {\r\n    this.listenTo(Adapt, {\r\n      'assessment:complete': this.onAssessmentComplete,\r\n      'assessment:restored': this.onAssessmentRestored\r\n    });\r\n\r\n    // Check if completion requires completing all content.\r\n    if (this._config._requireContentCompleted) {\r\n      this.listenTo(Adapt.course, 'change:_isComplete', this.checkCompletion);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Store the assessment state.\r\n   * @param {object} assessmentState - The object returned by Adapt.assessment.getState()\r\n   */\r\n  onAssessmentComplete(assessmentState) {\r\n    this._assessmentState = assessmentState;\r\n\r\n    this.submitScore();\r\n    // Check if completion requires passing an assessment.\r\n    if (this._config._requireAssessmentCompleted) {\r\n      this.checkCompletion();\r\n    }\r\n  }\r\n\r\n  submitScore() {\r\n    if (!this._config._shouldSubmitScore) return;\r\n\r\n    if (this._assessmentState.isPercentageBased) {\r\n      offlineStorage.set('score', this._assessmentState.scoreAsPercent, 0, 100);\r\n      return;\r\n    }\r\n\r\n    offlineStorage.set('score', this._assessmentState.score, this._assessmentState.minScore, this._assessmentState.maxScore);\r\n  }\r\n\r\n  /**\r\n   * Restores the _assessmentState object when an assessment is registered.\r\n   * @param {object} assessmentState - An object representing the overall assessment state\r\n   */\r\n  onAssessmentRestored(assessmentState) {\r\n    this._assessmentState = assessmentState;\r\n  }\r\n\r\n  /**\r\n   * Evaluate the course and assessment completion.\r\n   */\r\n  checkCompletion() {\r\n    const completionData = this.getCompletionData();\r\n\r\n    if (completionData.status === COMPLETION_STATE.INCOMPLETE) {\r\n      return;\r\n    }\r\n    \r\n    const canRetry = (completionData.assessment?.canRetry === true);\r\n    if (completionData.status === COMPLETION_STATE.FAILED && canRetry) {\r\n      return;\r\n    }\r\n\r\n    Adapt.trigger('tracking:complete', completionData);\r\n    logging.debug('tracking:complete', completionData);\r\n  }\r\n\r\n  /**\r\n   * The return value of this function should be passed to the trigger of 'tracking:complete'.\r\n   * @returns An object representing the user's course completion.\r\n   */\r\n  getCompletionData() {\r\n    const completionData = {\r\n      status: COMPLETION_STATE.INCOMPLETE,\r\n      assessment: null\r\n    };\r\n\r\n    // Course complete is required.\r\n    if (this._config._requireContentCompleted && !Adapt.course.get('_isComplete')) {\r\n      // INCOMPLETE: course not complete.\r\n      return completionData;\r\n    }\r\n\r\n    // Assessment completed required.\r\n    if (this._config._requireAssessmentCompleted) {\r\n      if (!this._assessmentState) {\r\n        // INCOMPLETE: assessment is not complete.\r\n        return completionData;\r\n      }\r\n\r\n      // PASSED/FAILED: assessment completed.\r\n      completionData.status = this._assessmentState.isPass ? COMPLETION_STATE.PASSED : COMPLETION_STATE.FAILED;\r\n      completionData.assessment = this._assessmentState;\r\n\r\n      return completionData;\r\n    }\r\n\r\n    // COMPLETED: criteria met, no assessment requirements.\r\n    completionData.status = COMPLETION_STATE.COMPLETED;\r\n\r\n    return completionData;\r\n  }\r\n\r\n  /**\r\n   * Set the _config object to the values retrieved from config.json.\r\n   */\r\n  loadConfig() {\r\n    this._config = Adapt.config.get('_completionCriteria') ?? this._config;\r\n    const newShouldSubmitScore = this._config._shouldSubmitScore;\r\n    const legacyShouldSubmitScore = Adapt.config.get('_spoor')?._tracking?._shouldSubmitScore;\r\n    // If the legacy property exists, use it for backward compatibility but warn in the console\r\n    if (legacyShouldSubmitScore !== undefined) logging.deprecated('config.json:_spoor._tracking._shouldSubmitScore, please use only config.json:_completionCriteria._shouldSubmitScore');\r\n    this._config._shouldSubmitScore = legacyShouldSubmitScore ?? newShouldSubmitScore ?? true;\r\n  }\r\n\r\n}\r\n\r\nconst tracking = new Tracking();\r\nexport default tracking;\r\n","import Adapt from 'core/js/adapt';\r\nimport a11y from 'core/js/a11y';\r\nimport components from 'core/js/components';\r\nimport data from 'core/js/data';\r\nimport device from 'core/js/device';\r\nimport drawer from 'core/js/drawer';\r\nimport location from 'core/js/location';\r\nimport logging from 'core/js/logging';\r\nimport mpabc from 'core/js/mpabc';\r\nimport notify from 'core/js/notify';\r\nimport offlineStorage from 'core/js/offlineStorage';\r\nimport router from 'core/js/router';\r\nimport scrolling from 'core/js/scrolling';\r\nimport startController from 'core/js/startController';\r\nimport tracking from 'core/js/tracking';\r\nimport wait from 'core/js/wait';\r\n\r\n/** START REDUNDANT ADAPT WAIT BEHAVIOUR */\r\nconst beginWait = () => {\r\n  logging.deprecated('Use wait.begin() as Adapt.trigger(\\'plugin:beginWait\\') will be removed in the future');\r\n  wait.begin();\r\n};\r\n\r\nconst endWait = () => {\r\n  logging.deprecated('Use wait.end() as Adapt.trigger(\\'plugin:endWait\\') will be removed in the future');\r\n  wait.end();\r\n};\r\n\r\nconst ready = () => {\r\n  if (wait.isWaiting()) {\r\n    return;\r\n  }\r\n  const isEventListening = (Adapt._events['plugins:ready']);\r\n  if (!isEventListening) {\r\n    return;\r\n  }\r\n  logging.deprecated(\"Use wait.queue(callback) as Adapt.on('plugins:ready', callback) will be removed in the future\");\r\n  Adapt.trigger('plugins:ready');\r\n};\r\n\r\nAdapt.listenTo(wait, 'ready', ready);\r\nAdapt.on({\r\n  'plugin:beginWait': beginWait,\r\n  'plugin:endWait': endWait\r\n});\r\n/** END REDUNDANT ADAPT WAIT BEHAVIOUR */\r\n\r\nObject.defineProperties(Adapt, {\r\n  accessibility: {\r\n    get() {\r\n      a11y.log.deprecated('Adapt.accessibility has moved to a11y');\r\n      return a11y;\r\n    }\r\n  },\r\n  a11y: {\r\n    get() {\r\n      logging.deprecated('Adapt.a11y, please use core/js/a11y directly');\r\n      return a11y;\r\n    }\r\n  },\r\n  componentStore: {\r\n    get() {\r\n      logging.deprecated('Adapt.componentStore, please use core/js/components directly');\r\n      return components._register;\r\n    }\r\n  },\r\n  data: {\r\n    get() {\r\n      logging.deprecated('Adapt.data, please use core/js/data directly');\r\n      return data;\r\n    }\r\n  },\r\n  device: {\r\n    get() {\r\n      logging.deprecated('device, please use core/js/device directly');\r\n      return device;\r\n    }\r\n  },\r\n  drawer: {\r\n    get() {\r\n      logging.deprecated('Adapt.drawer, please use core/js/drawer directly');\r\n      return drawer;\r\n    }\r\n  },\r\n  findById: {\r\n    get() {\r\n      logging.deprecated('Adapt.findById, please use data.findById directly');\r\n      return data.findById;\r\n    }\r\n  },\r\n  findViewByModelId: {\r\n    get() {\r\n      logging.deprecated('Adapt.findViewByModelId, please use data.findViewByModelId directly');\r\n      return data.findViewByModelId;\r\n    }\r\n  },\r\n  findByTrackingPosition: {\r\n    get() {\r\n      logging.deprecated('Adapt.findByTrackingPosition, please use data.findByTrackingPosition directly');\r\n      return data.findByTrackingPosition;\r\n    }\r\n  },\r\n  getViewName: {\r\n    get() {\r\n      logging.deprecated('Adapt.getViewName, please use components.getViewName instead');\r\n      return components.getViewName;\r\n    }\r\n\r\n  },\r\n  getViewClass: {\r\n    get() {\r\n      logging.deprecated('Adapt.getViewClass, please use components.getViewClass instead');\r\n      return components.getViewClass;\r\n    }\r\n\r\n  },\r\n  getModelName: {\r\n    get() {\r\n      logging.deprecated('Adapt.getModelName, please use components.getModelName instead');\r\n      return components.getModelName;\r\n    }\r\n  },\r\n  getModelClass: {\r\n    get() {\r\n      logging.deprecated('Adapt.getModelClass, please use components.getModelClass instead');\r\n      return components.getModelClass;\r\n    }\r\n  },\r\n  location: {\r\n    get() {\r\n      logging.deprecated('Adapt.location, please use core/js/location directly');\r\n      return location;\r\n    }\r\n  },\r\n  log: {\r\n    get() {\r\n      logging.deprecated('Adapt.log, please use core/js/logging directly');\r\n      return logging;\r\n    }\r\n  },\r\n  mpabc: {\r\n    get() {\r\n      logging.deprecated('Adapt.mpabc, please use core/js/mpabc directly');\r\n      return mpabc;\r\n    }\r\n  },\r\n  notify: {\r\n    get() {\r\n      logging.deprecated('Adapt.notify, please use core/js/notify directly');\r\n      return notify;\r\n    }\r\n  },\r\n  offlineStorage: {\r\n    get() {\r\n      logging.deprecated('offlineStorage, please use src/core/offlineStorage instead');\r\n      return offlineStorage;\r\n    }\r\n  },\r\n  navigateToElement: {\r\n    get() {\r\n      logging.deprecated('Adapt.navigateToElement, please use router.navigateToElement');\r\n      return router.navigateToElement;\r\n    }\r\n  },\r\n  register: {\r\n    get() {\r\n      logging.deprecated('Adapt.register, please use components.register instead');\r\n      return components.register;\r\n    }\r\n  },\r\n  router: {\r\n    get() {\r\n      logging.deprecated('Adapt.router, please use core/js/router directly');\r\n      return router;\r\n    }\r\n  },\r\n  scrolling: {\r\n    get() {\r\n      logging.deprecated('Adapt.scrolling, please use core/js/scrolling directly');\r\n      return scrolling;\r\n    }\r\n  },\r\n  scrollTo: {\r\n    get() {\r\n      logging.deprecated('Adapt.scrollTo, please use router.navigateToElement');\r\n      return scrolling.scrollTo;\r\n    }\r\n  },\r\n  startController: {\r\n    get() {\r\n      logging.deprecated('Adapt.startController, please use core/js/startController directly');\r\n      return startController;\r\n    }\r\n  },\r\n  store: {\r\n    get() {\r\n      logging.deprecated('Adapt.store, please use core/js/components directly');\r\n      return components._register;\r\n    }\r\n  },\r\n  tracking: {\r\n    get() {\r\n      logging.deprecated('Adapt.tracking, please use core/js/tracking directly');\r\n      return tracking;\r\n    }\r\n  },\r\n  wait: {\r\n    get() {\r\n      logging.deprecated('Adapt.wait, please use src/core/wait instead');\r\n      return wait;\r\n    }\r\n  }\r\n});\r\n","import Adapt from 'core/js/adapt';\r\nimport TemplateRenderEvent from 'core/js/templateRenderEvent';\r\n\r\n/**\r\n * Adds template and partial, preRender and postRender events to Adapt\r\n */\r\n\r\nfunction onRender(cb) {\r\n  const intercept = (object, name, mode, cb) => {\r\n    return (object[name] = cb.bind(object, object[name], name, mode));\r\n  };\r\n  Object.keys(Handlebars.templates).forEach(name => {\r\n    intercept(Handlebars.templates, name, 'template', cb);\r\n  });\r\n  Object.keys(Handlebars.partials).forEach(name => {\r\n    intercept(Handlebars.partials, name, 'partial', cb);\r\n  });\r\n}\r\n\r\nonRender((template, name, mode, ...args) => {\r\n  // Send preRender event to allow modification of args\r\n  const preRenderEvent = new TemplateRenderEvent(`${mode}:preRender`, name, mode, null, args);\r\n  Adapt.trigger(preRenderEvent.type, preRenderEvent);\r\n\r\n  // Execute template\r\n  const value = template(...preRenderEvent.args);\r\n\r\n  // Send postRender event to allow modification of rendered template\r\n  const postRenderEvent = new TemplateRenderEvent(`${mode}:postRender`, name, mode, value, preRenderEvent.args);\r\n  Adapt.trigger(postRenderEvent.type, postRenderEvent);\r\n\r\n  // Return rendered, modified template\r\n  return postRenderEvent.value;\r\n});\r\n","import Adapt from 'core/js/adapt';\r\nimport 'core/js/templates';\r\n\r\n/**\r\n * 27 April 2020 https://github.com/adaptlearning/adapt_framework/issues/2734\r\n * Chrome on Android defers load events on images when lite mode is enabled\r\n * and as part of a data saving technique.\r\n *\r\n * Add a loading=\"eager\" attribute to all template and partial img tags where\r\n * the loading attribute is missing.\r\n */\r\nAdapt.on('app:dataReady', () => {\r\n  const config = Adapt.config.get('_fixes');\r\n  if (config?._imgLazyLoad === false) return;\r\n  applyImgLoadingFix();\r\n});\r\n\r\nfunction applyImgLoadingFix() {\r\n  const findImgTag = /<img([^>]*)>/gi;\r\n  const hasLoadingAttr = / loading=/gi;\r\n  Adapt.on('template:postRender partial:postRender', event => {\r\n    const imgTagsFound = event.value.match(findImgTag);\r\n    if (!imgTagsFound) {\r\n      return;\r\n    }\r\n    event.value = imgTagsFound.reduce((value, img) => {\r\n      if (hasLoadingAttr.test(img)) {\r\n        return value;\r\n      }\r\n      // Add loading=\"eager\" by default\r\n      return value.replace(img, img.replace(findImgTag, '<img loading=\"eager\"$1>'));\r\n    }, event.value);\r\n  });\r\n  Adapt.on('reactElement:preRender', event => {\r\n    if (event.name !== 'img') return;\r\n    const options = event.args[1] = event.args[1] || {};\r\n    if (options && options.hasOwnProperty('loading')) return;\r\n    options.loading = 'eager';\r\n  });\r\n}\r\n","import Adapt from 'core/js/adapt';\r\nimport HTMLReactParser from 'html-react-parser';\r\nimport 'core/js/templates';\r\nimport logging from 'core/js/logging';\r\n\r\n/**\r\n * 27 October 2021 https://github.com/adaptlearning/adapt_authoring/issues/2570\r\n * The function reactHelpers.html was stopping javascript generated in the AAT editor\r\n * from presenting correctly in the DOM.\r\n *\r\n * This file helps deprecate the function reactHelpers.html and instead recommends\r\n * replacing it with dangerouslySetInnerHTML, a native react property.\r\n * https://reactjs.org/docs/dom-elements.html#dangerouslysetinnerhtml\r\n */\r\nAdapt.on('app:dataReady', () => {\r\n  const config = Adapt.config.get('_fixes');\r\n  if (config?._jsxReactHelpersHTML === false) return;\r\n  applyReactHelpersHTML();\r\n});\r\n\r\nfunction applyReactHelpersHTML() {\r\n  Adapt.on('reactElement:preRender', event => {\r\n    let [tagName, props, ...children] = event.args;\r\n    if (!children) return;\r\n    if (!Array.isArray(children)) children = [children];\r\n    children = children.filter(Boolean);\r\n    const hasSomeUnsafeConversions = children.some(c => c?.__html);\r\n    if (!hasSomeUnsafeConversions) return;\r\n    const hasManyChildren = (children.length > 1);\r\n    if (hasManyChildren) {\r\n      // Process reactHelpers.html() children amongst other nodes as a conversion from HTML strings to React nodes\r\n      // Warn as this is an unexpected use-case\r\n      event.args = event.args.map(child => {\r\n        if (!child || !child.__html) return child;\r\n        const attributes = Object.entries(props).map(([name, value]) => `${name}=\"${value}\"`).join(' ');\r\n        logging.warnOnce(`html() call should be the only child in its parent <${tagName} ${attributes}>`);\r\n        return child.__html ? HTMLReactParser(child.__html) : undefined;\r\n      });\r\n      return;\r\n    }\r\n    // Process one reactHelpers.html() child as dangerouslySetInnerHTML on the parent\r\n    // Allows html generated from the json to appear in the DOM in raw format\r\n    props = (event.args[1] = event.args[1] || {});\r\n    props.dangerouslySetInnerHTML = children[0];\r\n    event.args.length = 2;\r\n  });\r\n}\r\n","import Adapt from 'core/js/adapt';\r\nimport a11y from 'core/js/a11y';\r\nimport logging from './logging';\r\n\r\nconst helpers = {\r\n\r\n  lowercase(text) {\r\n    return text.toLowerCase();\r\n  },\r\n\r\n  capitalise(text) {\r\n    return text.charAt(0).toUpperCase() + text.slice(1);\r\n  },\r\n\r\n  inc(index) {\r\n    return index + 1;\r\n  },\r\n\r\n  dec(index) {\r\n    return index - 1;\r\n  },\r\n\r\n  odd (index) {\r\n    return (index + 1) % 2 === 0 ? 'even' : 'odd';\r\n  },\r\n\r\n  equals(value, text, block) {\r\n    return helpers.compare.call(this, value, '==', text, block);\r\n  },\r\n\r\n  compare(value, operator, text, block) {\r\n    // Comparison operators\r\n    switch (operator) {\r\n      case '===':\r\n        if (value === text) return block.fn(this);\r\n        break;\r\n      case '=': case '==':\r\n        // eslint-disable-next-line eqeqeq\r\n        if (value == text) return block.fn(this);\r\n        break;\r\n      case '>=':\r\n        if (value >= text) return block.fn(this);\r\n        break;\r\n      case '<=':\r\n        if (value <= text) return block.fn(this);\r\n        break;\r\n      case '>':\r\n        if (value > text) return block.fn(this);\r\n        break;\r\n      case '<':\r\n        if (value < text) return block.fn(this);\r\n        break;\r\n    }\r\n    return block.inverse(this);\r\n  },\r\n\r\n  math(lvalue, operator, rvalue, options) {\r\n    // Mathematical operators\r\n    lvalue = parseFloat(lvalue);\r\n    rvalue = parseFloat(rvalue);\r\n    switch (operator) {\r\n      case '+': return lvalue + rvalue;\r\n      case '-': return lvalue - rvalue;\r\n      case '*': return lvalue * rvalue;\r\n      case '/': return lvalue / rvalue;\r\n      case '%': return lvalue % rvalue;\r\n    }\r\n  },\r\n\r\n  /**\r\n   * Equivalent to:\r\n   *  if (conditionA || conditionB)\r\n   * @example\r\n   * {{#any displayTitle body instruction}}\r\n   * <div class='component__header {{_component}}__header'></div>\r\n   * {{/any}}\r\n   */\r\n  any(...args) {\r\n    const specified = args.slice(0, -1);\r\n    const block = args.slice(-1)[0];\r\n    return specified.some(Boolean) ? (block.fn ? block.fn(this) : true) : (block.inverse ? block.inverse(this) : false);\r\n  },\r\n\r\n  /**\r\n   * Equivalent to:\r\n   *  if (conditionA && conditionB)\r\n   * @example\r\n   * {{#all displayTitle body instruction}}\r\n   * <div class='component__header {{_component}}__header'></div>\r\n   * {{/all}}\r\n   */\r\n  all(...args) {\r\n    const specified = args.slice(0, -1);\r\n    const block = args.slice(-1)[0];\r\n    return specified.every(Boolean) ? (block.fn ? block.fn(this) : true) : (block.inverse ? block.inverse(this) : false);\r\n  },\r\n\r\n  /**\r\n   * Equivalent to:\r\n   *  if (!conditionA && !conditionB)\r\n   * @example\r\n   * {{#none displayTitle body instruction}}\r\n   * <div class='component__header {{_component}}__header'></div>\r\n   * {{/none}}\r\n   */\r\n  none(...args) {\r\n    const specified = args.slice(0, -1);\r\n    const block = args.slice(-1)[0];\r\n    return !specified.some(Boolean) ? (block.fn ? block.fn(this) : true) : (block.inverse ? block.inverse(this) : false);\r\n  },\r\n\r\n  /**\r\n   * Allow JSON to be a template i.e. you can use handlebars {{expressions}} within your JSON\r\n   */\r\n  compile(template, context) {\r\n    if (!template) return '';\r\n    if (template instanceof Object) template = template.toString();\r\n    const data = (context?.data?.root ? this : context);\r\n    return Handlebars.compile(template)(data);\r\n  },\r\n\r\n  /**\r\n   * Allow JSON to be a template and accessible text\r\n   */\r\n  compile_a11y_text(template, context) {\r\n    logging.deprecated('a11y_text is no longer required. https://tink.uk/understanding-screen-reader-interaction-modes/');\r\n    return helpers.compile.call(this, template, context);\r\n  },\r\n\r\n  /**\r\n   * Allow JSON to be a template and normalized text\r\n   */\r\n  compile_a11y_normalize(template, context) {\r\n    if (!template) {\r\n      return '';\r\n    }\r\n    if (template instanceof Object) template = template.toString();\r\n    return Handlebars.helpers.a11y_normalize.call(this, helpers.compile.call(this, template, context));\r\n  },\r\n\r\n  /**\r\n   * Remove all html tags except styling tags\r\n   */\r\n  compile_a11y_remove_breaks(template, context) {\r\n    if (!template) {\r\n      return '';\r\n    }\r\n    return Handlebars.helpers.a11y_remove_breaks.call(this, helpers.compile.call(this, template, context));\r\n  },\r\n\r\n  /**\r\n   * makes the _globals object in course.json available to a template\r\n   */\r\n  import_globals(context) {\r\n    if (context.data.root._globals) {\r\n      return '';\r\n    }\r\n    context.data.root._globals = Adapt.course.get('_globals');\r\n    return '';\r\n  },\r\n\r\n  /**\r\n   * makes the Adapt module data available to a template\r\n   */\r\n  import_adapt(context) {\r\n\r\n    if (context.data.root.Adapt) {\r\n      return;\r\n    }\r\n    const adapt = context.data.root.Adapt = {};\r\n\r\n    let i, l, name;\r\n\r\n    const directImport = ['config', 'course'];\r\n    for (i = 0, l = directImport.length; i < l; i++) {\r\n      name = directImport[i];\r\n      // convert the model to a json object and add to the current context\r\n      adapt[name] = Adapt[name].toJSON();\r\n    }\r\n\r\n    const indexedImport = ['contentObjects', 'articles', 'blocks', 'components'];\r\n    for (i = 0, l = indexedImport.length; i < l; i++) {\r\n      name = indexedImport[i];\r\n      // convert the collection of models to an array of json objects\r\n      const importArray = Adapt[name].toJSON();\r\n      // convert the array of json models to an object indexed by id\r\n      const importIndex = {};\r\n      for (let i1 = 0, l1 = importArray.length; i1 < l1; i1++) {\r\n        const item = importArray[i1];\r\n        importIndex[item._id] = item;\r\n      }\r\n      // add the indexed object to the current context\r\n      adapt[name] = importIndex;\r\n    }\r\n\r\n    return '';\r\n\r\n  },\r\n\r\n  /**\r\n   * Allow components to fetch their component description.\r\n   *\r\n   * Creates an aria label using the `a11y_aria_label` helper containing\r\n   * the component description specified in the\r\n   * `_globals._component[componentName].ariaRegion`. This value is defined\r\n   * in the `properties.schema:globals.ariaRegion`.\r\n   *\r\n   * @param {string} [override]\r\n   * @returns {string}\r\n   */\r\n  component_description(override, context) {\r\n    if (!this._isA11yComponentDescriptionEnabled) {\r\n      return;\r\n    }\r\n    const isNotDefined = !this._globals._components?.['_' + this._component];\r\n    if (isNotDefined) {\r\n      return;\r\n    }\r\n    const hasOverride = (arguments.length > 1);\r\n    let description;\r\n    if (hasOverride) {\r\n      description = override;\r\n      description = helpers.compile(description, context);\r\n    } else {\r\n      description = this._globals._components['_' + this._component].ariaRegion;\r\n      description = helpers.compile(description, override);\r\n    }\r\n    if (!description) {\r\n      return;\r\n    }\r\n    return new Handlebars.SafeString('<div class=\"aria-label\">' + description + '</div>');\r\n  },\r\n\r\n  a11y_text(text) {\r\n    logging.deprecated('a11y_text is no longer required. https://tink.uk/understanding-screen-reader-interaction-modes/');\r\n    return text;\r\n  },\r\n\r\n  /**\r\n   * Handlebars helper for `a11y.normalize(htmls)`.\r\n   *\r\n   * @param {string} htmls Any htmls.\r\n   * @returns {string}\r\n   */\r\n  a11y_normalize(htmls) {\r\n    return a11y.normalize.apply(a11y, arguments);\r\n  },\r\n\r\n  /**\r\n   * Handlebars helper for `a11y.removeBreaks(htmls)`.\r\n   *\r\n   * @param {string} htmls Any htmls.\r\n   * @returns {string}\r\n   */\r\n  a11y_remove_breaks(htmls) {\r\n    return a11y.removeBreaks.apply(a11y, arguments);\r\n  },\r\n\r\n  /**\r\n   * Creates a div styled with tiny, transparent text.\r\n   * It it absolutely positioned.\r\n   * The text is not visibly readable but is read by screen readers.\r\n   *\r\n   * @param {string} htmls\r\n   * @returns {string}\r\n   */\r\n  a11y_aria_label(htmls) {\r\n    let values = Array.prototype.slice.call(arguments, 0, -1);\r\n    values = values.filter(Boolean);\r\n    return new Handlebars.SafeString('<div class=\"aria-label\">' + values.join(' ') + '</div>');\r\n  },\r\n\r\n  /**\r\n   * Creates a div styled with tiny, transparent text.\r\n   * It it relatively positioned.\r\n   * The text is not visibly readable but is read by screen readers.\r\n   *\r\n   * @param {string} htmls Aria label texts.\r\n   * @returns {string}\r\n   */\r\n  a11y_aria_label_relative(htmls) {\r\n    let values = Array.prototype.slice.call(arguments, 0, -1);\r\n    values = values.filter(Boolean);\r\n    return new Handlebars.SafeString('<div class=\"aria-label relative\">' + values.join(' ') + '</div>');\r\n  },\r\n\r\n  /**\r\n   * Creates a div styled with tiny, transparent text and `role\"=img\"`.\r\n   * It is used for representing an image to a screen reader user in an\r\n   * order which cannot be represented in the DOM in a way that achieves the\r\n   * styling objectives.\r\n   * It it absolutely positioned.\r\n   * The text is not visibly readable but is read by screen readers.\r\n   *\r\n   * @param {string} texts Aria label texts.\r\n   * @returns {string}\r\n   */\r\n  a11y_aria_image(texts) {\r\n    let values = Array.prototype.slice.call(arguments, 0, -1);\r\n    values = values.filter(Boolean);\r\n    return new Handlebars.SafeString('<div class=\"aria-label\" role=\"img\" aria-label=\"' + values.join(' ') + '\"></div>');\r\n  },\r\n\r\n  /**\r\n   * Returns an `a` tag which when receiving focus causes the focus to wrap\r\n   * to the top of the readable document.\r\n   *\r\n   * @returns {string}\r\n   */\r\n  a11y_wrap_focus() {\r\n    const cfg = Adapt.config.get('_accessibility');\r\n    if (cfg._isPopupWrapFocusEnabled === false) return '';\r\n    return new Handlebars.SafeString('<a class=\"a11y-focusguard a11y-ignore a11y-ignore-focus\" tabindex=\"0\" role=\"presentation\">&nbsp;</a>');\r\n  },\r\n\r\n  /**\r\n   * Creates the attributes for a subject heading text. `role=\"heading\"` and\r\n   * `aria-level=\"#\"`. It will use the `_ariaLevel` attribute from the current\r\n   * context if specified, a number if given as the `levelOrType` parameter,\r\n   * or a name from the configured aria levels hash.\r\n   *\r\n   * @param {number|string} level\r\n   * @returns {string}\r\n   * @deprecated Please use a11y_aria_level or a11y.ariaLevel accordingly\r\n   */\r\n  a11y_attrs_heading(level) {\r\n    logging.deprecated('a11y_attrs_heading, please use a11y_aria_level or a11y.ariaLevel');\r\n    const resolvedLevel = a11y.ariaLevel({\r\n      id: this._id ?? Array.from(arguments).lastItem?.data?.root?._id,\r\n      level,\r\n      override: this._ariaLevel\r\n    });\r\n    return new Handlebars.SafeString(' role=\"heading\" aria-level=\"${resolvedLevel}\" ');\r\n  },\r\n\r\n  /**\r\n   * Creates the value of the aria-level attribute for a subject heading text.\r\n   *\r\n   * @param {number|string} id The originating model id\r\n   * @param {number|string} level An explicit level number (\"1\"), a relative increment (\"@block+1\") or a default type name (\"menu\").\r\n   * @param {number|string} [override=null] An explicit level number (\"1\"), a relative increment (\"@block+1\") or a default type name (\"menu\"), usually passed through from the config to override the default.\r\n   * @returns {string}\r\n   */\r\n  a11y_aria_level(id, level, override = null) {\r\n    const resolvedLevel = a11y.ariaLevel({ id, level, override });\r\n    return resolvedLevel;\r\n  },\r\n\r\n  a11y_attrs_tabbable() {\r\n    logging.deprecated('a11y_attrs_tabbable should not be used. tabbable elements should be natively tabbable.');\r\n    return new Handlebars.SafeString(' role=\"region\" tabindex=\"0\" ');\r\n  },\r\n\r\n  /**\r\n   * Produce display text with alternative screen reader version.\r\n   * @param {string} visible Text that will be displayed on screen\r\n   * @param {string} alternatives Text that will be read by the screen reader (instead of what's displayed on screen)\r\n   * @example {{a11y_alt_text '$5bn' 'five billion dollars'}} or {{a11y_alt_text 'Here are some bits to read' 'There are' _items.length 'items to read'}}\r\n   */\r\n  a11y_alt_text(visible, alternatives) {\r\n    let values = Array.prototype.slice.call(arguments, 1, -1);\r\n    values = values.filter(Boolean);\r\n    return new Handlebars.SafeString('<span aria-hidden=\"true\">' + visible + '</span><span class=\"aria-label\">' + values.join(' ') + '</span>');\r\n  }\r\n\r\n};\r\n\r\n// Compatibility references\r\nObject.assign(helpers, {\r\n\r\n  if_value_equals() {\r\n    logging.deprecated('if_value_equals, use equals instead.');\r\n    return helpers.equals.apply(this, arguments);\r\n  },\r\n\r\n  numbers() {\r\n    logging.deprecated('numbers, use inc instead.');\r\n    return helpers.inc.apply(this, arguments);\r\n  },\r\n\r\n  lowerCase() {\r\n    logging.deprecated('lowerCase, use lowercase instead.');\r\n    return helpers.lowercase.apply(this, arguments);\r\n  }\r\n\r\n});\r\n\r\nfor (const name in helpers) {\r\n  Handlebars.registerHelper(name, helpers[name]);\r\n}\r\n\r\nexport default helpers;\r\n","import Adapt from 'core/js/adapt';\r\n\r\nclass HeadingView extends Backbone.View {\r\n\r\n  initialize() {\r\n    this.listenTo(Adapt.parentView, 'postRemove', this.remove);\r\n    this.listenTo(this.model, 'change:_isComplete', this.updateAria);\r\n    this.render();\r\n  }\r\n\r\n  render() {\r\n    const template = Handlebars.templates[this.constructor.template];\r\n    const data = this.model.toJSON();\r\n    const customHeadingType = this.$el.attr('data-a11y-heading-type');\r\n    if (customHeadingType) data._type = customHeadingType;\r\n    if (data._type === 'course') data._type = 'menu';\r\n    this.$el.html(template(data));\r\n    this.checkCompletion();\r\n  }\r\n\r\n  updateAria() {\r\n    const template = Handlebars.templates[this.constructor.template];\r\n    const data = this.model.toJSON();\r\n    const $rendered = $(`<div>${template(data)}</div>`);\r\n    this.$('.aria-label').html($rendered.find('.aria-label').html());\r\n    this.checkCompletion();\r\n  }\r\n\r\n  checkCompletion() {\r\n    const isComplete = this.model.get('_isComplete');\r\n    this.$el\r\n      .toggleClass('is-complete', isComplete)\r\n      .toggleClass('is-incomplete', !isComplete);\r\n  }\r\n\r\n}\r\n\r\nHeadingView.template = 'heading';\r\n\r\nexport default HeadingView;\r\n","import Adapt from 'core/js/adapt';\r\nimport HeadingView from 'core/js/views/headingView';\r\n\r\nclass Headings extends Backbone.Controller {\r\n\r\n  initialize() {\r\n    this.listenTo(Adapt, 'view:render', this.onViewRender);\r\n  }\r\n\r\n  onViewRender(view) {\r\n    const $headingSeats = view.$('.js-heading');\r\n    $headingSeats.each((index, el) => new HeadingView({ el, model: view.model }));\r\n  }\r\n\r\n}\r\n\r\nexport default new Headings();\r\n","import Adapt from 'core/js/adapt';\r\nimport a11y from 'core/js/a11y';\r\nimport location from 'core/js/location';\r\nimport router from 'core/js/router';\r\nimport startController from 'core/js/startController';\r\n\r\nclass NavigationView extends Backbone.View {\r\n\r\n  className() {\r\n    return 'nav';\r\n  }\r\n\r\n  events() {\r\n    return {\r\n      'click [data-event]': 'triggerEvent'\r\n    };\r\n  }\r\n\r\n  attributes() {\r\n    return {\r\n      role: 'navigation'\r\n    };\r\n  }\r\n\r\n  initialize() {\r\n    this.sortNavigationButtons = _.debounce(this.sortNavigationButtons.bind(this), 1);\r\n    this.listenToOnce(Adapt, {\r\n      'courseModel:dataLoading': this.remove\r\n    });\r\n    this.listenTo(Adapt, 'router:menu router:page', this.onNavigate);\r\n    this.preRender();\r\n  }\r\n\r\n  preRender() {\r\n    Adapt.trigger('navigationView:preRender', this);\r\n    this.render();\r\n  }\r\n\r\n  render() {\r\n    const template = Handlebars.templates[this.constructor.template];\r\n    this.$el.html(template({\r\n      _globals: Adapt.course.get('_globals'),\r\n      _accessibility: Adapt.config.get('_accessibility')\r\n    })).insertBefore('#app');\r\n\r\n    _.defer(() => {\r\n      Adapt.trigger('navigationView:postRender', this);\r\n    });\r\n\r\n    return this;\r\n  }\r\n\r\n  triggerEvent(event) {\r\n    event.preventDefault();\r\n    const currentEvent = $(event.currentTarget).attr('data-event');\r\n    Adapt.trigger('navigation:' + currentEvent);\r\n    switch (currentEvent) {\r\n      case 'backButton':\r\n        router.navigateToPreviousRoute();\r\n        break;\r\n      case 'homeButton':\r\n        router.navigateToHomeRoute();\r\n        break;\r\n      case 'parentButton':\r\n        router.navigateToParent();\r\n        break;\r\n      case 'skipNavigation':\r\n        this.skipNavigation();\r\n        break;\r\n      case 'returnToStart':\r\n        startController.returnToStartLocation();\r\n        break;\r\n    }\r\n  }\r\n\r\n  skipNavigation() {\r\n    a11y.focusFirst('.' + location._contentType);\r\n  }\r\n\r\n  onNavigate(model) {\r\n    this.hideNavigationButton(model);\r\n    this.sortNavigationButtons();\r\n  }\r\n\r\n  hideNavigationButton(model) {\r\n    const shouldHide = (model.get('_type') === 'course');\r\n    this.$('.nav__back-btn, .nav__home-btn').toggleClass('u-display-none', shouldHide);\r\n  }\r\n\r\n  sortNavigationButtons() {\r\n    const container = this.$('.nav__inner')[0];\r\n    const items = [...container.children];\r\n    items\r\n      .sort((a, b) => parseFloat($(a).attr('data-order') || 0) - parseFloat($(b).attr('data-order') || 0))\r\n      .forEach(item => container.appendChild(item));\r\n  }\r\n\r\n  showNavigationButton() {\r\n    this.$('.nav__back-btn, .nav__home-btn').removeClass('u-display-none');\r\n  }\r\n\r\n}\r\n\r\nNavigationView.template = 'nav';\r\n\r\nexport default NavigationView;\r\n","import Adapt from 'core/js/adapt';\r\nimport NavigationView from 'core/js/views/navigationView';\r\n\r\nclass NavigationController extends Backbone.Controller {\r\n\r\n  initialize() {\r\n    this.listenTo(Adapt, 'adapt:preInitialize', this.addNavigationBar);\r\n  }\r\n\r\n  addNavigationBar() {\r\n    const adaptConfig = Adapt.course.get('_navigation');\r\n\r\n    if (adaptConfig?._isDefaultNavigationDisabled) {\r\n      Adapt.trigger('navigation:initialize');\r\n      return;\r\n    }\r\n\r\n    Adapt.navigation = new NavigationView();// This should be triggered after 'app:dataReady' as plugins might want to manipulate the navigation\r\n  }\r\n\r\n}\r\n\r\nexport default new NavigationController();\r\n","import LockingModel from 'core/js/models/lockingModel';\r\n\r\nexport default class ItemModel extends LockingModel {\r\n\r\n  defaults() {\r\n    return {\r\n      _isActive: false,\r\n      _isVisited: false,\r\n      _score: 0\r\n    };\r\n  }\r\n\r\n  reset() {\r\n    this.set({ _isActive: false, _isVisited: false });\r\n  }\r\n\r\n  toggleActive(isActive = !this.get('_isActive')) {\r\n    this.set('_isActive', isActive);\r\n  }\r\n\r\n  toggleVisited(isVisited = !this.get('_isVisited')) {\r\n    this.set('_isVisited', isVisited);\r\n  }\r\n\r\n}\r\n","import ComponentModel from 'core/js/models/componentModel';\r\nimport ItemModel from 'core/js/models/itemModel';\r\n\r\nexport default class ItemsComponentModel extends ComponentModel {\r\n\r\n  toJSON() {\r\n    const json = super.toJSON();\r\n    // Make sure _items is updated from child collection\r\n    json._items = this.getChildren().toJSON();\r\n    return json;\r\n  }\r\n\r\n  init() {\r\n    this.setUpItems();\r\n    this.listenTo(this.getChildren(), {\r\n      all: this.onAll,\r\n      'change:_isActive': this.setVisitedStatus,\r\n      'change:_isVisited': this.checkCompletionStatus\r\n    });\r\n    super.init();\r\n  }\r\n\r\n  restoreUserAnswers() {\r\n    const booleanArray = this.get('_userAnswer');\r\n    if (!booleanArray) return;\r\n    this.getChildren().forEach((child, index) => child.set('_isVisited', booleanArray[index]));\r\n  }\r\n\r\n  storeUserAnswer() {\r\n    const booleanArray = this.getChildren().map(child => child.get('_isVisited'));\r\n    this.set('_userAnswer', booleanArray);\r\n  }\r\n\r\n  setUpItems() {\r\n    // see https://github.com/adaptlearning/adapt_framework/issues/2480\r\n    const items = this.get('_items') || [];\r\n    items.forEach((item, index) => (item._index = index));\r\n    this.setChildren(new Backbone.Collection(items, { model: ItemModel }));\r\n  }\r\n\r\n  getItem(index) {\r\n    return this.getChildren().findWhere({ _index: index });\r\n  }\r\n\r\n  getVisitedItems() {\r\n    return this.getChildren().where({ _isVisited: true });\r\n  }\r\n\r\n  getActiveItems() {\r\n    return this.getChildren().where({ _isActive: true });\r\n  }\r\n\r\n  getActiveItem() {\r\n    return this.getChildren().findWhere({ _isActive: true });\r\n  }\r\n\r\n  areAllItemsCompleted() {\r\n    return this.getVisitedItems().length === this.getChildren().length;\r\n  }\r\n\r\n  checkCompletionStatus() {\r\n    this.setVisitedStatus();\r\n    this.storeUserAnswer();\r\n    if (!this.areAllItemsCompleted()) return;\r\n    this.setCompletionStatus();\r\n  }\r\n\r\n  /**\r\n   * @param {string} [type] 'hard' resets _isComplete and _isInteractionComplete, 'soft' resets _isInteractionComplete only.\r\n   * @param {boolean} [canReset] Defaults to this.get('_canReset')\r\n   * @returns {boolean}\r\n   */\r\n  reset(type = 'hard', canReset = this.get('_canReset')) {\r\n    const wasReset = super.reset(type, canReset);\r\n    if (!wasReset) return false;\r\n    this.getChildren().each(item => item.reset());\r\n    return true;\r\n  }\r\n\r\n  resetActiveItems() {\r\n    this.getChildren().each(item => item.toggleActive(false));\r\n  }\r\n\r\n  setActiveItem(index) {\r\n    const item = this.getItem(index);\r\n    if (!item) return;\r\n\r\n    const activeItem = this.getActiveItem();\r\n    if (activeItem) activeItem.toggleActive(false);\r\n    item.toggleActive(true);\r\n  }\r\n\r\n}\r\n","import ItemsComponentModel from 'core/js/models/itemsComponentModel';\r\n\r\nexport default class CardsModel extends ItemsComponentModel {\r\n  defaults() {\r\n    return ItemsComponentModel.resultExtend('defaults', {\r\n      _animateItems: false,\r\n      _percentInviewVertical: 70,\r\n      _transitionSpeed: 200\r\n    });\r\n  }\r\n\r\n  toggleItemsState(index) {\r\n    const item = this.getItem(index);\r\n\r\n    item.toggleActive();\r\n    item.toggleVisited(true);\r\n\r\n  }\r\n}\r\n","import logging from 'core/js/logging';\r\nimport AdaptView from 'core/js/views/adaptView';\r\n\r\nclass ComponentView extends AdaptView {\r\n\r\n  attributes() {\r\n    if (!this.model.get('_isA11yRegionEnabled')) {\r\n      return AdaptView.resultExtend('attributes', {}, this);\r\n    }\r\n    return AdaptView.resultExtend('attributes', {\r\n      'aria-labelledby': this.model.get('_id') + '-heading',\r\n      role: 'region'\r\n    }, this);\r\n  }\r\n\r\n  className() {\r\n    return [\r\n      'component',\r\n      this.model.get('_component').toLowerCase(),\r\n      this.model.get('_id'),\r\n      this.model.get('_classes'),\r\n      this.setVisibility(),\r\n      this.setHidden(),\r\n      'is-' + this.model.get('_layout'),\r\n      (this.model.get('_isComplete') ? 'is-complete' : ''),\r\n      (this.model.get('_isOptional') ? 'is-optional' : '')\r\n    ].join(' ');\r\n  }\r\n\r\n  renderState() {\r\n    logging.removed('renderState is removed and moved to item title');\r\n  }\r\n\r\n  /**\r\n   * Allows components that want to use inview for completion to set that up\r\n   * @param {string} [inviewElementSelector] Allows to you to specify (via a selector) which DOM element to use for inview.\r\n   * Defaults to `'.component__inner'` if not supplied.\r\n   * @param {function} [callback] Allows you to specify what function is called when the component has been viewed, should\r\n   * you want to perform additional checks before setting the component to completed - see adapt-contrib-assessmentResults\r\n   * for an example. Defaults to `view.setCompletionStatus` if not specified.\r\n   */\r\n  setupInviewCompletion(inviewElementSelector = '.component__inner', callback = this.setCompletionStatus) {\r\n    this.$inviewElement = this.$(inviewElementSelector);\r\n    this.inviewCallback = callback;\r\n\r\n    this.$inviewElement.on('inview.componentView', this.onInview.bind(this));\r\n  }\r\n\r\n  removeInviewListener() {\r\n    if (!this.$inviewElement) return;\r\n    this.$inviewElement.off('inview.componentView');\r\n    this.$inviewElement = null;\r\n  }\r\n\r\n  onInview(event, visible, visiblePartX, visiblePartY) {\r\n    if (!visible) return;\r\n\r\n    switch (visiblePartY) {\r\n      case 'top':\r\n        this.hasSeenTop = true;\r\n        break;\r\n      case 'bottom':\r\n        this.hasSeenBottom = true;\r\n        break;\r\n      case 'both':\r\n        this.hasSeenTop = this.hasSeenBottom = true;\r\n    }\r\n\r\n    if (!this.hasSeenTop || !this.hasSeenBottom) return;\r\n\r\n    this.inviewCallback();\r\n\r\n    if (this.model.get('_isComplete')) {\r\n      this.removeInviewListener();\r\n    }\r\n  }\r\n\r\n  postRender() {}\r\n\r\n  remove() {\r\n    this.removeInviewListener();\r\n    super.remove();\r\n  }\r\n\r\n}\r\n\r\nComponentView.type = 'component';\r\n\r\nexport default ComponentView;\r\n","import ComponentView from 'core/js/views/componentView';\r\nclass CardsView extends ComponentView {\r\n  className() {\r\n    let classes = super.className();\r\n\r\n    if (this.model.get('_animateItems')) {\r\n      classes += ' is-animated';\r\n    }\r\n\r\n    return classes;\r\n  }\r\n\r\n  preRender() {\r\n    this.onClick = this.onClick.bind(this);\r\n    this.onKeyDown = this.onKeyDown.bind(this);\r\n  }\r\n\r\n  postRender() {\r\n    this.$('.cards__widget').imageready(() => {\r\n      this.setReadyStatus();\r\n      if (this.model.get('_autoSetHeight')) {\r\n        this.setHeight();\r\n      }\r\n    });\r\n    if (this.model.get('_animateItems')) {\r\n      this.$('.cards__widget').on('onscreen.animate', this.checkIfOnScreen.bind(this));\r\n    }\r\n\r\n    if (this.model.get('_setCompletionOn') !== 'inview') {\r\n      this.setupItems();\r\n    } else {\r\n      this.setupInviewCompletion();\r\n    }\r\n\r\n  }\r\n\r\n  setHeight() {\r\n    const $collection = $(this.el).find('.cards__item-description');\r\n    const maxHeight = this.getMaxScrollHeight($collection) + this.model.get('_scrollPadding');\r\n    $(this.el).find('.cards__item').css({ height: maxHeight });\r\n  }\r\n\r\n  getMaxScrollHeight($collection) {\r\n    let maxHeight = 0;\r\n    $collection.each(function() {\r\n      maxHeight = Math.max(maxHeight, $(this)[0].scrollHeight);\r\n    });\r\n    return maxHeight;\r\n  }\r\n\r\n  checkIfOnScreen({ currentTarget }, { percentInviewVertical }) {\r\n    if (percentInviewVertical < this.model.get('_percentInviewVertical')) return;\r\n\r\n    $(currentTarget).off('onscreen.animate');\r\n    this.animateItems();\r\n  }\r\n\r\n  setupItems() {\r\n    this.model.getChildren().forEach((item) => {\r\n      if (!item.get('_hasAction')) {\r\n        item.toggleVisited();\r\n      }\r\n    });\r\n  }\r\n\r\n  animateItems() {\r\n    const _transitionSpeed = this.model.get('_transitionSpeed');\r\n    this.model.getChildren().forEach((item, index) => {\r\n      setTimeout(() => item.set('_isAnimated', true), (_transitionSpeed * index));\r\n    });\r\n  }\r\n\r\n  onKeyDown(event) {\r\n    if (event.keyCode === 27) {\r\n      const itemIndex = $(event.currentTarget).closest('.cards__item').data('index');\r\n      const item = this.model.getItem(itemIndex);\r\n      if (item.get('_isActive')) {\r\n        this.model.toggleItemsState(itemIndex);\r\n      }\r\n    }\r\n  }\r\n\r\n  onClick(event) {\r\n    const $item = $(event.currentTarget).closest('.cards__item');\r\n    const itemIndex = $item.data('index');\r\n    this.model.toggleItemsState(itemIndex);\r\n  }\r\n\r\n  remove() {\r\n    this.$('.cards__widget').off('onscreen.animate');\r\n    super.remove();\r\n  }\r\n}\r\nCardsView.template = 'cards.jsx';\r\n\r\nexport default CardsView;\r\n","import Adapt from 'core/js/adapt';\r\nimport CardsModel from './CardsModel';\r\nimport CardsView from './CardsView';\r\n\r\nexport default Adapt.register('cards', {\r\n  model: CardsModel,\r\n  view: CardsView\r\n});\r\n","const BUTTON_STATE = ENUM([\r\n  'SUBMIT',\r\n  'CORRECT',\r\n  'INCORRECT',\r\n  'SHOW_CORRECT_ANSWER',\r\n  'HIDE_CORRECT_ANSWER',\r\n  'SHOW_FEEDBACK',\r\n  'RESET'\r\n]);\r\n\r\nexport default BUTTON_STATE;\r\n","import Adapt from 'core/js/adapt';\r\nimport a11y from 'core/js/a11y';\r\nimport BUTTON_STATE from 'core/js/enums/buttonStateEnum';\r\n\r\n// convert BUTTON_STATE to property name\r\nconst textPropertyName = {\r\n  SUBMIT: 'submit',\r\n  CORRECT: 'correct',\r\n  INCORRECT: 'incorrect',\r\n  SHOW_CORRECT_ANSWER: 'showCorrectAnswer',\r\n  HIDE_CORRECT_ANSWER: 'hideCorrectAnswer',\r\n  SHOW_FEEDBACK: 'showFeedback',\r\n  RESET: 'reset'\r\n};\r\n\r\nexport default class ButtonsView extends Backbone.View {\r\n\r\n  initialize(options) {\r\n    this.parent = options.parent;\r\n    this.listenTo(Adapt.parentView, 'postRemove', this.remove);\r\n    this.listenTo(this.model, {\r\n      'change:_buttonState': this.onButtonStateChanged,\r\n      'change:feedbackMessage': this.onFeedbackMessageChanged,\r\n      'change:_attemptsLeft': this.onAttemptsChanged,\r\n      'change:_canSubmit': this.onCanSubmitChange\r\n    });\r\n    this.render();\r\n  }\r\n\r\n  events() {\r\n    return {\r\n      'click .js-btn-action': 'onActionClicked',\r\n      'click .js-btn-feedback': 'onFeedbackClicked'\r\n    };\r\n  }\r\n\r\n  render() {\r\n    const data = this.model.toJSON();\r\n    const template = Handlebars.templates.buttons;\r\n    _.defer(() => {\r\n      this.postRender();\r\n      Adapt.trigger('buttonsView:postRender', this);\r\n    });\r\n    this.$el.html(template(data));\r\n  }\r\n\r\n  postRender() {\r\n    this.refresh();\r\n  }\r\n\r\n  checkResetSubmittedState() {\r\n    const isSubmitted = this.model.get('_isSubmitted');\r\n    if (isSubmitted) {\r\n      this.$el.addClass('is-submitted');\r\n      return;\r\n    }\r\n\r\n    this.$('.js-btn-marking, .js-btn-marking-label').removeClass('is-incorrect is-correct').addClass('u-display-none');\r\n    this.$el.removeClass('is-submitted');\r\n    this.model.set('feedbackMessage', undefined);\r\n    a11y.toggleEnabled(this.$('.js-btn-feedback'), false);\r\n  }\r\n\r\n  onActionClicked() {\r\n    const buttonState = BUTTON_STATE(this.model.get('_buttonState'));\r\n    this.trigger('buttons:stateUpdate', buttonState);\r\n    this.checkResetSubmittedState();\r\n\r\n    if (buttonState === BUTTON_STATE.SHOW_CORRECT_ANSWER) {\r\n      const correctAnswer = this.model.getCorrectAnswerAsText?.();\r\n      this.updateAnswerLiveRegion(correctAnswer);\r\n    }\r\n\r\n    if (buttonState === BUTTON_STATE.HIDE_CORRECT_ANSWER) {\r\n      const userAnswer = this.model.getUserAnswerAsText?.();\r\n      this.updateAnswerLiveRegion(userAnswer);\r\n    }\r\n  }\r\n\r\n  onFeedbackClicked() {\r\n    this.trigger('buttons:stateUpdate', BUTTON_STATE.SHOW_FEEDBACK);\r\n  }\r\n\r\n  onFeedbackMessageChanged(model, changedAttribute) {\r\n    if (changedAttribute && this.model.get('_canShowFeedback')) {\r\n      // enable feedback button\r\n      a11y.toggleEnabled(this.$('.js-btn-feedback'), true);\r\n      return;\r\n    }\r\n    // disable feedback button\r\n    a11y.toggleEnabled(this.$('.js-btn-feedback'), false);\r\n  }\r\n\r\n  onCanSubmitChange() {\r\n    this.onButtonStateChanged(this.model, this.model.get('_buttonState'));\r\n  }\r\n\r\n  onButtonStateChanged(model, changedAttribute) {\r\n\r\n    this.updateAttemptsCount();\r\n\r\n    // Use 'correct' instead of 'complete' to signify button state\r\n    const $buttonsAction = this.$('.js-btn-action');\r\n    const buttonState = BUTTON_STATE(changedAttribute);\r\n    if (changedAttribute === BUTTON_STATE.CORRECT || changedAttribute === BUTTON_STATE.INCORRECT) {\r\n      // Both 'correct' and 'incorrect' states have no model answer, so disable the submit button\r\n      a11y.toggleEnabled($buttonsAction, false);\r\n      return;\r\n    }\r\n\r\n    const propertyName = textPropertyName[buttonState.asString];\r\n    const ariaLabel = this.model.get('_buttons')['_' + propertyName].ariaLabel;\r\n    const buttonText = this.model.get('_buttons')['_' + propertyName].buttonText;\r\n\r\n    // Enable the button, make accessible and update aria labels and text\r\n    a11y.toggleEnabled($buttonsAction, this.model.get('_canSubmit'));\r\n    $buttonsAction.html(buttonText).attr('aria-label', ariaLabel);\r\n  }\r\n\r\n  checkFeedbackState() {\r\n    const canShowFeedback = this.model.get('_canShowFeedback');\r\n\r\n    this.$('.js-btn-action').toggleClass('is-full-width', !canShowFeedback);\r\n    this.$('.js-btn-feedback').toggleClass('u-display-none', !canShowFeedback);\r\n    this.$('.js-btn-marking, .js-btn-marking-label').toggleClass('is-full-width u-display-none', !canShowFeedback);\r\n  }\r\n\r\n  updateAttemptsCount() {\r\n    const isInteractionComplete = this.model.get('_isInteractionComplete');\r\n    const attemptsLeft = (this.model.get('_attemptsLeft')) ? this.model.get('_attemptsLeft') : this.model.get('_attempts');\r\n    const shouldDisplayAttempts = this.model.get('_shouldDisplayAttempts');\r\n    let attemptsString;\r\n\r\n    this.checkResetSubmittedState();\r\n\r\n    if (!isInteractionComplete && attemptsLeft >= 0) {\r\n      attemptsString = attemptsLeft + ' ';\r\n      attemptsString += attemptsLeft === 1 ?\r\n        this.model.get('_buttons').remainingAttemptText :\r\n        this.model.get('_buttons').remainingAttemptsText;\r\n    } else {\r\n      this.$('.js-display-attempts').addClass('u-visibility-hidden');\r\n      this.showMarking();\r\n    }\r\n\r\n    if (shouldDisplayAttempts) {\r\n      this.$('.js-insert-attempts-string').html(attemptsString);\r\n    }\r\n\r\n  }\r\n\r\n  /**\r\n   * Updates the ARIA 'live region' with the correct/user answer when that button\r\n   * is selected by the learner.\r\n   * @param {string} answer Textual representation of the correct/user answer\r\n   */\r\n  updateAnswerLiveRegion(answer) {\r\n    if (!answer) return;\r\n    this.$('.js-answer-live-region').html(answer);\r\n  }\r\n\r\n  showMarking() {\r\n    if (!this.model.shouldShowMarking) return;\r\n\r\n    const isCorrect = this.model.get('_isCorrect');\r\n    const ariaLabels = Adapt.course.get('_globals')._accessibility._ariaLabels;\r\n\r\n    const $marking = this.$('.js-btn-marking, .js-btn-marking-label')\r\n      .removeClass('u-display-none')\r\n      .addClass(isCorrect ? 'is-correct' : 'is-incorrect');\r\n\r\n    const $ariaLabel = this.$('.js-btn-marking-label');\r\n    const hasSpanAriaLabel = Boolean($ariaLabel.length);\r\n    if (!hasSpanAriaLabel) {\r\n      // Backward compability\r\n      $marking.attr('aria-label', isCorrect ? ariaLabels.answeredCorrectly : ariaLabels.answeredIncorrectly);\r\n      return;\r\n    }\r\n\r\n    $ariaLabel.html(isCorrect ? ariaLabels.answeredCorrectly : ariaLabels.answeredIncorrectly);\r\n  }\r\n\r\n  refresh() {\r\n    this.updateAttemptsCount();\r\n    this.checkResetSubmittedState();\r\n    this.checkFeedbackState();\r\n    this.onButtonStateChanged(null, this.model.get('_buttonState'));\r\n    this.onFeedbackMessageChanged(null, this.model.get('feedbackMessage'));\r\n  }\r\n\r\n}\r\n","import Adapt from 'core/js/adapt';\r\nimport components from 'core/js/components';\r\nimport ComponentModel from 'core/js/models/componentModel';\r\nimport BUTTON_STATE from 'core/js/enums/buttonStateEnum';\r\n\r\nclass QuestionModel extends ComponentModel {\r\n\r\n  /// ///\r\n  // Setup question types\r\n  /// /\r\n\r\n  // Used to set model defaults\r\n  defaults() {\r\n    // Extend from the ComponentModel defaults\r\n    return ComponentModel.resultExtend('defaults', {\r\n      _isQuestionType: true,\r\n      _shouldDisplayAttempts: false,\r\n      _shouldShowMarking: false,\r\n      _canShowModelAnswer: true,\r\n      _canShowFeedback: true,\r\n      _canShowMarking: true,\r\n      _canSubmit: true,\r\n      _isSubmitted: false,\r\n      _isCorrectAnswerShown: false,\r\n      _questionWeight: Adapt.config.get('_questionWeight'),\r\n      _hasItemScoring: false,\r\n      _items: []\r\n    });\r\n  }\r\n\r\n  // Extend from the ComponentModel trackable\r\n  trackable() {\r\n    return ComponentModel.resultExtend('trackable', [\r\n      '_isSubmitted',\r\n      '_score',\r\n      '_isCorrect',\r\n      '_attemptsLeft'\r\n    ]);\r\n  }\r\n\r\n  trackableType() {\r\n    return ComponentModel.resultExtend('trackableType', [\r\n      Boolean,\r\n      Number,\r\n      Boolean,\r\n      Number\r\n    ]);\r\n  }\r\n\r\n  /**\r\n   * Returns a string of the model type group.\r\n   * @returns {string}\r\n   */\r\n  getTypeGroup() {\r\n    return 'question';\r\n  }\r\n\r\n  init() {\r\n    this.setupDefaultSettings();\r\n    this.setLocking('_canSubmit', true);\r\n    this.updateRawScore();\r\n    super.init();\r\n  }\r\n\r\n  // Calls default methods to setup on questions\r\n  setupDefaultSettings() {\r\n    // Not sure this is needed anymore, keeping to maintain API\r\n    this.setupWeightSettings();\r\n    this.setupButtonSettings();\r\n  }\r\n\r\n  // Used to setup either global or local button text\r\n  setupButtonSettings() {\r\n    const globalButtons = Adapt.course.get('_buttons');\r\n\r\n    // Check if  '_buttons' attribute exists and if not use the globally defined buttons.\r\n    if (!this.has('_buttons')) {\r\n      this.set('_buttons', globalButtons);\r\n    } else {\r\n      // Check all the components buttons.\r\n      // If they are empty use the global defaults.\r\n      const componentButtons = this.get('_buttons');\r\n\r\n      for (const key in componentButtons) {\r\n        if (typeof componentButtons[key] === 'object') {\r\n          // Button text.\r\n          if (!componentButtons[key].buttonText && globalButtons[key].buttonText) {\r\n            componentButtons[key].buttonText = globalButtons[key].buttonText;\r\n          }\r\n\r\n          // ARIA labels.\r\n          if (!componentButtons[key].ariaLabel && globalButtons[key].ariaLabel) {\r\n            componentButtons[key].ariaLabel = globalButtons[key].ariaLabel;\r\n          }\r\n        }\r\n\r\n        if (!componentButtons[key] && globalButtons[key]) {\r\n          componentButtons[key] = globalButtons[key];\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  // Used to setup either global or local question weight/score\r\n  setupWeightSettings() {\r\n    // Not needed as handled by model defaults, keeping to maintain API\r\n  }\r\n\r\n  /// ///\r\n  // Submit process\r\n  /// /\r\n\r\n  // Use to check if the user is allowed to submit the question\r\n  // Maybe the user has to select an item?\r\n  canSubmit() {}\r\n\r\n  checkCanSubmit() {\r\n    this.set('_canSubmit', this.canSubmit(), { pluginName: 'adapt' });\r\n  }\r\n\r\n  // Used to update the amount of attempts the user has left\r\n  updateAttempts() {\r\n    const attemptsLeft = this.get('_attemptsLeft') || this.get('_attempts');\r\n\r\n    this.set('_attemptsLeft', attemptsLeft - 1);\r\n  }\r\n\r\n  // Used to set _isEnabled and _isSubmitted on the model\r\n  setQuestionAsSubmitted() {\r\n    this.set({\r\n      _isEnabled: false,\r\n      _isSubmitted: true,\r\n      _shouldShowMarking: this.shouldShowMarking\r\n    });\r\n  }\r\n\r\n  // Sets _isCorrect:true/false based upon isCorrect method below\r\n  markQuestion() {\r\n\r\n    if (this.isCorrect()) {\r\n      this.set('_isCorrect', true);\r\n    } else {\r\n      this.set('_isCorrect', false);\r\n    }\r\n\r\n    this.updateRawScore();\r\n\r\n  }\r\n\r\n  // Should return a boolean based upon whether to question is correct or not\r\n  isCorrect() {}\r\n\r\n  /**\r\n   * Used to set the legacy _score property based upon the _questionWeight and correctness\r\n   * @deprecated Please use get score, get maxScore and get minScore instead\r\n   */\r\n  setScore() {\r\n    const questionWeight = this.get('_questionWeight');\r\n    const answeredCorrectly = this.get('_isCorrect');\r\n    const score = answeredCorrectly ? questionWeight : 0;\r\n    this.set('_score', score);\r\n  }\r\n\r\n  updateRawScore() {\r\n    this.set({\r\n      _rawScore: this.score,\r\n      _maxScore: this.maxScore,\r\n      _minScore: this.minScore\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Returns a numerical value between maxScore and minScore\r\n   * @type {number}\r\n   */\r\n  get score() {\r\n    return this.get('_isCorrect') ? this.maxScore : 0;\r\n  }\r\n\r\n  /**\r\n   * @type {number}\r\n   */\r\n  get maxScore() {\r\n    return this.get('_questionWeight');\r\n  }\r\n\r\n  /**\r\n   * @type {number}\r\n   */\r\n  get minScore() {\r\n    return 0;\r\n  }\r\n\r\n  // Checks if the question should be set to complete\r\n  // Calls setCompletionStatus and adds complete classes\r\n  checkQuestionCompletion() {\r\n\r\n    const isComplete = (this.get('_isCorrect') || this.get('_attemptsLeft') === 0);\r\n\r\n    if (isComplete) {\r\n      this.setCompletionStatus();\r\n    }\r\n\r\n    return isComplete;\r\n\r\n  }\r\n\r\n  // Updates buttons based upon question state by setting\r\n  // _buttonState on the model which buttonsView listens to\r\n  updateButtons() {\r\n\r\n    const isInteractionComplete = this.get('_isInteractionComplete');\r\n    const isCorrect = this.get('_isCorrect');\r\n    const isEnabled = this.get('_isEnabled');\r\n    const buttonState = this.get('_buttonState');\r\n    const canShowModelAnswer = this.get('_canShowModelAnswer');\r\n\r\n    if (isInteractionComplete) {\r\n\r\n      if (isCorrect || !canShowModelAnswer) {\r\n        // Use correct instead of complete to signify button state\r\n        this.set('_buttonState', BUTTON_STATE.CORRECT);\r\n\r\n      } else {\r\n\r\n        switch (buttonState) {\r\n          case BUTTON_STATE.SUBMIT:\r\n          case BUTTON_STATE.HIDE_CORRECT_ANSWER:\r\n            this.set('_buttonState', BUTTON_STATE.SHOW_CORRECT_ANSWER);\r\n            break;\r\n          default:\r\n            this.set('_buttonState', BUTTON_STATE.HIDE_CORRECT_ANSWER);\r\n        }\r\n\r\n      }\r\n\r\n    } else {\r\n\r\n      if (isEnabled) {\r\n        this.set('_buttonState', BUTTON_STATE.SUBMIT);\r\n      } else {\r\n        this.set('_buttonState', BUTTON_STATE.RESET);\r\n      }\r\n    }\r\n\r\n  }\r\n\r\n  // Used to setup the correct, incorrect and partly correct feedback\r\n  setupFeedback() {\r\n    if (!this.has('_feedback')) return;\r\n\r\n    if (this.get('_isCorrect')) {\r\n      this.setupCorrectFeedback();\r\n    } else if (this.isPartlyCorrect()) {\r\n      this.setupPartlyCorrectFeedback();\r\n    } else {\r\n      this.setupIncorrectFeedback();\r\n    }\r\n  }\r\n\r\n  // Used by the question to determine if the question is incorrect or partly correct\r\n  // Should return a boolean\r\n  isPartlyCorrect() {}\r\n\r\n  setupCorrectFeedback() {\r\n    this.set({\r\n      feedbackTitle: this.getFeedbackTitle(),\r\n      feedbackMessage: Handlebars.compile(this.get('_feedback').correct)(this.toJSON())\r\n    });\r\n  }\r\n\r\n  setupPartlyCorrectFeedback() {\r\n    const feedback = this.get('_feedback')._partlyCorrect;\r\n\r\n    if (feedback?.final) {\r\n      this.setAttemptSpecificFeedback(feedback);\r\n    } else {\r\n      this.setupIncorrectFeedback();\r\n    }\r\n  }\r\n\r\n  setupIncorrectFeedback() {\r\n    this.setAttemptSpecificFeedback(this.get('_feedback')._incorrect);\r\n  }\r\n\r\n  setAttemptSpecificFeedback(feedback) {\r\n    const body = (this.get('_attemptsLeft') && feedback.notFinal) || feedback.final;\r\n\r\n    this.set({\r\n      feedbackTitle: this.getFeedbackTitle(),\r\n      feedbackMessage: Handlebars.compile(body)(this.toJSON())\r\n    });\r\n  }\r\n\r\n  getFeedbackTitle() {\r\n    const title = this.get('_feedback').title || this.get('displayTitle') || this.get('title') || '';\r\n    return Handlebars.compile(title)(this.toJSON());\r\n  }\r\n\r\n  /**\r\n   * Used to determine whether the learner is allowed to interact with the question component or not.\r\n   * @return {Boolean}\r\n   */\r\n  isInteractive() {\r\n    return !this.get('_isComplete') || (this.get('_isEnabled') && !this.get('_isSubmitted'));\r\n  }\r\n\r\n  checkIfResetOnRevisit() {\r\n    super.checkIfResetOnRevisit();\r\n    // Setup button view state\r\n    this.set('_buttonState', this.get('_isInteractionComplete')\r\n      ? BUTTON_STATE.HIDE_CORRECT_ANSWER\r\n      : BUTTON_STATE.SUBMIT\r\n    );\r\n  }\r\n\r\n  /**\r\n   * Reset the model to let the user have another go (not the same as attempts)\r\n   * @param {string} [type] 'hard' resets _isComplete and _isInteractionComplete, 'soft' resets _isInteractionComplete only.\r\n   * @param {boolean} [canReset] Defaults to this.get('_canReset')\r\n   * @returns {boolean}\r\n   */\r\n  reset(type = 'hard', canReset = this.get('_canReset')) {\r\n    const wasReset = super.reset(type, canReset);\r\n    if (!wasReset) return false;\r\n    const attempts = this.get('_attempts');\r\n    this.set({\r\n      _attemptsLeft: attempts,\r\n      _isCorrect: undefined,\r\n      _isCorrectAnswerShown: false,\r\n      _isSubmitted: false,\r\n      _buttonState: BUTTON_STATE.SUBMIT,\r\n      _shouldShowMarking: this.shouldShowMarking\r\n    });\r\n    return true;\r\n  }\r\n\r\n  // Reset question for subsequent attempts\r\n  setQuestionAsReset() {\r\n    this.set({\r\n      _isEnabled: true,\r\n      _isSubmitted: false,\r\n      _shouldShowMarking: this.shouldShowMarking\r\n    });\r\n    this.resetQuestion();\r\n  }\r\n\r\n  /**\r\n   * Used by the question view to reset the options of the component.\r\n   * This is triggered when the reset button is clicked so it shouldn't be a full reset.\r\n   */\r\n  resetQuestion() {}\r\n\r\n  refresh() {\r\n    this.trigger('question:refresh');\r\n  }\r\n\r\n  getButtonState() {\r\n    if (this.get('_isCorrect')) {\r\n      return BUTTON_STATE.CORRECT;\r\n    }\r\n\r\n    if (this.get('_attemptsLeft') === 0) {\r\n      return this.get('_canShowModelAnswer') ? BUTTON_STATE.SHOW_CORRECT_ANSWER : BUTTON_STATE.INCORRECT;\r\n    }\r\n\r\n    return this.get('_isSubmitted') ? BUTTON_STATE.RESET : BUTTON_STATE.SUBMIT;\r\n  }\r\n\r\n  // Returns an object specific to the question type, e.g. if the question\r\n  // is a 'choice' this should contain an object with:\r\n  // - correctResponsesPattern[]\r\n  // - choices[]\r\n  getInteractionObject() {\r\n    return {};\r\n  }\r\n\r\n  // Returns a string detailing how the user answered the question.\r\n  getResponse() {}\r\n\r\n  // Returns a string describing the type of interaction: \"choice\" and \"matching\" supported (see scorm wrapper)\r\n  getResponseType() {}\r\n\r\n  /**\r\n   * Called at the end of the onSubmitClicked view function.\r\n   */\r\n  onSubmitted() {\r\n    // Stores the current attempt state\r\n    if (this.get('_shouldStoreAttempts')) this.addAttemptObject();\r\n    this.set('_shouldShowMarking', this.shouldShowMarking);\r\n  }\r\n\r\n  /** @type {boolean} */\r\n  get shouldShowMarking() {\r\n    return (!this.isInteractive() && this.get('_canShowMarking') && this.get('_isInteractionComplete'));\r\n  }\r\n\r\n}\r\n\r\n// This abstract model needs to registered to support deprecated view-only questions\r\ncomponents.register('question', { model: QuestionModel });\r\n\r\nexport default QuestionModel;\r\n","import Adapt from 'core/js/adapt';\r\nimport ComponentView from 'core/js/views/componentView';\r\nimport ButtonsView from 'core/js/views/buttonsView';\r\nimport BUTTON_STATE from 'core/js/enums/buttonStateEnum';\r\nimport a11y from 'core/js/a11y';\r\nimport log from 'core/js/logging';\r\nimport data from 'core/js/data';\r\nimport location from 'core/js/location';\r\nimport 'core/js/models/questionModel';\r\n\r\nclass QuestionView extends ComponentView {\r\n\r\n  className() {\r\n    return [\r\n      'component',\r\n      'is-question',\r\n      this.model.get('_component').toLowerCase(),\r\n      this.model.get('_id'),\r\n      this.model.get('_classes'),\r\n      this.setVisibility(),\r\n      'is-' + this.model.get('_layout'),\r\n      (this.model.get('_isComplete') ? 'is-complete' : ''),\r\n      (this.model.get('_isOptional') ? 'is-optional' : ''),\r\n      (this.model.get('_canShowModelAnswer') ? 'can-show-model-answer' : ''),\r\n      (this.model.get('_canShowFeedback') ? 'can-show-feedback' : ''),\r\n      (this.model.get('_canShowMarking') ? 'can-show-marking' : '')\r\n    ].join(' ');\r\n  }\r\n\r\n  initialize(...args) {\r\n    // Allow isInteractive to be used in jsx templates\r\n    this.isInteractive = this.isInteractive.bind(this);\r\n    super.initialize(...args);\r\n  }\r\n\r\n  /**\r\n   * Used to determine whether the learner is allowed to interact with the question component or not.\r\n   * @return {Boolean}\r\n   * @deprecated since v6.0.5 please use this.model.isInteractive, this.model.get('_shouldShowMarking') or this.model.shouldShowMarking\r\n  */\r\n  isInteractive() {\r\n    log.deprecated('questionView.isInteractive please use this.model.isInteractive, this.model.get(\\'_shouldShowMarking\\') or this.model.shouldShowMarking');\r\n    return this.model.isInteractive();\r\n  }\r\n\r\n  preRender() {\r\n    // Setup listener for _isEnabled\r\n    this.listenTo(this.model, 'change:_isEnabled', this.onEnabledChanged);\r\n\r\n    this.listenTo(this.model, 'question:refresh', this.refresh);\r\n\r\n    // Checks to see if the question should be reset on revisit\r\n    if (this.checkIfResetOnRevisit !== QuestionView.prototype.checkIfResetOnRevisit) {\r\n      log.deprecated('QuestionView.checkIfResetOnRevisit, please use QuestionModel.checkIfResetOnRevisit');\r\n    }\r\n    this.checkIfResetOnRevisit();\r\n    _.defer(() => this.ensureLegacyLifecycleState());\r\n    // This method helps setup default settings on the model\r\n    this._runModelCompatibleFunction('setupDefaultSettings');\r\n    // Blank method for setting up questions before rendering\r\n    this.setupQuestion();\r\n  }\r\n\r\n  // Used in the question view to disabled the question when _isEnabled has been set to false\r\n  onEnabledChanged(model, changedAttribute) {\r\n\r\n    // If isEnabled == false add disabled class\r\n    // else remove disabled class\r\n    if (!changedAttribute) {\r\n      this.$('.component__widget').addClass('is-disabled');\r\n      this.disableQuestion();\r\n    } else {\r\n      this.$('.component__widget').removeClass('is-disabled');\r\n      this.enableQuestion();\r\n    }\r\n\r\n  }\r\n\r\n  // Used by the question to disable the question during submit and complete stages\r\n  disableQuestion() {}\r\n\r\n  // Used by the question to enable the question during interactions\r\n  enableQuestion() {}\r\n\r\n  /**\r\n   * Used to check if the question should reset on revisit\r\n   * @deprecated since core v6.0.1 Please use QuestionModel.checkIfResetOnRevisit\r\n   */\r\n  checkIfResetOnRevisit() {\r\n    const canReset = (this.model.get('_canReset') !== false);\r\n    const isResetOnRevisit = this.model.get('_isResetOnRevisit');\r\n    // If reset is enabled set defaults\r\n    // Call blank method for question to handle\r\n    if (!canReset || !isResetOnRevisit) return;\r\n    // Skip if calling the empty function definition\r\n    if (this.resetQuestionOnRevisit === QuestionView.prototype.resetQuestionOnRevisit) return;\r\n    // Warn if using a legacy resetQuestionOnRevisit\r\n    log.deprecated('QuestionView.resetQuestionOnRevisit, please QuestionModel.reset');\r\n    // Defer is added to allow the component to render\r\n    _.defer(() => {\r\n      this.resetQuestionOnRevisit(isResetOnRevisit);\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Ensure the view is in the correct state on first render\r\n   * @private\r\n   */\r\n  ensureLegacyLifecycleState() {\r\n    const isInteractionComplete = this.model.get('_isInteractionComplete');\r\n    if (isInteractionComplete) {\r\n      this.onHideCorrectAnswerClicked();\r\n      return;\r\n    }\r\n    this.onResetClicked();\r\n  }\r\n\r\n  /**\r\n   * Used by the question to reset the question when revisiting the component\r\n   * @param {string} type\r\n   * @deprecated since core v6.0.1 Please use QuestionModel.reset\r\n   */\r\n  resetQuestionOnRevisit(type) {}\r\n\r\n  // Left blank for question setup - should be used instead of preRender\r\n  setupQuestion() {}\r\n\r\n  // Calls default methods to setup after the question is rendered\r\n  postRender() {\r\n    this.addButtonsView();\r\n    this.onQuestionRendered();\r\n  }\r\n\r\n  // Used to setup buttonsView and sets up the internal events for the question\r\n  addButtonsView() {\r\n    this.buttonsView = new ButtonsView({ model: this.model, el: this.$('.btn__container') });\r\n\r\n    this.listenTo(this.buttonsView, 'buttons:stateUpdate', this.onButtonStateUpdate);\r\n\r\n  }\r\n\r\n  onButtonStateUpdate(buttonState) {\r\n\r\n    switch (buttonState) {\r\n      case BUTTON_STATE.SUBMIT:\r\n        this.onSubmitClicked();\r\n        break;\r\n      case BUTTON_STATE.RESET:\r\n        this.onResetClicked();\r\n        break;\r\n      case BUTTON_STATE.SHOW_CORRECT_ANSWER:\r\n        this.onShowCorrectAnswerClicked();\r\n        break;\r\n      case BUTTON_STATE.HIDE_CORRECT_ANSWER:\r\n        this.onHideCorrectAnswerClicked();\r\n        break;\r\n      case BUTTON_STATE.SHOW_FEEDBACK:\r\n        this.showFeedback();\r\n        break;\r\n    }\r\n\r\n  }\r\n\r\n  // Blank method used just like postRender is for presentational components\r\n  onQuestionRendered() {}\r\n\r\n  // Triggered when the submit button is clicked\r\n  onSubmitClicked() {\r\n    // canSubmit is setup in questions and should return a boolean\r\n    // If the question stops the user form submitting - show instruction error\r\n    // and give a blank method, onCannotSubmit to the question\r\n    const canSubmit = this._runModelCompatibleFunction('canSubmit');\r\n\r\n    if (!canSubmit) {\r\n      this.showInstructionError();\r\n      this.onCannotSubmit();\r\n      return;\r\n    }\r\n\r\n    // Used to update the amount of attempts the question has\r\n    this._runModelCompatibleFunction('updateAttempts');\r\n\r\n    // Used to set attributes on the model after being submitted\r\n    // Also adds a class of submitted\r\n    this._runModelCompatibleFunction('setQuestionAsSubmitted');\r\n\r\n    // Used to store the users answer for later\r\n    // This is a blank method given to the question\r\n    this._runModelCompatibleFunction('storeUserAnswer');\r\n\r\n    // Used to set question as correct:true/false\r\n    // Calls isCorrect which is blank for the question\r\n    // to fill out and return a boolean\r\n    this._runModelCompatibleFunction('markQuestion', 'isCorrect');\r\n\r\n    // Used by the question to set the score on the model\r\n    this._runModelCompatibleFunction('setScore');\r\n\r\n    // Used to check if the question is complete\r\n    // Triggers setCompletionStatus and adds class to widget\r\n    this._runModelCompatibleFunction('checkQuestionCompletion');\r\n\r\n    // Used by the question to display markings on the component\r\n    if (this.model.shouldShowMarking) {\r\n      this.showMarking();\r\n    }\r\n\r\n    this.recordInteraction();\r\n\r\n    // Used to setup the feedback by checking against\r\n    // question isCorrect or isPartlyCorrect\r\n    this._runModelCompatibleFunction('setupFeedback');\r\n\r\n    // Used to trigger an event so plugins can display feedback\r\n    // Do this before updating the buttons so that the focus can be\r\n    // shifted immediately\r\n    this.showFeedback();\r\n\r\n    // Force height re-calculations before the submit button\r\n    // becomes disabled.\r\n    $(window).resize();\r\n\r\n    // Used to update buttonsView based upon question state\r\n    // Update buttons happens before showFeedback to preserve tabindexes and after setupFeedback to allow buttons to use feedback attribute\r\n    this._runModelCompatibleFunction('updateButtons');\r\n\r\n    this.model.onSubmitted();\r\n    this.onSubmitted();\r\n  }\r\n\r\n  showInstructionError() {\r\n    Adapt.trigger('questionView:showInstructionError', this);\r\n  }\r\n\r\n  // Blank method for question to fill out when the question cannot be submitted\r\n  onCannotSubmit() {}\r\n\r\n  // Blank method for question to fill out when the question was successfully submitted\r\n  onSubmitted() {}\r\n\r\n  // Used to set _isEnabled and _isSubmitted on the model\r\n  // Also adds a 'submitted' class to the widget\r\n  setQuestionAsSubmitted() {\r\n    this.model.setQuestionAsSubmitted();\r\n    this.$('.component__widget').addClass('is-submitted');\r\n  }\r\n\r\n  // This is important and should give the user feedback on how they answered the question\r\n  // Normally done through ticks and crosses by adding classes\r\n  showMarking() {}\r\n\r\n  // Checks if the question should be set to complete\r\n  // Calls setCompletionStatus and adds complete classes\r\n  checkQuestionCompletion() {\r\n\r\n    const isComplete = this.model.checkQuestionCompletion();\r\n\r\n    if (isComplete) {\r\n      this.$('.component__widget').addClass('is-complete show-user-answer');\r\n    }\r\n\r\n  }\r\n\r\n  recordInteraction() {\r\n    if (this.model.get('_recordInteraction') === true || !this.model.has('_recordInteraction')) {\r\n      Adapt.trigger('questionView:recordInteraction', this);\r\n    }\r\n  }\r\n\r\n  // Used to show feedback based upon whether _canShowFeedback is true\r\n  showFeedback() {\r\n\r\n    if (this.model.get('_canShowFeedback')) {\r\n      Adapt.trigger('questionView:showFeedback', this);\r\n    } else {\r\n      Adapt.trigger('questionView:disabledFeedback', this);\r\n    }\r\n\r\n  }\r\n\r\n  onResetClicked() {\r\n    this.setQuestionAsReset();\r\n\r\n    this._runModelCompatibleFunction('resetUserAnswer');\r\n\r\n    this.model.checkCanSubmit();\r\n\r\n    this._runModelCompatibleFunction('updateButtons');\r\n\r\n    // onResetClicked is called as part of the checkIfResetOnRevisit\r\n    // function and as a button click. if the view is already rendered,\r\n    // then the button was clicked, focus on the first tabbable element\r\n    if (!this.model.get('_isReady')) return;\r\n    // Attempt to get the current page location\r\n    const currentModel = data.findById(location._currentId);\r\n    // Make sure the page is ready\r\n    if (!currentModel?.get('_isReady')) return;\r\n    // Focus on the first readable item in this element\r\n    a11y.focusNext(this.$el, { preventScroll: true });\r\n  }\r\n\r\n  setQuestionAsReset() {\r\n    this.model.setQuestionAsReset();\r\n    this.resetQuestion();\r\n    this.$('.component__widget').removeClass('is-submitted');\r\n  }\r\n\r\n  /**\r\n   * Used by the question view to reset the look and feel of the component.\r\n   * This is triggered when the reset button is clicked so it shouldn't be a full reset.\r\n   */\r\n  resetQuestion() {}\r\n\r\n  refresh() {\r\n    this.model.set('_buttonState', this.model.getButtonState());\r\n\r\n    if (this.model.shouldShowMarking) {\r\n      this.showMarking();\r\n    }\r\n\r\n    if (this.buttonsView) {\r\n      _.defer(this.buttonsView.refresh.bind(this.buttonsView));\r\n    }\r\n  }\r\n\r\n  onShowCorrectAnswerClicked() {\r\n    this.setQuestionAsShowCorrect();\r\n\r\n    this._runModelCompatibleFunction('updateButtons');\r\n\r\n    this.showCorrectAnswer();\r\n  }\r\n\r\n  setQuestionAsShowCorrect() {\r\n    this.$('.component__widget')\r\n      .addClass('is-submitted show-correct-answer')\r\n      .removeClass('show-user-answer');\r\n  }\r\n\r\n  // Used by the question to display the correct answer to the user\r\n  showCorrectAnswer() {\r\n    this.model.set('_isCorrectAnswerShown', true);\r\n  }\r\n\r\n  onHideCorrectAnswerClicked() {\r\n    this.setQuestionAsHideCorrect();\r\n\r\n    this._runModelCompatibleFunction('updateButtons');\r\n\r\n    this.hideCorrectAnswer();\r\n  }\r\n\r\n  setQuestionAsHideCorrect() {\r\n    this.$('.component__widget')\r\n      .addClass('is-submitted show-user-answer')\r\n      .removeClass('show-correct-answer');\r\n  }\r\n\r\n  // Used by the question to display the users answer and\r\n  // hide the correct answer\r\n  // Should use the values stored in storeUserAnswer\r\n  hideCorrectAnswer() {\r\n    this.model.set('_isCorrectAnswerShown', false);\r\n  }\r\n\r\n  // Time elapsed between the time the interaction was made available to the learner for response and the time of the first response\r\n  getLatency() {\r\n    return null;\r\n  }\r\n\r\n  // This function is overridden if useQuestionModeOnly: false. see below.\r\n  _runModelCompatibleFunction(name, lookForViewOnlyFunction) {\r\n    return this.model[name](); // questionModel Only\r\n  }\r\n}\r\n\r\nQuestionView._isQuestionType = true;\r\n\r\n/* BACKWARDS COMPATIBILITY SECTION\r\n* This section below is only for compatibility between the separated questionView+questionModel and the old questionView\r\n* Remove this section in when all components use questionModel and there is no need to have model behaviour in the questionView\r\n*/\r\n\r\nclass ViewOnlyQuestionViewCompatibilityLayer extends QuestionView {\r\n\r\n  /* All of these functions have been moved to the questionModel.js file.\r\n    * On the rare occasion that they have not been overridden by the component and\r\n          that they call the view only questionView version,\r\n          these functions are included as redirects to the new Question Model.\r\n          It is very unlikely that these are needed but they are included to ensure compatibility.\r\n    * If you need to override these in your component you should now make and register a component model.\r\n    * Please remove them from your question component's view.\r\n  */\r\n\r\n  // Returns an object specific to the question type.\r\n  getInteractionObject() {\r\n    log.deprecated('QuestionView.getInteractionObject, please use QuestionModel.getInteractionObject');\r\n    return this.model.getInteractionObject();\r\n  }\r\n\r\n  // Retturns a string detailing how the user answered the question.\r\n  getResponse() {\r\n    log.deprecated('QuestionView.getInteractionObject, please use QuestionModel.getInteractionObject');\r\n    return this.model.getResponse();\r\n  }\r\n\r\n  // Returns a string describing the type of interaction: \"choice\" and \"matching\" supported (see scorm wrapper)\r\n  getResponseType() {\r\n    log.deprecated('QuestionView.getResponseType, please use QuestionModel.getResponseType');\r\n    return this.model.getResponseType();\r\n  }\r\n\r\n  // Calls default methods to setup on questions\r\n  setupDefaultSettings() {\r\n    log.deprecated('QuestionView.setupDefaultSettings, please use QuestionModel.setupDefaultSettings');\r\n    return this.model.setupDefaultSettings();\r\n  }\r\n\r\n  // Used to setup either global or local button text\r\n  setupButtonSettings() {\r\n    log.deprecated('QuestionView.setupButtonSettings, please use QuestionModel.setupButtonSettings');\r\n    return this.model.setupButtonSettings();\r\n  }\r\n\r\n  // Used to setup either global or local question weight/score\r\n  setupWeightSettings() {\r\n    log.deprecated('QuestionView.setupWeightSettings, please use QuestionModel.setupWeightSettings');\r\n    return this.model.setupWeightSettings();\r\n  }\r\n\r\n  // Use to check if the user is allowed to submit the question\r\n  // Maybe the user has to select an item?\r\n  canSubmit() {\r\n    log.deprecated('QuestionView.canSubmit, please use QuestionModel.canSubmit');\r\n    return this.model.canSubmit();\r\n  }\r\n\r\n  // Used to update the amount of attempts the user has left\r\n  updateAttempts() {\r\n    log.deprecated('QuestionView.updateAttempts, please use QuestionModel.updateAttempts');\r\n    return this.model.updateAttempts();\r\n  }\r\n\r\n  // This is important for returning or showing the users answer\r\n  // This should preserve the state of the users answers\r\n  storeUserAnswer() {\r\n    log.deprecated('QuestionView.storeUserAnswer, please use QuestionModel.storeUserAnswer');\r\n    return this.model.storeUserAnswer();\r\n  }\r\n\r\n  // Used by the question view to reset the stored user answer\r\n  resetUserAnswer() {\r\n    log.deprecated('QuestionView.resetUserAnswer, please use QuestionModel.resetUserAnswer');\r\n    return this.model.resetUserAnswer();\r\n  }\r\n\r\n  // Sets _isCorrect:true/false based upon isCorrect method below\r\n  markQuestion() {\r\n\r\n    if (this._isInViewOnlyCompatibleMode('isCorrect')) {\r\n\r\n      if (this.isCorrect()) {\r\n        this.model.set('_isCorrect', true);\r\n      } else {\r\n        this.model.set('_isCorrect', false);\r\n      }\r\n\r\n      this.model.set({\r\n        _rawScore: this.model.get('_isCorrect') ? this.model.get('_questionWeight') : 0,\r\n        _maxScore: this.model.get('_questionWeight'),\r\n        _minScore: 0\r\n      });\r\n\r\n    } else {\r\n      return this.model.markQuestion();\r\n    }\r\n  }\r\n\r\n  // Should return a boolean based upon whether to question is correct or not\r\n  isCorrect() {\r\n    log.deprecated('QuestionView.isCorrect, please use QuestionModel.isCorrect');\r\n    return this.model.isCorrect();\r\n  }\r\n\r\n  // Used to set the score based upon the _questionWeight\r\n  setScore() {\r\n    log.deprecated('QuestionView.setScore, please use QuestionModel.setScore');\r\n    return this.model.setScore();\r\n  }\r\n\r\n  // Updates buttons based upon question state by setting\r\n  // _buttonState on the model which buttonsView listens to\r\n  updateButtons() {\r\n    log.deprecated('QuestionView.updateButtons, please use QuestionModel.updateButtons');\r\n    return this.model.updateButtons();\r\n  }\r\n\r\n  // Used to setup the correct, incorrect and partly correct feedback\r\n  setupFeedback() {\r\n\r\n    if (this._isInViewOnlyCompatibleMode('isPartlyCorrect')) {\r\n\r\n      // Use view based feedback where necessary\r\n      if (this.model.get('_isCorrect')) {\r\n        this._runModelCompatibleFunction('setupCorrectFeedback');\r\n      } else if (this.isPartlyCorrect()) {\r\n        this._runModelCompatibleFunction('setupPartlyCorrectFeedback');\r\n      } else {\r\n        this._runModelCompatibleFunction('setupIncorrectFeedback');\r\n      }\r\n\r\n    } else {\r\n      // Use model based feedback\r\n      this.model.setupFeedback();\r\n    }\r\n\r\n  }\r\n\r\n  // Used by the question to determine if the question is incorrect or partly correct\r\n  // Should return a boolean\r\n  isPartlyCorrect() {\r\n    log.deprecated('QuestionView.isPartlyCorrect, please use QuestionModel.isPartlyCorrect');\r\n    return this.model.isPartlyCorrect();\r\n  }\r\n\r\n  setupCorrectFeedback() {\r\n    log.deprecated('QuestionView.setupCorrectFeedback, please use QuestionModel.setupCorrectFeedback');\r\n    return this.model.setupCorrectFeedback();\r\n  }\r\n\r\n  setupPartlyCorrectFeedback() {\r\n    log.deprecated('QuestionView.setupPartlyCorrectFeedback, please use QuestionModel.setupPartlyCorrectFeedback');\r\n    return this.model.setupPartlyCorrectFeedback();\r\n  }\r\n\r\n  setupIncorrectFeedback() {\r\n    log.deprecated('QuestionView.setupIncorrectFeedback, please use QuestionModel.setupIncorrectFeedback');\r\n    return this.model.setupIncorrectFeedback();\r\n  }\r\n\r\n  // Helper functions for compatibility layer\r\n  _runModelCompatibleFunction(name, lookForViewOnlyFunction) {\r\n    if (this._isInViewOnlyCompatibleMode(name, lookForViewOnlyFunction)) {\r\n      return this[name](); // questionView\r\n    } else {\r\n      return this.model[name](); // questionModel\r\n    }\r\n  }\r\n\r\n  _isInViewOnlyCompatibleMode(name, lookForViewOnlyFunction) {\r\n    // return false uses the model function questionModel\r\n    // return true uses the view only function questionView\r\n\r\n    const checkForFunction = (lookForViewOnlyFunction || name);\r\n\r\n    // if the function does NOT exist on the view at all, use the model only\r\n    if (!this.constructor.prototype[checkForFunction]) return false; // questionModel\r\n\r\n    // if the function DOES exist on the view and MATCHES the compatibility function above, use the model only\r\n    const hasCompatibleVersion = (Object.prototype.hasOwnProperty.call(ViewOnlyQuestionViewCompatibilityLayer.prototype, checkForFunction));\r\n    const usingCompatibleVersion = (this.constructor.prototype[checkForFunction] === ViewOnlyQuestionViewCompatibilityLayer.prototype[checkForFunction]);\r\n    if (hasCompatibleVersion && usingCompatibleVersion) {\r\n      switch (checkForFunction) {\r\n        case 'setupFeedback':\r\n        case 'markQuestion':\r\n          return true; // questionView\r\n      }\r\n      return false; // questionModel\r\n    }\r\n\r\n    // if the function DOES exist on the view and does NOT match the compatibility function above, use the view function\r\n    return true; // questionView\r\n  }\r\n\r\n};\r\n\r\n// return question view class extended with the compatibility layer\r\nexport default ViewOnlyQuestionViewCompatibilityLayer;\r\n\r\n/* END OF BACKWARDS COMPATIBILITY SECTION */\r\n","\r\nimport QuestionView from 'core/js/views/questionView';\r\nimport Adapt from 'core/js/adapt';\r\nclass ChooseView extends QuestionView {\r\n\r\n  initialize(...args) {\r\n    this.onKeyPress = this.onKeyPress.bind(this);\r\n    this.onItemOptionSelect = this.onItemOptionSelect.bind(this);\r\n    super.initialize(...args);\r\n  }\r\n\r\n  setupQuestion() {\r\n    this.model.setupRandomisation();\r\n  }\r\n\r\n  onQuestionRendered() {\r\n    this.$('.choose__item').imageready(() => this.setReadyStatus());\r\n    this.setupItems();\r\n  }\r\n\r\n  setupItems() {\r\n    const _spaceSize = this.model.get('_spaceSize');\r\n    let _spaces = '';\r\n    for (let i = 0; i < _spaceSize; i++) {\r\n      _spaces += '&nbsp;';\r\n    }\r\n    this.model.get('_items')?.forEach((item) => {\r\n      let _choose = `<span class=\"choose__replace\">${_spaces}</span>`;\r\n      this.updateItem(item, _choose, false);\r\n      if (item._selected) {\r\n        _choose = this.getChoose(item);\r\n        this.updateItem(item, _choose, true);\r\n      }\r\n\r\n    });\r\n\r\n  }\r\n\r\n  getChoose(item) {\r\n    const _hasGraphic = item._selected._graphic && item._selected._graphic.large;\r\n    if (!_hasGraphic) {\r\n      return item._selected.text;\r\n    }\r\n    const _graphic = Adapt.device.screenSize !== 'small' ? item._selected._graphic.large : item._selected._graphic.small;\r\n    return `<img src=\"${_graphic}\"/>`;\r\n  }\r\n\r\n  updateItem(item, answer, selected) {\r\n    const $item = this.getItemElement(item);\r\n    if (!selected) {\r\n      const _text = item.text.replace('[]', answer);\r\n      return $item.find('.choose__item-text').html(_text);\r\n    }\r\n    $item.find('.choose__item-text .choose__replace').html(answer);\r\n  }\r\n\r\n  getItemElement(item) {\r\n    if (!item) return;\r\n    const index = item._index;\r\n    return this.$('.choose__item').filter(`[data-index=\"${index}\"]`);\r\n  }\r\n\r\n  onKeyPress(event) {\r\n\r\n    if (event.which !== 13) return;\r\n    this.onItemOptionSelect(event);\r\n  }\r\n\r\n  onItemOptionSelect(event) {\r\n    if (!this.model.isInteractive()) return;\r\n\r\n    const $input = $(event.currentTarget);\r\n    const itemIndex = $input.data('adapt-index');\r\n    const optionIndex = parseInt($input.val());\r\n    this.model.setOptionSelected(itemIndex, optionIndex, true);\r\n    this.model.set('_highlighted', `${itemIndex}-${optionIndex}`);\r\n\r\n    const item = this.model.get('_items')[itemIndex];\r\n\r\n    const _choose = this.getChoose(item);\r\n    this.updateItem(item, _choose, true);\r\n  }\r\n\r\n  resetQuestion() {\r\n    this.$('.choose__item').removeClass('is-correct is-incorrect is-selected');\r\n    this.$('.choose__item-choice').removeClass('is-correct is-incorrect is-selected');\r\n    this.model.set('_isAtLeastOneCorrectSelection', false);\r\n\r\n    this.model.get('_items').forEach(item => {\r\n      const $item = this.getItemElement(item);\r\n      $item.find('.choose__item-text .choose__replace').replaceWith('[]');\r\n      // if (item._isCorrect) return;\r\n      item._options.forEach(option => (option._isSelected = false));\r\n      item._selected = null;\r\n\r\n    });\r\n\r\n    this.setupItems();\r\n  }\r\n\r\n}\r\nChooseView.template = 'choose.jsx';\r\n\r\nexport default ChooseView;\r\n","\r\nimport Adapt from 'core/js/adapt';\r\nimport QuestionModel from 'core/js/models/questionModel';\r\n\r\nexport default class ChooseModel extends QuestionModel {\r\n\r\n  init() {\r\n    super.init();\r\n\r\n    this.setupQuestionItemIndexes();\r\n  }\r\n\r\n  reset(type = 'hard', canReset = this.get('_canReset')) {\r\n    const wasReset = super.reset(type, canReset);\r\n    if (!wasReset) return false;\r\n    this.set('_isAtLeastOneCorrectSelection', false);\r\n    this.get('_items').forEach(item => {\r\n      item._options.forEach(option => (option._isSelected = false));\r\n      item._selected = null;\r\n    });\r\n    return true;\r\n  }\r\n\r\n  setupQuestionItemIndexes() {\r\n\r\n    this.get('_items').forEach((item, index) => {\r\n      if (item._index === undefined) {\r\n        item._index = index;\r\n        item._selected = false;\r\n\r\n      }\r\n      if (item._options === undefined) {\r\n        item._options = this.get('_choices').map(choice => {\r\n          return {\r\n            text: choice.text,\r\n            _graphic: choice._graphic\r\n          };\r\n        });\r\n      }\r\n      item._options.forEach((option, index) => {\r\n\r\n        if (option._index !== undefined) return;\r\n        option._index = index;\r\n        option._isSelected = false;\r\n      });\r\n\r\n    });\r\n  }\r\n\r\n  setupRandomisation() {\r\n    if (!this.get('_isRandom') || !this.get('_isEnabled')) return;\r\n\r\n    this.get('_items').forEach(item => (item._options = _.shuffle(item._options)));\r\n  }\r\n\r\n  restoreUserAnswers() {\r\n    if (!this.get('_isSubmitted')) return;\r\n\r\n    const userAnswer = this.get('_userAnswer');\r\n\r\n    this.get('_items').forEach(item => {\r\n      item._options.forEach(option => {\r\n        if (option._index !== userAnswer[item._index]) return;\r\n        option._isSelected = true;\r\n        item._selected = option;\r\n      });\r\n    });\r\n\r\n    this.setQuestionAsSubmitted();\r\n    this.checkCanSubmit();\r\n    this.markQuestion();\r\n    this.setScore();\r\n    this.setupFeedback();\r\n  }\r\n\r\n  canSubmit() {\r\n    const canSubmit = this.get('_items').every(({ _options }) => {\r\n      return _options.some(({ _isSelected }) => _isSelected);\r\n    });\r\n\r\n    return canSubmit;\r\n  }\r\n\r\n  setOptionSelected(itemIndex, optionIndex, isSelected) {\r\n    const item = this.get('_items')[itemIndex];\r\n\r\n    if (isNaN(optionIndex)) {\r\n      item._options.forEach(option => (option._isSelected = false));\r\n      item._selected = null;\r\n      return this.checkCanSubmit();\r\n    }\r\n    item._options.forEach((option) => {\r\n      option._isSelected = false;\r\n    });\r\n    const option = item._options.find(({ _index }) => _index === optionIndex);\r\n    option._isSelected = isSelected;\r\n    item._selected = option;\r\n\r\n    this.checkCanSubmit();\r\n  }\r\n\r\n  storeUserAnswer() {\r\n    const userAnswer = new Array(this.get('_items').length);\r\n\r\n    this.get('_items').forEach(item => {\r\n      const optionIndex = item._options.findIndex(({ _isSelected }) => _isSelected);\r\n\r\n      userAnswer[item._index] = item._options[optionIndex]._index;\r\n    });\r\n    this.set({\r\n      _userAnswer: userAnswer\r\n    });\r\n  }\r\n\r\n  isCorrect() {\r\n    const numberOfCorrectAnswers = this.get('_items').reduce((a, item) => {\r\n      const isCorrect = item._selected?._isCorrect;\r\n      item._isCorrect = Boolean(isCorrect);\r\n      if (!isCorrect) {\r\n        return a;\r\n      }\r\n      this.set('_isAtLeastOneCorrectSelection', true);\r\n      return ++a;\r\n    }, 0);\r\n\r\n    this.set('_numberOfCorrectAnswers', numberOfCorrectAnswers);\r\n\r\n    if (numberOfCorrectAnswers === this.get('_items').length) {\r\n      return true;\r\n    }\r\n\r\n    return false;\r\n  }\r\n\r\n  setScore() {\r\n    const questionWeight = this.get('_questionWeight');\r\n\r\n    if (this.get('_isCorrect')) {\r\n      this.set('_score', questionWeight);\r\n      return;\r\n    }\r\n\r\n    const numberOfCorrectAnswers = this.get('_numberOfCorrectAnswers');\r\n    const itemLength = this.get('_items').length;\r\n\r\n    const score = questionWeight * numberOfCorrectAnswers / itemLength;\r\n\r\n    this.set('_score', score);\r\n  }\r\n\r\n  isPartlyCorrect() {\r\n    return this.get('_isAtLeastOneCorrectSelection');\r\n  }\r\n\r\n  resetUserAnswer() {\r\n    this.set('_userAnswer', []);\r\n  }\r\n\r\n  getInteractionObject() {\r\n    const interactions = {\r\n      correctResponsesPattern: null,\r\n      source: null,\r\n      target: null\r\n    };\r\n    const items = this.get('_items');\r\n\r\n    interactions.correctResponsesPattern = [\r\n      items.map(({ _options }, questionIndex) => {\r\n\r\n        questionIndex++;\r\n        return [\r\n          questionIndex,\r\n\r\n          _options.filter(({ _isCorrect }) => _isCorrect).map(({ _index }) => {\r\n\r\n            return `${questionIndex}_${_index + 1}`;\r\n          })\r\n        ].join('[.]');\r\n      }).join('[,]')\r\n    ];\r\n\r\n    interactions.source = items.map(item => {\r\n      return {\r\n        // Offset by 1.\r\n        id: `${item._index + 1}`,\r\n        description: item.text\r\n      };\r\n    }).flat(Infinity);\r\n\r\n    interactions.target = items.map(({ _options }, index) => {\r\n\r\n      index++;\r\n      return _options.map(option => {\r\n        return {\r\n          id: `${index}_${option._index + 1}`,\r\n          description: option.text\r\n        };\r\n      });\r\n    }).flat(Infinity);\r\n    return interactions;\r\n  }\r\n\r\n  getResponse() {\r\n    const responses = this.get('_userAnswer').map((userAnswer, index) => {\r\n      return `${index + 1}.${userAnswer + 1}`;\r\n    });\r\n\r\n    return responses.join('#');\r\n  }\r\n\r\n  getResponseType() {\r\n    return 'matching';\r\n  }\r\n\r\n  getCorrectAnswerAsText() {\r\n    const correctAnswerTemplate = Adapt.course.get('_globals')._components._choose.ariaCorrectAnswer;\r\n    const ariaAnswer = this.get('_items').map(item => {\r\n      const correctOption = item._options.find(({ _isCorrect }) => _isCorrect);\r\n      return Handlebars.compile(correctAnswerTemplate)({\r\n        itemText: item.text,\r\n        correctAnswer: correctOption.text\r\n      });\r\n    }).join('<br>');\r\n\r\n    return ariaAnswer;\r\n  }\r\n\r\n  getUserAnswerAsText() {\r\n    const userAnswerTemplate = Adapt.course.get('_globals')._components._choose.ariaUserAnswer;\r\n    const answerArray = this.get('_userAnswer');\r\n\r\n    const ariaAnswer = this.get('_items').map((item, index) => {\r\n      const key = answerArray[index];\r\n      return Handlebars.compile(userAnswerTemplate)({\r\n        itemText: item.text,\r\n        userAnswer: item._options[(key)].text\r\n      });\r\n    }).join('<br>');\r\n\r\n    return ariaAnswer;\r\n  }\r\n}\r\n","import Adapt from 'core/js/adapt';\r\nimport ChooseView from './chooseView';\r\nimport ChooseModel from './chooseModel';\r\n\r\nexport default Adapt.register('choose', {\r\n  view: ChooseView,\r\n  model: ChooseModel\r\n});\r\n","import ItemsComponentModel from 'core/js/models/itemsComponentModel';\r\n\r\nexport default class AccordionModel extends ItemsComponentModel {\r\n\r\n  defaults() {\r\n    return ItemsComponentModel.resultExtend('defaults', {\r\n      _shouldCollapseItems: true,\r\n      _shouldExpandFirstItem: false,\r\n      _toggleSpeed: 200\r\n    });\r\n  }\r\n\r\n  checkIfResetOnRevisit() {\r\n    this.resetActiveItems();\r\n    super.checkIfResetOnRevisit();\r\n    this.checkExpandFirstItem();\r\n  }\r\n\r\n  toggleItemsState(index) {\r\n    const item = this.getItem(index);\r\n    const previousActiveItem = this.getActiveItem();\r\n\r\n    item.toggleActive();\r\n    item.toggleVisited(true);\r\n\r\n    if (!previousActiveItem || !this.get('_shouldCollapseItems')) return;\r\n    previousActiveItem.toggleActive(false);\r\n  }\r\n\r\n  checkExpandFirstItem() {\r\n    if (!this.get('_shouldExpandFirstItem')) return;\r\n    this.toggleItemsState(0);\r\n  }\r\n\r\n}\r\n","import ComponentView from 'core/js/views/componentView';\r\n\r\nclass AccordionView extends ComponentView {\r\n\r\n  preRender() {\r\n    this.onClick = this.onClick.bind(this);\r\n    this.listenTo(this.model.getChildren(), 'change:_isActive', this.onItemsActiveChange);\r\n  }\r\n\r\n  postRender() {\r\n    // If an item is active add display: block; to start jquery animate state\r\n    this.getItemElement(this.model.getActiveItem())?.find('.js-accordion-item-content')?.css('display', 'block');\r\n    this.setReadyStatus();\r\n    if (this.model.get('_setCompletionOn') !== 'inview') return;\r\n    this.setupInviewCompletion();\r\n  }\r\n\r\n  onClick(event) {\r\n    this.model.toggleItemsState($(event.currentTarget).parents('.js-accordion-item').data('index'));\r\n  }\r\n\r\n  onItemsActiveChange(item, isActive) {\r\n    this.toggleItem(item, isActive);\r\n  }\r\n\r\n  toggleItem(item, shouldExpand) {\r\n    const $item = this.getItemElement(item);\r\n    const $body = $item.children('.js-accordion-item-content').stop(true, true);\r\n    if (!shouldExpand) {\r\n      $body.slideUp(this.model.get('_toggleSpeed'));\r\n      return;\r\n    }\r\n    $body.slideDown(this.model.get('_toggleSpeed'));\r\n  }\r\n\r\n  getItemElement(item) {\r\n    if (!item) return;\r\n    const index = item.get('_index');\r\n    return this.$('.js-accordion-item').filter(`[data-index=\"${index}\"]`);\r\n  }\r\n\r\n}\r\n\r\nAccordionView.template = 'accordion.jsx';\r\n\r\nexport default AccordionView;\r\n","import components from 'core/js/components';\r\nimport AccordionModel from './AccordionModel';\r\nimport AccordionView from './AccordionView';\r\n\r\nexport default components.register('accordion', {\r\n  model: AccordionModel,\r\n  view: AccordionView\r\n});\r\n","import Adapt from 'core/js/adapt';\r\nimport ComponentModel from 'core/js/models/componentModel';\r\n\r\nexport default class AssessmentResultsModel extends ComponentModel {\r\n\r\n  init(...args) {\r\n    // save the original body text so we can restore it when the assessment is reset\r\n    this.set('originalBody', this.get('body'));\r\n\r\n    this.listenTo(Adapt, {\r\n      'assessments:complete': this.onAssessmentComplete,\r\n      'assessments:reset': this.onAssessmentReset\r\n    });\r\n\r\n    super.init(...args);\r\n  }\r\n\r\n  /**\r\n   * Checks to see if the assessment was completed in a previous session or not\r\n   */\r\n  checkIfAssessmentComplete() {\r\n    if (!Adapt.assessment || this.get('_assessmentId') === undefined) {\r\n      return;\r\n    }\r\n\r\n    const assessmentModel = Adapt.assessment.get(this.get('_assessmentId'));\r\n    if (!assessmentModel || assessmentModel.length === 0) return;\r\n\r\n    const state = assessmentModel.getState();\r\n    const isResetOnRevisit = assessmentModel.get('_assessment')._isResetOnRevisit;\r\n    if (state.isComplete && (!state.allowResetIfPassed || !isResetOnRevisit)) {\r\n      this.onAssessmentComplete(state);\r\n      return;\r\n    }\r\n\r\n    this.setVisibility();\r\n  }\r\n\r\n\r\n\r\n  onAssessmentComplete(state) {\r\n    if (this.get('_assessmentId') === undefined ||\r\n        this.get('_assessmentId') !== state.id) return;\r\n\r\n    /*\r\n    make shortcuts to some of the key properties in the state object so that\r\n    content developers can just use {{attemptsLeft}} in json instead of {{state.attemptsLeft}}\r\n    */\r\n    this._state = state;\r\n    this.set({\r\n      attempts: state.attempts,\r\n      attemptsSpent: state.attemptsSpent,\r\n      attemptsLeft: state.attemptsLeft,\r\n      score: state.score,\r\n      scoreAsPercent: state.scoreAsPercent,\r\n      maxScore: state.maxScore,\r\n      isPass: state.isPass\r\n    });\r\n\r\n    this.setFeedbackBand(state);\r\n\r\n    this.checkRetryEnabled(state);\r\n\r\n    this.setFeedbackText();\r\n\r\n    this.toggleVisibility(true);\r\n  }\r\n\r\n  \r\n  setFeedbackBand(state) {\r\n    const scoreProp = state.isPercentageBased ? 'scoreAsPercent' : 'score';\r\n    const bands = _.sortBy(this.get('_bands'), '_score');\r\n    \r\n    for (let i = (bands.length - 1); i >= 0; i--) {\r\n      const isScoreInBandRange = (state[scoreProp] >= bands[i]._score);\r\n      if (!isScoreInBandRange) continue;\r\n      if (this.get('multipleFeedback') && this.get('multipleFeedback')[state.attemptsSpent] && !state.isPass) {\r\n        bands[i].feedback = this.get('multipleFeedback')[state.attemptsSpent]\r\n        this.set('_feedbackBand', bands[i])\r\n      } else {\r\n        this.set('_feedbackBand', bands[i])\r\n      }\r\n      this.set('_feedbackBand', bands[i]);\r\n      break;\r\n    }\r\n  }\r\n\r\n  checkRetryEnabled(state) {\r\n    const assessmentModel = Adapt.assessment.get(state.id);\r\n    if (!assessmentModel.canResetInPage()) return false;\r\n\r\n    const feedbackBand = this.get('_feedbackBand');\r\n    const isRetryEnabled = (feedbackBand && feedbackBand._allowRetry) !== false;\r\n    const isAttemptsLeft = (state.attemptsLeft > 0 || state.attemptsLeft === 'infinite');\r\n    const showRetry = isRetryEnabled && isAttemptsLeft && (!state.isPass || state.allowResetIfPassed);\r\n\r\n    this.set({\r\n      _isRetryEnabled: showRetry,\r\n      retryFeedback: showRetry ? this.get('_retry').feedback : ''\r\n    });\r\n  }\r\n\r\n  setFeedbackText() {\r\n    const feedbackBand = this.get('_feedbackBand');\r\n\r\n    // ensure any handlebars expressions in the .feedback are handled...\r\n    const feedback = feedbackBand ? Handlebars.compile(feedbackBand.feedback)(this.toJSON()) : '';\r\n\r\n    this.set({\r\n      feedback,\r\n      body: this.get('_completionBody')\r\n    });\r\n  }\r\n\r\n  setVisibility() {\r\n    if (!Adapt.assessment) return;\r\n\r\n    const assessmentModel = Adapt.assessment.get(this.get('_assessmentId'));\r\n    if (!assessmentModel || assessmentModel.length === 0) return;\r\n\r\n    const state = assessmentModel.getState();\r\n    const isAttemptInProgress = state.attemptInProgress;\r\n    const isComplete = !isAttemptInProgress && state.isComplete;\r\n    const isVisibleBeforeCompletion = this.get('_isVisibleBeforeCompletion') || false;\r\n    const isVisible = isVisibleBeforeCompletion || isComplete;\r\n\r\n    this.toggleVisibility(isVisible);\r\n  }\r\n\r\n  toggleVisibility(isVisible) {\r\n    if (isVisible === undefined) {\r\n      isVisible = !this.get('_isVisible');\r\n    }\r\n\r\n    this.set('_isVisible', isVisible, { pluginName: 'assessmentResults' });\r\n  }\r\n\r\n  checkCompletion() {\r\n    if (this.get('_setCompletionOn') === 'pass' && !this.get('isPass')) {\r\n      return;\r\n    }\r\n\r\n    this.setCompletionStatus();\r\n  }\r\n\r\n  /**\r\n   * Handles resetting the component whenever its corresponding assessment is reset\r\n   * The component can either inherit the assessment's reset type or define its own\r\n   */\r\n  onAssessmentReset(state) {\r\n    if (this.get('_assessmentId') === undefined ||\r\n        this.get('_assessmentId') !== state.id) return;\r\n\r\n    let resetType = this.get('_resetType');\r\n    if (!resetType || resetType === 'inherit') {\r\n      // backwards compatibility - state.resetType was only added in assessment v2.3.0\r\n      resetType = state.resetType || 'hard';\r\n    }\r\n    this.reset(resetType, true);\r\n  }\r\n\r\n  reset(...args) {\r\n    this.set({\r\n      body: this.get('originalBody'),\r\n      state: null,\r\n      feedback: '',\r\n      _feedbackBand: null,\r\n      retryFeedback: '',\r\n      _isRetryEnabled: false\r\n    });\r\n\r\n    super.reset(...args);\r\n  }\r\n}\r\n","import Adapt from 'core/js/adapt';\r\nimport router from 'core/js/router';\r\nimport ComponentView from 'core/js/views/componentView';\r\n\r\nclass AssessmentResultsView extends ComponentView {\r\n\r\n  events() {\r\n    return {\r\n      'click .js-assessment-retry-btn': 'onRetryClicked',\r\n      'click .review-answer': 'reviewAnswer',\r\n      'click .close': 'onCloseClicked'\r\n    };\r\n  }\r\n  \r\n  onCloseClicked() {\r\n    var e = top.window || window\r\n    e.close()\r\n  }\r\n\r\n  reviewAnswer(e) {\r\n   e.preventDefault()\r\n   /*get first question*/\r\n   const state = this.model._state;\r\n   let fristQuestion = state.questions[0]._id;\r\n   \r\n  /*get proprties of article*/\r\n   let parent = this.$el.parents('.article');\r\n   let article = parent.siblings('.article')\r\n\r\n\r\n   router.navigateToElement(`.${fristQuestion}`, {\r\n    duration: 300,\r\n   })\r\n   \r\n   /*add marking after review*/\r\n  article.removeClass('no-marking')\r\n\r\n    if (state._attemptsLeft){\r\n      $('.results-retry').removeClass('display-none')\r\n    }else { $('.results-retakeCourse').removeClass('display-none')\r\n  }\r\n\r\n\r\n   \r\n  }\r\n\r\n  \r\n\r\n  preRender() {\r\n    this.model.setLocking('_isVisible', false);\r\n\r\n    this.listenTo(Adapt.parentView, 'preRemove', () => {\r\n      this.model.unsetLocking('_isVisible');\r\n    });\r\n\r\n    this.listenTo(this.model, {\r\n      'change:_feedbackBand': this.addClassesToArticle,\r\n      'change:body': this.render\r\n    });\r\n  }\r\n\r\n  postRender() {\r\n    this.model.checkIfAssessmentComplete();\r\n    this.setReadyStatus();\r\n    this.setupInviewCompletion('.component__inner', this.model.checkCompletion.bind(this.model));\r\n  }\r\n\r\n \r\n\r\n  /**\r\n   * Resets the state of the assessment and optionally redirects the user\r\n   * back to the assessment for another attempt.\r\n   */\r\n  onRetryClicked() {\r\n    const state = this.model._state;\r\n    Adapt.assessment.get(state.id).reset(null, wasReset => {\r\n      if (!wasReset) return;\r\n\r\n      if (this.model.get('_retry')._routeToAssessment !== true) return;\r\n      router.navigateToElement(`.${state.articleId}`);\r\n    });\r\n  }\r\n\r\n  /**\r\n   * If there are classes specified for the feedback band, apply them to the containing article\r\n   * This allows for custom styling based on the band the user's score falls into\r\n   */\r\n  addClassesToArticle(model, value) {\r\n    if (!value?._classes) return;\r\n\r\n    this.$el.parents('.article').addClass(value._classes);\r\n  }\r\n\r\n}\r\n\r\nAssessmentResultsView.template = 'assessmentResults';\r\n\r\nexport default AssessmentResultsView;\r\n","import components from 'core/js/components';\r\nimport AssessmentResultsModel from './assessmentResultsModel';\r\nimport AssessmentResultsView from './assessmentResultsView';\r\n\r\nexport default components.register('assessmentResults', {\r\n  model: AssessmentResultsModel,\r\n  view: AssessmentResultsView\r\n});\r\n","import ComponentView from 'core/js/views/componentView';\r\n\r\nexport default class BlankView extends ComponentView {\r\n\r\n  get template() {\r\n    return 'blank';\r\n  }\r\n\r\n  postRender() {\r\n    this.setReadyStatus();\r\n    this.setupInviewCompletion();\r\n  }\r\n\r\n}\r\n","import components from 'core/js/components';\r\nimport BlankView from './blankView';\r\nimport ComponentModel from 'core/js/models/componentModel';\r\n\r\nexport default components.register('blank', {\r\n  model: ComponentModel.extend({}), // create a new class in the inheritance chain so it can be extended per component type if necessary later\r\n  view: BlankView\r\n});\r\n","/*\r\n * adapt-contrib-flipcard\r\n * License - https://github.com/ExultCorp/adapt-contrib-flipcard/blob/master/LICENSE\r\n * Maintainers - Himanshu Rajotia <himanshu.rajotia@exultcorp.com>\r\n */\r\ndefine([\r\n    'coreViews/componentView',\r\n    'coreJS/adapt'\r\n], function(ComponentView, Adapt) {\r\n\r\n    var Flipcard = ComponentView.extend({\r\n\r\n        events: {\r\n            'click .flipcard__item': 'onClickFlipItem'\r\n        },\r\n\r\n        preRender: function() {\r\n            this.listenTo(Adapt, 'device:resize', this.reRender, this);\r\n            this.checkIfResetOnRevisit();\r\n        },\r\n\r\n        // this is use to set ready status for current component on postRender.\r\n        postRender: function() {\r\n            if (!Modernizr.testProp('transformStyle', 'preserve-3d')) {\r\n                this.$('.flipcard__item-back').hide();\r\n            }\r\n\r\n            this.$('.flipcard__widget').imageready(_.bind(function() {\r\n                this.setReadyStatus();\r\n                this.reRender();\r\n            }, this));\r\n        },\r\n\r\n        // Used to check if the flipcard should reset on revisit\r\n        checkIfResetOnRevisit: function() {\r\n            var isResetOnRevisit = this.model.get('_isResetOnRevisit');\r\n\r\n            // If reset is enabled set defaults\r\n            if (isResetOnRevisit) {\r\n                this.model.reset(isResetOnRevisit);\r\n            }\r\n\r\n            _.each(this.model.get('_items'), function(item) {\r\n                item._isVisited = false;\r\n            });\r\n        },\r\n\r\n        // This function called on triggering of device resize and device change event of Adapt.\r\n        reRender: function() {\r\n            var imageHeight = this.$('.flipcard__item-frontImage').eq(0).height();\r\n            if (imageHeight) {\r\n                this.$('.flipcard__item').height(imageHeight);\r\n            }\r\n        },\r\n\r\n        // Click or Touch event handler for flip card.\r\n        onClickFlipItem: function(event) {\r\n            if (event && event.target.tagName.toLowerCase() === 'a') {\r\n                return;\r\n            } else {\r\n                event && event.preventDefault();\r\n            }\r\n\r\n            var $selectedElement = $(event.currentTarget);\r\n            var flipType = this.model.get('_flipType');\r\n            if (flipType === 'allFlip') {\r\n                this.performAllFlip($selectedElement);\r\n            } else if (flipType === 'singleFlip') {\r\n                this.performSingleFlip($selectedElement);\r\n            }\r\n        },\r\n\r\n        // This function will be responsible to perform All flip on flipcard\r\n        // where all cards can flip and stay in the flipped state.\r\n        performAllFlip: function($selectedElement) {\r\n            if (!Modernizr.testProp('transformStyle', 'preserve-3d')) {\r\n                var $frontflipcard = $selectedElement.find('.flipcard__item-front');\r\n                var $backflipcard = $selectedElement.find('.flipcard__item-back');\r\n                var flipTime = this.model.get('_flipTime') || 'fast';\r\n                if ($frontflipcard.is(':visible')) {\r\n                    $frontflipcard.fadeOut(flipTime, function() {\r\n                        $backflipcard.fadeIn(flipTime);\r\n                    });\r\n                } else if ($backflipcard.is(':visible')) {\r\n                    $backflipcard.fadeOut(flipTime, function() {\r\n                        $frontflipcard.fadeIn(flipTime);\r\n                    });\r\n                }\r\n            } else {\r\n                $selectedElement.toggleClass('flipcard-flip');\r\n            }\r\n\r\n            var flipcardElementIndex = this.$('.flipcard__item').index($selectedElement);\r\n            this.setVisited(flipcardElementIndex);\r\n        },\r\n\r\n        // This function will be responsible to perform Single flip on flipcard where\r\n        // only one card can flip and stay in the flipped state.\r\n        performSingleFlip: function($selectedElement) {\r\n            var flipcardContainer = $selectedElement.closest('.flipcard__widget');\r\n            if (!Modernizr.testProp('transformStyle', 'preserve-3d')) {\r\n                var frontflipcard = $selectedElement.find('.flipcard__item-front');\r\n                var backflipcard = $selectedElement.find('.flipcard__item-back');\r\n                var flipTime = this.model.get('_flipTime') || 'fast';\r\n\r\n                if (backflipcard.is(':visible')) {\r\n                    backflipcard.fadeOut(flipTime, function() {\r\n                        frontflipcard.fadeIn(flipTime);\r\n                    });\r\n                } else {\r\n                    var visibleflipcardBack = flipcardContainer.find('.flipcard__item-back:visible');\r\n                    if (visibleflipcardBack.length > 0) {\r\n                        visibleflipcardBack.fadeOut(flipTime, function() {\r\n                            flipcardContainer.find('.flipcard__item-front:hidden').fadeIn(flipTime);\r\n                        });\r\n                    }\r\n                    frontflipcard.fadeOut(flipTime, function() {\r\n                        backflipcard.fadeIn(flipTime);\r\n                    });\r\n                }\r\n            } else {\r\n                if ($selectedElement.hasClass('flipcard-flip')) {\r\n                    $selectedElement.removeClass('flipcard-flip');\r\n                } else {\r\n                    flipcardContainer.find('.flipcard__item').removeClass('flipcard-flip');\r\n                    $selectedElement.addClass('flipcard-flip');\r\n                }\r\n            }\r\n\r\n            var flipcardElementIndex = this.$('.flipcard__item').index($selectedElement);\r\n            this.setVisited(flipcardElementIndex);\r\n        },\r\n\r\n        // This function will set the visited status for particular flipcard item.\r\n        setVisited: function(index) {\r\n            var item = this.model.get('_items')[index];\r\n            item._isVisited = true;\r\n            this.checkCompletionStatus();\r\n        },\r\n\r\n        // This function will be used to get visited states of all flipcard items.\r\n        getVisitedItems: function() {\r\n            return _.filter(this.model.get('_items'), function(item) {\r\n                return item._isVisited;\r\n            });\r\n        },\r\n\r\n        // This function will check or set the completion status of current component.\r\n        checkCompletionStatus: function() {\r\n            if (this.getVisitedItems().length === this.model.get('_items').length) {\r\n                this.setCompletionStatus();\r\n            }\r\n        }\r\n    });\r\n\r\n    Adapt.register('flipcard', Flipcard);\r\n\r\n    return Flipcard;\r\n\r\n});\r\n","import QuestionView from 'core/js/views/questionView';\r\n\r\nclass McqView extends QuestionView {\r\n\r\n  initialize(...args) {\r\n    this.onKeyPress = this.onKeyPress.bind(this);\r\n    this.onItemSelect = this.onItemSelect.bind(this);\r\n    this.onItemFocus = this.onItemFocus.bind(this);\r\n    this.onItemBlur = this.onItemBlur.bind(this);\r\n    super.initialize(...args);\r\n  }\r\n\r\n  setupQuestion() {\r\n    this.model.setupRandomisation();\r\n  }\r\n\r\n  onQuestionRendered() {\r\n    this.setReadyStatus();\r\n  }\r\n\r\n  onKeyPress(event) {\r\n    if (event.which !== 13) return;\r\n    // <ENTER> keypress\r\n    this.onItemSelect(event);\r\n  }\r\n\r\n  onItemFocus(event) {\r\n    if (!this.model.isInteractive()) return;\r\n\r\n    const index = parseInt($(event.currentTarget).data('adapt-index'));\r\n    const item = this.model.getChildren().findWhere({ _index: index });\r\n    item.set('_isHighlighted', true);\r\n  }\r\n\r\n  onItemBlur(event) {\r\n    const index = $(event.currentTarget).data('adapt-index');\r\n    const item = this.model.getChildren().findWhere({ _index: index });\r\n    item.set('_isHighlighted', false);\r\n  }\r\n\r\n  onItemSelect(event) {\r\n    if (!this.model.isInteractive()) return;\r\n\r\n    const index = $(event.currentTarget).data('adapt-index');\r\n    const itemModel = this.model.getItem(index);\r\n    let shouldSelect = !itemModel.get('_isActive');\r\n\r\n    if (this.model.isSingleSelect()) {\r\n      // Assume a click is always a selection\r\n      shouldSelect = true;\r\n      this.model.resetActiveItems();\r\n    } else if (shouldSelect && this.model.isAtActiveLimit()) {\r\n      // At the selection limit, deselect the last item\r\n      this.model.getLastActiveItem().toggleActive(false);\r\n    }\r\n\r\n    // Select or deselect accordingly\r\n    itemModel.toggleActive(shouldSelect);\r\n  }\r\n\r\n  // Used by the question view to reset the look and feel of the component.\r\n  resetQuestion() {\r\n    this.model.resetItems();\r\n  }\r\n\r\n}\r\n\r\nMcqView.template = 'mcq.jsx';\r\n\r\nexport default McqView;\r\n","import McqView from 'components/adapt-contrib-mcq/js/McqView';\r\n\r\nclass GmcqView extends McqView {\r\n\r\n  onQuestionRendered() {\r\n    this.$('.js-item-label').imageready(() => this.setReadyStatus());\r\n  }\r\n\r\n}\r\n\r\nGmcqView.template = 'gmcq.jsx';\r\n\r\nexport default GmcqView;\r\n","import Adapt from 'core/js/adapt';\r\nimport QuestionModel from 'core/js/models/questionModel';\r\nimport ItemsComponentModel from 'core/js/models/itemsComponentModel';\r\n\r\nclass BlendedItemsComponentQuestionModel extends QuestionModel {\r\n\r\n  init() {\r\n    ItemsComponentModel.prototype.init.call(this);\r\n    super.init();\r\n  }\r\n\r\n  /**\r\n   * @param {string} [type] 'hard' resets _isComplete and _isInteractionComplete, 'soft' resets _isInteractionComplete only.\r\n   * @param {boolean} [canReset] Defaults to this.get('_canReset')\r\n   * @returns {boolean}\r\n   */\r\n  reset(type = 'hard', canReset = this.get('_canReset')) {\r\n    ItemsComponentModel.prototype.reset.call(this, type, canReset);\r\n    return super.reset(type, canReset);\r\n  }\r\n\r\n}\r\n// extend BlendedItemsComponentQuestionModel with ItemsComponentModel\r\nObject.getOwnPropertyNames(ItemsComponentModel.prototype).forEach(name => {\r\n  if (name === 'constructor' || name === 'init' || name === 'reset') return;\r\n  Object.defineProperty(BlendedItemsComponentQuestionModel.prototype, name, {\r\n    value: ItemsComponentModel.prototype[name]\r\n  });\r\n});\r\n\r\nexport default class ItemsQuestionModel extends BlendedItemsComponentQuestionModel {\r\n\r\n  init() {\r\n    super.init();\r\n    this.set('_isRadio', this.isSingleSelect());\r\n    this.listenTo(this.getChildren(), 'change:_isActive', this.checkCanSubmit);\r\n    this.checkCanSubmit();\r\n  }\r\n\r\n  restoreUserAnswers() {\r\n    if (!this.get('_isSubmitted')) return;\r\n\r\n    const itemModels = this.getChildren();\r\n    const userAnswer = this.get('_userAnswer');\r\n    itemModels.each(item => {\r\n      item.toggleActive(userAnswer[item.get('_index')]);\r\n    });\r\n\r\n    this.setQuestionAsSubmitted();\r\n    this.markQuestion();\r\n    this.setScore();\r\n    this.setupFeedback();\r\n  }\r\n\r\n  setupRandomisation() {\r\n    if (!this.get('_isRandom') || !this.get('_isEnabled')) return;\r\n    const children = this.getChildren();\r\n    children.set(children.shuffle());\r\n  }\r\n\r\n  // check if the user is allowed to submit the question\r\n  canSubmit() {\r\n    const activeItems = this.getActiveItems();\r\n    return activeItems.length > 0;\r\n  }\r\n\r\n  // This is important for returning or showing the users answer\r\n  // This should preserve the state of the users answers\r\n  storeUserAnswer() {\r\n    const items = this.getChildren().slice(0);\r\n    items.sort((a, b) => a.get('_index') - b.get('_index'));\r\n    const userAnswer = items.map(itemModel => itemModel.get('_isActive'));\r\n    this.set('_userAnswer', userAnswer);\r\n  }\r\n\r\n  isCorrect() {\r\n    const allChildren = this.getChildren();\r\n    const activeChildren = allChildren.filter(itemModel => itemModel.get('_isActive'));\r\n\r\n    const isItemCorrect = itemModel => itemModel.get('_shouldBeSelected') && !itemModel.get('_isPartlyCorrect');\r\n    const isItemPartlyCorrect = itemModel => itemModel.get('_isPartlyCorrect');\r\n    const isItemIncorrect = itemModel => !itemModel.get('_shouldBeSelected') && !itemModel.get('_isPartlyCorrect');\r\n\r\n    const sum = (list, predicate) => list.reduce((sum, item) => sum + (predicate(item) ? 1 : 0), 0);\r\n\r\n    const props = {\r\n      _numberOfRequiredAnswers: sum(allChildren, isItemCorrect),\r\n      _numberOfCorrectAnswers: sum(activeChildren, isItemCorrect),\r\n      _numberOfPartlyCorrectAnswers: sum(activeChildren, isItemPartlyCorrect),\r\n      _numberOfIncorrectAnswers: sum(activeChildren, isItemIncorrect)\r\n    };\r\n\r\n    activeChildren.forEach(itemModel => itemModel.set('_isCorrect', itemModel.get('_shouldBeSelected')));\r\n\r\n    props._isAtLeastOneCorrectSelection = (props._numberOfCorrectAnswers || props._numberOfPartlyCorrectAnswers);\r\n\r\n    const numberOfSelectableAnswers = this.get('_selectable');\r\n    const hasSelectableCorrectAnswers = (props._numberOfCorrectAnswers === numberOfSelectableAnswers);\r\n    const hasAllCorrectAnswers = (props._numberOfCorrectAnswers === props._numberOfRequiredAnswers);\r\n    const hasCorrectAnswers = (hasSelectableCorrectAnswers || hasAllCorrectAnswers);\r\n    const hasIncorrectAnswers = props._numberOfIncorrectAnswers;\r\n    const hasPartlyCorrectAnswers = props._numberOfPartlyCorrectAnswers;\r\n\r\n    this.set(props);\r\n\r\n    return hasCorrectAnswers && !hasIncorrectAnswers && !hasPartlyCorrectAnswers;\r\n  }\r\n\r\n  // Sets the score based upon the questionWeight\r\n  // Can be overwritten if the question needs to set the score in a different way\r\n  setScore() {\r\n    const questionWeight = this.get('_questionWeight');\r\n    const answeredCorrectly = this.get('_isCorrect');\r\n    const score = answeredCorrectly ? questionWeight : 0;\r\n    this.set('_score', score);\r\n  }\r\n\r\n  get score() {\r\n    if (!this.get('_hasItemScoring')) return super.score;\r\n    const children = this.getChildren()?.toArray() || [];\r\n    return children.reduce((score, child) => (score += child.get('_isActive') ? child.get('_score') || 0 : 0), 0);\r\n  }\r\n\r\n  get maxScore() {\r\n    if (!this.get('_hasItemScoring')) return super.maxScore;\r\n    const children = this.getChildren()?.toArray() || [];\r\n    const scores = children.map(child => child.get('_score') || 0);\r\n    scores.sort((a, b) => a - b);\r\n    return scores.reverse().slice(0, this.get('_selectable')).filter(score => score > 0).reduce((maxScore, score) => (maxScore += score), 0);\r\n  }\r\n\r\n  get minScore() {\r\n    if (!this.get('_hasItemScoring')) return super.minScore;\r\n    const children = this.getChildren()?.toArray() || [];\r\n    const scores = children.map(child => child.get('_score') || 0);\r\n    scores.sort((a, b) => a - b);\r\n    return scores.slice(0, this.get('_selectable')).filter(score => score < 0).reduce((minScore, score) => (minScore += score), 0);\r\n  }\r\n\r\n  setupFeedback() {\r\n    if (!this.has('_feedback')) return;\r\n\r\n    if (this.get('_isCorrect')) {\r\n      this.setupCorrectFeedback();\r\n      return;\r\n    }\r\n\r\n    if (this.isPartlyCorrect()) {\r\n      this.setupPartlyCorrectFeedback();\r\n      return;\r\n    }\r\n\r\n    // apply individual item feedback\r\n    const activeItem = this.getActiveItem();\r\n    if (this.isSingleSelect() && activeItem.get('feedback')) {\r\n      this.setupIndividualFeedback(activeItem);\r\n      return;\r\n    }\r\n\r\n    this.setupIncorrectFeedback();\r\n  }\r\n\r\n  setupIndividualFeedback(selectedItem) {\r\n    const json = this.toJSON();\r\n    this.set({\r\n      feedbackTitle: Handlebars.compile(this.getFeedbackTitle(this.get('_feedback')))(json),\r\n      feedbackMessage: Handlebars.compile(selectedItem.get('feedback'))(json)\r\n    });\r\n  }\r\n\r\n  isPartlyCorrect() {\r\n    return this.get('_isAtLeastOneCorrectSelection');\r\n  }\r\n\r\n  resetUserAnswer() {\r\n    this.set('_userAnswer', []);\r\n  }\r\n\r\n  isAtActiveLimit() {\r\n    const selectedItems = this.getActiveItems();\r\n    return (selectedItems.length === this.get('_selectable'));\r\n  }\r\n\r\n  isSingleSelect() {\r\n    return (this.get('_selectable') === 1);\r\n  }\r\n\r\n  getLastActiveItem() {\r\n    const selectedItems = this.getActiveItems();\r\n    return selectedItems[selectedItems.length - 1];\r\n  }\r\n\r\n  /**\r\n   * Reset the question items for another attempt\r\n   */\r\n  resetQuestion() {\r\n    this.resetItems();\r\n  }\r\n\r\n  resetItems() {\r\n    this.resetActiveItems();\r\n    this.set('_isAtLeastOneCorrectSelection', false);\r\n  }\r\n\r\n  getInteractionObject() {\r\n    const interactions = {\r\n      correctResponsesPattern: [],\r\n      choices: []\r\n    };\r\n\r\n    interactions.choices = this.getChildren().map(itemModel => {\r\n      return {\r\n        id: (itemModel.get('_index') + 1).toString(),\r\n        description: itemModel.get('text')\r\n      };\r\n    });\r\n\r\n    const correctItems = this.getChildren().filter(itemModel => {\r\n      return itemModel.get('_shouldBeSelected');\r\n    });\r\n\r\n    interactions.correctResponsesPattern = [\r\n      correctItems.map(itemModel => {\r\n        // indexes are 0-based, we need them to be 1-based for cmi.interactions\r\n        return String(itemModel.get('_index') + 1);\r\n      }).join('[,]')\r\n    ];\r\n\r\n    return interactions;\r\n  }\r\n\r\n  /**\r\n  * used by adapt-contrib-spoor to get the user's answers in the format required by the cmi.interactions.n.student_response data field\r\n  * returns the user's answers as a string in the format '1,5,2'\r\n  */\r\n  getResponse() {\r\n    const activeItems = this.getActiveItems();\r\n    const activeIndexes = activeItems.map(itemModel => {\r\n      // indexes are 0-based, we need them to be 1-based for cmi.interactions\r\n      return itemModel.get('_index') + 1;\r\n    });\r\n    return activeIndexes.join(',');\r\n  }\r\n\r\n  /**\r\n  * used by adapt-contrib-spoor to get the type of this question in the format required by the cmi.interactions.n.type data field\r\n  */\r\n  getResponseType() {\r\n    return 'choice';\r\n  }\r\n\r\n  /**\r\n   * Creates a string explaining the answer(s) the learner should have chosen\r\n   * Used by ButtonsView to retrieve question-specific correct answer text for the ARIA\r\n   * 'live region' that gets updated when the learner selects the 'show correct answer' button\r\n   * @return {string}\r\n   */\r\n  getCorrectAnswerAsText() {\r\n    const globals = Adapt.course.get('_globals')._components['_' + this.get('_component')];\r\n    const isSingleSelect = this.isSingleSelect();\r\n    const ariaAnswer = isSingleSelect ? globals?.ariaCorrectAnswer : globals?.ariaCorrectAnswers;\r\n    if (!ariaAnswer) return;\r\n\r\n    const correctOptions = this.getChildren().where({ _shouldBeSelected: true });\r\n    const correctAnswer = isSingleSelect ?\r\n      correctOptions[0]?.get('text') :\r\n      correctOptions.map(correctOption => correctOption.get('text')).join('<br>');\r\n\r\n    return Handlebars.compile(ariaAnswer)({ correctAnswer });\r\n  }\r\n\r\n  /**\r\n   * Creates a string listing the answer(s) the learner chose\r\n   * Used by ButtonsView to retrieve question-specific user answer text for the ARIA\r\n   * 'live region' that gets updated when the learner selects the 'hide correct answer' button\r\n   * @return {string}\r\n   */\r\n  getUserAnswerAsText() {\r\n    const globals = Adapt.course.get('_globals')._components['_' + this.get('_component')];\r\n    const isSingleSelect = this.isSingleSelect();\r\n    const ariaAnswer = isSingleSelect ? globals?.ariaUserAnswer : globals?.ariaUserAnswers;\r\n    if (!ariaAnswer) return;\r\n\r\n    const selectedItems = this.getActiveItems();\r\n    const userAnswer = isSingleSelect ?\r\n      selectedItems[0].get('text') :\r\n      selectedItems.map(selectedItem => selectedItem.get('text')).join('<br>');\r\n\r\n    return Handlebars.compile(ariaAnswer)({ userAnswer });\r\n  }\r\n\r\n}\r\n","import ItemsQuestionModel from 'core/js/models/itemsQuestionModel';\r\n\r\nexport default class McqModel extends ItemsQuestionModel {}\r\n","import McqModel from 'components/adapt-contrib-mcq/js/McqModel';\r\n\r\nexport default class GmcqModel extends McqModel {}\r\n","import components from 'core/js/components';\r\nimport GmcqView from './GmcqView';\r\nimport GmcqModel from './GmcqModel';\r\n\r\nexport default components.register('gmcq', {\r\n  model: GmcqModel,\r\n  view: GmcqView\r\n});\r\n","import ComponentView from 'core/js/views/componentView';\r\n\r\nclass GraphicView extends ComponentView {\r\n\r\n  events() {\r\n    return {\r\n      'click .js-graphic-link': 'onClick'\r\n    };\r\n  }\r\n\r\n  postRender() {\r\n    this.$('.graphic__widget').imageready(() => {\r\n      this.setReadyStatus();\r\n      this.setupInviewCompletion('.graphic__widget');\r\n    });\r\n  }\r\n\r\n  onClick(event) {\r\n    if (event) event.preventDefault();\r\n\r\n    const item = this.model.get('_graphic');\r\n    const { _url: url, _target: target = '_blank' } = item;\r\n\r\n    const isNewWindow = (target !== '_self');\r\n    if (isNewWindow) return window.open(url, target);\r\n    const isRouterNavigation = (url.substr(0, 1) === '#');\r\n    if (isRouterNavigation) return Backbone.history.navigate(url, { trigger: true });\r\n    window.location.href = url;\r\n  }\r\n\r\n}\r\n\r\nGraphicView.template = 'graphic.jsx';\r\n\r\nexport default GraphicView;\r\n","import ComponentModel from 'core/js/models/componentModel';\r\n\r\nexport default class GraphicModel extends ComponentModel {}\r\n","import components from 'core/js/components';\r\nimport GraphicView from './GraphicView';\r\nimport GraphicModel from './GraphicModel';\r\n\r\nexport default components.register('graphic', {\r\n  model: GraphicModel,\r\n  view: GraphicView\r\n});\r\n","import Adapt from 'core/js/adapt';\r\nimport a11y from 'core/js/a11y';\r\n\r\nclass HotgraphicPopupView extends Backbone.View {\r\n\r\n  className() {\r\n    return 'hotgraphic-popup';\r\n  }\r\n\r\n  events() {\r\n    return {\r\n      'click .js-hotgraphic-popup-close': 'closePopup',\r\n      'click .js-hotgraphic-controls-click': 'onControlClick'\r\n    };\r\n  }\r\n\r\n  initialize(...args) {\r\n    super.initialize(...args);\r\n    // Debounce required as a second (bad) click event is dispatched on iOS causing a jump of two items.\r\n    this.onControlClick = _.debounce(this.onControlClick.bind(this), 100);\r\n    this.listenToOnce(Adapt, 'notify:opened', this.onOpened);\r\n    this.listenTo(this.model.getChildren(), {\r\n      'change:_isActive': this.onItemsActiveChange,\r\n      'change:_isVisited': this.onItemsVisitedChange\r\n    });\r\n    this.render();\r\n  }\r\n\r\n  onOpened() {\r\n    this.applyNavigationClasses(this.model.getActiveItem().get('_index'));\r\n    this.updatePageCount();\r\n    this.handleTabs();\r\n  }\r\n\r\n  applyNavigationClasses (index) {\r\n    const itemCount = this.model.get('_items').length;\r\n    const canCycleThroughPagination = this.model.get('_canCycleThroughPagination');\r\n\r\n    const shouldEnableBack = index > 0 || canCycleThroughPagination;\r\n    const shouldEnableNext = index < itemCount - 1 || canCycleThroughPagination;\r\n    const $controls = this.$('.hotgraphic-popup__controls');\r\n\r\n    this.$('hotgraphic-popup__nav')\r\n      .toggleClass('first', !shouldEnableBack)\r\n      .toggleClass('last', !shouldEnableNext);\r\n\r\n    a11y.toggleAccessibleEnabled($controls.filter('.back'), shouldEnableBack);\r\n    a11y.toggleAccessibleEnabled($controls.filter('.next'), shouldEnableNext);\r\n  }\r\n\r\n  updatePageCount() {\r\n    const template = Adapt.course.get('_globals')._components._hotgraphic.popupPagination || '{{itemNumber}} / {{totalItems}}';\r\n    const labelText = Handlebars.compile(template)({\r\n      itemNumber: this.model.getActiveItem().get('_index') + 1,\r\n      totalItems: this.model.get('_items').length\r\n    });\r\n    this.$('.hotgraphic-popup__count').html(labelText);\r\n  }\r\n\r\n  handleTabs() {\r\n    a11y.toggleHidden(this.$('.hotgraphic-popup__item:not(.is-active)'), true);\r\n    a11y.toggleHidden(this.$('.hotgraphic-popup__item.is-active'), false);\r\n  }\r\n\r\n  onItemsActiveChange(item, _isActive) {\r\n    if (!_isActive) return;\r\n    const index = item.get('_index');\r\n    this.updatePageCount();\r\n    this.applyItemClasses(index);\r\n    this.handleTabs();\r\n    this.handleFocus(index);\r\n  }\r\n\r\n  applyItemClasses(index) {\r\n    this.$(`.hotgraphic-popup__item[data-index=\"${index}\"]`).addClass('is-active').removeAttr('aria-hidden');\r\n    this.$(`.hotgraphic-popup__item[data-index=\"${index}\"] .hotgraphic-popup__item-title`).attr('id', 'notify-heading');\r\n    this.$(`.hotgraphic-popup__item:not([data-index=\"${index}\"])`).removeClass('is-active').attr('aria-hidden', 'true');\r\n    this.$(`.hotgraphic-popup__item:not([data-index=\"${index}\"]) .hotgraphic-popup__item-title`).removeAttr('id');\r\n  }\r\n\r\n  handleFocus(index) {\r\n    a11y.focusFirst(this.$('.hotgraphic-popup__inner .is-active'));\r\n    this.applyNavigationClasses(index);\r\n  }\r\n\r\n  onItemsVisitedChange(item, _isVisited) {\r\n    if (!_isVisited) return;\r\n\r\n    this.$('.hotgraphic-popup__item')\r\n      .filter(`[data-index=\"${item.get('_index')}\"]`)\r\n      .addClass('is-visited');\r\n  }\r\n\r\n  render() {\r\n    const data = this.model.toJSON();\r\n    data.view = this;\r\n    const template = Handlebars.templates[this.constructor.template];\r\n    this.$el.html(template(data));\r\n  }\r\n\r\n  closePopup() {\r\n    Adapt.trigger('notify:close');\r\n  }\r\n\r\n  onControlClick(event) {\r\n    const direction = $(event.currentTarget).data('direction');\r\n    const index = this.getNextIndex(direction);\r\n    if (index === -1) return;\r\n\r\n    this.setItemState(index);\r\n  }\r\n\r\n  getNextIndex(direction) {\r\n    let index = this.model.getActiveItem().get('_index');\r\n    const lastIndex = this.model.get('_items').length - 1;\r\n\r\n    switch (direction) {\r\n      case 'back':\r\n        if (index > 0) return --index;\r\n        if (this.model.get('_canCycleThroughPagination')) return lastIndex;\r\n        break;\r\n      case 'next':\r\n        if (index < lastIndex) return ++index;\r\n        if (this.model.get('_canCycleThroughPagination')) return 0;\r\n    }\r\n    return -1;\r\n  }\r\n\r\n  setItemState(index) {\r\n    this.model.getActiveItem().toggleActive();\r\n\r\n    const nextItem = this.model.getItem(index);\r\n    nextItem.toggleActive();\r\n    nextItem.toggleVisited(true);\r\n  }\r\n\r\n};\r\n\r\nHotgraphicPopupView.template = 'hotgraphicPopup';\r\n\r\nexport default HotgraphicPopupView;\r\n","import Adapt from 'core/js/adapt';\r\nimport components from 'core/js/components';\r\nimport data from 'core/js/data';\r\nimport device from 'core/js/device';\r\nimport notify from 'core/js/notify';\r\nimport ComponentView from 'core/js/views/componentView';\r\nimport HotgraphicPopupView from './hotgraphicPopupView';\r\n\r\nclass HotGraphicView extends ComponentView {\r\n\r\n  events () {\r\n    return {\r\n      'click .js-hotgraphic-item-click': 'onPinClicked'\r\n    };\r\n  }\r\n\r\n  initialize(...args) {\r\n    super.initialize(...args);\r\n\r\n    this.setUpViewData();\r\n    this.setUpModelData();\r\n    this.setUpEventListeners();\r\n  }\r\n\r\n  setUpViewData() {\r\n    this.popupView = null;\r\n    this._isPopupOpen = false;\r\n  }\r\n\r\n  setUpModelData() {\r\n    if (this.model.get('_canCycleThroughPagination') !== undefined) return;\r\n    this.model.set('_canCycleThroughPagination', false);\r\n  }\r\n\r\n  setUpEventListeners() {\r\n    this.listenTo(Adapt, 'device:changed', this.reRender);\r\n\r\n    this.listenTo(this.model.getChildren(), {\r\n      'change:_isActive': this.onItemsActiveChange,\r\n      'change:_isVisited': this.onItemsVisitedChange\r\n    });\r\n  }\r\n\r\n  reRender() {\r\n    if (device.screenSize === 'large' || this.model.get('_isNarrativeOnMobile') === false) return;\r\n\r\n    this.replaceWithNarrative();\r\n  }\r\n\r\n  replaceWithNarrative() {\r\n    const NarrativeView = components.getViewClass('narrative');\r\n    if (!NarrativeView) return;\r\n\r\n    const model = this.prepareNarrativeModel();\r\n    const newNarrative = new NarrativeView({ model });\r\n    // NOTE: if this component is doing its inital render in 'narrative mode',\r\n    // this.$el.parents() won't exist at this point - which is why the following is\r\n    // written the way it is, instead of (what would appear to be) the more efficient\r\n    // this.$el.parents('.component__container')\r\n    const $container = data.findViewByModelId(model.get('_parentId')).$el.find('.component__container');\r\n    $container.append(newNarrative.$el);\r\n\r\n    this.remove();\r\n    _.defer(() => {\r\n      Adapt.trigger('device:resize');\r\n    });\r\n  }\r\n\r\n  prepareNarrativeModel() {\r\n    this.model.set({\r\n      _component: 'narrative',\r\n      _wasHotgraphic: true,\r\n      originalBody: this.model.get('body'),\r\n      originalInstruction: this.model.get('instruction')\r\n    });\r\n\r\n    // Check if active item exists, default to 0\r\n    const activeItem = this.model.getActiveItem();\r\n    if (!activeItem) {\r\n      this.model.getItem(0).toggleActive(true);\r\n    }\r\n\r\n    // Swap mobile body and instructions for desktop variants.\r\n    if (this.model.get('mobileBody')) {\r\n      this.model.set('body', this.model.get('mobileBody'));\r\n    }\r\n    if (this.model.get('mobileInstruction')) {\r\n      this.model.set('instruction', this.model.get('mobileInstruction'));\r\n    }\r\n\r\n    return this.model;\r\n  }\r\n\r\n  onItemsActiveChange(model, _isActive) {\r\n    this.getItemElement(model).toggleClass('is-active', _isActive);\r\n  }\r\n\r\n  getItemElement(model) {\r\n    const index = model.get('_index');\r\n    return this.$('.js-hotgraphic-item-click').filter(`[data-index=\"${index}\"]`);\r\n  }\r\n\r\n  onItemsVisitedChange(model, _isVisited) {\r\n    if (!_isVisited) return;\r\n\r\n    const $pin = this.getItemElement(model);\r\n    // Append the word 'visited.' to the pin's aria-label\r\n    const visitedLabel = ` ${this.model.get('_globals')._accessibility._ariaLabels.visited}.`;\r\n    $pin.find('.aria-label').each((index, el) => {\r\n      el.innerHTML += visitedLabel;\r\n    });\r\n\r\n    $pin.addClass('is-visited');\r\n  }\r\n\r\n  preRender() {\r\n    if (device.screenSize === 'large') {\r\n      this.render();\r\n      return;\r\n    }\r\n\r\n    this.reRender();\r\n  }\r\n\r\n  postRender() {\r\n    this.$('.hotgraphic__widget').imageready(this.setReadyStatus.bind(this));\r\n    if (this.model.get('_setCompletionOn') !== 'inview') return;\r\n    this.setupInviewCompletion('.component__widget');\r\n  }\r\n\r\n  onPinClicked (event) {\r\n    const item = this.model.getItem($(event.currentTarget).data('index'));\r\n    item.toggleActive(true);\r\n    item.toggleVisited(true);\r\n\r\n    this.openPopup();\r\n  }\r\n\r\n  openPopup() {\r\n    if (this._isPopupOpen) return;\r\n\r\n    this._isPopupOpen = true;\r\n\r\n    this.popupView = new HotgraphicPopupView({\r\n      model: this.model\r\n    });\r\n\r\n    notify.popup({\r\n      _attributes: { 'data-adapt-id': this.model.get('_id') },\r\n      _view: this.popupView,\r\n      _isCancellable: true,\r\n      _showCloseButton: false,\r\n      _classes: 'hotgraphic is-component is-hotgraphic ' + this.model.get('_classes')\r\n    });\r\n\r\n    this.listenToOnce(Adapt, {\r\n      'popup:closed': this.onPopupClosed\r\n    });\r\n  }\r\n\r\n  onPopupClosed() {\r\n    this.model.getActiveItem().toggleActive();\r\n    this._isPopupOpen = false;\r\n  }\r\n\r\n}\r\n\r\nHotGraphicView.template = 'hotgraphic';\r\n\r\nexport default HotGraphicView;\r\n","import components from 'core/js/components';\r\nimport HotgraphicView from './hotgraphicView';\r\nimport ItemsComponentModel from 'core/js/models/itemsComponentModel';\r\n\r\nexport default components.register('hotgraphic', {\r\n  model: ItemsComponentModel.extend({}),\r\n  view: HotgraphicView\r\n});\r\n","import QuestionView from 'core/js/views/questionView';\r\n\r\nclass MatchingView extends QuestionView {\r\n\r\n  preinitialize() {\r\n    this.setActiveOption = (...args) => this.model.setActiveOption(...args);\r\n    this.setHighlightedOption = (...args) => this.model.setHighlightedOption(...args);\r\n  }\r\n\r\n  setupQuestion() {\r\n    this.model.setupRandomisation();\r\n    this.model.setupInitialHighlighted();\r\n  }\r\n\r\n  onQuestionRendered() {\r\n    this.setReadyStatus();\r\n  }\r\n\r\n}\r\n\r\nMatchingView.template = 'matching.jsx';\r\n\r\nexport default MatchingView;\r\n","import ItemModel from 'core/js/models/itemModel';\r\n\r\nexport default class MatchingItemModel extends ItemModel {\r\n\r\n  defaults() {\r\n    return ItemModel.resultExtend('defaults', {\r\n      _isHighlighted: false\r\n    });\r\n  }\r\n\r\n  toggleHighlighted(isHighlighted = !this.get('_isHighlighted')) {\r\n    this.set('_isHighlighted', isHighlighted);\r\n  }\r\n\r\n}\r\n","import Adapt from 'core/js/adapt';\r\nimport MatchingItemModel from './MatchingItemModel';\r\nimport ItemsQuestionModel from 'core/js/models/itemsQuestionModel';\r\n\r\nexport default class MatchingModel extends ItemsQuestionModel {\r\n\r\n  toJSON() {\r\n    const json = super.toJSON();\r\n    // Make sure _items and _options is updated from child collection\r\n    json._items = this.get('_items');\r\n    json._options = this.getChildren().toJSON();\r\n    return json;\r\n  }\r\n\r\n  setUpItems() {\r\n    let index = 0;\r\n    const items = (this.get('_items') || []);\r\n    const options = items.reduce((options, item, itemIndex) => {\r\n      item._index = itemIndex;\r\n      const itemOptions = (item._options || []);\r\n      itemOptions.forEach((option, optionIndex) => {\r\n        option._index = index++;\r\n        option._optionIndex = optionIndex;\r\n        option._itemIndex = item._index;\r\n        option._shouldBeSelected = Boolean(option._isCorrect);\r\n      });\r\n      options.push(...itemOptions);\r\n      return options;\r\n    }, []);\r\n    this.set({\r\n      _items: items,\r\n      _selectable: items.length\r\n    });\r\n    // Use _options for getChildren instead of _items.\r\n    // Note: This creates a small gap between the json config and the ItemsQuestionModel apis\r\n    // as 'item' in the api refers now to 'options' from the json. Doing this allows the options\r\n    // to inherit the scoring, save/restore and completion mechanisms normally reserve for _items\r\n    this.setChildren(new Backbone.Collection(options, { model: MatchingItemModel }));\r\n  }\r\n\r\n  setupInitialHighlighted() {\r\n    this.get('_items')?.forEach(({ _index }) => {\r\n      const selectOption = this.getActiveItemOption(_index) || this.getFirstItemOption(_index);\r\n      selectOption?.toggleHighlighted(true);\r\n    });\r\n  }\r\n\r\n  resetItems() {\r\n    super.resetItems();\r\n    this.resetHighlightedItems();\r\n    this.setupInitialHighlighted();\r\n  }\r\n\r\n  resetHighlightedItems() {\r\n    this.getChildren().forEach(option => option.toggleHighlighted(false));\r\n  }\r\n\r\n  canSubmit() {\r\n    // Can submit if every item has an active option\r\n    const options = this.getChildren().models;\r\n    const activeCount = options.reduce((count, option) => (count + (option.get('_isActive') ? 1 : 0)), 0);\r\n    const canSubmit = (activeCount === this.get('_selectable'));\r\n    return canSubmit;\r\n  }\r\n\r\n  getItemOptions(itemIndex) {\r\n    return this.getChildren().filter(option => (option.get('_itemIndex') === itemIndex));\r\n  }\r\n\r\n  getActiveItemOption(itemIndex) {\r\n    return this.getItemOptions(itemIndex).find(option => option.get('_isActive'));\r\n  }\r\n\r\n  getFirstItemOption(itemIndex) {\r\n    return this.getItemOptions(itemIndex)[0];\r\n  }\r\n\r\n  getCorrectItemOption(itemIndex) {\r\n    const activeOption = this.getActiveItemOption(itemIndex);\r\n    return activeOption.get('_shouldBeSelected')\r\n      ? activeOption\r\n      : this.getItemOptions(itemIndex).find(option => option.get('_shouldBeSelected'));\r\n  }\r\n\r\n  setHighlightedOption(optionIndex) {\r\n    const itemIndex = this.getItem(optionIndex).get('_itemIndex');\r\n    const itemOptions = this.getItemOptions(itemIndex);\r\n    itemOptions.forEach(option => {\r\n      const isHighlighted = (option.get('_index') === optionIndex);\r\n      option.toggleHighlighted(isHighlighted);\r\n    });\r\n  }\r\n\r\n  setActiveOption(optionIndex) {\r\n    const itemIndex = this.getItem(optionIndex).get('_itemIndex');\r\n    const itemOptions = this.getItemOptions(itemIndex);\r\n    itemOptions.forEach(option => {\r\n      const isActive = (option.get('_index') === optionIndex);\r\n      option.toggleHighlighted(isActive);\r\n      option.toggleActive(isActive);\r\n    });\r\n    this.unsetDuplicateOptions(optionIndex);\r\n  }\r\n\r\n  unsetDuplicateOptions(optionIndex) {\r\n    const allowOnlyUniqueAnswers = this.get('_allowOnlyUniqueAnswers');\r\n    if (!allowOnlyUniqueAnswers) return;\r\n    const itemIndex = this.getItem(optionIndex).get('_itemIndex');\r\n    const activeItemOption = this.getActiveItemOption(itemIndex);\r\n    const activeItemOptionText = activeItemOption.get('text');\r\n    const otherActiveOptions = this.getChildren().filter(option => (option !== activeItemOption) && option.get('_isActive'));\r\n    otherActiveOptions.forEach(option => {\r\n      const optionText = option.get('text');\r\n      const hasMatchingText = (activeItemOptionText === optionText);\r\n      if (!hasMatchingText) return;\r\n      option.toggleHighlighted(false);\r\n      option.toggleActive(false);\r\n    });\r\n  }\r\n\r\n  get maxScore() {\r\n    if (!this.get('_hasItemScoring')) return super.maxScore;\r\n    const items = this.get('_items') || [];\r\n    const maxItemScores = items.map(({ _index }) => {\r\n      const itemOptions = this.getItemOptions(_index);\r\n      const optionScores = itemOptions.map(child => child.get('_score') || 0);\r\n      optionScores.sort((a, b) => a - b);\r\n      return optionScores[optionScores.length - 1] || 0;\r\n    });\r\n    maxItemScores.sort((a, b) => a - b);\r\n    return maxItemScores.reverse().filter(score => score > 0).reduce((maxScore, score) => (maxScore += score), 0);\r\n  }\r\n\r\n  get minScore() {\r\n    if (!this.get('_hasItemScoring')) return super.minScore;\r\n    const items = this.get('_items') || [];\r\n    const minItemScores = items.map(({ _index }) => {\r\n      const itemOptions = this.getItemOptions(_index);\r\n      const optionScores = itemOptions.map(child => child.get('_score') || 0);\r\n      optionScores.sort((a, b) => a - b);\r\n      return optionScores[0] || 0;\r\n    });\r\n    minItemScores.sort((a, b) => a - b);\r\n    return minItemScores.filter(score => score < 0).reduce((minScore, score) => (minScore += score), 0);\r\n  }\r\n\r\n  /**\r\n   * Used by tracking extensions to return an object containing the component's specific interactions.\r\n   */\r\n  getInteractionObject() {\r\n    const items = this.get('_items');\r\n    const interactions = {\r\n      correctResponsesPattern: null,\r\n      source: null,\r\n      target: null\r\n    };\r\n    // This contains an array with a single string value, matching the source 'id' with the correct\r\n    // matching target 'id' value. An example is as follows:\r\n    // [ \"1[.]1_2[,]2[.]2_3\" ]\r\n    interactions.correctResponsesPattern = [\r\n      items.map((item) => {\r\n        // Offset the item index and use it as a group identifier.\r\n        const itemPosition = item._index + 1;\r\n        const itemOptions = this.getItemOptions(item._index).sort((a, b) => a.get('_index') - b.get('_index'));\r\n        return [\r\n          itemPosition,\r\n          // Get the correct item(s).\r\n          itemOptions.filter(option => option.get('_shouldBeSelected')).map(option => {\r\n            // Prefix the option's index and offset by 1.\r\n            const optionPosition = option.get('_optionIndex') + 1;\r\n            return `${itemPosition}_${optionPosition}`;\r\n          })\r\n        ].join('[.]');\r\n      }).join('[,]')\r\n    ];\r\n    // The 'source' property contains an array of all the stems/questions, e.g.\r\n    // [{id: \"1\", description: \"First question\"}, {id: \"2\", description: \"Second question\"}]\r\n    interactions.source = items.map(item => {\r\n      const itemPosition = item._index + 1;\r\n      return {\r\n        // Offset by 1.\r\n        id: `${itemPosition}`,\r\n        description: item.text\r\n      };\r\n    }).flat(Infinity);\r\n    // The 'target' property contains an array of all the option responses, with the 'id'\r\n    // prefixed to indicate the grouping, e.g.\r\n    // [  {id: \"1_1\": description: \"First option, group 1\"},\r\n    //    {id: \"1_2\": description: \"Second option, group 1\"}\r\n    //    {id: \"2_1\": description: \"First option, group 2\"}  ]\r\n    interactions.target = items.map(item => {\r\n      // Offset by 1, as these values are not zero-indexed.\r\n      const itemPosition = item._index + 1;\r\n      const itemOptions = this.getItemOptions(item._index).sort((a, b) => a.get('_index') - b.get('_index'));\r\n      return itemOptions.map(option => {\r\n        const optionPosition = option.get('_optionIndex') + 1;\r\n        return {\r\n          id: `${itemPosition}_${optionPosition}`,\r\n          description: option.get('text')\r\n        };\r\n      });\r\n    }).flat(Infinity);\r\n    return interactions;\r\n  }\r\n\r\n  /**\r\n   * Used by adapt-contrib-spoor to get the user's answers in the format required by the cmi.interactions.n.student_response data field\r\n   * @return {string} the user's answers as a string in the format \"1.1#2.3#3.2\" assuming user selected option 1 in drop-down 1,\r\n   * option 3 in drop-down 2 and option 2 in drop-down 3. The '#' character will be changed to either ',' or '[,]' by adapt-contrib-spoor,\r\n   * depending on which SCORM version is being used.\r\n   */\r\n  getResponse() {\r\n    const items = this.get('_items');\r\n    const responses = items.map(({ _index }) => {\r\n      const activeOption = this.getActiveItemOption(_index);\r\n      // convert from 0-based to 1-based counting\r\n      const itemIndex = _index + 1;\r\n      const optionIndex = activeOption.get('_optionIndex') + 1;\r\n      return `${itemIndex}.${optionIndex}`;\r\n    });\r\n    return responses.join('#');\r\n  }\r\n\r\n  /**\r\n   * Used by adapt-contrib-spoor to get the type of this question in the format required by the cmi.interactions.n.type data field\r\n   * @return {string}\r\n   */\r\n  getResponseType() {\r\n    return 'matching';\r\n  }\r\n\r\n  /**\r\n   * Creates a string explaining the answers the learner should have chosen\r\n   * Used by ButtonsView to retrieve question-specific correct answer text for the ARIA\r\n   * 'live region' that gets updated when the learner selects the 'show correct answer' button\r\n   * @return {string}\r\n   */\r\n  getCorrectAnswerAsText() {\r\n    const correctAnswerTemplate = Adapt.course.get('_globals')._components._matching.ariaCorrectAnswer;\r\n    const ariaAnswer = this.get('_items').map(item => {\r\n      const correctOption = this.getCorrectItemOption(item._index);\r\n      return Handlebars.compile(correctAnswerTemplate)({\r\n        itemText: item.text,\r\n        correctAnswer: correctOption.get('text')\r\n      });\r\n    }).join('<br>');\r\n\r\n    return ariaAnswer;\r\n  }\r\n\r\n  /**\r\n   * Creates a string listing the answers the learner chose\r\n   * Used by ButtonsView to retrieve question-specific user answer text for the ARIA\r\n   * 'live region' that gets updated when the learner selects the 'hide correct answer' button\r\n   * @return {string}\r\n   */\r\n  getUserAnswerAsText() {\r\n    const userAnswerTemplate = Adapt.course.get('_globals')._components._matching.ariaUserAnswer;\r\n    const items = this.get('_items');\r\n    const ariaAnswer = items.map(item => {\r\n      const activeOption = this.getActiveItemOption(item._index);\r\n      return Handlebars.compile(userAnswerTemplate)({\r\n        itemText: item.text,\r\n        userAnswer: activeOption.get('text')\r\n      });\r\n    }).join('<br>');\r\n\r\n    return ariaAnswer;\r\n  }\r\n}\r\n","import components from 'core/js/components';\r\nimport MatchingView from './MatchingView';\r\nimport MatchingModel from './MatchingModel';\r\n\r\nexport default components.register('matching', {\r\n  view: MatchingView,\r\n  model: MatchingModel\r\n});\r\n","import components from 'core/js/components';\r\nimport McqView from './McqView';\r\nimport McqModel from './McqModel';\r\n\r\nexport default components.register('mcq', {\r\n  model: McqModel,\r\n  view: McqView\r\n});\r\n","define([\r\n  'core/js/adapt',\r\n  'core/js/device',\r\n  'libraries/mediaelement-and-player'\r\n], function(Adapt, device) {\r\n  var mepPrototype = $.extend({}, window.mejs.MediaElementPlayer.prototype);\r\n\r\n  $.extend(window.mejs.MediaElementPlayer.prototype, {\r\n    /**\r\n    * fixes a bug (adaptlearning/adapt_framework#1478)\r\n    * where the media player going into/coming out of full-screen mode would trigger inview on\r\n    * components below it; we therefore need to switch off inview when entering full screen mode\r\n    * and switch it back on again after exiting full screen mode\r\n    */\r\n    detectFullscreenMode: function() {\r\n      var vendorPrefix = this.getVendorPrefix();\r\n      var fsEventName = 'on' + vendorPrefix + 'fullscreenchange';\r\n\r\n      if (document[fsEventName] === null) {\r\n        document[fsEventName] = function fullScreenEventHandler() {\r\n\r\n          var elementName = (vendorPrefix === '' ? 'fullscreenElement' : vendorPrefix + 'FullscreenElement');\r\n\r\n          if (document[elementName] !== null) {\r\n            $.inview.lock('mediaelement');\r\n            Adapt.trigger('media:fullscreen:enter');\r\n          } else {\r\n            $.inview.unlock('mediaelement');\r\n            Adapt.trigger('media:fullscreen:exit');\r\n          }\r\n        };\r\n      }\r\n      return mepPrototype.detectFullscreenMode.apply(this, arguments);\r\n    },\r\n\r\n    /**\r\n    * because the fullscreen events and properties are still vendor-prefixed in some browsers...\r\n    */\r\n    getVendorPrefix: function() {\r\n      var browser = device.browser;\r\n\r\n      if (browser === 'internet explorer') {\r\n        return 'ms';\r\n      }\r\n\r\n      if (browser === 'microsoft edge' || browser === 'safari') {\r\n        return 'webkit';\r\n      }\r\n\r\n      return ''; // Chrome, Opera and Firefox no longer require a vendor prefix\r\n    }\r\n  });\r\n});\r\n","import Adapt from 'core/js/adapt';\r\nimport offlineStorage from 'core/js/offlineStorage';\r\nimport a11y from 'core/js/a11y';\r\nimport logging from 'core/js/logging';\r\nimport ComponentView from 'core/js/views/componentView';\r\nimport 'libraries/mediaelement-and-player';\r\nimport 'libraries/mediaelement-fullscreen-hook';\r\n\r\n/*\r\n  * Default shortcut keys trap a screen reader user inside the player once in focus. These keys are unnecessary\r\n  * as one may traverse the player in a linear fashion without needing to know or use shortcut keys. Below is\r\n  * the removal of the default shortcut keys.\r\n  *\r\n  * The default seek interval functions are passed two different data types from mejs which they handle incorrectly. One\r\n  * is a duration integer the other is the player object. The default functions error on slider key press and so break\r\n  * accessibility. Below is a correction.\r\n  */\r\n\r\nObject.assign(window.mejs.MepDefaults, {\r\n  keyActions: [],\r\n  defaultSeekForwardInterval: duration => {\r\n    if (typeof duration === 'object') return duration.duration * 0.05;\r\n    return duration * 0.05;\r\n  },\r\n  defaultSeekBackwardInterval: duration => {\r\n    if (typeof duration === 'object') return duration.duration * 0.05;\r\n    return duration * 0.05;\r\n  }\r\n});\r\n\r\n// The following function is used to to prevent a memory leak in Internet Explorer\r\n// See: http://javascript.crockford.com/memory/leak.html\r\nconst purge = function(d) {\r\n  let a = d.attributes;\r\n  if (a) {\r\n    for (let i = a.length - 1; i >= 0; i -= 1) {\r\n      const n = a[i].name;\r\n      if (typeof d[n] === 'function') {\r\n        d[n] = null;\r\n      }\r\n    }\r\n  }\r\n  a = d.childNodes;\r\n  if (a) {\r\n    for (let i = 0, count = a.length; i < count; i += 1) {\r\n      purge(d.childNodes[i]);\r\n    }\r\n  }\r\n};\r\n\r\n/**\r\n * Force the default language so that the aria-label can be localised from Adapt\r\n * Note: Do not change these, their names and values are required for mapping in mejs\r\n */\r\nwindow.mejs.i18n.locale.language = 'en-US';\r\nwindow.mejs.i18n.locale.strings['en-US'] = {};\r\nconst ariaLabelMappings = {\r\n  playText: 'Play',\r\n  pauseText: 'Pause',\r\n  stopText: 'Stop',\r\n  audioPlayerText: 'Audio Player',\r\n  videoPlayerText: 'Video Player',\r\n  tracksText: 'Captions/Subtitles',\r\n  timeSliderText: 'Time Slider',\r\n  muteText: 'Mute Toggle',\r\n  unmuteStatusText: 'Unmute',\r\n  muteStatusText: 'Mute',\r\n  volumeSliderText: 'Volume Slider',\r\n  fullscreenText: 'Fullscreen',\r\n  goFullscreenText: 'Go Fullscreen',\r\n  turnOffFullscreenText: 'Turn off Fullscreen',\r\n  noneText: 'None',\r\n  skipBackText: 'Skip back %1 seconds',\r\n  allyVolumeControlText: 'Use Up/Down Arrow keys to increase or decrease volume.',\r\n  progessHelpText: 'Use Left/Right Arrow keys to advance one second, Up/Down arrows to advance ten seconds.'\r\n};\r\n\r\nAdapt.on('app:dataReady', () => {\r\n  // Populate the aria labels from the _global._components._media\r\n  const dynamicLabels = window.mejs.i18n.locale.strings['en-US'];\r\n  const fixedDefaults = window.mejs.MepDefaults;\r\n  const globals = Adapt.course.get('_globals')?._components?._media;\r\n  for (const k in ariaLabelMappings) {\r\n    dynamicLabels[ariaLabelMappings[k]] = globals[k] ?? ariaLabelMappings[k];\r\n    fixedDefaults[k] = dynamicLabels[ariaLabelMappings[k]];\r\n  }\r\n});\r\n\r\nclass MediaView extends ComponentView {\r\n\r\n  events() {\r\n    return {\r\n      'click .js-media-inline-transcript-toggle': 'onToggleInlineTranscript',\r\n      'click .js-media-external-transcript-click': 'onExternalTranscriptClicked',\r\n      'click .js-skip-to-transcript': 'onSkipToTranscript'\r\n    };\r\n  }\r\n\r\n  className() {\r\n    let classes = super.className();\r\n    const playerOptions = this.model.get('_playerOptions');\r\n    if (playerOptions?.toggleCaptionsButtonWhenOnlyOne) {\r\n      classes += ' toggle-captions';\r\n    }\r\n    return classes;\r\n  }\r\n\r\n  preRender() {\r\n    this.listenTo(Adapt, {\r\n      'device:resize': this.onScreenSizeChanged,\r\n      'device:changed': this.onDeviceChanged,\r\n      'media:stop': this.onMediaStop\r\n    });\r\n\r\n    _.bindAll(this, 'onMediaElementPlay', 'onMediaElementPause', 'onMediaElementEnded', 'onMediaElementTimeUpdate', 'onMediaElementSeeking', 'onOverlayClick', 'onMediaElementClick', 'onWidgetInview');\r\n\r\n    // set initial player state attributes\r\n    this.model.set({\r\n      _isMediaEnded: false,\r\n      _isMediaPlaying: false\r\n    });\r\n\r\n    if (!this.model.get('_media').source) return;\r\n    const media = this.model.get('_media');\r\n\r\n    // Avoid loading of Mixed Content (insecure content on a secure page)\r\n    if (window.location.protocol === 'https:' && media.source.indexOf('http:') === 0) {\r\n      media.source = media.source.replace(/^http:/, 'https:');\r\n    }\r\n\r\n    this.model.set('_media', media);\r\n  }\r\n\r\n  postRender() {\r\n    this.setupPlayer();\r\n    this.addMejsButtonClass();\r\n  }\r\n\r\n  addMejsButtonClass() {\r\n    this.$('.mejs-overlay-button').addClass('icon');\r\n  }\r\n\r\n  setupPlayer() {\r\n    if (!this.model.get('_playerOptions')) this.model.set('_playerOptions', {});\r\n\r\n    const modelOptions = this.model.get('_playerOptions');\r\n\r\n    if (modelOptions.pluginPath === undefined) {\r\n      // on the off-chance anyone still needs to use the Flash-based player...\r\n      _.extend(modelOptions, {\r\n        pluginPath: 'https://cdnjs.cloudflare.com/ajax/libs/mediaelement/2.21.2/',\r\n        flashName: 'flashmediaelement-cdn.swf',\r\n        flashScriptAccess: 'always'\r\n      });\r\n    }\r\n\r\n    if (modelOptions.features === undefined) {\r\n      modelOptions.features = ['playpause', 'progress', 'current', 'duration'];\r\n      if (this.model.get('_useClosedCaptions')) {\r\n        modelOptions.features.unshift('tracks');\r\n      }\r\n      if (this.model.get('_allowFullScreen')) {\r\n        modelOptions.features.push('fullscreen');\r\n      }\r\n      if (this.model.get('_showVolumeControl')) {\r\n        modelOptions.features.push('volume');\r\n      }\r\n    }\r\n\r\n    /*\r\n    Unless we are on Android/iOS and using native controls, when MediaElementJS initializes the player\r\n    it will invoke the success callback prior to performing one last call to setPlayerSize.\r\n    This call to setPlayerSize is deferred by 50ms so we add a delay of 100ms here to ensure that\r\n    we don't invoke setReadyStatus until the player is definitely finished rendering.\r\n    */\r\n    modelOptions.success = _.debounce(this.onPlayerReady.bind(this), 100);\r\n\r\n    if (this.model.get('_useClosedCaptions')) {\r\n      const startLanguage = this.model.get('_startLanguage') || 'en';\r\n      if (!offlineStorage.get('captions')) {\r\n        offlineStorage.set('captions', startLanguage);\r\n      }\r\n      modelOptions.startLanguage = this.checkForSupportedCCLanguage(offlineStorage.get('captions'));\r\n    }\r\n\r\n    if (modelOptions.alwaysShowControls === undefined) {\r\n      modelOptions.alwaysShowControls = false;\r\n    }\r\n    if (modelOptions.hideVideoControlsOnLoad === undefined) {\r\n      modelOptions.hideVideoControlsOnLoad = true;\r\n    }\r\n\r\n    this.addMediaTypeClass();\r\n\r\n    this.addThirdPartyFixes(modelOptions, () => {\r\n      // create the player\r\n      this.$('audio, video').mediaelementplayer(modelOptions);\r\n      this.cleanUpPlayer();\r\n\r\n      const _media = this.model.get('_media');\r\n      // if no media is selected - set ready now, as success won't be called\r\n      if (!_media.mp3 && !_media.mp4 && !_media.ogv && !_media.webm && !_media.source) {\r\n        logging.warn('ERROR! No media is selected in components.json for component ' + this.model.get('_id'));\r\n        this.setReadyStatus();\r\n        return;\r\n      }\r\n      // Check if we're streaming\r\n      if (!_media.source) return;\r\n      this.$('.media__widget').addClass('external-source');\r\n    });\r\n  }\r\n\r\n  addMediaTypeClass() {\r\n    const media = this.model.get('_media');\r\n    if (!media?.type) return;\r\n    const typeClass = media.type.replace(/\\//, '-');\r\n    this.$('.media__widget').addClass(typeClass);\r\n  }\r\n\r\n  addThirdPartyFixes(modelOptions, callback) {\r\n    const media = this.model.get('_media');\r\n    if (!media) return callback();\r\n\r\n    if (media.mp3 || media.ogg) {\r\n      // https://github.com/adaptlearning/adapt_framework/issues/3055\r\n      modelOptions.alwaysShowControls = true;\r\n    }\r\n\r\n    switch (media.type) {\r\n      case 'video/vimeo':\r\n        modelOptions.alwaysShowControls = false;\r\n        modelOptions.hideVideoControlsOnLoad = true;\r\n        modelOptions.features = [];\r\n        if (MediaView.froogaloopAdded) return callback();\r\n        $.getScript('assets/froogaloop.js')\r\n          .done(() => {\r\n            MediaView.froogaloopAdded = true;\r\n            callback();\r\n          })\r\n          .fail(() => {\r\n            MediaView.froogaloopAdded = false;\r\n            logging.error('Could not load froogaloop.js');\r\n          });\r\n        break;\r\n      default:\r\n        callback();\r\n    }\r\n  }\r\n\r\n  cleanUpPlayer() {\r\n    const containerLabel = this.model.get('displayTitle') || this.model.get('title');\r\n    this.$('.media__widget').children('.mejs-offscreen').remove();\r\n    this.$('[role=application]').removeAttr('role tabindex');\r\n    this.$('.mejs-container').attr({\r\n      role: 'region',\r\n      'aria-label': containerLabel\r\n    });\r\n    this.$('[aria-controls]').removeAttr('aria-controls');\r\n    this.$('.mejs-overlay-play').attr('aria-hidden', 'true');\r\n  }\r\n\r\n  setupEventListeners() {\r\n    this.completionEvent = (this.model.get('_setCompletionOn') || 'play');\r\n\r\n    if (this.completionEvent === 'inview') {\r\n      this.setupInviewCompletion('.component__widget');\r\n    }\r\n\r\n    // wrapper to check if preventForwardScrubbing is turned on.\r\n    if ((this.model.get('_preventForwardScrubbing')) && (!this.model.get('_isComplete'))) {\r\n      $(this.mediaElement).on({\r\n        seeking: this.onMediaElementSeeking,\r\n        timeupdate: this.onMediaElementTimeUpdate\r\n      });\r\n    }\r\n\r\n    // handle other completion events in the event Listeners\r\n    $(this.mediaElement).on({\r\n      play: this.onMediaElementPlay,\r\n      pause: this.onMediaElementPause,\r\n      ended: this.onMediaElementEnded\r\n    });\r\n\r\n    // occasionally the mejs code triggers a click of the captions language\r\n    // selector during setup, this slight delay ensures we skip that\r\n    _.delay(this.listenForCaptionsChange.bind(this), 250);\r\n  }\r\n\r\n  /**\r\n   * Sets up the component to detect when the user has changed the captions so that it can store the user's\r\n   * choice in offlineStorage and notify other media components on the same page of the change\r\n   * Also sets the component up to listen for this event from other media components on the same page\r\n   */\r\n  listenForCaptionsChange() {\r\n    if (!this.model.get('_useClosedCaptions')) return;\r\n\r\n    const selector = this.model.get('_playerOptions').toggleCaptionsButtonWhenOnlyOne ?\r\n      '.mejs-captions-button button' :\r\n      '.mejs-captions-selector';\r\n\r\n    this.$(selector).on('click.mediaCaptionsChange', _.debounce(() => {\r\n      const srclang = this.mediaElement.player.selectedTrack ? this.mediaElement.player.selectedTrack.srclang : 'none';\r\n      offlineStorage.set('captions', srclang);\r\n      Adapt.trigger('media:captionsChange', this, srclang);\r\n    }, 250)); // needs debouncing because the click event fires twice\r\n\r\n    this.listenTo(Adapt, 'media:captionsChange', this.onCaptionsChanged);\r\n  }\r\n\r\n  /**\r\n   * Handles updating the captions in this instance when learner changes captions in another\r\n   * media component on the same page\r\n   * @param {Backbone.View} view The view instance that triggered the event\r\n   * @param {string} lang The captions language the learner chose in the other media component\r\n   */\r\n  onCaptionsChanged(view, lang) {\r\n    if (view?.cid === this.cid) return; // ignore the event if we triggered it\r\n\r\n    lang = this.checkForSupportedCCLanguage(lang);\r\n\r\n    this.mediaElement.player.setTrack(lang);\r\n\r\n    // because calling player.setTrack doesn't update the cc button's languages popup...\r\n    const $inputs = this.$('.mejs-captions-selector input');\r\n    $inputs.filter(':checked').prop('checked', false);\r\n    $inputs.filter(`[value=\"${lang}\"]`).prop('checked', true);\r\n  }\r\n\r\n  /**\r\n   * When the learner selects a captions language in another media component, that language may not be available\r\n   * in this instance, in which case default to the `_startLanguage` if that's set - or \"none\" if it's not\r\n   * @param {string} lang The language we're being asked to switch to e.g. \"de\"\r\n   * @return {string} The language we're actually going to switch to - or \"none\" if there's no good match\r\n   */\r\n  checkForSupportedCCLanguage(lang) {\r\n    if (!lang || lang === 'none') return 'none';\r\n\r\n    if (_.findWhere(this.model.get('_media').cc, { srclang: lang })) return lang;\r\n\r\n    return this.model.get('_startLanguage') || 'none';\r\n  }\r\n\r\n  onMediaElementPlay(event) {\r\n    this.queueGlobalEvent('play');\r\n\r\n    Adapt.trigger('media:stop', this);\r\n\r\n    if (this.model.get('_pauseWhenOffScreen')) {\r\n      this.$('.mejs-container').on('inview', this.onWidgetInview);\r\n    }\r\n\r\n    this.model.set({\r\n      _isMediaPlaying: true,\r\n      _isMediaEnded: false\r\n    });\r\n\r\n    if (this.completionEvent !== 'play') return;\r\n    this.setCompletionStatus();\r\n  }\r\n\r\n  onMediaElementPause(event) {\r\n    this.queueGlobalEvent('pause');\r\n\r\n    this.$('.mejs-container').off('inview', this.onWidgetInview);\r\n\r\n    this.model.set('_isMediaPlaying', false);\r\n  }\r\n\r\n  onMediaElementEnded(event) {\r\n    this.queueGlobalEvent('ended');\r\n\r\n    this.model.set('_isMediaEnded', true);\r\n\r\n    if (this.completionEvent === 'ended') {\r\n      this.setCompletionStatus();\r\n    }\r\n  }\r\n\r\n  onWidgetInview(event, isInView) {\r\n    if (!isInView && !this.mediaElement.paused) this.mediaElement.player.pause();\r\n  }\r\n\r\n  onMediaElementSeeking(event) {\r\n    let maxViewed = this.model.get('_maxViewed');\r\n    if (!maxViewed) {\r\n      maxViewed = 0;\r\n    }\r\n    if (event.target.currentTime <= maxViewed) return;\r\n    event.target.currentTime = maxViewed;\r\n  }\r\n\r\n  onMediaElementTimeUpdate(event) {\r\n    let maxViewed = this.model.get('_maxViewed');\r\n    if (!maxViewed) {\r\n      maxViewed = 0;\r\n    }\r\n    if (event.target.currentTime <= maxViewed) return;\r\n    this.model.set('_maxViewed', event.target.currentTime);\r\n  }\r\n\r\n  // Overrides the default play/pause functionality to stop accidental playing on touch devices\r\n  setupPlayPauseToggle() {\r\n    // bit sneaky, but we don't have a this.mediaElement.player ref on iOS devices\r\n    const player = this.mediaElement.player;\r\n\r\n    if (!player) {\r\n      logging.warn('MediaView.setupPlayPauseToggle: OOPS! there is no player reference.');\r\n      return;\r\n    }\r\n\r\n    // stop the player dealing with this, we'll do it ourselves\r\n    player.options.clickToPlayPause = false;\r\n\r\n    // play on 'big button' click\r\n    this.$('.mejs-overlay-button').on('click', this.onOverlayClick);\r\n\r\n    // pause on player click\r\n    this.$('.mejs-mediaelement').on('click', this.onMediaElementClick);\r\n  }\r\n\r\n  onMediaStop(view) {\r\n\r\n    // Make sure this view isn't triggering media:stop\r\n    if (view?.cid === this.cid) return;\r\n\r\n    if (!this.mediaElement || !this.mediaElement.player) return;\r\n\r\n    this.mediaElement.player.pause();\r\n\r\n  }\r\n\r\n  onOverlayClick() {\r\n    const player = this.mediaElement.player;\r\n    if (!player) return;\r\n\r\n    player.play();\r\n  }\r\n\r\n  onMediaElementClick(event) {\r\n    const player = this.mediaElement.player;\r\n    if (!player) return;\r\n\r\n    const isPaused = player.media.paused;\r\n    if (!isPaused) player.pause();\r\n  }\r\n\r\n  remove() {\r\n    this.$('.mejs-overlay-button').off('click', this.onOverlayClick);\r\n    this.$('.mejs-mediaelement').off('click', this.onMediaElementClick);\r\n    this.$('.mejs-container').off('inview', this.onWidgetInview);\r\n\r\n    if (this.model.get('_useClosedCaptions')) {\r\n      const selector = this.model.get('_playerOptions').toggleCaptionsButtonWhenOnlyOne ?\r\n        '.mejs-captions-button button' :\r\n        '.mejs-captions-selector';\r\n      this.$(selector).off('click.mediaCaptionsChange');\r\n    }\r\n\r\n    const modelOptions = this.model.get('_playerOptions');\r\n    delete modelOptions.success;\r\n\r\n    const media = this.model.get('_media');\r\n    if (media) {\r\n      switch (media.type) {\r\n        case 'video/vimeo':\r\n          this.$('iframe')[0].isRemoved = true;\r\n      }\r\n    }\r\n\r\n    if (this.mediaElement && this.mediaElement.player) {\r\n      const playerId = this.mediaElement.player.id;\r\n\r\n      purge(this.$el[0]);\r\n      this.mediaElement.player.remove();\r\n\r\n      if (window.mejs.players[playerId]) {\r\n        delete window.mejs.players[playerId];\r\n      }\r\n    }\r\n\r\n    if (this.mediaElement) {\r\n      $(this.mediaElement).off({\r\n        play: this.onMediaElementPlay,\r\n        pause: this.onMediaElementPause,\r\n        ended: this.onMediaElementEnded,\r\n        seeking: this.onMediaElementSeeking,\r\n        timeupdate: this.onMediaElementTimeUpdate\r\n      });\r\n\r\n      this.mediaElement.src = '';\r\n      $(this.mediaElement.pluginElement).remove();\r\n      delete this.mediaElement;\r\n    }\r\n\r\n    super.remove();\r\n  }\r\n\r\n  onDeviceChanged() {\r\n    if (!this.model.get('_media').source) return;\r\n    this.$('.mejs-container').width(this.$('.component__widget').width());\r\n  }\r\n\r\n  onPlayerReady(mediaElement, domObject) {\r\n    this.mediaElement = mediaElement;\r\n\r\n    let player = this.mediaElement.player;\r\n    if (!player) player = window.mejs.players[this.$('.mejs-container').attr('id')];\r\n\r\n    const hasTouch = window.mejs.MediaFeatures.hasTouch;\r\n    if (hasTouch) {\r\n      this.setupPlayPauseToggle();\r\n    }\r\n\r\n    this.addThirdPartyAfterFixes();\r\n    this.cleanUpPlayerAfter();\r\n\r\n    if (player && this.model.has('_startVolume')) {\r\n      // Setting the start volume only works with the Flash-based player if you do it here rather than in setupPlayer\r\n      player.setVolume(parseInt(this.model.get('_startVolume')) / 100);\r\n    }\r\n\r\n    this.setReadyStatus();\r\n    this.setupEventListeners();\r\n  }\r\n\r\n  addThirdPartyAfterFixes() {\r\n    const media = this.model.get('_media');\r\n    switch (media.type) {\r\n      case 'video/vimeo':\r\n        this.$('.mejs-container').attr('tabindex', 0);\r\n    }\r\n  }\r\n\r\n  cleanUpPlayerAfter() {\r\n    this.$(\"[aria-valuemax='NaN']\").attr('aria-valuemax', 0);\r\n  }\r\n\r\n  onScreenSizeChanged() {\r\n    this.$('audio, video').width(this.$('.component__widget').width());\r\n  }\r\n\r\n  onSkipToTranscript() {\r\n    // need slight delay before focussing button to make it work when JAWS is running\r\n    // see https://github.com/adaptlearning/adapt_framework/issues/2427\r\n    _.delay(() => {\r\n      a11y.focus(this.$('.media__transcript-btn'));\r\n    }, 250);\r\n  }\r\n\r\n  onToggleInlineTranscript(event) {\r\n    if (event) event.preventDefault();\r\n    const $transcriptBodyContainer = this.$('.media__transcript-body-inline');\r\n    const $button = this.$('.media__transcript-btn-inline');\r\n    const $buttonText = this.$('.media__transcript-btn-inline .media__transcript-btn-text');\r\n\r\n    if ($transcriptBodyContainer.hasClass('inline-transcript-open')) {\r\n      $transcriptBodyContainer.stop(true, true).slideUp(() => {\r\n        $(window).resize();\r\n      }).removeClass('inline-transcript-open');\r\n      $button.attr('aria-expanded', false);\r\n      $buttonText.html(this.model.get('_transcript').inlineTranscriptButton);\r\n\r\n      return;\r\n    }\r\n\r\n    $transcriptBodyContainer.stop(true, true).slideDown(() => {\r\n      $(window).resize();\r\n    }).addClass('inline-transcript-open');\r\n\r\n    $button.attr('aria-expanded', true);\r\n    $buttonText.html(this.model.get('_transcript').inlineTranscriptCloseButton);\r\n\r\n    if (this.model.get('_transcript')._setCompletionOnView !== false) {\r\n      this.setCompletionStatus();\r\n    }\r\n  }\r\n\r\n  onExternalTranscriptClicked(event) {\r\n    if (this.model.get('_transcript')._setCompletionOnView === false) return;\r\n    this.setCompletionStatus();\r\n  }\r\n\r\n  /**\r\n   * Queue firing a media event to prevent simultaneous events firing, and provide a better indication of how the\r\n   * media  player is behaving\r\n   * @param {string} eventType\r\n   */\r\n  queueGlobalEvent(eventType) {\r\n    const time = Date.now();\r\n    const lastEvent = this.lastEvent || { time: 0 };\r\n    const timeSinceLastEvent = time - lastEvent.time;\r\n    const debounceTime = 500;\r\n\r\n    this.lastEvent = {\r\n      time,\r\n      type: eventType\r\n    };\r\n\r\n    // Clear any existing timeouts\r\n    clearTimeout(this.eventTimeout);\r\n\r\n    // Always trigger 'ended' events\r\n    if (eventType === 'ended') {\r\n      return this.triggerGlobalEvent(eventType);\r\n    }\r\n\r\n    // Fire the event after a delay, only if another event has not just been fired\r\n    if (timeSinceLastEvent <= debounceTime) return;\r\n    this.eventTimeout = setTimeout(this.triggerGlobalEvent.bind(this, eventType), debounceTime);\r\n  }\r\n\r\n  triggerGlobalEvent(eventType) {\r\n    const player = this.mediaElement.player;\r\n\r\n    const eventObj = {\r\n      type: eventType,\r\n      src: this.mediaElement.src,\r\n      platform: this.mediaElement.pluginType\r\n    };\r\n\r\n    if (player) eventObj.isVideo = player.isVideo;\r\n\r\n    Adapt.trigger('media', eventObj);\r\n  }\r\n\r\n}\r\n\r\nMediaView.froogaloopAdded = false;\r\n\r\nexport default MediaView;\r\n","import components from 'core/js/components';\r\nimport MediaView from './mediaView';\r\nimport ComponentModel from 'core/js/models/componentModel';\r\n\r\nexport default components.register('media', {\r\n  // create a new class in the inheritance chain so it can be extended per component type if necessary later\r\n  model: ComponentModel.extend({}),\r\n  view: MediaView\r\n});\r\n","import ItemsComponentModel from 'core/js/models/itemsComponentModel';\r\n\r\nexport default class NarrativeModel extends ItemsComponentModel {}\r\n","export default new ENUM([\r\n  'SMALL',\r\n  'LARGE'\r\n]);\r\n","import Adapt from 'core/js/adapt';\r\nimport components from 'core/js/components';\r\nimport a11y from 'core/js/a11y';\r\nimport device from 'core/js/device';\r\nimport notify from 'core/js/notify';\r\nimport ComponentView from 'core/js/views/componentView';\r\nimport MODE from './modeEnum';\r\n\r\nclass NarrativeView extends ComponentView {\r\n\r\n  events() {\r\n    return {\r\n      'click .js-narrative-strapline-open-popup': 'openPopup',\r\n      'click .js-narrative-controls-click': 'onNavigationClicked',\r\n      'click .js-narrative-progress-click': 'onProgressClicked',\r\n      'swipeleft .js-narrative-swipe': 'onSwipeLeft',\r\n      'swiperight .js-narrative-swipe': 'onSwipeRight'\r\n    };\r\n  }\r\n\r\n  initialize(...args) {\r\n    super.initialize(...args);\r\n\r\n    this._isInitial = true;\r\n  }\r\n\r\n  preRender() {\r\n    this.listenTo(Adapt, {\r\n      'device:changed device:resize': this.reRender,\r\n      'notify:closed': this.closeNotify\r\n    });\r\n    this.renderMode();\r\n\r\n    this.listenTo(this.model.getChildren(), {\r\n      'change:_isActive': this.onItemsActiveChange,\r\n      'change:_isVisited': this.onItemsVisitedChange\r\n    });\r\n\r\n    this.calculateWidths();\r\n  }\r\n\r\n  onItemsActiveChange(item, _isActive) {\r\n    if (!_isActive) return;\r\n    if (this.isTextBelowImage()) {\r\n      item.toggleVisited(true);\r\n    }\r\n    this.setStage(item);\r\n    this.setFocus(item.get('_index'));\r\n  }\r\n\r\n  setFocus(itemIndex) {\r\n    if (this._isInitial) return;\r\n    const $straplineHeaderElm = this.$('.narrative__strapline-header-inner');\r\n    const hasStraplineTransition = !this.isLargeMode() && ($straplineHeaderElm.css('transitionDuration') !== '0s');\r\n    if (hasStraplineTransition) {\r\n      $straplineHeaderElm.one('transitionend', () => {\r\n        this.focusOnNarrativeElement(itemIndex);\r\n      });\r\n      return;\r\n    }\r\n\r\n    this.focusOnNarrativeElement(itemIndex);\r\n  }\r\n\r\n  focusOnNarrativeElement(itemIndex) {\r\n    const dataIndexAttr = `[data-index='${itemIndex}']`;\r\n    const $elementToFocus = this.isLargeMode() ?\r\n      this.$(`.narrative__content-item${dataIndexAttr}`) :\r\n      this.$(`.narrative__strapline-btn${dataIndexAttr}`);\r\n    a11y.focusFirst($elementToFocus);\r\n  }\r\n\r\n  onItemsVisitedChange(item, _isVisited) {\r\n    if (!_isVisited) return;\r\n    this.$(`[data-index=\"${item.get('_index')}\"]`).addClass('is-visited');\r\n  }\r\n\r\n  calculateMode() {\r\n    const mode = device.screenSize === 'large' ? MODE.LARGE : MODE.SMALL;\r\n    this.model.set('_mode', mode);\r\n  }\r\n\r\n  renderMode() {\r\n    this.calculateMode();\r\n\r\n    const isLargeMode = this.isLargeMode();\r\n    const isTextBelowImage = this.isTextBelowImage();\r\n    this.$el\r\n      .toggleClass('mode-large', isLargeMode)\r\n      .toggleClass('mode-small', !isLargeMode)\r\n      .toggleClass('items-are-full-width', isTextBelowImage);\r\n  }\r\n\r\n  isLargeMode() {\r\n    return this.model.get('_mode') === MODE.LARGE;\r\n  }\r\n\r\n  isTextBelowImage() {\r\n    const isTextBelowImage = (device.screenSize === 'large')\r\n      ? this.model.get('_isTextBelowImage')\r\n      : this.model.get('_isMobileTextBelowImage');\r\n    return Boolean(isTextBelowImage);\r\n  }\r\n\r\n  postRender() {\r\n    this.renderMode();\r\n    this.setupNarrative();\r\n\r\n    this.$('.narrative__slider').imageready(this.setReadyStatus.bind(this));\r\n\r\n    if (Adapt.config.get('_disableAnimation')) {\r\n      this.$el.addClass('disable-animation');\r\n    }\r\n  }\r\n\r\n  setupNarrative() {\r\n    this.renderMode();\r\n    const items = this.model.getChildren();\r\n    if (!items || !items.length) return;\r\n\r\n    let activeItem = this.model.getActiveItem();\r\n    if (!activeItem) {\r\n      activeItem = this.model.getItem(0);\r\n      activeItem.toggleActive(true);\r\n    } else {\r\n      // manually trigger change as it is not fired on reentry\r\n      items.trigger('change:_isActive', activeItem, true);\r\n    }\r\n\r\n    this.calculateWidths();\r\n\r\n    if (!this.isLargeMode() && !this.model.get('_wasHotgraphic')) {\r\n      this.replaceInstructions();\r\n    }\r\n    this.setupEventListeners();\r\n    this._isInitial = false;\r\n  }\r\n\r\n  calculateWidths() {\r\n    const itemCount = this.model.getChildren().length;\r\n    this.model.set({\r\n      _totalWidth: 100 * itemCount,\r\n      _itemWidth: 100 / itemCount\r\n    });\r\n  }\r\n\r\n  resizeControl() {\r\n    const previousMode = this.model.get('_mode');\r\n    this.renderMode();\r\n    if (previousMode !== this.model.get('_mode')) this.replaceInstructions();\r\n    this.evaluateNavigation();\r\n    const activeItem = this.model.getActiveItem();\r\n    if (activeItem) this.setStage(activeItem);\r\n  }\r\n\r\n  reRender() {\r\n    if (this.model.get('_wasHotgraphic') && this.isLargeMode()) {\r\n      this.replaceWithHotgraphic();\r\n      return;\r\n    }\r\n    this.resizeControl();\r\n  }\r\n\r\n  closeNotify() {\r\n    this.evaluateCompletion();\r\n  }\r\n\r\n  replaceInstructions() {\r\n    if (this.isLargeMode()) {\r\n      this.$('.narrative__instruction-inner').html(this.model.get('instruction'));\r\n      return;\r\n    }\r\n\r\n    if (this.model.get('mobileInstruction') && !this.model.get('_wasHotgraphic')) {\r\n      this.$('.narrative__instruction-inner').html(this.model.get('mobileInstruction'));\r\n    }\r\n  }\r\n\r\n  replaceWithHotgraphic() {\r\n    const HotgraphicView = components.getViewClass('hotgraphic');\r\n    if (!HotgraphicView) return;\r\n\r\n    const model = this.prepareHotgraphicModel();\r\n    const newHotgraphic = new HotgraphicView({ model });\r\n\r\n    this.$el.parents('.component__container').append(newHotgraphic.$el);\r\n    this.remove();\r\n    _.defer(() => {\r\n      Adapt.trigger('device:resize');\r\n    });\r\n  }\r\n\r\n  prepareHotgraphicModel() {\r\n    const model = this.model;\r\n    model.resetActiveItems();\r\n    model.set({\r\n      _isPopupOpen: false,\r\n      _component: 'hotgraphic',\r\n      body: model.get('originalBody'),\r\n      instruction: model.get('originalInstruction')\r\n    });\r\n\r\n    return model;\r\n  }\r\n\r\n  moveSliderToIndex(itemIndex) {\r\n    let offset = this.model.get('_itemWidth') * itemIndex;\r\n    if (Adapt.config.get('_defaultDirection') === 'ltr') {\r\n      offset *= -1;\r\n    }\r\n    const cssValue = `translateX(${offset}%)`;\r\n    const $sliderElm = this.$('.narrative__slider');\r\n    const $straplineHeaderElm = this.$('.narrative__strapline-header-inner');\r\n\r\n    $sliderElm.css('transform', cssValue);\r\n    $straplineHeaderElm.css('transform', cssValue);\r\n  }\r\n\r\n  setStage(item) {\r\n    const index = item.get('_index');\r\n    const indexSelector = `[data-index=\"${index}\"]`;\r\n\r\n    if (this.isLargeMode()) {\r\n      // Set the visited attribute for large screen devices\r\n      item.toggleVisited(true);\r\n    }\r\n\r\n    this.$('.narrative__progress').removeClass('is-selected').filter(indexSelector).addClass('is-selected');\r\n    /*selected title*/\r\n    this.$('.narrative__content-title-inner').removeClass('is-selected').filter(indexSelector).addClass('is-selected');\r\n\r\n    const $slideGraphics = this.$('.narrative__slider-image-container');\r\n    a11y.toggleAccessibleEnabled($slideGraphics, false);\r\n    a11y.toggleAccessibleEnabled($slideGraphics.filter(indexSelector), true);\r\n\r\n    const $narrativeItems = this.$('.narrative__content-item');\r\n    $narrativeItems.addClass('u-visibility-hidden u-display-none');\r\n    a11y.toggleAccessible($narrativeItems, false);\r\n    a11y.toggleAccessible($narrativeItems.filter(indexSelector).removeClass('u-visibility-hidden u-display-none'), true);\r\n\r\n    const $narrativeStraplineButtons = this.$('.narrative__strapline-btn');\r\n    a11y.toggleAccessibleEnabled($narrativeStraplineButtons, false);\r\n    a11y.toggleAccessibleEnabled($narrativeStraplineButtons.filter(indexSelector), true);\r\n\r\n    this.evaluateNavigation();\r\n    this.evaluateCompletion();\r\n    this.shouldShowInstructionError();\r\n    this.moveSliderToIndex(index);\r\n  }\r\n\r\n  evaluateNavigation() {\r\n    const active = this.model.getActiveItem();\r\n    if (!active) return;\r\n\r\n    const index = active.get('_index');\r\n    const itemCount = this.model.getChildren().length;\r\n\r\n    const isAtStart = index === 0;\r\n    const isAtEnd = index === itemCount - 1;\r\n\r\n    const $left = this.$('.narrative__controls-left');\r\n    const $right = this.$('.narrative__controls-right');\r\n\r\n    const globals = Adapt.course.get('_globals');\r\n\r\n    const ariaLabelsGlobals = globals._accessibility._ariaLabels;\r\n    const narrativeGlobals = globals._components._narrative;\r\n\r\n    const ariaLabelPrevious = narrativeGlobals.previous || ariaLabelsGlobals.previous;\r\n    const ariaLabelNext = narrativeGlobals.next || ariaLabelsGlobals.next;\r\n\r\n    const prevTitle = isAtStart ? '' : this.model.getItem(index - 1).get('title');\r\n    const nextTitle = isAtEnd ? '' : this.model.getItem(index + 1).get('title');\r\n\r\n    a11y.toggleEnabled($left, !isAtStart);\r\n    a11y.toggleEnabled($right, !isAtEnd);\r\n\r\n    $left.attr('aria-label', Handlebars.helpers.compile_a11y_normalize(ariaLabelPrevious, {\r\n      title: prevTitle,\r\n      _globals: globals,\r\n      itemNumber: isAtStart ? null : index,\r\n      totalItems: itemCount\r\n    }));\r\n    $right.attr('aria-label', Handlebars.helpers.compile_a11y_normalize(ariaLabelNext, {\r\n      title: nextTitle,\r\n      _globals: globals,\r\n      itemNumber: isAtEnd ? null : index + 2,\r\n      totalItems: itemCount\r\n    }));\r\n  }\r\n\r\n  evaluateCompletion() {\r\n    if (this.model.areAllItemsCompleted()) {\r\n      this.trigger('allItems');\r\n      this.$('.narrative__instruction-inner').removeClass('instruction-error');\r\n    }\r\n  }\r\n\r\n  openPopup() {\r\n    const currentItem = this.model.getActiveItem();\r\n    notify.popup({\r\n      title: currentItem.get('title'),\r\n      body: currentItem.get('body')\r\n    });\r\n\r\n    Adapt.on('popup:opened', function() {\r\n      // Set the visited attribute for small and medium screen devices\r\n      currentItem.toggleVisited(true);\r\n    });\r\n  }\r\n\r\n  onNavigationClicked(event) {\r\n    const $btn = $(event.currentTarget);\r\n    let index = this.model.getActiveItem().get('_index');\r\n    $btn.data('direction') === 'right' ? index++ : index--;\r\n    this.model.setActiveItem(index);\r\n  }\r\n\r\n  onSwipeLeft() {\r\n    let index = this.model.getActiveItem().get('_index');\r\n    this.model.setActiveItem(++index);\r\n  }\r\n\r\n  onSwipeRight() {\r\n    let index = this.model.getActiveItem().get('_index');\r\n    this.model.setActiveItem(--index);\r\n  }\r\n\r\n  onProgressClicked(event) {\r\n    const index = $(event.target).data('index');\r\n    this.model.setActiveItem(index);\r\n  }\r\n\r\n  /**\r\n   * In mobile view, highlight instruction if user navigates to another\r\n   * item before completing, in case the strapline is missed\r\n   */\r\n  shouldShowInstructionError() {\r\n    const prevItemIndex = this.model.getActiveItem().get('_index') - 1;\r\n    if (prevItemIndex < 0 || this.model.getItem(prevItemIndex).get('_isVisited')) return;\r\n    this.$('.narrative__instruction-inner').addClass('instruction-error');\r\n  }\r\n\r\n  setupEventListeners() {\r\n    if (this.model.get('_setCompletionOn') === 'inview') {\r\n      this.setupInviewCompletion('.component__widget');\r\n    }\r\n  }\r\n}\r\n\r\nNarrativeView.template = 'narrative';\r\n\r\nexport default NarrativeView;\r\n","import components from 'core/js/components';\r\nimport NarrativeModel from './NarrativeModel';\r\nimport NarrativeView from './NarrativeView';\r\n\r\nexport default components.register('narrative', {\r\n  model: NarrativeModel,\r\n  view: NarrativeView\r\n});\r\n","import Adapt from 'core/js/adapt';\r\nimport QuestionView from 'core/js/views/questionView';\r\nimport 'libraries/rangeslider';\r\n\r\nexport default class SliderView extends QuestionView {\r\n\r\n  events() {\r\n    return {\r\n      'click .js-slider-number-click': 'onNumberSelected',\r\n      'focus .js-slider-item-input': 'onHandleFocus',\r\n      'blur .js-slider-item-input': 'onHandleBlur'\r\n    };\r\n  }\r\n\r\n  // Used by question to setup itself just before rendering\r\n  setupQuestion() {\r\n    if (this.model.get('_isSubmitted')) return;\r\n\r\n    this.selectItem(this.getIndexFromValue(this.model.get('_selectedItem').value));\r\n  }\r\n\r\n  setupRangeslider() {\r\n    this.$sliderScaleMarker = this.$('.js-slider-number-selection');\r\n    this.$slider = this.$('.js-slider-item-input');\r\n    if (this.model.has('_scaleStep')) {\r\n      this.$slider.attr({ step: this.model.get('_scaleStep') });\r\n    }\r\n\r\n    this.$slider.rangeslider({\r\n      polyfill: false,\r\n      onSlide: this.handleSlide.bind(this)\r\n    });\r\n    this.oldValue = 0;\r\n\r\n    if (this._deferEnable) {\r\n      this.setAllItemsEnabled();\r\n    }\r\n  }\r\n\r\n  handleSlide(position, value) {\r\n    if (this.oldValue === value) {\r\n      return;\r\n    }\r\n    const itemIndex = this.getIndexFromValue(value);\r\n    const pixels = this.mapIndexToPixels(itemIndex);\r\n    this.selectItem(itemIndex);\r\n    this.animateToPosition(pixels);\r\n    this.oldValue = value;\r\n  }\r\n\r\n  disableQuestion() {\r\n    this.setAllItemsEnabled();\r\n  }\r\n\r\n  enableQuestion() {\r\n    this.setAllItemsEnabled();\r\n  }\r\n\r\n  setAllItemsEnabled() {\r\n    const isEnabled = this.model.get('_isEnabled');\r\n\r\n    if (!this.$slider) {\r\n      this._deferEnable = true; // slider is not yet ready\r\n      return;\r\n    }\r\n\r\n    this.$('.slider__widget').toggleClass('is-disabled', !isEnabled);\r\n    this.$slider.prop('disabled', !isEnabled).rangeslider('update', true);\r\n  }\r\n\r\n  onQuestionRendered() {\r\n    this.setupRangeslider();\r\n    this.setScalePositions();\r\n    this.onScreenSizeChanged();\r\n    this.showScaleMarker(true);\r\n    this.listenTo(Adapt, 'device:resize', this.onScreenSizeChanged);\r\n    this.setReadyStatus();\r\n  }\r\n\r\n  // this should make the slider handle, slider marker and slider bar to animate to give position\r\n  animateToPosition(newPosition) {\r\n    if (!this.$sliderScaleMarker) return;\r\n\r\n    this.$sliderScaleMarker\r\n      .velocity('stop')\r\n      .velocity({\r\n        left: newPosition\r\n      }, {\r\n        duration: 200,\r\n        easing: 'linear',\r\n        mobileHA: false\r\n      });\r\n  }\r\n\r\n  // this shoud give the index of item using given slider value\r\n  getIndexFromValue(itemValue) {\r\n    const scaleStart = this.model.get('_scaleStart');\r\n    const scaleEnd = this.model.get('_scaleEnd');\r\n    return Math.round(this.mapValue(itemValue, scaleStart, scaleEnd, 0, this.model.get('_items').length - 1));\r\n  }\r\n\r\n  mapIndexToPixels(value, $widthObject) {\r\n    const numberOfItems = this.model.get('_items').length;\r\n    const width = $widthObject ? $widthObject.width() : this.$('.js-slider-scale').width();\r\n\r\n    return Math.round(this.mapValue(value, 0, numberOfItems - 1, 0, width));\r\n  }\r\n\r\n  mapPixelsToIndex(value) {\r\n    const numberOfItems = this.model.get('_items').length;\r\n    const width = this.$('.slider-sliderange').width();\r\n\r\n    return Math.round(this.mapValue(value, 0, width, 0, numberOfItems - 1));\r\n  }\r\n\r\n  normalise(value, low, high) {\r\n    const range = high - low;\r\n    return (value - low) / range;\r\n  }\r\n\r\n  mapValue(value, inputLow, inputHigh, outputLow, outputHigh) {\r\n    const normal = this.normalise(value, inputLow, inputHigh);\r\n    return normal * (outputHigh - outputLow) + outputLow;\r\n  }\r\n\r\n  onHandleFocus(event) {\r\n    event.preventDefault();\r\n    this.$slider.on('keydown', this.onKeyDown.bind(this));\r\n  }\r\n\r\n  onHandleBlur(event) {\r\n    event.preventDefault();\r\n    this.$slider.off('keydown');\r\n  }\r\n\r\n  onKeyDown(event) {\r\n    if (event.which === 9) return; // tab key\r\n    event.preventDefault();\r\n\r\n    let newItemIndex = this.getIndexFromValue(this.model.get('_selectedItem').value);\r\n\r\n    switch (event.which) {\r\n      case 40: //  down\r\n      case 37: //  left\r\n        newItemIndex = Math.max(newItemIndex - 1, 0);\r\n        break;\r\n      case 38: //  up\r\n      case 39: //  right\r\n        newItemIndex = Math.min(newItemIndex + 1, this.model.get('_items').length - 1);\r\n        break;\r\n    }\r\n\r\n    this.selectItem(newItemIndex);\r\n    if (typeof newItemIndex === 'number') this.showScaleMarker(true);\r\n    this.animateToPosition(this.mapIndexToPixels(newItemIndex));\r\n    this.setSliderValue(this.getValueFromIndex(newItemIndex));\r\n  }\r\n\r\n  onNumberSelected(event) {\r\n    event.preventDefault();\r\n\r\n    if (this.model.get('_isInteractionComplete')) {\r\n      return;\r\n    }\r\n\r\n    // when component is not reset, selecting a number should be prevented\r\n    if (this.$slider.prop('disabled')) {\r\n      return;\r\n    }\r\n\r\n    const itemValue = parseFloat($(event.currentTarget).attr('data-id'));\r\n    const index = this.getIndexFromValue(itemValue);\r\n    this.selectItem(index);\r\n    this.animateToPosition(this.mapIndexToPixels(index));\r\n    this.setSliderValue(itemValue);\r\n  }\r\n\r\n  getValueFromIndex(index) {\r\n    return this.model.get('_items')[index].value;\r\n  }\r\n\r\n  resetControlStyles() {\r\n    this.$('.slider-handle').empty();\r\n    this.showScaleMarker(false);\r\n    this.$('.slider-bar').animate({ width: '0' });\r\n    this.setSliderValue(this.model.get('_items')[0].value);\r\n  }\r\n\r\n  onCannotSubmit() { }\r\n\r\n  setSliderValue(value) {\r\n    if (!this.$slider) return;\r\n    this.$slider.val(value).change();\r\n  }\r\n\r\n  showMarking() {\r\n    if (!this.model.get('_canShowMarking')) return;\r\n\r\n    this.$('.slider__widget').removeClass('is-correct is-incorrect')\r\n      .addClass(this.model.get('_selectedItem').correct ? 'is-correct' : 'is-incorrect');\r\n  }\r\n\r\n  resetQuestion() {\r\n    this.selectItem(0);\r\n    this.animateToPosition(0);\r\n    this.resetControlStyles();\r\n    this.showScaleMarker(true);\r\n  }\r\n\r\n  setScalePositions() {\r\n    const numberOfItems = this.model.get('_items').length;\r\n    this.model.get('_items').forEach((item, index) => {\r\n      const normalisedPosition = this.normalise(index, 0, numberOfItems - 1);\r\n      this.$('.js-slider-number').eq(index).data('normalisedPosition', normalisedPosition);\r\n    });\r\n  }\r\n\r\n  showScale() {\r\n    const $markers = this.$('.js-slider-scale-notch-container').empty();\r\n\r\n    if (this.model.get('_showScale') === false) {\r\n      $markers.eq(0).addClass('u-display-none');\r\n      this.$('.js-slider-number').addClass(\r\n        this.model.get('_showScaleIndicator') ? 'u-visibility-hidden' : 'u-display-none'\r\n      );\r\n      return;\r\n    }\r\n\r\n    const $scaler = this.$('.js-slider-scale');\r\n    for (let i = 1, count = this.model.get('_items').length - 1; i < count; i++) {\r\n      $markers.append(`<div class=\"slider__scale-notch\" style=\"left: ${this.mapIndexToPixels(i, $scaler)}px\">`);\r\n    }\r\n    // Do we show scale numbers\r\n    this.showScaleNumbers();\r\n  }\r\n\r\n  showScaleNumbers() {\r\n    const $scaler = this.$('.js-slider-scale');\r\n    const $numbers = this.$('.js-slider-number');\r\n\r\n    if (this.model.get('_showScaleNumbers') === false) {\r\n      $numbers.addClass('u-display-none');\r\n      return;\r\n    }\r\n\r\n    const scaleWidth = $scaler.width();\r\n    this.model.get('_items').forEach((item, index) => {\r\n      const $number = $numbers.eq(index);\r\n      const newLeft = Math.round($number.data('normalisedPosition') * scaleWidth);\r\n      $number.css({ left: newLeft });\r\n    });\r\n  }\r\n\r\n  // Labels are enabled in slider.hbs. Here we manage their containing div.\r\n  showLabels() {\r\n    if (this.model.get('labelStart') || this.model.get('labelEnd')) return;\r\n    this.$('.js-slider-label-container').eq(0).addClass('u-display-none');\r\n  }\r\n\r\n  remapSliderBar() {\r\n    const $scaler = this.$('.js-slider-scale');\r\n    const currentIndex = this.getIndexFromValue(this.model.get('_selectedItem').value);\r\n    const left = this.mapIndexToPixels(currentIndex, $scaler);\r\n    this.$('.slider-handle').css({ left: `${left}px` });\r\n    this.$('.js-slider-number-selection').css({ left: `${left}px` });\r\n    this.$('.slider-bar').width(left);\r\n  }\r\n\r\n  onScreenSizeChanged() {\r\n    this.showScale();\r\n    this.showLabels();\r\n    this.remapSliderBar();\r\n    if (this.$('.slider__widget').hasClass('show-user-answer')) {\r\n      this.hideCorrectAnswer();\r\n    } else if (this.$('.slider__widget').hasClass('show-correct-answer')) {\r\n      this.showCorrectAnswer();\r\n    }\r\n  }\r\n\r\n  showCorrectAnswer() {\r\n    this.showScaleMarker(false);\r\n\r\n    const answers = this.model.getCorrectAnswers();\r\n    if (answers.length === 0) {\r\n      console.log('adapt-contrib-slider::WARNING: no correct answer or correct range set in JSON');\r\n      return;\r\n    }\r\n\r\n    const middleAnswer = answers[Math.floor(answers.length / 2)];\r\n    this.animateToPosition(this.mapIndexToPixels(this.getIndexFromValue(middleAnswer)));\r\n    this.showModelAnswers(answers);\r\n    this.setSliderValue(middleAnswer);\r\n  }\r\n\r\n  showModelAnswers(correctAnswerArray) {\r\n    const $parentDiv = this.$('.js-slider-model-range');\r\n    correctAnswerArray.forEach((correctAnswer, index) => {\r\n      $parentDiv.append($('<div class=\"slider__number-model-answer\">'));\r\n\r\n      const $element = this.$('.js-slider-model-range .slider__number-model-answer').eq(index);\r\n      const startingLeft = this.mapIndexToPixels(this.getIndexFromValue(this.model.get('_selectedItem').value));\r\n\r\n      if (this.model.get('_showNumber')) $element.html(correctAnswer);\r\n\r\n      $element.css({ left: startingLeft }).fadeIn(0, () => {\r\n        $element.animate({ left: this.mapIndexToPixels(this.getIndexFromValue(correctAnswer)) });\r\n      });\r\n    });\r\n  }\r\n\r\n  hideCorrectAnswer() {\r\n    const userAnswerIndex = this.getIndexFromValue(this.model.get('_userAnswer'));\r\n    this.$('.js-slider-model-range').empty();\r\n\r\n    this.showScaleMarker(true);\r\n    this.selectItem(userAnswerIndex);\r\n    this.animateToPosition(this.mapIndexToPixels(userAnswerIndex));\r\n    this.setSliderValue(this.model.get('_userAnswer'));\r\n  }\r\n\r\n  // according to given item index this should make the item as selected\r\n  selectItem(itemIndex) {\r\n    // deselect all items before selecting the chosen item\r\n    this.model.deselectAllItems();\r\n    const item = this.model.get('_items')[itemIndex];\r\n    if (!item) return;\r\n    item.selected = true;\r\n    this.model.set('_selectedItem', item);\r\n    this.$('.js-slider-item-input').attr({\r\n      value: item.value,\r\n      'aria-valuenow': item.value\r\n    });\r\n    this.showNumber(true);\r\n  }\r\n\r\n  // this makes the marker visible or hidden\r\n  showScaleMarker(show) {\r\n    const $scaleMarker = this.$('.js-slider-number-selection');\r\n    if (this.model.get('_showScaleIndicator')) {\r\n      this.showNumber(show);\r\n      $scaleMarker.toggleClass('display-block', show);\r\n    }\r\n  }\r\n\r\n  // this should add the current slider value to the marker\r\n  showNumber(show) {\r\n    const $scaleMarker = this.$('.js-slider-number-selection');\r\n    if (this.model.get('_showNumber')) {\r\n      if (show) {\r\n        $scaleMarker.html(this.model.get('_selectedItem').value);\r\n      } else {\r\n        $scaleMarker.html = '';\r\n      }\r\n    }\r\n  }\r\n\r\n}\r\n","import Adapt from 'core/js/adapt';\r\nimport QuestionModel from 'core/js/models/questionModel';\r\n\r\nexport default class SliderModel extends QuestionModel {\r\n\r\n  init() {\r\n    QuestionModel.prototype.init.call(this);\r\n\r\n    this.setupModelItems();\r\n    this.selectDefaultItem();\r\n  }\r\n\r\n  /**\r\n  * @param {string} [type] 'hard' resets _isComplete and _isInteractionComplete, 'soft' resets _isInteractionComplete only.\r\n  * @param {boolean} [canReset] Defaults to this.get('_canReset')\r\n  * @returns {boolean}\r\n  */\r\n  reset(type = 'hard', canReset = this.get('_canReset')) {\r\n    const wasReset = super.reset(type, canReset);\r\n    if (!wasReset) return false;\r\n    this.deselectAllItems();\r\n    this.selectDefaultItem();\r\n    return true;\r\n  }\r\n\r\n  selectDefaultItem() {\r\n    this.set('_selectedItem', this.get('_items')[0]);\r\n  }\r\n\r\n  /**\r\n   * Returns the number of decimal places in a specified number\r\n   */\r\n  getDecimalPlaces(num) {\r\n    return (num.toString().split('.')[1] || []).length;\r\n  }\r\n\r\n  setupModelItems() {\r\n    const items = [];\r\n    const answer = this.get('_correctAnswer');\r\n    const range = this.get('_correctRange');\r\n    const start = this.get('_scaleStart');\r\n    const end = this.get('_scaleEnd');\r\n    const step = this.get('_scaleStep') || 1;\r\n\r\n    const dp = this.getDecimalPlaces(step);\r\n\r\n    for (let i = start; i <= end; i += step) {\r\n      if (dp !== 0) {\r\n        // Ensure that steps with decimal places are handled correctly.\r\n        i = parseFloat(i.toFixed(dp));\r\n      }\r\n\r\n      items.push({\r\n        value: i,\r\n        selected: false,\r\n        // _correctAnswer/answer is a String - this allows AAT users to assign it no value when _correctRange needs to be used instead\r\n        // we therefore need to convert it to Number when checking the answer (see https://github.com/adaptlearning/adapt_framework/issues/2259)\r\n        correct: answer ? i === Number(answer) : (i >= range._bottom && i <= range._top)\r\n      });\r\n    }\r\n\r\n    this.set({\r\n      _items: items,\r\n      _marginDir: Adapt.config.get('_defaultDirection') === 'rtl' ? 'right' : 'left'\r\n    });\r\n  }\r\n\r\n  /**\r\n  * allow the user to submit immediately; the slider handle may already be in the position they want to choose\r\n  */\r\n  canSubmit() {\r\n    return true;\r\n  }\r\n\r\n  restoreUserAnswers() {\r\n    if (!this.get('_isSubmitted')) {\r\n      this.set({\r\n        _userAnswer: undefined\r\n      });\r\n      this.selectDefaultItem();\r\n      return;\r\n    }\r\n\r\n    const items = this.get('_items');\r\n    const userAnswer = this.get('_userAnswer');\r\n    const selectedItem = items.find(({ value }) => value === userAnswer);\r\n    if (selectedItem) {\r\n      selectedItem.selected = true;\r\n      this.set('_selectedItem', selectedItem);\r\n    }\r\n\r\n    this.setQuestionAsSubmitted();\r\n    this.markQuestion();\r\n    this.setScore();\r\n    this.setupFeedback();\r\n  }\r\n\r\n  // This preserves the state of the users answers for returning or showing the users answer\r\n  storeUserAnswer() {\r\n    this.set('_userAnswer', this.get('_selectedItem').value);\r\n  }\r\n\r\n  resetUserAnswer() {\r\n    this.set({\r\n      _isAtLeastOneCorrectSelection: false,\r\n      _userAnswer: undefined\r\n    });\r\n    this.selectDefaultItem();\r\n  }\r\n\r\n  deselectAllItems() {\r\n    this.get('_items').forEach(item => (item.selected = false));\r\n  }\r\n\r\n  isCorrect() {\r\n    const numberOfCorrectAnswers = this.get('_items').filter(({ selected, correct }) => selected && correct).length;\r\n\r\n    this.set('_isAtLeastOneCorrectSelection', numberOfCorrectAnswers > 0);\r\n    this.set('_numberOfCorrectAnswers', numberOfCorrectAnswers);\r\n\r\n    return this.get('_isAtLeastOneCorrectSelection');\r\n  }\r\n\r\n  isPartlyCorrect() {\r\n    return this.get('_isAtLeastOneCorrectSelection');\r\n  }\r\n\r\n  // Used to set the score based upon the _questionWeight\r\n  setScore() {\r\n    const numberOfCorrectAnswers = this.get('_numberOfCorrectAnswers');\r\n    const questionWeight = this.get('_questionWeight');\r\n    const score = questionWeight * numberOfCorrectAnswers;\r\n    this.set('_score', score);\r\n  }\r\n\r\n  /**\r\n  * Used by adapt-contrib-spoor to get the user's answers in the format required by the cmi.interactions.n.student_response data field\r\n  */\r\n  getResponse() {\r\n    return this.get('_userAnswer').toString();\r\n  }\r\n\r\n  /**\r\n  * Used by adapt-contrib-spoor to get the type of this question in the format required by the cmi.interactions.n.type data field\r\n  */\r\n  getResponseType() {\r\n    return 'numeric';\r\n  }\r\n\r\n  getCorrectAnswers() {\r\n\r\n    // are we dealing with a single correct answer or a range?\r\n    const answerSingle = this.get('_correctAnswer');\r\n    const answers = [];\r\n    if (answerSingle) {\r\n      return [ answerSingle ];\r\n    }\r\n    const answerMultiple = this.get('_correctRange');\r\n    if (!answerMultiple) {\r\n      return answers;\r\n    }\r\n    const bottom = answerMultiple._bottom;\r\n    const top = answerMultiple._top;\r\n    if (bottom === undefined || top === undefined) {\r\n      return answers;\r\n    }\r\n    let answer = bottom;\r\n    const step = this.get('_scaleStep') || 1;\r\n    while (answer <= top) {\r\n      answers.push(answer);\r\n      answer += step;\r\n    }\r\n    return answers;\r\n  }\r\n\r\n  /**\r\n   * Creates a string explaining the answer (or answer range) the learner should have chosen\r\n   * Used by ButtonsView to retrieve question-specific correct answer text for the ARIA\r\n   * 'live region' that gets updated when the learner selects the 'show correct answer' button\r\n   * @return {string}\r\n   */\r\n  getCorrectAnswerAsText() {\r\n    const globals = Adapt.course.get('_globals')._components._slider;\r\n    const answers = this.getCorrectAnswers();\r\n    if (answers.length > 1) {\r\n      return Handlebars.compile(globals.ariaCorrectAnswerRange)({\r\n        bottom: answers.shift(),\r\n        top: answers.pop()\r\n      });\r\n    }\r\n\r\n    return Handlebars.compile(globals.ariaCorrectAnswer)({ correctAnswer: answers[0] });\r\n  }\r\n\r\n  /**\r\n   * Creates a string listing the answer the learner chose\r\n   * Used by ButtonsView to retrieve question-specific user answer text for the ARIA\r\n   * 'live region' that gets updated when the learner selects the 'hide correct answer' button\r\n   * @return {string}\r\n   */\r\n  getUserAnswerAsText() {\r\n    const answerTemplate = Adapt.course.get('_globals')._components._slider.ariaUserAnswer;\r\n    return Handlebars.compile(answerTemplate)({ userAnswer: this.get('_userAnswer') });\r\n  }\r\n\r\n}\r\n","import components from 'core/js/components';\r\nimport SliderView from './sliderView';\r\nimport SliderModel from './sliderModel';\r\n\r\nexport default components.register('slider', {\r\n  view: SliderView,\r\n  model: SliderModel\r\n});\r\n","import ComponentView from 'core/js/views/componentView';\r\nimport gsap from '.../libraries/gsap.min';\r\nimport ScrollTrigger from '.../libraries/ScrollTrigger.min';\r\n\r\n\r\nclass TextView extends ComponentView {\r\n\r\n  events() {\r\n    return {\r\n      'click .close': 'onCloseClicked'\r\n    };\r\n  }\r\n\r\n  postRender() {\r\n    this.setReadyStatus();\r\n    this.setupInview();\r\n    this.gsapTest();\r\n\r\n  }\r\n\r\n  setupInview() {\r\n    const selector = this.getInviewElementSelector();\r\n    if (!selector) return this.setCompletionStatus();\r\n    this.setupInviewCompletion(selector);\r\n  }\r\n\r\n  /**\r\n   * determines which element should be used for inview logic - body, instruction or title - and returns the selector for that element\r\n   */\r\n  getInviewElementSelector() {\r\n    if (this.model.get('body')) return '.component__body';\r\n    if (this.model.get('instruction')) return '.component__instruction';\r\n    if (this.model.get('displayTitle')) return '.component__title';\r\n    return null;\r\n  }\r\n\r\n  onCloseClicked() {\r\n    var e = top.window || window\r\n    e.close()\r\n  }\r\n gsapTest(){\r\n   gsap.registerPlugin(ScrollTrigger);\r\n\r\n    gsap.to('.bg-section',{\r\n\r\n      scrollTrigger: {\r\n          trigger:'.bg-section',\r\n          start:'-450px center',\r\n          end: '700px center',\r\n          scrub: true\r\n        },\r\n        width:'100%',\r\n        duration: 1\r\n      });\r\n\r\n      gsap.to('.tabs',{\r\n\r\n        scrollTrigger: {\r\n            trigger:'.tabs',\r\n            start:'50px center',\r\n            end: '750px bottom',\r\n            scrub: true\r\n          },\r\n          x:'0',\r\n          autoAlpha: '1',\r\n          ease: Power4.easeOut,\r\n          duration: 1.5\r\n        });\r\n\r\n        gsap.to('.flex',{\r\n\r\n          scrollTrigger: {\r\n              trigger:'.flex',\r\n              start:'50px center',\r\n              end: '750px bottom',\r\n              scrub: true\r\n            },\r\n            x:'0',\r\n            autoAlpha: '1',\r\n            duration: 1.5\r\n          });\r\n\r\n\r\n          gsap.to('.cards__item[data-index=\"0\"]',{\r\n\r\n            scrollTrigger: {\r\n                trigger:'.cards__item[data-index=\"0\"]',\r\n                start:'50px center',\r\n                end: '850px bottom',\r\n                scrub: true\r\n              },\r\n              x:'-490px',\r\n              duration: 1.5\r\n            });\r\n\r\n\r\n            gsap.to('.cards__item[data-index=\"1\"]',{\r\n\r\n              scrollTrigger: {\r\n                  trigger:'.cards__item[data-index=\"1\"]',\r\n                  start:'50px center',\r\n                  end: '850px bottom',\r\n                  scrub: true\r\n                },\r\n                x:'490px',\r\n                duration: 1.5\r\n              });\r\n\r\n                gsap.to('.graphiccompare',{\r\n                    \r\n                  y: '0',\r\n                  opacity: '1',\r\n                  duration: 1.5,\r\n                  scrollTrigger: {\r\n                      trigger:'.graphiccompare',\r\n                      start:'0px center',\r\n                      end: '750px bottom',\r\n                      scrub: true\r\n                    },\r\n                    \r\n                  });\r\n\r\n                  gsap.to('.narrative',{\r\n                \r\n                    scrollTrigger: {\r\n                        trigger:'.narrative',\r\n                        start:'550px bottom',\r\n                        end: '750px bottom',\r\n                        scrub: true\r\n                      },\r\n                      autoAlpha: '1',\r\n                      duration: 3\r\n                    });\r\n\r\n                    gsap.utils.toArray('.talk__chat-character-1').forEach(element => {\r\n                      \r\n                    gsap.to(element,{\r\n                \r\n                      scrollTrigger: {\r\n                          trigger: element,\r\n                          start:'0px center',\r\n                          end: '0px bottom',\r\n                          scrub: false\r\n                        },\r\n                        x: '0',\r\n                        autoAlpha: '1',\r\n                        duration: 1\r\n                      })\r\n                    });\r\n\r\n                    gsap.utils.toArray('.talk__chat-character-2').forEach(ele => {\r\n                      \r\n                      gsap.to(ele,{\r\n                  \r\n                        scrollTrigger: {\r\n                            trigger: ele,\r\n                            start:'0px center',\r\n                            end: '0px bottom',\r\n                            scrub: false\r\n                          },\r\n                          x: '0',\r\n                          autoAlpha: '1',\r\n                          duration: 1\r\n                        })\r\n                      });\r\n        \r\n\r\n  }\r\n\r\n\r\n\r\n}\r\n\r\nTextView.template = 'text.jsx';\r\n\r\nexport default TextView;\r\n","import ComponentModel from 'core/js/models/componentModel';\r\n\r\nexport default class TextModel extends ComponentModel {}\r\n","import components from 'core/js/components';\r\nimport TextView from './TextView';\r\nimport TextModel from './TextModel';\r\n\r\nexport default components.register('text', {\r\n  model: TextModel,\r\n  view: TextView\r\n});\r\n","import QuestionView from 'core/js/views/questionView';\r\nclass TextInputView extends QuestionView {\r\n\r\n  events() {\r\n    return {\r\n      'focus .js-textinput-textbox': 'clearValidationError',\r\n      'change .js-textinput-textbox': 'onInputChanged',\r\n      'keyup .js-textinput-textbox': 'onInputChanged'\r\n    };\r\n  }\r\n\r\n  setupQuestion() {\r\n    this.model.setupRandomisation();\r\n  }\r\n\r\n  disableQuestion() {\r\n    this.setAllItemsEnabled(false);\r\n  }\r\n\r\n  enableQuestion() {\r\n    this.setAllItemsEnabled(true);\r\n  }\r\n\r\n  setAllItemsEnabled(isEnabled) {\r\n    this.model.get('_items').forEach((item, index) => {\r\n      const $itemInput = this.$('.js-textinput-textbox').eq(index);\r\n\r\n      $itemInput.prop('disabled', !isEnabled);\r\n    });\r\n  }\r\n\r\n  onQuestionRendered() {\r\n    this.setReadyStatus();\r\n  }\r\n\r\n  clearValidationError() {\r\n    this.$('.js-textinput-textbox').removeClass('has-error');\r\n  }\r\n\r\n  // Blank method for question to fill out when the question cannot be submitted\r\n  onCannotSubmit() {\r\n    this.showValidationError();\r\n  }\r\n\r\n  showValidationError() {\r\n    this.$('.js-textinput-textbox').addClass('has-error');\r\n  }\r\n\r\n  // This is important and should give the user feedback on how they answered the question\r\n  // Normally done through ticks and crosses by adding classes\r\n  showMarking() {\r\n    if (!this.model.get('_canShowMarking')) return;\r\n\r\n    this.model.get('_items').forEach((item, i) => {\r\n      const $item = this.$('.js-textinput-item').eq(i);\r\n      $item.removeClass('is-correct is-incorrect').addClass(item._isCorrect ? 'is-correct' : 'is-incorrect');\r\n    });\r\n  }\r\n\r\n  // Used by the question view to reset the look and feel of the component.\r\n  resetQuestion() {\r\n    this.$('.js-textinput-textbox').prop('disabled', !this.model.get('_isEnabled')).val('');\r\n\r\n    this.model.set({\r\n      _isAtLeastOneCorrectSelection: false,\r\n      _isCorrect: undefined\r\n    });\r\n  }\r\n\r\n  showCorrectAnswer() {\r\n    const correctAnswers = this.model.get('_answers');\r\n\r\n    this.model.get('_items').forEach((item, index) => {\r\n      const correctAnswer = correctAnswers ? correctAnswers[index][0] : item._answers[0];\r\n      this.$('.js-textinput-textbox').eq(index).val(correctAnswer);\r\n    });\r\n  }\r\n\r\n  hideCorrectAnswer() {\r\n    this.model.get('_items').forEach((item, index) => {\r\n      this.$('.js-textinput-textbox').eq(index).val(item.userAnswer);\r\n    });\r\n  }\r\n\r\n  onInputChanged(e) {\r\n    const $input = $(e.target);\r\n    this.model.setItemUserAnswer($input.parents('.js-textinput-item').index(), $input.val());\r\n  }\r\n\r\n}\r\n\r\nTextInputView.template = 'textinput.jsx';\r\n\r\nexport default TextInputView;\r\n","import QuestionModel from 'core/js/models/questionModel';\r\n\r\nclass TextInputModel extends QuestionModel {\r\n\r\n  init() {\r\n    super.init();\r\n\r\n    this.set('_genericAnswerIndexOffset', TextInputModel.genericAnswerIndexOffset);\r\n\r\n    this.setupQuestionItemIndexes();\r\n    this.checkCanSubmit();\r\n  }\r\n\r\n  /**\r\n   * @param {string} [type] 'hard' resets _isComplete and _isInteractionComplete, 'soft' resets _isInteractionComplete only.\r\n   * @param {boolean} [canReset] Defaults to this.get('_canReset')\r\n   * @returns {boolean}\r\n   */\r\n  reset(type = 'hard', canReset = this.get('_canReset')) {\r\n    const wasReset = super.reset(type, canReset);\r\n    if (!wasReset) return false;\r\n    this.set({\r\n      _isAtLeastOneCorrectSelection: false,\r\n      _isCorrect: null\r\n    });\r\n    return true;\r\n  }\r\n\r\n  setupQuestionItemIndexes() {\r\n    this.get('_items').forEach((item, index) => {\r\n      if (item._index === undefined) item._index = index;\r\n      if (item._answerIndex === undefined) item._answerIndex = -1;\r\n    });\r\n  }\r\n\r\n  restoreUserAnswers() {\r\n    if (!this.get('_isSubmitted')) return;\r\n\r\n    const userAnswer = this.get('_userAnswer');\r\n    const genericAnswers = this.get('_answers');\r\n    this.get('_items').forEach(item => {\r\n      const answerIndex = userAnswer[item._index];\r\n      if (answerIndex >= TextInputModel.genericAnswerIndexOffset) {\r\n        item.userAnswer = genericAnswers[answerIndex - TextInputModel.genericAnswerIndexOffset];\r\n        item._answerIndex = answerIndex;\r\n      } else if (answerIndex > -1) {\r\n        item.userAnswer = item._answers[answerIndex];\r\n        item._answerIndex = answerIndex;\r\n      } else {\r\n        if (item.userAnswer === undefined) item.userAnswer = '******';\r\n        item._answerIndex = -1;\r\n      }\r\n      if (item.userAnswer instanceof Array) item.userAnswer = item.userAnswer[0];\r\n    });\r\n\r\n    this.setQuestionAsSubmitted();\r\n    this.markQuestion();\r\n    this.setScore();\r\n    this.setupFeedback();\r\n  }\r\n\r\n  setupRandomisation() {\r\n    if (!this.get('_isRandom') || !this.get('_isEnabled')) return;\r\n\r\n    this.set('_items', _.shuffle(this.get('_items')));\r\n  }\r\n\r\n  // Use to check if the user is allowed to submit the question\r\n  canSubmit() {\r\n    // can submit if every item has user input\r\n    return this.get('_items').every(({ userAnswer }) => userAnswer);\r\n  }\r\n\r\n  setItemUserAnswer(itemIndex, userAnswer) {\r\n    const item = this.get('_items')[itemIndex];\r\n    item.userAnswer = userAnswer;\r\n    this.checkCanSubmit();\r\n  }\r\n\r\n  // Preserves the state for returning or showing the user's answers\r\n  storeUserAnswer() {\r\n    const items = this.get('_items');\r\n\r\n    this.isCorrect();\r\n\r\n    const userAnswer = new Array(items.length);\r\n    items.forEach(({ _index, _answerIndex }) => (userAnswer[_index] = _answerIndex));\r\n    this.set('_userAnswer', userAnswer);\r\n  }\r\n\r\n  isCorrect() {\r\n    if (this.get('_answers')) {\r\n      this.markGenericAnswers();\r\n    } else {\r\n      this.markSpecificAnswers();\r\n    }\r\n    return this.get('_items').every(({ _isCorrect }) => _isCorrect);\r\n  }\r\n\r\n  isPartlyCorrect() {\r\n    return this.get('_isAtLeastOneCorrectSelection');\r\n  }\r\n\r\n  // Allows the learner to give answers into any input, ignoring the order.\r\n  // (this excludes any inputs which have their own specific answers).\r\n  markGenericAnswers() {\r\n    let numberOfCorrectAnswers = 0;\r\n    const correctAnswers = this.get('_answers').slice();\r\n    const usedAnswerIndexes = [];\r\n\r\n    this.get('_items').forEach(item => {\r\n      correctAnswers.forEach((answerGroup, answerIndex) => {\r\n        if (usedAnswerIndexes.includes(answerIndex)) return;\r\n\r\n        if (this.checkAnswerIsCorrect(answerGroup, item.userAnswer) === false) return;\r\n\r\n        usedAnswerIndexes.push(answerIndex);\r\n        item._isCorrect = true;\r\n        item._answerIndex = answerIndex + TextInputModel.genericAnswerIndexOffset;\r\n\r\n        this.set({\r\n          _numberOfCorrectAnswers: ++numberOfCorrectAnswers,\r\n          _isAtLeastOneCorrectSelection: true\r\n        });\r\n\r\n      });\r\n      if (!item._isCorrect) item._isCorrect = false;\r\n    });\r\n  }\r\n\r\n  // Marks any items which have answers specific to it\r\n  // (i.e. item has a _answers array)\r\n  markSpecificAnswers() {\r\n    let numberOfCorrectAnswers = 0;\r\n    this.get('_items').forEach(item => {\r\n      const answers = item._answers;\r\n      if (!answers) return;\r\n      const userAnswer = item.userAnswer || '';\r\n      const isCorrect = this.checkAnswerIsCorrect(answers, userAnswer);\r\n      item._isCorrect = isCorrect;\r\n      item._answerIndex = answers.indexOf(this.cleanupUserAnswer(userAnswer));\r\n      if (!isCorrect) return;\r\n      this.set({\r\n        _numberOfCorrectAnswers: ++numberOfCorrectAnswers,\r\n        _isAtLeastOneCorrectSelection: true\r\n      });\r\n    });\r\n  }\r\n\r\n  checkAnswerIsCorrect(possibleAnswers, userAnswer) {\r\n    const uAnswer = this.cleanupUserAnswer(userAnswer);\r\n\r\n    const answerIsCorrect = possibleAnswers.some(cAnswer => {\r\n      return this.cleanupUserAnswer(cAnswer) === uAnswer;\r\n    });\r\n    return answerIsCorrect;\r\n  }\r\n\r\n  cleanupUserAnswer(userAnswer) {\r\n    if (this.get('_allowsAnyCase')) {\r\n      userAnswer = userAnswer.toLowerCase();\r\n    }\r\n    if (this.get('_allowsPunctuation')) {\r\n      userAnswer = userAnswer.replace(/[.,-/#!$%^&*;:{}=\\-_`~()]/g, '');\r\n      // remove any orphan double spaces and replace with single space (B & Q)->(B  Q)->(B Q)\r\n      userAnswer = userAnswer.replace(/(  +)+/g, ' ');\r\n    }\r\n    // removes whitespace from beginning/end (leave any in the middle)\r\n    return userAnswer.trim();\r\n  }\r\n\r\n  // Used to set the score based upon the _questionWeight\r\n  setScore() {\r\n    const numberOfCorrectAnswers = this.get('_numberOfCorrectAnswers');\r\n    const questionWeight = this.get('_questionWeight');\r\n    const itemLength = this.get('_items').length;\r\n\r\n    const score = questionWeight * numberOfCorrectAnswers / itemLength;\r\n    this.set('_score', score);\r\n  }\r\n\r\n  resetUserAnswer() {\r\n    this.get('_items').forEach(item => {\r\n      item._isCorrect = false;\r\n      item.userAnswer = '';\r\n    });\r\n  }\r\n\r\n  /**\r\n  * used by adapt-contrib-spoor to get the user's answers in the format required by the cmi.interactions.n.student_response data field\r\n  * returns the user's answers as a string in the format 'answer1[,]answer2[,]answer3'\r\n  * the use of [,] as an answer delimiter is from the SCORM 2004 specification for the fill-in interaction type\r\n  */\r\n  getResponse() {\r\n    return this.get('_items').map(({ userAnswer }) => userAnswer).join('[,]');\r\n  }\r\n\r\n  /**\r\n  * used by adapt-contrib-spoor to get the type of this question in the format required by the cmi.interactions.n.type data field\r\n  */\r\n  getResponseType() {\r\n    return 'fill-in';\r\n  }\r\n\r\n}\r\n\r\nTextInputModel.genericAnswerIndexOffset = 65536;\r\n\r\nexport default TextInputModel;\r\n","import components from 'core/js/components';\r\nimport TextInputView from './textInputView';\r\nimport TextInputModel from './textInputModel';\r\n\r\nexport default components.register('textinput', {\r\n  view: TextInputView,\r\n  model: TextInputModel\r\n});\r\n","import ItemsComponentModel from 'core/js/models/itemsComponentModel';\r\n\r\nexport default class FlexModel extends ItemsComponentModel {\r\n\r\n  checkIfResetOnRevisit() {\r\n    this.resetActiveItems();\r\n    super.checkIfResetOnRevisit();\r\n    this.toggleItemsState(0);\r\n  }\r\n\r\n  toggleItemsState(index) {\r\n    const item = this.getItem(index);\r\n    const previousActiveItem = this.getActiveItem();\r\n\r\n    item.toggleActive();\r\n    item.toggleVisited(true);\r\n\r\n    if (!previousActiveItem) return;\r\n    previousActiveItem.toggleActive(false);\r\n  }\r\n\r\n}\r\n","import ComponentView from 'core/js/views/componentView';\r\n\r\nclass FlexView extends ComponentView {\r\n\r\n  preRender() {\r\n    this.onClick = this.onClick.bind(this);\r\n    this.onMouseOver = this.onMouseOver.bind(this);\r\n  }\r\n\r\n  postRender() {\r\n    this.$('.component__widget').imageready(() => {\r\n      this.setReadyStatus();\r\n    });\r\n    if (this.model.get('_setCompletionOn') !== 'inview') return;\r\n    this.setupInviewCompletion();\r\n  }\r\n\r\n  onClick(event) {\r\n    this.model.toggleItemsState($(event.currentTarget).parents('.js-flex-item').data('index'));\r\n  }\r\n\r\n  onMouseOver(event) {\r\n    this.model.toggleItemsState($(event.currentTarget).parents('.js-flex-item').data('index'));\r\n  }\r\n}\r\n\r\nFlexView.template = 'flex.jsx';\r\n\r\nexport default FlexView;\r\n","import components from 'core/js/components';\r\nimport FlexModel from './FlexModel';\r\nimport FlexView from './FlexView';\r\n\r\nexport default components.register('flex', {\r\n  model: FlexModel,\r\n  view: FlexView\r\n});\r\n","define(function(require) {\r\n\r\n    var ComponentView = require('coreViews/componentView');\r\n    var Adapt = require('coreJS/adapt');\r\n\r\n    var Flipper = ComponentView.extend({\r\n        events: {\r\n            \"click .flipper-container\": \"onClick\"\r\n        },\r\n\r\n        preRender: function() {\r\n            this.model.set(\"_stage\", 0);\r\n            this.locked = false;\r\n        },\r\n\r\n        postRender: function() {\r\n            var $container = this.$(\".flipper-container\");\r\n\r\n            if (this.model.get(\"width\")) {\r\n                $container.width(this.model.get(\"width\"));\r\n            }\r\n\r\n            $container.imageready(this.onImageReady.bind(this));\r\n        },\r\n\r\n        onImageReady: function() {\r\n            this.setItemVisibility();\r\n            this.setItemHeights();\r\n            this.setReadyStatus();\r\n        },\r\n\r\n        setItemHeights: function() {\r\n            if (this.model.get(\"_equalHeights\") === false) return;\r\n            var $items = this.$(\".flipper-item\");\r\n            var hMax = _.reduce($items, function(hMax, el) {\r\n                var h = $(el).outerHeight();\r\n                return h > hMax ? h : hMax;\r\n            }, 0);\r\n            $items.height(hMax);\r\n            this.$(\".flipper-container\").height(hMax);\r\n        },\r\n\r\n        setItemVisibility: function() {\r\n            var stage = this.model.get(\"_stage\");\r\n            var rx = /state-\\d+/;\r\n            _.each(this.$(\".flipper-item\"), function(el, i) {\r\n                if (stage === i) {\r\n                    el.className = el.className.replace(rx, 'state-1');\r\n                } else if (stage - 1 === i || (stage === 0 && i === this.model.get('_items').length - 1)) {\r\n                    el.className = el.className.replace(rx, 'state-2');\r\n                } else {\r\n                    el.className = el.className.replace(rx, 'state-0');\r\n                }\r\n            }, this);\r\n        },\r\n\r\n        onClick: function() {\r\n            if (this.locked) return;\r\n\r\n            this.setLock();\r\n\r\n            var stage = this.model.get(\"_stage\") + 1;\r\n            var numItems = this.model.get(\"_items\").length;\r\n            if (stage + 1 === numItems) {\r\n                this.setCompletionStatus();\r\n            } else if (stage === numItems) {\r\n                stage = 0;\r\n            }\r\n\r\n            this.setStage(stage);\r\n        },\r\n\r\n        setLock: function() {\r\n            var $flipper = this.$(\".flipper\");\r\n            $flipper.addClass(\"animating\");\r\n            this.locked = true;\r\n            setTimeout(function() {\r\n                $flipper.removeClass(\"animating\");\r\n                this.locked = false;\r\n            }.bind(this), 600);\r\n        },\r\n\r\n        setStage: function(stage) {\r\n            this.model.set(\"_stage\", stage);\r\n            var flipper = this.$(\".flipper\")[0];\r\n            flipper.className = flipper.className.replace(/stage-\\d+/, \"stage-\" + stage);\r\n            this.setItemVisibility();\r\n        }\r\n\r\n    });\r\n\r\n    Adapt.register('flipper', Flipper);\r\n\r\n    return Flipper;\r\n\r\n});\r\n","import ComponentView from 'core/js/views/componentView';\r\n\r\nclass GraphicCompareView extends ComponentView {\r\n  preRender() {\r\n    this.onChange = this.onChange.bind(this);\r\n\r\n    const initialValue = this.model.get('_initialValue');\r\n    this.model.set('_value', initialValue === 'left' ? 0 : initialValue === 'right' ? 100 : 50);\r\n\r\n  }\r\n\r\n  postRender() {\r\n    this.$('.graphiccompare__widget').imageready(() => {\r\n      this.setReadyStatus();\r\n      this.setupInviewCompletion('.graphiccompare__widget');\r\n    });\r\n  }\r\n\r\n  onChange(event) {\r\n    const value = event.target.value;\r\n    this.model.set('_value', value);\r\n  }\r\n}\r\n\r\nGraphicCompareView.template = 'graphicCompare.jsx';\r\n\r\nexport default GraphicCompareView;\r\n","import ComponentModel from 'core/js/models/componentModel';\r\n\r\nexport default class GraphicCompareModel extends ComponentModel {\r\n  defaults() {\r\n    return ComponentModel.resultExtend('defaults', { _value: 50 });\r\n  }\r\n}\r\n","import components from 'core/js/components';\r\nimport GraphicCompareView from './GraphicCompareView';\r\nimport GraphicCompareModel from './GraphicCompareModel';\r\n\r\nexport default components.register('graphicCompare', {\r\n  model: GraphicCompareModel,\r\n  view: GraphicCompareView\r\n});\r\n","import Adapt from 'core/js/adapt';\r\nimport ComponentView from 'core/js/views/componentView';\r\nimport '../libraries/lottie-player';\r\nimport * as LottieInteractivity from '../libraries/lottie-interactivity.min';\r\nclass LottieInteractivityView extends ComponentView {\r\n\r\n  preRender() {\r\n    const lottieModel = this.model.get('_lottie');\r\n    const lottieplayerEl = document.createElement('lottie-player');\r\n\r\n    lottieModel.controls && lottieplayerEl.setAttribute('controls', lottieModel.controls);\r\n    if (lottieModel.loop !== -1) {\r\n      lottieplayerEl.setAttribute('loop', true);\r\n      lottieplayerEl.setAttribute('count', lottieModel.loop);\r\n    }\r\n    lottieModel.autoplay && lottieplayerEl.setAttribute('autoplay', lottieModel.autoplay);\r\n    lottieModel.speed && lottieModel.speed > 1 && lottieplayerEl.setAttribute('speed', lottieModel.speed);\r\n    lottieModel.style && lottieplayerEl.setAttribute('style', lottieModel.style);\r\n    lottieModel.renderer && lottieplayerEl.setAttribute('renderer', lottieModel.renderer);\r\n    lottieModel.background && lottieplayerEl.setAttribute('background', lottieModel.background);\r\n    lottieModel.preserveAspectRatio && lottieplayerEl.setAttribute('preserveAspectRatio', lottieModel.preserveAspectRatio);\r\n    lottieplayerEl.setAttribute('src', lottieModel.src);\r\n\r\n    this.model.set('lottieplayer', lottieplayerEl.outerHTML);\r\n\r\n    // this.$el.on('onscreen', this.onScreenChange.bind(this));\r\n  }\r\n\r\n  postRender() {\r\n\r\n    const lottieplayer = this.$('lottie-player')[0];\r\n    lottieplayer.addEventListener('ready', () => {\r\n      Adapt.trigger('lottie:ready', this);\r\n      this.setReadyStatus();\r\n    });\r\n    lottieplayer.addEventListener('error', () => {\r\n      this.setReadyStatus();\r\n      this.model.set('failed', this.model.get('_lottie').failed);\r\n    });\r\n    lottieplayer.addEventListener('play', () => {\r\n      Adapt.trigger('lottie:play', this);\r\n    });\r\n    lottieplayer.addEventListener('pause', () => {\r\n      Adapt.trigger('lottie:pause', this);\r\n    });\r\n    if (this.model.get('_setCompletionOn') === 'inview') {\r\n      this.setupInviewCompletion('.component__widget');\r\n    } else {\r\n      lottieplayer.addEventListener('complete', () => {\r\n        this.setCompletionStatus();\r\n      });\r\n    }\r\n    const interactivity = this.model.get('_lottie').interactivity;\r\n    if (interactivity) {\r\n      interactivity.player = lottieplayer;\r\n      LottieInteractivity.create(interactivity);\r\n    }\r\n  }\r\n\r\n  /* onScreenChange(event, { onscreen, percentInview } = {}) {\r\n    const isOffScreen = (!onscreen || percentInview < 1);\r\n    if (isOffScreen) {\r\n\r\n      return;\r\n    }\r\n    if (this.model.get('wasPlayed') === true) return;\r\n\r\n    console.log(this.model.get('wasPlayed'));\r\n    const lottieModel = this.model.get('_lottie');\r\n    const lottieplayer = this.$('lottie-player')[0];\r\n    if (lottieModel.autoplay) {\r\n      this.model.set('wasPlayed', true);\r\n      lottieplayer.play();\r\n    }\r\n  } */\r\n}\r\n\r\nLottieInteractivityView.template = 'lottieInteractivity.jsx';\r\n\r\nexport default LottieInteractivityView;\r\n","import ComponentModel from 'core/js/models/componentModel';\r\n\r\nexport default class LottieInteractivityModel extends ComponentModel {}\r\n","import Adapt from 'core/js/adapt';\r\nimport LottieInteractivityView from './LottieInteractivityView';\r\nimport LottieInteractivityModel from './LottieInteractivityModel';\r\n\r\nexport default Adapt.register('lottieInteractivity', {\r\n  model: LottieInteractivityModel,\r\n  view: LottieInteractivityView\r\n});\r\n","define([\r\n  'core/js/adapt',\r\n  'core/js/models/componentModel'\r\n], function(Adapt, ComponentModel) {\r\n\r\n  var Model = ComponentModel.extend({\r\n\r\n    getNavigationData: function() {\r\n\r\n      /*\r\n      * Combine the config, model, order, index and type for each _buttons\r\n      * Add each combined item to an array\r\n      */\r\n\r\n      var buttonTypeModels = {\r\n        _returnToPreviousLocation: this.getReturnToPreviousLocation(),\r\n        _page: this.getCurrentPage(),\r\n        _up: this.getCurrentMenu(),\r\n        _root: Adapt.course,\r\n        _next: this.getNextPage(),\r\n        _previous: this.getPrevPage(),\r\n        _sibling: this.getSiblingPages(),\r\n        _close: new Backbone.Model({\r\n          _id: '',\r\n          _onClick: 'top.window.close();'\r\n        })\r\n      };\r\n\r\n      var data = [];\r\n      var buttons = this.get('_buttons');\r\n\r\n      if (!buttons) {\r\n        return data;\r\n      }\r\n\r\n      var order = 0;\r\n      var item;\r\n      var currentPageComplete = buttonTypeModels._page.get('_isComplete');\r\n\r\n      for (var attrName in buttons) {\r\n\r\n        var buttonConfig = buttons[attrName];\r\n        var buttonModel = buttonTypeModels[attrName];\r\n\r\n        if (attrName === '_sibling') {\r\n\r\n          // Skip if only one sibling\r\n          if (buttonModel.length <= 1) continue;\r\n\r\n          // Generate sibling entries\r\n          _.each(buttonModel, function(model, index) {\r\n\r\n            item = model.toJSON();\r\n            _.extend(item, buttonConfig, {\r\n              type: attrName,\r\n              index: index,\r\n              order: order++,\r\n              locked: item._isLocked || (buttonConfig._lockUntilPageComplete && !currentPageComplete)\r\n            });\r\n            data.push(item);\r\n\r\n          });\r\n\r\n          continue;\r\n\r\n        }\r\n\r\n        // Find buttonModel from config._customRouteId if not found in defined type\r\n        if (buttonConfig._customRouteId) buttonModel = Adapt.findById(buttonConfig._customRouteId);\r\n\r\n        // Convert found buttonModel to json if exists or create an 'undefined' json\r\n        item = buttonModel ? buttonModel.toJSON() : { '_isHidden': true };\r\n\r\n        _.extend(item, buttonConfig, {\r\n          type: attrName,\r\n          index: 0,\r\n          order: order++,\r\n          locked: item._isLocked || (buttonConfig._lockUntilPageComplete && !currentPageComplete)\r\n        });\r\n        data.push(item);\r\n\r\n      }\r\n\r\n      // requires a stable sorting algorithm - native sorting in Chrome is unstable (should be stable from Chrome 70)\r\n      var orderedData = _.sortBy(data, '_order');\r\n\r\n      orderedData.forEach(function(item, index) {\r\n        item._index = index;\r\n      });\r\n\r\n      return orderedData;\r\n\r\n    },\r\n\r\n    getReturnToPreviousLocation: function() {\r\n\r\n      return Adapt.location._previousId ? Adapt.findById(Adapt.location._previousId) : null;\r\n\r\n    },\r\n\r\n    getCurrentPage: function() {\r\n\r\n      var parents = this.getAncestorModels ? this.getAncestorModels() : this.getParents().models;\r\n      for (var i = 0, l = parents.length; i < l; i++) {\r\n\r\n        var model = parents[i];\r\n        switch (model.get('_type')) {\r\n          case 'page':\r\n            return model;\r\n        }\r\n\r\n      }\r\n\r\n    },\r\n\r\n    getCurrentMenu: function() {\r\n\r\n      var parents = this.getAncestorModels ? this.getAncestorModels() : this.getParents().models;\r\n      for (var i = 0, l = parents.length; i < l; i++) {\r\n\r\n        var model = parents[i];\r\n        switch (model.get('_type')) {\r\n          case 'menu':\r\n          case 'course':\r\n            return model;\r\n        }\r\n\r\n      }\r\n\r\n    },\r\n\r\n    getSiblingPages: function() {\r\n\r\n      var currentMenu = this.getCurrentMenu();\r\n      var siblingModels = currentMenu.getAllDescendantModels(true);\r\n\r\n      siblingModels = _.filter(siblingModels, function(model) {\r\n        return model.get('_type') === 'page' && model.get('_isAvailable') &&\r\n          (!this.get('_shouldSkipOptionalPages') || !model.get('_isOptional'));\r\n      }, this);\r\n\r\n      return siblingModels;\r\n\r\n    },\r\n\r\n    getPrevPage: function() {\r\n\r\n      var currentPage = this.getCurrentPage();\r\n      var currentPageId = currentPage.get('_id');\r\n\r\n      var pages = this.getPages();\r\n\r\n      var hasFoundCurrentPage = false;\r\n      for (var i = pages.length-1; i > -1; i--) {\r\n\r\n        var page = pages[i];\r\n        var isNotAvailable = !page.get('_isAvailable');\r\n        if (isNotAvailable) continue;\r\n\r\n        if (!hasFoundCurrentPage) {\r\n          hasFoundCurrentPage = page.get('_id') === currentPageId;\r\n          continue;\r\n        }\r\n\r\n        if (!this.get('_shouldSkipOptionalPages') || !page.get('_isOptional')) {\r\n          return page;\r\n        }\r\n\r\n      }\r\n\r\n      return;\r\n\r\n    },\r\n\r\n    getNextPage: function() {\r\n\r\n      var currentPage = this.getCurrentPage();\r\n      var currentPageId = currentPage.get('_id');\r\n\r\n      var pages = this.getPages();\r\n\r\n      var hasFoundCurrentPage = false;\r\n      for (var i = 0, l = pages.length; i < l; i++) {\r\n\r\n        var page = pages[i];\r\n        var isNotAvailable = !page.get('_isAvailable');\r\n        if (isNotAvailable) continue;\r\n\r\n        if (!hasFoundCurrentPage) {\r\n          hasFoundCurrentPage = page.get('_id') === currentPageId;\r\n          continue;\r\n        }\r\n\r\n        if (!this.get('_shouldSkipOptionalPages') || !page.get('_isOptional')) {\r\n          return page;\r\n        }\r\n\r\n      }\r\n\r\n      return;\r\n\r\n    },\r\n\r\n    getPages: function() {\r\n\r\n      var loopStyle = this.get('_loopStyle');\r\n\r\n      if (!loopStyle) return [];\r\n\r\n      var loop = false;\r\n      var descendants;\r\n      switch (loopStyle) {\r\n        case 'allPages':\r\n          loop = true;\r\n          descendants = Adapt.course.getAllDescendantModels(true);\r\n          break;\r\n        case 'siblings':\r\n          loop = true;\r\n          /* falls through */\r\n        default:\r\n          var currentMenu = this.getCurrentMenu();\r\n          descendants = currentMenu.getAllDescendantModels(true);\r\n      }\r\n\r\n      if (loop) {\r\n        // Create a double copy to allow loop searching\r\n        descendants = descendants.concat(descendants);\r\n      }\r\n\r\n      return _.filter(descendants, function(model) {\r\n        return model.get('_type') === 'page';\r\n      });\r\n\r\n    }\r\n\r\n  });\r\n\r\n  return Model;\r\n\r\n});\r\n","/* eslint-disable no-var */\r\ndefine([\"core/js/adapt\"], function (Adapt) {\r\n  var Tooltip = Backbone.View.extend({\r\n    className: \"collab__tooltip\",\r\n\r\n    initialize: function (options) {\r\n      this.removeOtherTooltips();\r\n      this.setupEventListeners();\r\n      this.setupData(options);\r\n\r\n      this.render();\r\n    },\r\n\r\n    removeOtherTooltips: function () {\r\n      Adapt.trigger(\"tooltip:remove\");\r\n      Adapt.tooltip = this;\r\n    },\r\n\r\n    setupEventListeners: function () {\r\n      _.bindAll(this, \"remove\", \"postRender\", \"show\");\r\n      this.show = _.debounce(this.show, 17);\r\n\r\n      $(document).on(\"mouseover\", this.remove);\r\n\r\n      this.listenTo(Adapt, {\r\n        \"device:resize\": this.checkPosition,\r\n        \"tooltip:remove\": this.remove,\r\n        remove: this.remove\r\n      });\r\n    },\r\n\r\n    setupData: function (options) {\r\n      this.$target = options.$target;\r\n      this.id = this.$target.attr(\"data-id\");\r\n      this.type = this.$target.attr(\"data-type\");\r\n      this.index = this.$target.attr(\"data-index\");\r\n\r\n      this.model.set(\"tooltip\", this.$target.attr(\"data-tooltip\"));\r\n    },\r\n\r\n    render: function () {\r\n      var template = Handlebars.templates[\"pageNav-tooltip\"];\r\n\r\n      this.$el.html(template(this.model.toJSON()));\r\n      _.defer(this.postRender);\r\n    },\r\n\r\n    postRender: function () {\r\n      if (this.isRemoved) return;\r\n\r\n      this.checkPosition();\r\n      this.show();\r\n    },\r\n\r\n    checkPosition: function () {\r\n      if (this.isRemoved) return;\r\n\r\n      var buttonPosition = this.$target.position();\r\n      var buttonWidth = this.$target.outerWidth(true);\r\n      var buttonHalfWidth = buttonWidth / 2;\r\n      var buttonCenterLeft = buttonPosition.left + buttonHalfWidth;\r\n\r\n      var tooltipWidth = this.$el.outerWidth(true);\r\n      var tooltipHalfWidth = tooltipWidth / 2;\r\n\r\n      var tooltipCenter = {\r\n        top: buttonPosition.top,\r\n        left: buttonCenterLeft\r\n      };\r\n\r\n      var $offsetParent = this.$el.offsetParent();\r\n      var parentWidth = $offsetParent.innerWidth();\r\n\r\n      var overflowRight = parentWidth - (tooltipCenter.left + tooltipHalfWidth);\r\n      var overflowLeft = tooltipCenter.left - tooltipHalfWidth;\r\n\r\n      var isOverflowingRight = overflowRight < 0;\r\n      var isOverflowingLeft = overflowLeft < 0;\r\n\r\n      var leftOffset = isOverflowingRight\r\n        ? overflowRight\r\n        : isOverflowingLeft\r\n        ? -overflowLeft\r\n        : 0;\r\n\r\n      this.$el.css({\r\n        top: tooltipCenter.top,\r\n        left: tooltipCenter.left + leftOffset\r\n      });\r\n\r\n      this.$el.find(\".pagenav__triangle\").css({\r\n        left: tooltipHalfWidth - leftOffset\r\n      });\r\n    },\r\n\r\n    show: function () {\r\n      if (this.isRemoved) return;\r\n\r\n      this.$el.addClass(\"show\");\r\n    },\r\n\r\n    remove: function () {\r\n      this.isRemoved = true;\r\n\r\n      delete this.$target;\r\n      delete Adapt.tooltip;\r\n\r\n      $(document).off(\"mouseover\", this.onBodyMouseOver);\r\n      Backbone.View.prototype.remove.call(this);\r\n    }\r\n  });\r\n\r\n  return Tooltip;\r\n});\r\n","\r\ndefine([\r\n  'core/js/adapt',\r\n  'core/js/views/componentView',\r\n  './tooltip'\r\n], function(Adapt, ComponentView, Tooltip) {\r\n\r\n  function getAttributes($node){\r\n    var attrs = {};\r\n    _.each($node[0].attributes, function (attribute) {\r\n      attrs[attribute.name] = attribute.value;\r\n    });\r\n    return attrs;\r\n  }\r\n\r\n  var View = ComponentView.extend({\r\n\r\n    events: {\r\n      'click .js-pagenav-btn': 'onButtonClick',\r\n      'mouseover .js-pagenav-btn': 'onButtonTooltip'\r\n    },\r\n\r\n    preRender: function() {\r\n      this.model.set('_items', this.model.getNavigationData());\r\n\r\n      this.$el.addClass('pagenav ' + this.model.get('_id'));\r\n\r\n      _.bindAll(this, 'postRender', 'checkButtonStates');\r\n\r\n      this.listenTo(Adapt, 'remove', this.remove);\r\n      this.listenTo(Adapt.contentObjects, {\r\n        'change:_isComplete change:_isLocked': this.onContentObjectComplete\r\n      });\r\n\r\n    },\r\n\r\n    postRender: function() {\r\n      this.checkButtonStates();\r\n      this.setReadyStatus();\r\n      this.setupInview();\r\n    },\r\n\r\n    setupInview: function() {\r\n      const selector = this.getInviewElementSelector();\r\n      if (!selector) return this.setCompletionStatus();\r\n      this.setupInviewCompletion(selector);\r\n    },\r\n\r\n    /**\r\n    * determines which element should be used for inview logic - body, instruction, title or widget - and returns the selector for that element\r\n    */\r\n    getInviewElementSelector: function() {\r\n      if (this.model.get('body')) return '.component__body';\r\n      if (this.model.get('instruction')) return '.component__instruction';\r\n      if (this.model.get('displayTitle')) return '.component__title';\r\n      if (this.model.get('_buttons')) return '.component__widget';\r\n      return null;\r\n    },\r\n\r\n    onContentObjectComplete: function() {\r\n\r\n      _.defer(this.checkButtonStates);\r\n\r\n    },\r\n\r\n    checkButtonStates: function() {\r\n\r\n      this.$('button').each(function(index, item) {\r\n        this.checkButtonState(item);\r\n      }.bind(this));\r\n\r\n    },\r\n\r\n    checkButtonState: function(button) {\r\n\r\n      var $button = $(button);\r\n      var id = $button.attr('data-id');\r\n      var index = $button.attr('data-item-index');\r\n\r\n      if (!id) return;\r\n\r\n      // get the button data\r\n      var items = this.model.getNavigationData();\r\n      var data = items[index];\r\n\r\n      // rerender the button\r\n      var $buttonRendered = $(Handlebars.partials['pageNav-item'](data));\r\n      if ($buttonRendered.length === 0) {\r\n        $button.remove();\r\n        return;\r\n      }\r\n\r\n      // get button attribute names from current and rerendered\r\n      var renderedAttrs = getAttributes($buttonRendered);\r\n      var attrs = getAttributes($button);\r\n      var renderedAttrNames = _.keys(renderedAttrs);\r\n      var attrNames = _.keys(attrs);\r\n\r\n      // remove redundant attributes\r\n      var removeAttrNames = _.difference(attrNames, renderedAttrNames);\r\n      removeAttrNames.forEach(function(name) {\r\n        $button.removeAttr(name);\r\n      });\r\n\r\n      // update remaining attributes\r\n      $button.attr(renderedAttrs);\r\n\r\n      // update button text\r\n      $button.html($buttonRendered.html());\r\n\r\n    },\r\n\r\n    onButtonClick: function(event) {\r\n\r\n      var $target = $(event.currentTarget);\r\n      var isLocked = $target.hasClass('is-locked');\r\n      var isSelected = $target.hasClass('is-selected');\r\n\r\n      if (isLocked || isSelected) return;\r\n\r\n      var id = $target.attr('data-id');\r\n      var index = $target.attr('data-item-index');\r\n\r\n      switch (id) {\r\n        case '':\r\n          var items = this.model.getNavigationData();\r\n          try {\r\n            var execute = new Function(items[index]._onClick||'');\r\n            execute();\r\n          } catch (err) {\r\n            Adapt.log.error(err);\r\n          }\r\n          break;\r\n        default:\r\n          this.navigateTo(id);\r\n          break;\r\n      }\r\n    },\r\n\r\n    onButtonTooltip: function(event) {\r\n\r\n      var $target = $(event.currentTarget);\r\n\r\n      var id = $target.attr('data-id') || this.model.getCurrentPage().get('_id');\r\n\r\n      if (!id) {\r\n        return;\r\n      }\r\n\r\n      // If tooltip isn't defined allow the event to propogate down to the document\r\n      if (!$target.attr('data-tooltip')) {\r\n        return;\r\n      }\r\n\r\n      // Don't allow event to propogate, to stop the document over events\r\n      event.stopPropagation();\r\n\r\n\r\n      // If this tooltip is already rendered then skip\r\n      if (Adapt.tooltip) {\r\n\r\n        var type = $target.attr('data-type');\r\n        var index = $target.attr('data-index');\r\n        var isCurrentTooltip = (Adapt.tooltip.type === type) && (Adapt.tooltip.index === index);\r\n\r\n        if (isCurrentTooltip) {\r\n          return;\r\n        }\r\n\r\n      }\r\n\r\n      var tooltip = new Tooltip({\r\n        $target: $target,\r\n        model: Adapt.findById(id)\r\n      });\r\n\r\n      this.$('.pagenav__tooltip-container').append(tooltip.$el);\r\n\r\n    },\r\n\r\n    navigateTo: function(id) {\r\n\r\n      var isCourse = (id === Adapt.course.get('_id'));\r\n      var hash = '#' + (isCourse ? '/' : '/id/' + id);\r\n\r\n      Backbone.history.navigate(hash, { trigger: true, replace: false });\r\n\r\n    }\r\n\r\n  });\r\n\r\n  return View;\r\n\r\n});\r\n","define([\r\n  'core/js/adapt',\r\n  './model',\r\n  './view'\r\n], function(Adapt, Model, View) {\r\n\r\n  return Adapt.register('pageNav', {\r\n    model: Model,\r\n    view: View\r\n  });\r\n\r\n});\r\n","\r\nimport QuestionView from 'core/js/views/questionView';\r\n\r\nclass SelectChoiceView extends QuestionView {\r\n\r\n  initialize(...args) {\r\n    this.onKeyPress = this.onKeyPress.bind(this);\r\n    this.onItemOptionSelect = this.onItemOptionSelect.bind(this);\r\n    super.initialize(...args);\r\n  }\r\n\r\n  setupQuestion() {\r\n    this.model.setupRandomisation();\r\n  }\r\n\r\n  onQuestionRendered() {\r\n    this.$('.selectchoice__item').imageready(() => this.setReadyStatus());\r\n\r\n  }\r\n\r\n  onKeyPress(event) {\r\n\r\n    if (event.which !== 13) return;\r\n    // <ENTER> keypress\r\n    this.onItemOptionSelect(event);\r\n  }\r\n\r\n  onItemOptionSelect(event) {\r\n    if (!this.model.isInteractive()) return;\r\n\r\n    const $input = $(event.currentTarget);\r\n    const itemIndex = $input.data('adapt-index');\r\n    const optionIndex = parseInt($input.val());\r\n    this.model.setOptionSelected(itemIndex, optionIndex, true);\r\n    this.model.set('_highlighted', `${itemIndex}-${optionIndex}`);\r\n\r\n  }\r\n\r\n  resetQuestion() {\r\n    this.$('.selectchoice__item').removeClass('is-correct is-incorrect');\r\n    this.model.set('_isAtLeastOneCorrectSelection', false);\r\n\r\n    this.model.get('_items').forEach(item => {\r\n     // if (item._isCorrect) return;\r\n      item._options.forEach(option => (option._isSelected = false));\r\n      item._selected = null;\r\n    });\r\n  }\r\n\r\n  // showCorrectAnswer() {\r\n  //   this.model.set('_isCorrectAnswerShown', true);\r\n  // }\r\n\r\n  // hideCorrectAnswer() {\r\n  //   this.model.set('_isCorrectAnswerShown', false);\r\n  // }\r\n\r\n}\r\nSelectChoiceView.template = 'selectchoice.jsx';\r\n\r\nexport default SelectChoiceView;\r\n","\r\nimport Adapt from 'core/js/adapt';\r\nimport QuestionModel from 'core/js/models/questionModel';\r\n\r\nexport default class SelectChoiceModel extends QuestionModel {\r\n\r\n  init() {\r\n    super.init();\r\n\r\n    this.setupQuestionItemIndexes();\r\n  }\r\n\r\n  reset(type = 'hard', canReset = this.get('_canReset')) {\r\n    const wasReset = super.reset(type, canReset);\r\n    if (!wasReset) return false;\r\n    this.set('_isAtLeastOneCorrectSelection', false);\r\n    this.get('_items').forEach(item => {\r\n      item._options.forEach(option => (option._isSelected = false));\r\n      item._selected = null;\r\n    });\r\n    return true;\r\n  }\r\n\r\n  setupQuestionItemIndexes() {\r\n    this.get('_choices').forEach((choice, index) => {\r\n      if (choice._value === undefined) {\r\n        choice._value = (index + 1);\r\n      }\r\n    });\r\n\r\n    this.get('_items').forEach((item, index) => {\r\n      if (item._index === undefined) {\r\n        item._index = index;\r\n        item._selected = false;\r\n      }\r\n      if (item._options === undefined) {\r\n        item._options = this.get('_choices').map(choice => {\r\n          return {\r\n            text: choice.text,\r\n            _graphic: choice._graphic,\r\n            _value: choice._value,\r\n            _isCorrect: choice._value === item._shouldBeSelected\r\n          };\r\n        });\r\n      }\r\n      item._options.forEach((option, index) => {\r\n        if (option._index !== undefined) return;\r\n        option._index = index;\r\n        option._isSelected = false;\r\n      });\r\n    });\r\n  }\r\n\r\n  setupRandomisation() {\r\n    if (!this.get('_isRandom') || !this.get('_isEnabled')) return;\r\n\r\n    this.get('_items').forEach(item => (item._options = _.shuffle(item._options)));\r\n  }\r\n\r\n  restoreUserAnswers() {\r\n    if (!this.get('_isSubmitted')) return;\r\n\r\n    const userAnswer = this.get('_userAnswer');\r\n\r\n    this.get('_items').forEach(item => {\r\n      item._options.forEach(option => {\r\n        if (option._index !== userAnswer[item._index]) return;\r\n        option._isSelected = true;\r\n        item._selected = option;\r\n      });\r\n    });\r\n\r\n    this.setQuestionAsSubmitted();\r\n    this.checkCanSubmit();\r\n    this.markQuestion();\r\n    this.setScore();\r\n    this.setupFeedback();\r\n  }\r\n\r\n  canSubmit() {\r\n    const canSubmit = this.get('_items').every(({ _options }) => {\r\n      return _options.some(({ _isSelected }) => _isSelected);\r\n    });\r\n\r\n    return canSubmit;\r\n  }\r\n\r\n  setOptionSelected(itemIndex, optionIndex, isSelected) {\r\n    const item = this.get('_items')[itemIndex];\r\n    const _optionIndex = (optionIndex - 1);\r\n    if (isNaN(_optionIndex)) {\r\n      item._options.forEach(option => (option._isSelected = false));\r\n      item._selected = null;\r\n      return this.checkCanSubmit();\r\n    }\r\n    const option = item._options.find(({ _index }) => _index === _optionIndex);\r\n    option._isSelected = isSelected;\r\n    item._selected = option;\r\n    this.checkCanSubmit();\r\n  }\r\n\r\n  storeUserAnswer() {\r\n    const userAnswer = new Array(this.get('_items').length);\r\n\r\n    this.get('_items').forEach(item => {\r\n      const optionIndex = item._options.findIndex(({ _isSelected }) => _isSelected);\r\n\r\n      userAnswer[item._index] = item._options[optionIndex]._value - 1;\r\n    });\r\n    \r\n    this.set({\r\n      _userAnswer: userAnswer\r\n    });\r\n  }\r\n\r\n  isCorrect() {\r\n    const numberOfCorrectAnswers = this.get('_items').reduce((a, item) => {\r\n      const isCorrect = item._selected?._isCorrect;\r\n      item._isCorrect = Boolean(isCorrect);\r\n      if (!isCorrect) {\r\n        return a;\r\n      }\r\n      this.set('_isAtLeastOneCorrectSelection', true);\r\n      return ++a;\r\n    }, 0);\r\n\r\n    this.set('_numberOfCorrectAnswers', numberOfCorrectAnswers);\r\n\r\n    if (numberOfCorrectAnswers === this.get('_items').length) {\r\n      return true;\r\n    }\r\n\r\n    return false;\r\n  }\r\n\r\n  setScore() {\r\n    const questionWeight = this.get('_questionWeight');\r\n\r\n    if (this.get('_isCorrect')) {\r\n      this.set('_score', questionWeight);\r\n      return;\r\n    }\r\n\r\n    const numberOfCorrectAnswers = this.get('_numberOfCorrectAnswers');\r\n    const itemLength = this.get('_items').length;\r\n\r\n    const score = questionWeight * numberOfCorrectAnswers / itemLength;\r\n\r\n    this.set('_score', score);\r\n  }\r\n\r\n  isPartlyCorrect() {\r\n    return this.get('_isAtLeastOneCorrectSelection');\r\n  }\r\n\r\n  resetUserAnswer() {\r\n    this.set('_userAnswer', []);\r\n  }\r\n\r\n  getInteractionObject() {\r\n    const interactions = {\r\n      correctResponsesPattern: null,\r\n      source: null,\r\n      target: null\r\n    };\r\n    const items = this.get('_items');\r\n\r\n    interactions.correctResponsesPattern = [\r\n      items.map(({ _options }, questionIndex) => {\r\n\r\n        questionIndex++;\r\n        return [\r\n          questionIndex,\r\n\r\n          _options.filter(({ _isCorrect }) => _isCorrect).map(({ _index }) => {\r\n\r\n            return `${questionIndex}_${_index + 1}`;\r\n          })\r\n        ].join('[.]');\r\n      }).join('[,]')\r\n    ];\r\n\r\n    interactions.source = items.map(item => {\r\n      return {\r\n        // Offset by 1.\r\n        id: `${item._index + 1}`,\r\n        description: item.text\r\n      };\r\n    }).flat(Infinity);\r\n\r\n    interactions.target = items.map(({ _options }, index) => {\r\n\r\n      index++;\r\n      return _options.map(option => {\r\n        return {\r\n          id: `${index}_${option._index + 1}`,\r\n          description: option.text\r\n        };\r\n      });\r\n    }).flat(Infinity);\r\n    return interactions;\r\n  }\r\n\r\n  getResponse() {\r\n    const responses = this.get('_userAnswer').map((userAnswer, index) => {\r\n      return `${index + 1}.${userAnswer + 1}`;\r\n    });\r\n\r\n    return responses.join('#');\r\n  }\r\n\r\n  getResponseType() {\r\n    return 'matching';\r\n  }\r\n\r\n  getCorrectAnswerAsText() {\r\n    const correctAnswerTemplate = Adapt.course.get('_globals')._components._selectchoice.ariaCorrectAnswer;\r\n    const ariaAnswer = this.get('_items').map(item => {\r\n      const correctOption = item._options.find(({ _isCorrect }) => _isCorrect);\r\n      return Handlebars.compile(correctAnswerTemplate)({\r\n        itemText: item.text,\r\n        correctAnswer: correctOption.text\r\n      });\r\n    }).join('<br>');\r\n\r\n    return ariaAnswer;\r\n  }\r\n\r\n  getUserAnswerAsText() {\r\n    const userAnswerTemplate = Adapt.course.get('_globals')._components._selectchoice.ariaUserAnswer;\r\n    const answerArray = this.get('_userAnswer');\r\n\r\n    const ariaAnswer = this.get('_items').map((item, index) => {\r\n      const key = answerArray[index];\r\n      return Handlebars.compile(userAnswerTemplate)({\r\n        itemText: item.text,\r\n        userAnswer: item._options[(key)].text\r\n      });\r\n    }).join('<br>');\r\n\r\n    return ariaAnswer;\r\n  }\r\n}\r\n","import Adapt from 'core/js/adapt';\r\nimport SelectChoiceView from './selectchoiceView';\r\nimport SelectChoiceModel from './selectchoiceModel';\r\n\r\nexport default Adapt.register('selectchoice', {\r\n  view: SelectChoiceView,\r\n  model: SelectChoiceModel\r\n});\r\n","import Adapt from 'core/js/adapt';\r\nimport device from 'core/js/device';\r\nimport a11y from 'core/js/a11y';\r\nimport ComponentView from 'core/js/views/componentView';\r\n\r\nclass TabsView extends ComponentView {\r\n\r\n  className() {\r\n    return [\r\n      super.className(),\r\n      `is-${this.layout}-layout`\r\n    ].join(' ');\r\n  }\r\n\r\n  get layout() {\r\n    const layout = (device.screenSize === 'large')\r\n      ? this.model.get('_tabLayout')\r\n      : 'vertical';\r\n    return layout;\r\n  }\r\n\r\n  preRender() {\r\n    this.reset();\r\n    this.setItemWidth();\r\n    this.onTabItemClicked = this.onTabItemClicked.bind(this);\r\n    this.onTabItemKeyUp = this.onTabItemKeyUp.bind(this);\r\n    this.listenTo(Adapt, 'device:resize', this.setItemWidth);\r\n    this.listenTo(this.model.getChildren(), 'change:_isActive', this.onItemsActiveChange);\r\n\r\n  }\r\n\r\n  reset() {\r\n    this.model.resetActiveItems();\r\n    const firstItem = this.model.getItem(0);\r\n    if (!firstItem) return;\r\n    firstItem.toggleActive(true);\r\n    firstItem.toggleVisited(true);\r\n  }\r\n\r\n  setItemWidth () {\r\n    const itemWidth = (this.layout === 'horizontal')\r\n      ? 100 / this.model.get('_items').length + '%'\r\n      : '';\r\n    this.model.set('itemWidth', itemWidth);\r\n  }\r\n\r\n  postRender() {\r\n    this.setReadyStatus();\r\n    if (this.model.get('_setCompletionOn') !== 'inview') return;\r\n    this.setupInviewCompletion();\r\n\r\n  }\r\n  \r\n\r\n  onItemsActiveChange(item, isActive) {\r\n    if (!isActive) return;\r\n    item.toggleVisited(true);\r\n  }\r\n\r\n  onTabItemClicked(e) {\r\n    if (e && e.preventDefault) e.preventDefault();\r\n    let index = $(e.currentTarget).data('index');\r\n    this.model.setActiveItem(index);\r\n    const $tabPanel = $(e.currentTarget).parents('.tabs__widget').find('[role=tabpanel]');\r\n    a11y.focus($tabPanel[index]);\r\n  }\r\n\r\n  onTabItemKeyUp(event) {\r\n    // https://developer.mozilla.org/en-US/docs/Web/Accessibility/ARIA/Roles/Tab_Role\r\n    const $tabs = $(event.currentTarget).parents('[role=tablist]').find('[role=tab]');\r\n    if (!$tabs.length) return;\r\n    let currentIndex = $tabs.toArray().findIndex(tab => tab === event.currentTarget);\r\n    switch (event.which) {\r\n      case 37:\r\n        if (currentIndex === 0) currentIndex = $tabs.length;\r\n        currentIndex--;\r\n        break;\r\n      case 39:\r\n        if (currentIndex === $tabs.length - 1) currentIndex = -1;\r\n        currentIndex++;\r\n    }\r\n    this.model.setActiveItem(currentIndex);\r\n    a11y.focus($tabs[currentIndex]);\r\n  }\r\n\r\n}\r\n\r\nTabsView.template = 'tabs.jsx';\r\n\r\nexport default TabsView;\r\n","import components from 'core/js/components';\r\nimport TabsView from './TabsView';\r\nimport ItemsComponentModel from 'core/js/models/itemsComponentModel';\r\n\r\nexport default components.register('tabs', {\r\n  model: ItemsComponentModel.extend({}),\r\n  view: TabsView\r\n});\r\n","import ItemModel from 'core/js/models/itemModel';\r\nimport ComponentModel from 'core/js/models/componentModel';\r\n\r\nexport default class TalkModel extends ComponentModel {\r\n\r\n  init() {\r\n    this.setUpItems();\r\n\r\n    super.init();\r\n  }\r\n\r\n  setUpItems() {\r\n\r\n    const items = this.get('_items') || [];\r\n    const characters = this.get('_characters') || [];\r\n    characters.forEach((character, index) => {\r\n      character._index = index + 1;\r\n    });\r\n    items.forEach((item, index) => {\r\n      item._index = index;\r\n      if (!item._character) return;\r\n      item._character = characters.filter((character) => character._index === item._character)[0];\r\n    });\r\n    this.setChildren(new Backbone.Collection(items, { model: ItemModel }));\r\n  }\r\n\r\n}\r\n","import ComponentView from 'core/js/views/componentView';\r\n\r\nclass TalkView extends ComponentView {\r\n  postRender () {\r\n    this.$('.component__widget').imageready(() => {\r\n      this.setReadyStatus();\r\n    });\r\n    this.setupInviewCompletion('.component__widget');\r\n  }\r\n\r\n}\r\n\r\nTalkView.template = 'talk.jsx';\r\n\r\nexport default TalkView;\r\n","import components from 'core/js/components';\r\nimport TalkModel from './TalkModel';\r\nimport TalkView from './TalkView';\r\n\r\nexport default components.register('talk', {\r\n  model: TalkModel,\r\n  view: TalkView\r\n});\r\n","import ItemsComponentModel from 'core/js/models/itemsComponentModel';\r\n\r\nexport default class VerticalItemsModel extends ItemsComponentModel {}\r\n","import ComponentView from 'core/js/views/componentView';\r\nclass VerticalItemsView extends ComponentView {\r\n\r\n  postRender () {\r\n    this.setupItems();\r\n    this.setReadyStatus();\r\n    this.setupInviewCompletion('.component__widget');\r\n  }\r\n\r\n  setupItems() {\r\n    this.model.getChildren().forEach(item => {\r\n      const $item = this.getItemElement(item);\r\n      if (item.get('_graphic')?.src) {\r\n        $item.find('.verticalitems__item__content-graphic').imageready(() => {\r\n          $item.find('.verticalitems__item__content').css('min-height', $item.find('.verticalitems__item__content-graphic img').height());\r\n        });\r\n      }\r\n      $item.on('onscreen', this.onInviewItem.bind(this));\r\n    });\r\n  }\r\n\r\n  onInviewItem(event, { onscreen, percentInview } = {}) {\r\n    const isOffScreen = (!onscreen || percentInview < (this.model.get('_onScreenPercentInviewVertical') ?? 1));\r\n    if (isOffScreen) return;\r\n    const index = $(event.currentTarget).data('index');\r\n    const item = this.model.getItem(index);\r\n    item.set('_isVisited', true);\r\n  }\r\n\r\n  getItemElement(item) {\r\n    if (!item) return;\r\n    const index = item.get('_index');\r\n    return this.$('.verticalitems__item').filter(`[data-index=\"${index}\"]`);\r\n  }\r\n\r\n  remove() {\r\n    this.model.getChildren().forEach(item => {\r\n      this.getItemElement(item).off('onscreen', this.onInviewItem.bind(this));\r\n    });\r\n    super.remove();\r\n  }\r\n}\r\n\r\nVerticalItemsView.template = 'vertical-items.jsx';\r\n\r\nexport default VerticalItemsView;\r\n","import Adapt from 'core/js/adapt';\r\nimport VerticalItemsModel from './VerticalItemsModel';\r\nimport VerticalItemsView from './VerticalItemsView';\r\n\r\nexport default Adapt.register('verticalItems', {\r\n  model: VerticalItemsModel,\r\n  view: VerticalItemsView\r\n});\r\n","import Adapt from 'core/js/adapt';\r\n\r\nexport default class AnimateMenuView extends Backbone.View {\r\n\r\n  initialize() {\r\n    this.listenTo(Adapt, {\r\n      'remove': this.remove,\r\n      'popup:opened': this.notifyOpened,\r\n      'popup:closed': this.notifyClosed\r\n    });\r\n\r\n    this.listenToOnce(Adapt, 'menuView:ready', this.render);\r\n    this.listenTo(Adapt.config, 'change:_activeLanguage', this.remove);\r\n  }\r\n\r\n  render() {\r\n    this.firstRun = true;\r\n    this.notifyIsOpen = false;\r\n    this.elementIsInView = true;\r\n\r\n    // Check if notify is visible\r\n    if ($('body').children('.notify').css('visibility') == 'visible') {\r\n      this.notifyOpened();\r\n    }\r\n\r\n    this.modelID = '.menu';\r\n    this.titleEnabled = false;\r\n    this.bodyEnabled = false;\r\n    this.customEnabled = false;\r\n    this.customItems = [];\r\n\r\n    // Title\r\n    if (this.model.get('_animate')._title._isEnabled) {\r\n      this.titleEnabled = true;\r\n      this.titleEffect = this.model.get('_animate')._title._effect;\r\n      this.titleDelay = this.model.get('_animate')._title._delay ? this.model.get('_animate')._title._delay : 0;\r\n      $(this.modelID).find('.menu__title-inner').addClass('is-animated');\r\n      $(this.modelID).find('.menu__title-inner').addClass('is-animate-hidden');\r\n    }\r\n\r\n    // Body\r\n    if (this.model.get('_animate')._body._isEnabled) {\r\n      this.bodyEnabled = true;\r\n      this.bodyEffect = this.model.get('_animate')._body._effect;\r\n      this.bodyDelay = this.model.get('_animate')._body._delay ? this.model.get('_animate')._body._delay : 0;\r\n      $(this.modelID).find('.menu__body-inner').addClass('is-animated');\r\n      $(this.modelID).find('.menu__body-inner').addClass('is-animate-hidden');\r\n    }\r\n\r\n    // Custom\r\n    if (this.model.get('_animate')._custom._isEnabled) {\r\n      this.customEnabled = true;\r\n      this.customElement = this.model.get('_animate')._custom._element;\r\n      this.customEffect = this.model.get('_animate')._custom._effect;\r\n      this.customDelay = this.model.get('_animate')._custom._delay ? this.model.get('_animate')._custom._delay : 0;\r\n      // Only apply if an element has been specified\r\n      if (this.customElement !='') {\r\n        $(this.modelID).find('.'+this.customElement).addClass('is-animated');\r\n        $(this.modelID).find('.'+this.customElement).addClass('is-animate-hidden');\r\n      }\r\n      // Custom items\r\n      if (this.customItems.length > 0) {\r\n        for (let i = 0, l = this.customItems.length; i < l; i++) {\r\n          $(this.modelID).find('.'+this.customItems[i]._element).addClass('is-animated');\r\n          $(this.modelID).find('.'+this.customItems[i]._element).addClass('is-animate-hidden');\r\n        }\r\n      }\r\n      // Custom items\r\n      if (this.model.has('_animate') && this.model.get('_animate')._isEnabled && this.model.get('_animate')._custom._items) {\r\n        this.customItems = this.model.get('_animate')._custom._items;\r\n      }\r\n    }\r\n\r\n    _.defer(() => {\r\n      this.postRender();\r\n    });\r\n  }\r\n\r\n  postRender() {\r\n    if (!this.notifyIsOpen) {\r\n      this.animateElements();\r\n    }\r\n  }\r\n\r\n  notifyOpened() {\r\n    this.notifyIsOpen = true;\r\n  }\r\n\r\n  notifyClosed() {\r\n    this.notifyIsOpen = false;\r\n\r\n    if (this.elementIsInView && this.firstRun) {\r\n      _.delay(() => {\r\n        this.animateElements();\r\n      }, 400);\r\n    }\r\n  }\r\n\r\n  animateElements() {\r\n    this.firstRun = false;\r\n\r\n    if (this.titleEnabled) {\r\n      _.delay(() => {\r\n        $(this.modelID).find('.menu__title-inner').addClass(this.titleEffect);\r\n        $(this.modelID).find('.menu__title-inner').removeClass('is-animate-hidden');\r\n      }, Math.round(this.titleDelay * 1000));\r\n    }\r\n\r\n    if (this.bodyEnabled) {\r\n      _.delay(() => {\r\n        $(this.modelID).find('.menu__body-inner').addClass(this.bodyEffect);\r\n        $(this.modelID).find('.menu__body-inner').removeClass('is-animate-hidden');\r\n      }, Math.round(this.bodyDelay * 1000));\r\n    }\r\n\r\n    if (this.customEnabled) {\r\n      // Only apply if an element has been specified\r\n      if (this.customElement !='') {\r\n        _.delay(() => {\r\n          $(this.modelID).find('.'+this.customElement).addClass(this.customEffect);\r\n          $(this.modelID).find('.'+this.customElement).removeClass('is-animate-hidden');\r\n        }, Math.round(this.customDelay * 1000));\r\n      }\r\n      // Custom items\r\n      if (this.customItems.length == 0) return;\r\n      for (let i = 0, l = this.customItems.length; i < l; i++) {\r\n        this.animateItem(this.customItems[i]);\r\n      }\r\n    }\r\n  }\r\n\r\n  animateItem(item) {\r\n    _.delay(() => {\r\n      $(this.modelID).find('.'+item._element).addClass(item._effect);\r\n      $(this.modelID).find('.'+item._element).removeClass('is-animate-hidden');\r\n    }, Math.round(item._delay * 1000));\r\n  }\r\n}\r\n","import Adapt from 'core/js/adapt';\r\n\r\nexport default class AnimateArticleView extends Backbone.View {\r\n\r\n  initialize() {\r\n    this.listenTo(Adapt, 'remove', this.removeInViewListeners);\r\n    this.listenTo(Adapt, 'popup:closed', this.notifyClosed);\r\n\r\n    this.render();\r\n  }\r\n\r\n  render() {\r\n    if (!Adapt.course.get('_animate')) return;\r\n\r\n    this.firstRun = true;\r\n    this.elementIsInView = false;\r\n\r\n    this.modelID = '.'+this.model.get('_id');\r\n\r\n    this.titleEnabled = false;\r\n    this.titleDelay = 0;\r\n\r\n    this.bodyEnabled = false;\r\n    this.bodyDelay = 0;\r\n\r\n    this.instructionEnabled = false;\r\n    this.instructionDelay = 0;\r\n\r\n    this.customEnabled = false;\r\n    this.customDelay = 0;\r\n    this.customItems = [];\r\n\r\n    // Title\r\n    // Check for global config first and set vars accordingly\r\n    if (Adapt.course.get('_animate')._article._title._isEnabled) {\r\n      this.titleEnabled = true;\r\n      this.titleEffect = Adapt.course.get('_animate')._article._title._effect;\r\n      this.titleDelay = Adapt.course.get('_animate')._article._title._delay;\r\n    }\r\n    // Check against article view config\r\n    if (this.model.has('_animate') && this.model.get('_animate')._isEnabled) {\r\n      if (this.model.get('_animate')._title._isEnabled) {\r\n        this.titleEnabled = true;\r\n        this.titleEffect = this.model.get('_animate')._title._effect;\r\n        this.titleDelay = this.model.get('_animate')._title._delay;\r\n      }\r\n    }\r\n\r\n    // Body\r\n    // Check for global config first and set vars accordingly\r\n    if (Adapt.course.get('_animate')._article._body._isEnabled) {\r\n      this.bodyEnabled = true;\r\n      this.bodyEffect = Adapt.course.get('_animate')._article._body._effect;\r\n      this.bodyDelay = Adapt.course.get('_animate')._article._body._delay;\r\n    }\r\n    // Check against article view config\r\n    if (this.model.has('_animate') && this.model.get('_animate')._isEnabled) {\r\n      if (this.model.get('_animate')._body._isEnabled) {\r\n        this.bodyEnabled = true;\r\n        this.bodyEffect = this.model.get('_animate')._body._effect;\r\n        this.bodyDelay = this.model.get('_animate')._body._delay;\r\n      }\r\n    }\r\n\r\n    // Instruction\r\n    // Check for global config first and set vars accordingly\r\n    if (Adapt.course.get('_animate')._article._instruction._isEnabled) {\r\n      this.instructionEnabled = true;\r\n      this.instructionEffect = Adapt.course.get('_animate')._article._instruction._effect;\r\n      this.instructionDelay = Adapt.course.get('_animate')._article._instruction._delay;\r\n    }\r\n    // Check against article view config\r\n    if (this.model.has('_animate') && this.model.get('_animate')._isEnabled) {\r\n      if (this.model.get('_animate')._instruction._isEnabled) {\r\n        this.instructionEnabled = true;\r\n        this.instructionEffect = this.model.get('_animate')._instruction._effect;\r\n        this.instructionDelay = this.model.get('_animate')._instruction._delay;\r\n      }\r\n    }\r\n\r\n    // Custom\r\n    // Check for global config first and set vars accordingly\r\n    if (Adapt.course.get('_animate')._article._custom._isEnabled) {\r\n      this.customEnabled = true;\r\n      this.customElement = Adapt.course.get('_animate')._article._custom._element;\r\n      this.customEffect = Adapt.course.get('_animate')._article._custom._effect;\r\n      this.customDelay = Adapt.course.get('_animate')._article._custom._delay;\r\n      // Custom items\r\n      if (Adapt.course.get('_animate')._article._custom._items) {\r\n        for (let i = 0, l = Adapt.course.get('_animate')._article._custom._items.length; i < l; i++) {\r\n          this.customItems.push(Adapt.course.get('_animate')._article._custom._items[i]);\r\n        }\r\n      }\r\n    }\r\n    // Check against article view config\r\n    if (this.model.has('_animate') && this.model.get('_animate')._isEnabled) {\r\n      if (this.model.get('_animate')._custom._isEnabled) {\r\n        this.customEnabled = true;\r\n        this.customElement = this.model.get('_animate')._custom._element;\r\n        this.customEffect = this.model.get('_animate')._custom._effect;\r\n        this.customDelay = this.model.get('_animate')._custom._delay;\r\n        // Custom items\r\n        if (this.model.has('_animate') && this.model.get('_animate')._isEnabled && this.model.get('_animate')._custom._items) {\r\n          for (let i = 0, l = this.model.get('_animate')._custom._items.length; i < l; i++) {\r\n            this.customItems.push(this.model.get('_animate')._custom._items[i]);\r\n          }\r\n        }\r\n      }\r\n    }\r\n\r\n    _.defer(() => {\r\n      this.postRender();\r\n    });\r\n  }\r\n\r\n  postRender() {\r\n    this.addClasses();\r\n    $(this.modelID).on('inview', this.inview.bind(this));\r\n  }\r\n\r\n  addClasses() {\r\n    if (this.titleEnabled) {\r\n      $(this.modelID).find('.article__title-inner').addClass('is-animated');\r\n      $(this.modelID).find('.article__title-inner').addClass('is-animate-hidden');\r\n    }\r\n\r\n    if (this.bodyEnabled) {\r\n      $(this.modelID).find('.article__body-inner').addClass('is-animated');\r\n      $(this.modelID).find('.article__body-inner').addClass('is-animate-hidden');\r\n    }\r\n\r\n    if (this.instructionEnabled) {\r\n      $(this.modelID).find('.article__instruction-inner').addClass('is-animated');\r\n      $(this.modelID).find('.article__instruction-inner').addClass('is-animate-hidden');\r\n    }\r\n\r\n    if (this.customEnabled && this.customElement !='') {\r\n      $(this.modelID).find('.'+this.customElement).addClass('is-animated');\r\n      $(this.modelID).find('.'+this.customElement).addClass('is-animate-hidden');\r\n    }\r\n\r\n    // Add classes to all custom items\r\n    if (this.customItems.length > 0) {\r\n      for (let i = 0, l = this.customItems.length; i < l; i++) {\r\n        $(this.modelID).find('.'+this.customItems[i]._element).addClass('is-animated');\r\n        $(this.modelID).find('.'+this.customItems[i]._element).addClass('is-animate-hidden');\r\n      }\r\n    }\r\n  }\r\n\r\n  notifyClosed() {\r\n    if (this.elementIsInView && this.firstRun) {\r\n      _.delay(() => {\r\n        this.animateElements();\r\n        this.removeInViewListeners();\r\n      }, 400);\r\n    }\r\n  }\r\n\r\n  inview(event, visible, visiblePartX, visiblePartY) {\r\n    if (visible) {\r\n      if (visiblePartY === 'top') {\r\n        this._isVisibleTop = true;\r\n      } else if (visiblePartY === 'bottom') {\r\n        this._isVisibleBottom = true;\r\n      } else {\r\n        this._isVisibleTop = true;\r\n        this._isVisibleBottom = true;\r\n      }\r\n\r\n      // Check if element comes into view\r\n      if (this._isVisibleTop || this._isVisibleBottom && Adapt.animate.notifyIsOpen == false) {\r\n        this.elementIsInView = true;\r\n        if (!Adapt.animate.notifyIsOpen) {\r\n          this.animateElements();\r\n          this.removeInViewListeners();\r\n        }\r\n      } else {\r\n        this.elementIsInView = false;\r\n      }\r\n    }\r\n  }\r\n\r\n  animateElements() {\r\n    this.firstRun = false;\r\n\r\n    if (this.titleEnabled) {\r\n      _.delay(() => {\r\n        $(this.modelID).find('.article__title-inner').addClass(this.titleEffect);\r\n        $(this.modelID).find('.article__title-inner').removeClass('is-animate-hidden');\r\n      }, Math.round(this.titleDelay * 1000));\r\n    }\r\n\r\n    if (this.bodyEnabled) {\r\n      _.delay(() => {\r\n        $(this.modelID).find('.article__body-inner').addClass(this.bodyEffect);\r\n        $(this.modelID).find('.article__body-inner').removeClass('is-animate-hidden');\r\n      }, Math.round(this.bodyDelay * 1000));\r\n    }\r\n\r\n    if (this.instructionEnabled) {\r\n      _.delay(() => {\r\n        $(this.modelID).find('.article__instruction-inner').addClass(this.instructionEffect);\r\n        $(this.modelID).find('.article__instruction-inner').removeClass('is-animate-hidden');\r\n      }, Math.round(this.instructionDelay * 1000));\r\n    }\r\n\r\n    if (this.customEnabled) {\r\n      // Only apply if an element has been specified\r\n      if (this.customElement !='') {\r\n        _.delay(() => {\r\n          $(this.modelID).find('.'+this.customElement).addClass(this.customEffect);\r\n          $(this.modelID).find('.'+this.customElement).removeClass('is-animate-hidden');\r\n        }, Math.round(this.customDelay * 1000));\r\n      }\r\n      // Custom items\r\n      if (this.customItems.length == 0) return;\r\n      for (let i = 0, l = this.customItems.length; i < l; i++) {\r\n        this.animateItem(this.customItems[i]);\r\n      }\r\n    }\r\n  }\r\n\r\n  animateItem(item) {\r\n    _.delay(() => {\r\n      $(this.modelID).find('.'+item._element).addClass(item._effect);\r\n      $(this.modelID).find('.'+item._element).removeClass('is-animate-hidden');\r\n    }, Math.round(item._delay * 1000));\r\n  }\r\n\r\n  removeInViewListeners() {\r\n    $(this.modelID).off('inview');\r\n  }\r\n}\r\n","import Adapt from 'core/js/adapt';\r\n\r\nexport default class AnimateBlockView extends Backbone.View {\r\n\r\n  initialize() {\r\n    this.listenTo(Adapt, 'remove', this.removeInViewListeners);\r\n    this.listenTo(Adapt, 'popup:closed', this.notifyClosed);\r\n\r\n    this.render();\r\n  }\r\n\r\n  render() {\r\n    if (!Adapt.course.get('_animate')) return;\r\n\r\n    this.firstRun = true;\r\n    this.elementIsInView = false;\r\n\r\n    this.modelID = '.'+this.model.get('_id');\r\n\r\n    this.titleEnabled = false;\r\n    this.titleDelay = 0;\r\n\r\n    this.bodyEnabled = false;\r\n    this.bodyDelay = 0;\r\n\r\n    this.instructionEnabled = false;\r\n    this.instructionDelay = 0;\r\n\r\n    this.customEnabled = false;\r\n    this.customDelay = 0;\r\n    this.customItems = [];\r\n\r\n    // Title\r\n    // Check for global config first and set vars accordingly\r\n    if (Adapt.course.get('_animate')._block._title._isEnabled) {\r\n      this.titleEnabled = true;\r\n      this.titleEffect = Adapt.course.get('_animate')._block._title._effect;\r\n      this.titleDelay = Adapt.course.get('_animate')._block._title._delay;\r\n    }\r\n    // Check against block view config\r\n    if (this.model.has('_animate') && this.model.get('_animate')._isEnabled) {\r\n      if (this.model.get('_animate')._title._isEnabled) {\r\n        this.titleEnabled = true;\r\n        this.titleEffect = this.model.get('_animate')._title._effect;\r\n        this.titleDelay = this.model.get('_animate')._title._delay;\r\n      }\r\n    }\r\n\r\n    // Body\r\n    // Check for global config first and set vars accordingly\r\n    if (Adapt.course.get('_animate')._block._body._isEnabled) {\r\n      this.bodyEnabled = true;\r\n      this.bodyEffect = Adapt.course.get('_animate')._block._body._effect;\r\n      this.bodyDelay = Adapt.course.get('_animate')._block._body._delay;\r\n    }\r\n    // Check against block view config\r\n    if (this.model.has('_animate') && this.model.get('_animate')._isEnabled) {\r\n      if (this.model.get('_animate')._body._isEnabled) {\r\n        this.bodyEnabled = true;\r\n        this.bodyEffect = this.model.get('_animate')._body._effect;\r\n        this.bodyDelay = this.model.get('_animate')._body._delay;\r\n      }\r\n    }\r\n\r\n    // Instruction\r\n    // Check for global config first and set vars accordingly\r\n    if (Adapt.course.get('_animate')._block._instruction._isEnabled) {\r\n      this.instructionEnabled = true;\r\n      this.instructionEffect = Adapt.course.get('_animate')._block._instruction._effect;\r\n      this.instructionDelay = Adapt.course.get('_animate')._block._instruction._delay;\r\n    }\r\n    // Check against block view config\r\n    if (this.model.has('_animate') && this.model.get('_animate')._isEnabled) {\r\n      if (this.model.get('_animate')._instruction._isEnabled) {\r\n        this.instructionEnabled = true;\r\n        this.instructionEffect = this.model.get('_animate')._instruction._effect;\r\n        this.instructionDelay = this.model.get('_animate')._instruction._delay;\r\n      }\r\n    }\r\n\r\n    // Custom\r\n    // Check for global config first and set vars accordingly\r\n    if (Adapt.course.get('_animate')._block._custom._isEnabled) {\r\n      this.customEnabled = true;\r\n      this.customElement = Adapt.course.get('_animate')._block._custom._element;\r\n      this.customEffect = Adapt.course.get('_animate')._block._custom._effect;\r\n      this.customDelay = Adapt.course.get('_animate')._block._custom._delay;\r\n      // Custom items\r\n      if (Adapt.course.get('_animate')._block._custom._items) {\r\n        for (let i = 0, l = Adapt.course.get('_animate')._block._custom._items.length; i < l; i++) {\r\n          this.customItems.push(Adapt.course.get('_animate')._block._custom._items[i]);\r\n        }\r\n      }\r\n    }\r\n    // Check against block view config\r\n    if (this.model.has('_animate') && this.model.get('_animate')._isEnabled) {\r\n      if (this.model.get('_animate')._custom._isEnabled) {\r\n        this.customEnabled = true;\r\n        this.customElement = this.model.get('_animate')._custom._element;\r\n        this.customEffect = this.model.get('_animate')._custom._effect;\r\n        this.customDelay = this.model.get('_animate')._custom._delay;\r\n        // Custom items\r\n        if (this.model.has('_animate') && this.model.get('_animate')._isEnabled && this.model.get('_animate')._custom._items) {\r\n          for (let i = 0, l = this.model.get('_animate')._custom._items.length; i < l; i++) {\r\n            this.customItems.push(this.model.get('_animate')._custom._items[i]);\r\n          }\r\n        }\r\n      }\r\n    }\r\n\r\n    _.defer(() => {\r\n      this.postRender();\r\n    });\r\n  }\r\n\r\n  postRender() {\r\n    this.addClasses();\r\n    $(this.modelID).on('inview', this.inview.bind(this));\r\n  }\r\n\r\n  addClasses() {\r\n    if (this.titleEnabled) {\r\n      $(this.modelID).find('.block__title-inner').addClass('is-animated');\r\n      $(this.modelID).find('.block__title-inner').addClass('is-animate-hidden');\r\n    }\r\n\r\n    if (this.bodyEnabled) {\r\n      $(this.modelID).find('.block__body-inner').addClass('is-animated');\r\n      $(this.modelID).find('.block__body-inner').addClass('is-animate-hidden');\r\n    }\r\n\r\n    if (this.instructionEnabled) {\r\n      $(this.modelID).find('.block__instruction-inner').addClass('is-animated');\r\n      $(this.modelID).find('.block__instruction-inner').addClass('is-animate-hidden');\r\n    }\r\n\r\n    if (this.customEnabled && this.customElement !='') {\r\n      $(this.modelID).find('.'+this.customElement).addClass('is-animated');\r\n      $(this.modelID).find('.'+this.customElement).addClass('is-animate-hidden');\r\n    }\r\n\r\n    // Add classes to all custom items\r\n    if (this.customItems.length > 0) {\r\n      for (let i = 0, l = this.customItems.length; i < l; i++) {\r\n        $(this.modelID).find('.'+this.customItems[i]._element).addClass('is-animated');\r\n        $(this.modelID).find('.'+this.customItems[i]._element).addClass('is-animate-hidden');\r\n      }\r\n    }\r\n  }\r\n\r\n  notifyClosed() {\r\n    if (this.elementIsInView && this.firstRun) {\r\n      _.delay(() => {\r\n        this.animateElements();\r\n        this.removeInViewListeners();\r\n      }, 400);\r\n    }\r\n  }\r\n\r\n  inview(event, visible, visiblePartX, visiblePartY) {\r\n    if (visible) {\r\n      if (visiblePartY === 'top') {\r\n        this._isVisibleTop = true;\r\n      } else if (visiblePartY === 'bottom') {\r\n        this._isVisibleBottom = true;\r\n      } else {\r\n        this._isVisibleTop = true;\r\n        this._isVisibleBottom = true;\r\n      }\r\n      // Check if element comes into view\r\n      if (this._isVisibleTop || this._isVisibleBottom && Adapt.animate.notifyIsOpen == false) {\r\n        this.elementIsInView = true;\r\n        if (!Adapt.animate.notifyIsOpen) {\r\n          this.animateElements();\r\n          this.removeInViewListeners();\r\n        }\r\n      } else {\r\n        this.elementIsInView = false;\r\n      }\r\n    }\r\n  }\r\n\r\n  animateElements() {\r\n    this.firstRun = false;\r\n\r\n    if (this.titleEnabled) {\r\n      _.delay(() => {\r\n        $(this.modelID).find('.block__title-inner').addClass(this.titleEffect);\r\n        $(this.modelID).find('.block__title-inner').removeClass('is-animate-hidden');\r\n      }, Math.round(this.titleDelay * 1000));\r\n    }\r\n\r\n    if (this.bodyEnabled) {\r\n      _.delay(() => {\r\n        $(this.modelID).find('.block__body-inner').addClass(this.bodyEffect);\r\n        $(this.modelID).find('.block__body-inner').removeClass('is-animate-hidden');\r\n      }, Math.round(this.bodyDelay * 1000));\r\n    }\r\n\r\n    if (this.instructionEnabled) {\r\n      _.delay(() => {\r\n        $(this.modelID).find('.block__instruction-inner').addClass(this.instructionEffect);\r\n        $(this.modelID).find('.block__instruction-inner').removeClass('is-animate-hidden');\r\n      }, Math.round(this.instructionDelay * 1000));\r\n    }\r\n\r\n    if (this.customEnabled) {\r\n      // Only apply if an element has been specified\r\n      if (this.customElement !='') {\r\n        _.delay(() => {\r\n          $(this.modelID).find('.'+this.customElement).addClass(this.customEffect);\r\n          $(this.modelID).find('.'+this.customElement).removeClass('is-animate-hidden');\r\n        }, Math.round(this.customDelay * 1000));\r\n      }\r\n      // Custom items\r\n      if (this.customItems.length == 0) return;\r\n      for (let i = 0, l = this.customItems.length; i < l; i++) {\r\n        this.animateItem(this.customItems[i]);\r\n      }\r\n    }\r\n  }\r\n\r\n  animateItem(item) {\r\n    _.delay(() => {\r\n      $(this.modelID).find('.'+item._element).addClass(item._effect);\r\n      $(this.modelID).find('.'+item._element).removeClass('is-animate-hidden');\r\n    }, Math.round(item._delay * 1000));\r\n  }\r\n\r\n  removeInViewListeners() {\r\n    $(this.modelID).off('inview');\r\n  }\r\n}\r\n","import Adapt from 'core/js/adapt';\r\n\r\nexport default class AnimateComponentView extends Backbone.View {\r\n\r\n  initialize() {\r\n    this.listenTo(Adapt, 'remove', this.removeInViewListeners);\r\n    this.listenTo(Adapt, 'popup:closed', this.notifyClosed);\r\n\r\n    this.render();\r\n  }\r\n\r\n  render() {\r\n    if (!Adapt.course.get('_animate')) return;\r\n\r\n    this.firstRun = true;\r\n    this.elementIsInView = false;\r\n\r\n    this.modelID = '.'+this.model.get('_id');\r\n\r\n    this.completeElementEnabled = false;\r\n    this.completeElementDelay = 0;\r\n\r\n    this.titleEnabled = false;\r\n    this.titleDelay = 0;\r\n\r\n    this.bodyEnabled = false;\r\n    this.bodyDelay = 0;\r\n\r\n    this.instructionEnabled = false;\r\n    this.instructionDelay = 0;\r\n\r\n    this.customEnabled = false;\r\n    this.customDelay = 0;\r\n    this.customItems = [];\r\n\r\n    // Complete element\r\n    // Check for global config first and set vars accordingly\r\n    if (Adapt.course.get('_animate')._component._completeElement._isEnabled) {\r\n      this.completeElementEnabled = true;\r\n      this.completeElementEffect = Adapt.course.get('_animate')._component._completeElement._effect;\r\n      this.completeElementDelay = Adapt.course.get('_animate')._component._completeElement._delay;\r\n    }\r\n    // Check against component view config\r\n    if (this.model.has('_animate') && this.model.get('_animate')._isEnabled) {\r\n      if (this.model.get('_animate')._completeElement._isEnabled) {\r\n        this.completeElementEnabled = true;\r\n        this.completeElementEffect = this.model.get('_animate')._completeElement._effect;\r\n        this.completeElementDelay = this.model.get('_animate')._completeElement._delay;\r\n      }\r\n    }\r\n\r\n    // Title\r\n    // Check for global config first and set vars accordingly\r\n    if (Adapt.course.get('_animate')._component._title._isEnabled) {\r\n      this.titleEnabled = true;\r\n      this.titleEffect = Adapt.course.get('_animate')._component._title._effect;\r\n      this.titleDelay = Adapt.course.get('_animate')._component._title._delay;\r\n    }\r\n    // Check against component view config\r\n    if (this.model.has('_animate') && this.model.get('_animate')._isEnabled) {\r\n      if (this.model.get('_animate')._title._isEnabled) {\r\n        this.titleEnabled = true;\r\n        this.titleEffect = this.model.get('_animate')._title._effect;\r\n        this.titleDelay = this.model.get('_animate')._title._delay;\r\n      }\r\n    }\r\n\r\n    // Body\r\n    // Check for global config first and set vars accordingly\r\n    if (Adapt.course.get('_animate')._component._body._isEnabled) {\r\n      this.bodyEnabled = true;\r\n      this.bodyEffect = Adapt.course.get('_animate')._component._body._effect;\r\n      this.bodyDelay = Adapt.course.get('_animate')._component._body._delay;\r\n    }\r\n    // Check against component view config\r\n    if (this.model.has('_animate') && this.model.get('_animate')._isEnabled) {\r\n      if (this.model.get('_animate')._body._isEnabled) {\r\n        this.bodyEnabled = true;\r\n        this.bodyEffect = this.model.get('_animate')._body._effect;\r\n        this.bodyDelay = this.model.get('_animate')._body._delay;\r\n      }\r\n    }\r\n\r\n    // Instruction\r\n    // Check for global config first and set vars accordingly\r\n    if (Adapt.course.get('_animate')._component._instruction._isEnabled) {\r\n      this.instructionEnabled = true;\r\n      this.instructionEffect = Adapt.course.get('_animate')._component._instruction._effect;\r\n      this.instructionDelay = Adapt.course.get('_animate')._component._instruction._delay;\r\n    }\r\n    // Check against component view config\r\n    if (this.model.has('_animate') && this.model.get('_animate')._isEnabled) {\r\n      if (this.model.get('_animate')._instruction._isEnabled) {\r\n        this.instructionEnabled = true;\r\n        this.instructionEffect = this.model.get('_animate')._instruction._effect;\r\n        this.instructionDelay = this.model.get('_animate')._instruction._delay;\r\n      }\r\n    }\r\n\r\n    // Custom\r\n    // Check for global config first and set vars accordingly\r\n    if (Adapt.course.get('_animate')._component._custom._isEnabled) {\r\n      this.customEnabled = true;\r\n      this.customElement = Adapt.course.get('_animate')._component._custom._element;\r\n      this.customEffect = Adapt.course.get('_animate')._component._custom._effect;\r\n      this.customDelay = Adapt.course.get('_animate')._component._custom._delay;\r\n      // Custom items\r\n      if (Adapt.course.get('_animate')._component._custom._items) {\r\n        for (let i = 0, l = Adapt.course.get('_animate')._component._custom._items.length; i < l; i++) {\r\n          this.customItems.push(Adapt.course.get('_animate')._component._custom._items[i]);\r\n        }\r\n      }\r\n    }\r\n    // Check against component view config\r\n    if (this.model.has('_animate') && this.model.get('_animate')._isEnabled) {\r\n      if (this.model.get('_animate')._custom._isEnabled) {\r\n        this.customEnabled = true;\r\n        this.customElement = this.model.get('_animate')._custom._element;\r\n        this.customEffect = this.model.get('_animate')._custom._effect;\r\n        this.customDelay = this.model.get('_animate')._custom._delay;\r\n        // Custom items\r\n        if (this.model.has('_animate') && this.model.get('_animate')._isEnabled && this.model.get('_animate')._custom._items) {\r\n          for (let i = 0, l = this.model.get('_animate')._custom._items.length; i < l; i++) {\r\n            this.customItems.push(this.model.get('_animate')._custom._items[i]);\r\n          }\r\n        }\r\n      }\r\n    }\r\n\r\n    _.defer(() => {\r\n      this.postRender();\r\n    });\r\n  }\r\n\r\n  postRender() {\r\n    this.addClasses();\r\n    $(this.modelID).on('inview', this.inview.bind(this));\r\n  }\r\n\r\n  addClasses() {\r\n    if (this.completeElementEnabled) {\r\n      $(this.modelID).addClass('is-animated');\r\n      $(this.modelID).addClass('is-animate-hidden');\r\n      this.model.set(\"_isAnimating\", true);\r\n    }\r\n\r\n    if (this.titleEnabled) {\r\n      $(this.modelID).find('.component__title-inner').addClass('is-animated');\r\n      $(this.modelID).find('.component__title-inner').addClass('is-animate-hidden');\r\n    }\r\n\r\n    if (this.bodyEnabled) {\r\n      $(this.modelID).find('.component__body-inner').addClass('is-animated');\r\n      $(this.modelID).find('.component__body-inner').addClass('is-animate-hidden');\r\n    }\r\n\r\n    if (this.instructionEnabled) {\r\n      $(this.modelID).find('.component__instruction-inner').addClass('is-animated');\r\n      $(this.modelID).find('.component__instruction-inner').addClass('is-animate-hidden');\r\n    }\r\n\r\n    if (this.customEnabled && this.customElement !='') {\r\n      $(this.modelID).find('.'+this.customElement).addClass('is-animated');\r\n      $(this.modelID).find('.'+this.customElement).addClass('is-animate-hidden');\r\n    }\r\n\r\n    // Add classes to all custom items\r\n    if (this.customItems.length > 0) {\r\n      for (let i = 0, l = this.customItems.length; i < l; i++) {\r\n        $(this.modelID).find('.'+this.customItems[i]._element).addClass('is-animated');\r\n        $(this.modelID).find('.'+this.customItems[i]._element).addClass('is-animate-hidden');\r\n      }\r\n    }\r\n  }\r\n\r\n  notifyClosed() {\r\n    if (this.elementIsInView && this.firstRun) {\r\n      _.delay(() => {\r\n        this.animateElements();\r\n        this.removeInViewListeners();\r\n      }, 400);\r\n    }\r\n  }\r\n\r\n  inview(event, visible, visiblePartX, visiblePartY) {\r\n    if (visible) {\r\n      if (visiblePartY === 'top') {\r\n        this._isVisibleTop = true;\r\n      } else if (visiblePartY === 'bottom') {\r\n        this._isVisibleBottom = true;\r\n      } else {\r\n        this._isVisibleTop = true;\r\n        this._isVisibleBottom = true;\r\n      }\r\n      // Check if element comes into view\r\n      if (this._isVisibleTop || this._isVisibleBottom && Adapt.animate.notifyIsOpen == false) {\r\n        this.elementIsInView = true;\r\n        if (!Adapt.animate.notifyIsOpen) {\r\n          this.animateElements();\r\n          this.removeInViewListeners();\r\n        }\r\n      } else {\r\n        this.elementIsInView = false;\r\n      }\r\n    }\r\n  }\r\n\r\n  animateElements() {\r\n    this.firstRun = false;\r\n\r\n    if (this.completeElementEnabled) {\r\n      _.delay(() => {\r\n        $(this.modelID).addClass(this.completeElementEffect);\r\n        $(this.modelID).removeClass('is-animate-hidden');\r\n        this.model.set(\"_isAnimating\", false);\r\n      }, Math.round(this.completeElementDelay * 1000));\r\n    }\r\n\r\n    if (this.titleEnabled) {\r\n      _.delay(() => {\r\n        $(this.modelID).find('.component__title-inner').addClass(this.titleEffect);\r\n        $(this.modelID).find('.component__title-inner').removeClass('is-animate-hidden');\r\n      }, Math.round(this.titleDelay * 1000));\r\n    }\r\n\r\n    if (this.bodyEnabled) {\r\n      _.delay(() => {\r\n        $(this.modelID).find('.component__body-inner').addClass(this.bodyEffect);\r\n        $(this.modelID).find('.component__body-inner').removeClass('is-animate-hidden');\r\n      }, Math.round(this.bodyDelay * 1000));\r\n    }\r\n\r\n    if (this.instructionEnabled) {\r\n      _.delay(() => {\r\n        $(this.modelID).find('.component__instruction-inner').addClass(this.instructionEffect);\r\n        $(this.modelID).find('.component__instruction-inner').removeClass('is-animate-hidden');\r\n      }, Math.round(this.instructionDelay * 1000));\r\n    }\r\n\r\n    if (this.customEnabled) {\r\n      // Only apply if an element has been specified\r\n      if (this.customElement !='') {\r\n        _.delay(() => {\r\n          $(this.modelID).find('.'+this.customElement).addClass(this.customEffect);\r\n          $(this.modelID).find('.'+this.customElement).removeClass('is-animate-hidden');\r\n        }, Math.round(this.customDelay * 1000));\r\n      }\r\n      // Custom items\r\n      if (this.customItems.length == 0) return;\r\n      for (let i = 0, l = this.customItems.length; i < l; i++) {\r\n        this.animateItem(this.customItems[i]);\r\n      }\r\n    }\r\n  }\r\n\r\n  animateItem(item) {\r\n    _.delay(() => {\r\n      $(this.modelID).find('.'+item._element).addClass(item._effect);\r\n      $(this.modelID).find('.'+item._element).removeClass('is-animate-hidden');\r\n    }, Math.round(item._delay * 1000));\r\n  }\r\n\r\n  removeInViewListeners() {\r\n    $(this.modelID).off('inview');\r\n  }\r\n}\r\n","import Adapt from 'core/js/adapt';\r\nimport AnimateMenuView from './animate-menuView';\r\nimport AnimateArticleView from './animate-articleView';\r\nimport AnimateBlockView from './animate-blockView';\r\nimport AnimateComponentView from './animate-componentView';\r\n\r\nclass Animate extends Backbone.Controller {\r\n\r\n  initialize() {\r\n    this.listenToOnce(Adapt, 'app:dataReady', this.onAppDataReady);\r\n  }\r\n\r\n  onAppDataReady() {\r\n    this.listenTo(Adapt.config, 'change:_activeLanguage', this.onLangChange);\r\n\r\n    if (!Adapt.course.get('_animate')) return;\r\n\r\n    if (Adapt.course.get('_animate')._isEnabled) {\r\n      this.setupAnimate();\r\n      this.setupListeners();\r\n    }\r\n  }\r\n\r\n  onLangChange() {\r\n    this.removeListeners();\r\n    this.listenToOnce(Adapt, 'app:dataReady', this.onAppDataReady);\r\n  }\r\n\r\n  setupListeners() {\r\n    this.listenTo(Adapt, {\r\n      'popup:opened': this.notifyOpened,\r\n      'popup:closed': this.notifyClosed,\r\n      'menuView:postRender': this.onMenuReady,\r\n      'articleView:postRender': this.onArticleReady,\r\n      'blockView:postRender': this.onBlockReady,\r\n      'componentView:postRender': this.onComponentReady\r\n    });\r\n  }\r\n\r\n  removeListeners() {\r\n    this.stopListening(Adapt, {\r\n      'popup:opened': this.notifyOpened,\r\n      'popup:closed': this.notifyClosed,\r\n      'menuView:postRender': this.onMenuReady,\r\n      'articleView:postRender': this.onArticleReady,\r\n      'blockView:postRender': this.onBlockReady,\r\n      'componentView:postRender': this.onComponentReady\r\n    });\r\n    this.stopListening(Adapt.config, 'change:_activeLanguage', this.onLangChange);\r\n  }\r\n\r\n  notifyOpened() {\r\n    Adapt.animate.notifyIsOpen = true;\r\n  }\r\n\r\n  notifyClosed() {\r\n    Adapt.animate.notifyIsOpen = false;\r\n  }\r\n\r\n  setupAnimate() {\r\n    Adapt.animate.notifyIsOpen = false;\r\n    // Check for global config\r\n    // Article\r\n    if (Adapt.course.get('_animate')._article._isEnabled) {\r\n      Adapt.animate.animateArticleEnabled = Adapt.course.get('_animate')._article._isEnabled;\r\n    } else {\r\n      Adapt.animate.animateArticleEnabled = false;\r\n    }\r\n    // Block\r\n    if (Adapt.course.get('_animate')._block._isEnabled) {\r\n      Adapt.animate.animateBlockEnabled = Adapt.course.get('_animate')._block._isEnabled;\r\n    } else {\r\n      Adapt.animate.animateBlockEnabled = false;\r\n    }\r\n    // Component\r\n    if (Adapt.course.get('_animate')._component._isEnabled) {\r\n      Adapt.animate.animateComponentEnabled = Adapt.course.get('_animate')._component._isEnabled;\r\n    } else {\r\n      Adapt.animate.animateComponentEnabled = false;\r\n    }\r\n  }\r\n\r\n  onMenuReady(view) {\r\n    if (view.model.get('_type') == 'menu' && view.model && view.model.get('_animate') && view.model.get('_animate')._isEnabled){\r\n      new AnimateMenuView({model:view.model});\r\n    }\r\n  }\r\n\r\n  onArticleReady(view) {\r\n    // Check for global first\r\n    if (view.model && Adapt.animate.animateArticleEnabled) {\r\n      new AnimateArticleView({model:view.model});\r\n    } else if (view.model && view.model.get('_animate') && view.model.get('_animate')._isEnabled){\r\n      new AnimateArticleView({model:view.model});\r\n    }\r\n  }\r\n\r\n  onBlockReady(view) {\r\n    // Check for global first\r\n    if (view.model && Adapt.animate.animateBlockEnabled) {\r\n      new AnimateBlockView({model:view.model});\r\n    } else if (view.model && view.model.get('_animate') && view.model.get('_animate')._isEnabled){\r\n      new AnimateBlockView({model:view.model});\r\n    }\r\n  }\r\n\r\n  onComponentReady(view) {\r\n    // Check for global first\r\n    if (view.model && Adapt.animate.animateComponentEnabled) {\r\n      new AnimateComponentView({model:view.model});\r\n    } else if (view.model && view.model.get('_animate') && view.model.get('_animate')._isEnabled){\r\n      new AnimateComponentView({model:view.model});\r\n    }\r\n  }\r\n}\r\n\r\nexport default Adapt.animate = new Animate();\r\n","import Adapt from 'core/js/adapt';\r\n\r\nexport default class BackgroundSwitcherBlockView extends Backbone.View {\r\n\r\n  className() {\r\n    return 'backgroundswitcher__item';\r\n  }\r\n\r\n  attributes() {\r\n    return {\r\n      'data-id': this.model.get('_id')\r\n    };\r\n  }\r\n\r\n  get isVideo() {\r\n    return /\\.mp4/gi.test(String(this._src));\r\n  }\r\n\r\n  get video() {\r\n    return this.$('video')[0];\r\n  }\r\n\r\n  get _src() {\r\n    // Note: Can add mobile image switching here if needed\r\n    const options = this.model.get('_backgroundSwitcher');\r\n    return options._src;\r\n  }\r\n\r\n  get _poster() {\r\n    // Note: Can add mobile image switching here if needed\r\n    const options = this.model.get('_backgroundSwitcher');\r\n    return options._poster;\r\n  }\r\n\r\n  togglePoster(showPoster) {\r\n    this.$el.toggleClass('backgroundswitcher-hide-poster', !showPoster);\r\n  }\r\n\r\n  get _classes() {\r\n    const options = this.model.get('_backgroundSwitcher');\r\n    return options._classes;\r\n  }\r\n\r\n  play() {\r\n    if (!this.isVideo) return;\r\n    if (Adapt.backgroundSwitcher.lowBandwidth) return;\r\n    if (Adapt?.visua11y?.noAnimations) return;\r\n    this.video.play();\r\n  }\r\n\r\n  pause() {\r\n    if (!this.isVideo) return;\r\n    this.video.pause();\r\n  }\r\n  \r\n  rewind() {\r\n    if (!this.isVideo) return;\r\n    this.video.currentTime = 0;\r\n  }\r\n\r\n  initialize({ blockView }) {\r\n    this.onTimeUpdate = this.onTimeUpdate.bind(this);\r\n    this.onBlockInView = this.onBlockInView.bind(this);\r\n    if (this.isVideo) this.renderVideo();\r\n    if (!this.isVideo) this.renderImage();\r\n    this.listenTo(Adapt, 'remove', this.onRemove);\r\n    this.blockView = blockView;\r\n    // Take the first measurement on postRender\r\n    this.onBlockInView();\r\n    this.blockView.$el\r\n      .addClass('has-background-switcher-image')\r\n      .on('onscreen.backgroundswitcher', this.onBlockInView);\r\n  }\r\n\r\n  renderVideo() {\r\n    // this.$el.html(Handlebars.templates.backgroundSwitcherVideo(this.model.toJSON()));\r\n    const videoTag = Adapt.backgroundSwitcher.getVideoTag();\r\n    videoTag.loop = true;\r\n    videoTag.playsinline = true;\r\n    videoTag.preload = Adapt.backgroundSwitcher.config?._preload || 'none';\r\n    videoTag.attributes['aria-hidden'] = true;\r\n    videoTag.src = this._src;\r\n    videoTag.muted = Adapt.backgroundSwitcher.isMuted;\r\n    videoTag.load();\r\n    this.el.appendChild(videoTag);\r\n    videoTag.addEventListener('timeupdate', this.onTimeUpdate);\r\n    if (!this._poster) return;\r\n    const posterTag = document.createElement('img');\r\n    posterTag.className = 'poster';\r\n    posterTag.attributes['aria-hidden'] = true;\r\n    posterTag.src = this._poster;\r\n    this.el.appendChild(posterTag);\r\n  }\r\n\r\n  renderImage() {\r\n    const imgTag = document.createElement('img');\r\n    imgTag.className = 'poster';\r\n    imgTag.attributes['aria-hidden'] = true;\r\n    imgTag.src = this._src;\r\n    this.el.appendChild(imgTag);\r\n  }\r\n\r\n  onTimeUpdate(event) {\r\n    /** @type {HTMLMediaElement} */\r\n    const videoTag = event.currentTarget;\r\n    if (videoTag.paused) return;\r\n    videoTag.removeEventListener('timeupdate', this.onTimeUpdate);\r\n    this.togglePoster(false);\r\n  }\r\n\r\n  onBlockInView() {\r\n    BackgroundSwitcherBlockView.addRecord(this);\r\n    const direction = BackgroundSwitcherBlockView.activeDirection(this);\r\n    if (!direction) return;\r\n    this.showBackground(direction);\r\n  }\r\n\r\n  activate() {\r\n    this.$el.addClass('is-active');\r\n    this.addClasses();\r\n    this.play();\r\n  }\r\n\r\n  deactivate() {\r\n    this.$el\r\n      .addClass('is-deactive')\r\n      .removeClass('is-active');\r\n  }\r\n\r\n  forceDeactivate() {\r\n    this.$el\r\n      .removeClass('is-deactive')\r\n      .addClass('is-deactive-force'); // Make sure IE11 ignores opacity animation\r\n  }\r\n\r\n  removeForceDeactivate() {\r\n    this.pause();\r\n    this.rewind();\r\n    // Make sure IE11 ignores opacity animation\r\n    this.$el.removeClass('is-deactive-force');\r\n  }\r\n\r\n  showBackground(direction) {\r\n    this.updateAttributes();\r\n    const currentActiveView = BackgroundSwitcherBlockView.findRecord(record => record.view.$el.hasClass('is-active'))?.view;\r\n    const currentDeactiveView = BackgroundSwitcherBlockView.findRecord(record => record.view.$el.hasClass('is-deactive'))?.view;\r\n    currentDeactiveView?.forceDeactivate();\r\n    currentActiveView?.deactivate();\r\n    this.removeClasses();\r\n    requestAnimationFrame(() => {\r\n      BackgroundSwitcherBlockView.setDirection(direction);\r\n      currentDeactiveView?.removeForceDeactivate();\r\n      this.activate();\r\n    });\r\n  }\r\n\r\n  updateAttributes() {\r\n    // Ready for mobile switching if needed\r\n    Object.entries(this.attributes()).forEach(([name, value]) => {\r\n      if (this.$el.attr(name) === value) return;\r\n      this.$el.attr(name, value);\r\n    });\r\n  }\r\n\r\n  addClasses() {\r\n    this.$el.addClass(this._classes);\r\n  }\r\n\r\n  removeClasses() {\r\n    this.$el.removeClass(this._classes);\r\n  }\r\n\r\n  onRemove() {\r\n    const videoTag = this.$('video')[0];\r\n    if (videoTag) {\r\n      videoTag.removeEventListener('timeupdate', this.onTimeUpdate);\r\n      Adapt.backgroundSwitcher.releaseVideoTag(videoTag);\r\n    }\r\n    BackgroundSwitcherBlockView.clearRecords();\r\n    $('body').removeClass('backgroundswitcher-active');\r\n    this.blockView.$el.off('onscreen.backgroundswitcher');\r\n    this.remove();\r\n  }\r\n\r\n  /**\r\n   * Keep a list of all the block's measurements so as to find the last active\r\n   * @param {BackgroundSwitcherBlockView} view\r\n   */\r\n  static addRecord(view) {\r\n    this.records = this.records || [];\r\n    this.records.forEach(record => (record.measurement = $(record.view.blockView.$el).onscreen()));\r\n    this.records.sort((a, b) => a.measurement.top - b.measurement.top);\r\n    const record = this.records.find(({ view: recordView }) => recordView === view);\r\n    if (record) return;\r\n    this.records.push({\r\n      view,\r\n      measurement: $(view.blockView.$el).onscreen()\r\n    });\r\n  }\r\n\r\n  static findRecord(predicate) {\r\n    return this.records.find(predicate);\r\n  }\r\n\r\n  static setDirection(direction) {\r\n    // Set animation direction\r\n    $('.backgroundswitcher__container')\r\n      .toggleClass('forward', direction === 'forward')\r\n      .toggleClass('backward', direction === 'backward');\r\n  }\r\n\r\n  /**\r\n   * Returns 'forward', 'backword' or null to demonstrate active direction\r\n   * @param {BackgroundSwitcherBlockView} view\r\n   * @returns {string|null}\r\n   */\r\n  static activeDirection(view) {\r\n    const current = this.getCurrent();\r\n    if (current?.view !== view) return null;\r\n    const previous = this.getPrevious();\r\n    if (previous === current) return;\r\n    current.isActive = true;\r\n    if (!previous) return 'forward';\r\n    previous.isActive = false;\r\n    // previous.view.pause();\r\n    return (previous.measurement.top < current.measurement.top) || (previous.measurement.top === current.measurement.top && previous.measurement.left < current.measurement.left)\r\n      ? 'forward'\r\n      : 'backward';\r\n  }\r\n\r\n  static getPrevious() {\r\n    return this.records.find(({ isActive }) => isActive);\r\n  }\r\n\r\n  static getCurrent() {\r\n    // Make sure to fetch the background for the last available block only\r\n    if (!this.records) return;\r\n    const threshold = Adapt.backgroundSwitcher.config?._inviewThreshold ?? 80;\r\n    const onScreens = this.records.filter(({ measurement: { percentFromTop, percentFromBottom, percentFromRight, percentFromLeft, onscreen } }) => onscreen && percentFromTop < threshold && percentFromBottom < threshold && percentFromRight < threshold && percentFromLeft < threshold);\r\n    // Fetch the last onscreen\r\n    const record = onScreens.pop();\r\n    if (record) return record;\r\n    // Find the lowest possible percent from bottom, the last background\r\n    const lowestPostivePercentFromBottom = this.records.reduce((lowestPostivePercentFromBottom, record) => {\r\n      if (record.measurement.percentFromBottom < 0) return lowestPostivePercentFromBottom;\r\n      if (!lowestPostivePercentFromBottom) return record;\r\n      return (lowestPostivePercentFromBottom.measurement.percentFromBottom < record.measurement.percentFromBottom)\r\n        ? lowestPostivePercentFromBottom\r\n        : record;\r\n    }, null);\r\n    return lowestPostivePercentFromBottom;\r\n  }\r\n\r\n  /**\r\n   * Clears records ready for another page\r\n   */\r\n  static clearRecords() {\r\n    this.records.length = 0;\r\n  }\r\n\r\n}\r\n","import Adapt from 'core/js/adapt';\r\nimport BackgroundSwitcherBlockView from './BackgroundSwitcherBlockView';\r\n\r\nexport default class BackgroundSwitcherPageView extends Backbone.View {\r\n\r\n  className() {\r\n    return 'backgroundswitcher__container';\r\n  }\r\n\r\n  initialize() {\r\n    this.addToBody();\r\n    this.listenTo(Adapt, {\r\n      'blockView:postRender': this.onBlockViewPostRender,\r\n      'backgroundSwitcher:lowBandwidth': this.onLowBandwidthChange,\r\n      remove: this.onRemove\r\n    });\r\n  }\r\n\r\n  addToBody() {\r\n    $('html').addClass('backgroundswitcher-active');\r\n    $('body').prepend(this.$el);\r\n  }\r\n\r\n  onBlockViewPostRender(view) {\r\n    if (!view.model.get('_backgroundSwitcher')?._isEnabled) return;\r\n    const backgroundSwitcherBlockView = new BackgroundSwitcherBlockView({ model: view.model, blockView: view });\r\n    this.$el.append(backgroundSwitcherBlockView.$el);\r\n  }\r\n\r\n  onLowBandwidthChange(value) {\r\n    this.$el.toggleClass('backgroundswitcher-lowbandwidth', value);\r\n  }\r\n\r\n  onRemove() {\r\n    $('html').removeClass('backgroundswitcher-active');\r\n    this.remove();\r\n  }\r\n\r\n}\r\n","import Adapt from 'core/js/adapt';\r\nimport data from 'core/js/data';\r\nimport _ from 'underscore';\r\nimport BackgroundSwitcherPageView from './BackgroundSwitcherPageView';\r\nimport BackgroundSwitcherBlockView from './BackgroundSwitcherBlockView';\r\n\r\nclass BackgroundSwitcher extends Backbone.Controller {\r\n\r\n  initialize() {\r\n    this.onBadMediaEvent = this.onBadMediaEvent.bind(this);\r\n    this.listenTo(Adapt, {\r\n      'app:dataReady': this.onDataReady,\r\n      'pageView:postRender': this.onPageViewPostRender,\r\n      'visua11y:changed': this.onVisua11yChanged\r\n    });\r\n    this._videoTags = null;\r\n    this._availableVideoTags = null;\r\n    this._isMuted = false;\r\n    this._lowBandwidth = false;\r\n  }\r\n\r\n  get config() {\r\n    return Adapt.course.get('_backgroundSwitcher');\r\n  }\r\n\r\n  onDataReady() {\r\n    this.isMuted = this.config?._isMuted ?? false;\r\n    const hasBackgroundSwitcher = data.some(model => model.get('_backgroundSwitcher')?._isEnabled === true);\r\n    if (!hasBackgroundSwitcher) return;\r\n    this.disableSmoothScrolling();\r\n    this.createVideoTags();\r\n    this.preloadImages();\r\n  }\r\n\r\n  onPageViewPostRender({ model }) {\r\n    if (!model.get('_backgroundSwitcher')?._isEnabled) return;\r\n    new BackgroundSwitcherPageView({ model });\r\n    this.setUpClickJack();\r\n  }\r\n\r\n  onVisua11yChanged() {\r\n    this.applyMute();\r\n    this.applyNoAnimation();\r\n  }\r\n\r\n  get isMuted() {\r\n    return this._isMuted;\r\n  }\r\n\r\n  set isMuted(value) {\r\n    this._isMuted = value;\r\n    this.applyMute();\r\n  }\r\n\r\n  applyMute() {\r\n    this._videoTags?.forEach(tag => (tag.muted = Adapt?.visua11y?.noBackgroundImages || this._isMuted));\r\n  }\r\n\r\n  applyNoAnimation() {\r\n    const background = BackgroundSwitcherBlockView.getCurrent();\r\n    const view = background?.view;\r\n    if (!background?.isActive || !view) return;\r\n    (Adapt?.visua11y?.noAnimations) ? view.pause() : view.play();\r\n  }\r\n\r\n  get lowBandwidth() {\r\n    return this._lowBandwidth;\r\n  }\r\n\r\n  set lowBandwidth(value) {\r\n    this._lowBandwidth = value;\r\n    this._videoTags.forEach(v => v.pause());\r\n    Adapt.trigger('backgroundSwitcher:lowBandwidth', this._lowBandwidth);\r\n  }\r\n\r\n  get maxVideos() {\r\n    const contentObjects = Adapt.course.findDescendantModels('contentobject');\r\n    const maxVideos = contentObjects.reduce((memo, contentobject) => {\r\n      const videoBlocks = contentobject.findDescendantModels('block').filter((block) => {\r\n        const config = block.get('_backgroundSwitcher');\r\n        return config?._isEnabled !== false && config?._src?.includes('.mp4');\r\n      });\r\n      return videoBlocks.length > memo ? videoBlocks.length : memo;\r\n    }, 1);\r\n    return maxVideos;\r\n  }\r\n\r\n  get images() {\r\n    const contentObjects = Adapt.course.findDescendantModels('contentobject');\r\n    const images = contentObjects.reduce((images, contentobject) => {\r\n      contentobject.findDescendantModels('block').forEach((block) => {\r\n        const config = block.get('_backgroundSwitcher');\r\n        if (config?._isEnabled === false) return;\r\n        if (config?._src && !config?._src?.includes('.mp4')) images.push(config._src);\r\n        if (config?._poster) images.push(config._poster);\r\n      });\r\n      return images;\r\n    }, []);\r\n    return images;\r\n  }\r\n\r\n  preloadImages() {\r\n    const $cache = $('<div>');\r\n    $cache[0].style = 'position:absolute;z-index:-1000;opacity:0;';\r\n    document.body.appendChild($cache[0]);\r\n    let loaded = 0;\r\n    const onloaded = event => {\r\n      const image = event.currentTarget;\r\n      image.removeEventListener('load', onloaded);\r\n      image.removeEventListener('error', onloaded);\r\n      $(image).remove();\r\n      loaded++;\r\n      if (loaded === this.images.length) $cache.remove();\r\n    };\r\n    this.images.forEach(src => {\r\n      const image = new Image();\r\n      image.className = 'backgroundswitcher-image-preload';\r\n      image.src = src;\r\n      image.addEventListener('load', onloaded);\r\n      image.addEventListener('error', onloaded);\r\n      $cache.append(image);\r\n    });\r\n  }\r\n\r\n  createVideoTags() {\r\n    const maxVideos = this.maxVideos;\r\n    this._videoTags = new Array(maxVideos);\r\n    this._availableVideoTags = new Array(maxVideos);\r\n    for (let i = 0, l = this._availableVideoTags.length; i < l; i++) {\r\n      const videoTag = this._videoTags[i] = this._availableVideoTags[i] = document.createElement('video');\r\n      videoTag.muted = true;\r\n      videoTag.isSeated = true;\r\n      videoTag.playsInline = true;\r\n      videoTag.preload = this.config?._preload || 'none';\r\n      videoTag.src = 'data:video/mp4;base64,AAAAIGZ0eXBpc29tAAACAGlzb21pc28yYXZjMW1wNDEAAAOBbW9vdgAAAGxtdmhkAAAAAAAAAAAAAAAAAAAD6AAAA+gAAQAAAQAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAqt0cmFrAAAAXHRraGQAAAADAAAAAAAAAAAAAAABAAAAAAAAA+gAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAABAAAAAABAAAAAKAAAAAAAkZWR0cwAAABxlbHN0AAAAAAAAAAEAAAPoAAAEAAABAAAAAAIjbWRpYQAAACBtZGhkAAAAAAAAAAAAAAAAAAAoAAAAKABVxAAAAAAALWhkbHIAAAAAAAAAAHZpZGUAAAAAAAAAAAAAAABWaWRlb0hhbmRsZXIAAAABzm1pbmYAAAAUdm1oZAAAAAEAAAAAAAAAAAAAACRkaW5mAAAAHGRyZWYAAAAAAAAAAQAAAAx1cmwgAAAAAQAAAY5zdGJsAAAAlnN0c2QAAAAAAAAAAQAAAIZhdmMxAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAABAACgBIAAAASAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAGP//AAAAMGF2Y0MBZAAp/+EAF2dkACms2V/khAAAAwAEAAADAKA8YMZYAQAGaOviSyLAAAAAGHN0dHMAAAAAAAAAAQAAABQAAAIAAAAAFHN0c3MAAAAAAAAAAQAAAAEAAAAwY3R0cwAAAAAAAAAEAAAAAQAABAAAAAABAAAGAAAAAAEAAAIAAAAAEQAABAAAAAAcc3RzYwAAAAAAAAABAAAAAQAAABQAAAABAAAAZHN0c3oAAAAAAAAAAAAAABQAAAMwAAAAEwAAAAwAAAAUAAAAEAAAAB8AAAAZAAAAFQAAABgAAAASAAAAEAAAABUAAAAXAAAAIwAAABAAAAAZAAAAEQAAABEAAAAXAAAAEQAAABRzdGNvAAAAAAAAAAEAAAOxAAAAYnVkdGEAAABabWV0YQAAAAAAAAAhaGRscgAAAAAAAAAAbWRpcmFwcGwAAAAAAAAAAAAAAAAtaWxzdAAAACWpdG9vAAAAHWRhdGEAAAABAAAAAExhdmY1Ny4yOC4xMDAAAAAIZnJlZQAABMRtZGF0AAAC8QYF///t3EXpvebZSLeWLNgg2SPu73gyNjQgLSBjb3JlIDE0OCByMjY2NSBhMDFlMzM5IC0gSC4yNjQvTVBFRy00IEFWQyBjb2RlYyAtIENvcHlsZWZ0IDIwMDMtMjAxNiAtIGh0dHA6Ly93d3cudmlkZW9sYW4ub3JnL3gyNjQuaHRtbCAtIG9wdGlvbnM6IGNhYmFjPTEgcmVmPTMgZGVibG9jaz0xOjA6MCBhbmFseXNlPTB4MzoweDExMyBtZT1oZXggc3VibWU9NyBwc3k9MSBwc3lfcmQ9MS4wMDowLjAwIG1peGVkX3JlZj0xIG1lX3JhbmdlPTE2IGNocm9tYV9tZT0xIHRyZWxsaXM9MSA4eDhkY3Q9MSBjcW09MCBkZWFkem9uZT0yMSwxMSBmYXN0X3Bza2lwPTEgY2hyb21hX3FwX29mZnNldD0tMiB0aHJlYWRzPTEgbG9va2FoZWFkX3RocmVhZHM9MSBzbGljZWRfdGhyZWFkcz0wIG5yPTAgZGVjaW1hdGU9MSBpbnRlcmxhY2VkPTAgYmx1cmF5X2NvbXBhdD0wIGNvbnN0cmFpbmVkX2ludHJhPTAgYmZyYW1lcz0zIGJfcHlyYW1pZD0yIGJfYWRhcHQ9MSBiX2JpYXM9MCBkaXJlY3Q9MSB3ZWlnaHRiPTEgb3Blbl9nb3A9MCB3ZWlnaHRwPTIga2V5aW50PTI1MCBrZXlpbnRfbWluPTIwIHNjZW5lY3V0PTQwIGludHJhX3JlZnJlc2g9MCByY19sb29rYWhlYWQ9NDAgcmM9Y3JmIG1idHJlZT0xIGNyZj0yOC4wIHFjb21wPTAuNjAgcXBtaW49MCBxcG1heD02OSBxcHN0ZXA9NCB2YnZfbWF4cmF0ZT0xMDAgdmJ2X2J1ZnNpemU9MTgzNSBjcmZfbWF4PTAuMCBuYWxfaHJkPW5vbmUgZmlsbGVyPTAgaXBfcmF0aW89MS40MCBhcT0xOjEuMDAAgAAAADdliIQAn8ket4Sv4N/8MvAHtq99THPJIafABVFPijchtanS8Mw6aa0tWGyt/2cQYkG1yh0Uj0+/AAAAD0GaImxJ/909iP1N1leiXwAAAAgBnkF5CH/vgQAAABBBmkM8IZMphJ/VF9nKPyiyAAAADEGaZEnhDyZTAk++gQAAABtBmoVJ4Q8mUwJP5J9yLeMJPZB+V34vLL4d2fEAAAAVQZqmSeEPJlMCT8K8tO8CvFNF4F9nAAAAEUGax0nhDyZTAk/VDHx1074RAAAAFEGa6EnhDyZTAk/ClXs0E/5AgBfAAAAADkGbCUnhDyZTAk/42A2AAAAADEGbKknhDyZTAk++gQAAABFBm0tJ4Q8mUwJv+SqXB6XowQAAABNBm2xJ4Q8mUwJv5aYpSZp9CTfMAAAAH0GbjUnhDyZTAm/Jfl28zEqav462f5Nm+T9YdKxlvIEAAAAMQZuuSeEPJlMCb8GBAAAAFUGbz0nhDyZTAm/mCtLPn5SN5p/XQQAAAA1Bm/BJ4Q8mUwIj/8eAAAAADUGaEUnhDyZTAiv/yoAAAAATQZoySeEPJlMCK//4hEA8Lzz1twAAAA1BmlNJ4Q8mUwI7/9GA';\r\n      videoTag.addEventListener('error', this.onBadMediaEvent);\r\n      videoTag.addEventListener('stalled', this.onBadMediaEvent);\r\n    }\r\n  }\r\n\r\n  onBadMediaEvent(event) {\r\n    /** @type {HTMLMediaElement} */\r\n    const videoTag = event.currentTarget;\r\n    if (videoTag.isSeated || (videoTag.paused && event.type !== 'error')) return;\r\n    this.lowBandwidth = true;\r\n  }\r\n\r\n  firstClick(event) {\r\n    for (let i = 0, l = this._availableVideoTags.length; i < l; i++) {\r\n      this._availableVideoTags[i].play();\r\n    }\r\n    _.delay(this.pauseAll, 100);\r\n  }\r\n\r\n  pauseAll() {\r\n    for (let i = 0, l = this._availableVideoTags.length; i < l; i++) {\r\n      this._availableVideoTags[i].pause();\r\n    }\r\n  }\r\n\r\n  setUpClickJack() {\r\n    _.bindAll(this, 'firstClick', 'pauseAll');\r\n\r\n    $('body').one({\r\n      click: this.firstClick,\r\n      touchend: this.firstClick\r\n    });\r\n  }\r\n\r\n  getVideoTag() {\r\n    const videoTag = this._availableVideoTags.pop();\r\n    videoTag.isSeated = false;\r\n    return videoTag;\r\n  }\r\n\r\n  releaseVideoTag(videoTag) {\r\n    this._availableVideoTags.push(videoTag);\r\n    videoTag.pause();\r\n    videoTag.isSeated = true;\r\n  }\r\n\r\n  /**\r\n   * Turn off smooth scrolling in IE and Edge to stop the background from flickering on scroll\r\n   */\r\n  disableSmoothScrolling() {\r\n    const userAgent = navigator.userAgent;\r\n    const shouldDisableSmoothScrolling = (userAgent.match(/MSIE 10/i) || userAgent.match(/Trident\\/7\\./) || userAgent.match(/Edge/));\r\n    if (!shouldDisableSmoothScrolling) return;\r\n    $('body').on('mousewheel', function (event) {\r\n      event.preventDefault();\r\n      const wd = event.originalEvent.wheelDelta;\r\n      const csp = window.pageYOffset;\r\n      window.scrollTo(0, csp - wd);\r\n    });\r\n  }\r\n\r\n}\r\n\r\nexport default (Adapt.backgroundSwitcher = new BackgroundSwitcher());\r\n","import Adapt from 'core/js/adapt';\r\nimport device from 'core/js/device';\r\nimport { templates } from 'core/js/reactHelpers';\r\nimport React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nclass BackgroundVideoView extends Backbone.View {\r\n\r\n  className() {\r\n    return 'backgroundvideo';\r\n  }\r\n\r\n  initialize() {\r\n    this.render(device.screenSize);\r\n    Adapt.on('device:changed', this.render, this);\r\n  }\r\n\r\n  render(screenSize) {\r\n    this.model.set('_screenSize', screenSize);\r\n    const props = { ...this.model.toJSON() };\r\n    const Template = templates[this.constructor.template.replace('.jsx', '')];\r\n    ReactDOM.render(<Template {...props} />, this.el);\r\n  }\r\n\r\n}\r\nBackgroundVideoView.template = 'backgroundvideo';\r\n\r\nexport default BackgroundVideoView;\r\n","import Adapt from 'core/js/adapt';\r\nimport BackgroundVideoView from './backgroundVideoView';\r\nclass BackgroundVideo extends Backbone.Controller {\r\n  initialize() {\r\n    this.listenTo(Adapt, 'app:dataReady', this._onDataReady);\r\n  }\r\n\r\n  _onDataReady() {\r\n    this.setupEventListeners();\r\n  }\r\n\r\n  setupEventListeners() {\r\n    this.listenTo(Adapt, {\r\n      'menuView:postRender pageView:postRender blockView:postRender': this.onPostRender\r\n    });\r\n\r\n  }\r\n\r\n  onPostRender(view) {\r\n    const viewModel = view.model;\r\n\r\n    if (!this.checkIsEnabled(viewModel)) return;\r\n    const backgroundVideoModel = new Backbone.Model(viewModel.get('_backgroundVideo'));\r\n    const backgroundVideoView = new BackgroundVideoView({ model: viewModel });\r\n    const _selector = backgroundVideoModel.get('_selector');\r\n    const el = _.isEmpty(_selector) ? view.$el : $(_selector);\r\n    const minHeight = backgroundVideoModel.get('_minHeight') || 0;\r\n    el.prepend(backgroundVideoView.el).addClass('has-backgroundvideo').css('min-height', minHeight + 'px');\r\n\r\n  }\r\n\r\n  checkIsEnabled(model) {\r\n    const _backgroundVideoModel = model.get('_backgroundVideo');\r\n    if (!_backgroundVideoModel || !_backgroundVideoModel._isEnabled) return false;\r\n    return true;\r\n  }\r\n}\r\nexport default new BackgroundVideo();\r\n","define([\r\n    'core/js/adapt',\r\n    '../../../adapt-contrib-spoor/libraries/SCORM_API_wrapper'\r\n],function(Adapt, pipwerks) {\r\n\r\n\r\n\r\n    $(\"body\").on('click', '.print-button', function() {\r\n        var certConfig = Adapt.course.get('_certificate');\r\n\r\n        var course = Adapt.course.get(\"displayTitle\");\r\n        var name = Adapt.offlineStorage.get('learnerinfo').name;\r\n        var date = (new Date()).toLocaleDateString(\"en-GB\");\r\n\r\n        var scormName = getName()\r\n;\r\n\r\n        var domain = document.location.origin;\r\n        var popup = window.open('course/en/document/certificate.html', 'bob');\r\n\r\n        var message = _.extend(certConfig, {\r\n            course: course,\r\n            name: scormName.learnerName || s,\r\n            id: scormName.learnerID || '',\r\n            date: date,\r\n        });\r\n\r\n        window.addEventListener('message', function() {\r\n            var e = JSON.parse(JSON.stringify(message))\r\n            popup.postMessage(e, domain)\r\n        });\r\n    })  \r\n    \r\n        function getName(){\r\n            let scormname = pipwerks.SCORM.API.get().LMSGetValue('cmi.core.student_name')\r\n            let name = scormname.replaceAll(',', '');\r\n            var nameID = {}\r\n            var scorm = pipwerks.SCORM.version == '1.2'\r\n            nameID.learnerName = scorm\r\n              ? name\r\n              : pipwerks.SCORM.API.get().LearnerName\r\n              nameID.learnerID = scorm\r\n              ? pipwerks.SCORM.API.get().LMSGetValue('cmi.core.student_id')\r\n              : pipwerks.SCORM.API.get().learnerID\r\n              console.log()\r\n            return nameID\r\n            \r\n          }\r\n\r\n });\r\n","import Adapt from 'core/js/adapt';\r\nimport logging from 'core/js/logging';\r\nimport AdaptArticleView from 'core/js/views/articleView';\r\n\r\nconst AssessmentView = {\r\n\r\n  postRender() {\r\n    AdaptArticleView.prototype.postRender.call(this);\r\n    if (this.model.isAssessmentEnabled()) {\r\n      this._setupEventListeners();\r\n\r\n      const config = this.model.getConfig();\r\n      if (config?._questions?._canShowMarking === false) {\r\n        this.$el.addClass('has-no-marking');\r\n      }\r\n    }\r\n    this.$el.addClass('is-assessment');\r\n  },\r\n\r\n  _setupEventListeners() {\r\n    this.listenTo(Adapt, {\r\n      'assessments:complete': this._onAssessmentComplete,\r\n      'assessments:reset': this._onAssessmentReset,\r\n      remove: this._onRemove\r\n    });\r\n  },\r\n\r\n  _removeEventListeners() {\r\n    this.stopListening(Adapt, {\r\n      'assessments:complete': this._onAssessmentComplete,\r\n      'assessments:reset': this._onAssessmentReset\r\n    });\r\n  },\r\n\r\n  _onAssessmentComplete(state, model) {\r\n    if (state.id !== this.model.get('_assessment')._id) return;\r\n\r\n    logging.info('assessment complete', state, model);\r\n  },\r\n\r\n  _onAssessmentReset(state, model) {\r\n    if (state.id !== this.model.get('_assessment')._id) return;\r\n\r\n    logging.info('assessment reset', state, model);\r\n\r\n  },\r\n\r\n  _onRemove() {\r\n    this._removeEventListeners();\r\n  }\r\n\r\n};\r\n\r\nexport default AssessmentView;\r\n","import data from 'core/js/data';\r\n\r\nclass QuestionBank {\r\n\r\n  constructor(quizBankId, articleId) {\r\n    this._bankId = quizBankId;\r\n    this._articleId = articleId;\r\n    this._unusedQuestionBlocks = null;\r\n    this._count = null;\r\n  }\r\n\r\n  calculateAvailableQuestionBlocks(count) {\r\n    this._count = parseInt(count);\r\n    const articleModel = data.findById(this._articleId);\r\n    const children = articleModel.getAvailableChildModels();\r\n    this._availableQuestionBlocks = children.map(blockModel => {\r\n      if (blockModel.get('_assessment')?._quizBankID !== this._bankId) return null;\r\n      return blockModel;\r\n    }).filter(Boolean);\r\n    const availableQuestionBlockIds = this._availableQuestionBlocks?.map(block => block.get('_id')) || [];\r\n    const unusedQuestionBlockIds = this._unusedQuestionBlocks?.map(block => block.get('_id')) || [];\r\n    const haveBlocksChanged = Boolean(_.difference(unusedQuestionBlockIds, availableQuestionBlockIds).length);\r\n    if (!haveBlocksChanged) return;\r\n    // Reset the unused question blocks if there are unused blocks which aren't available blocks\r\n    this._unusedQuestionBlocks = null;\r\n  }\r\n\r\n  getRandomQuestionBlocks() {\r\n    const questionBlocks = [];\r\n    let i = 0;\r\n    while (i++ < this._count) {\r\n      const nextBlock = this.unusedQuestionBlocks.shift();\r\n      questionBlocks.push(nextBlock);\r\n    }\r\n    return questionBlocks;\r\n  }\r\n\r\n  get unusedQuestionBlocks() {\r\n    const hasUnusedQuestion = Boolean(this._unusedQuestionBlocks?.length);\r\n    if (!hasUnusedQuestion) {\r\n      // Start again with all questions blocks, shuffled\r\n      this._unusedQuestionBlocks = _.shuffle(this._availableQuestionBlocks.slice(0));\r\n    }\r\n    return this._unusedQuestionBlocks;\r\n  }\r\n\r\n}\r\n\r\nexport default QuestionBank;\r\n","import Adapt from 'core/js/adapt';\r\nimport data from 'core/js/data';\r\nimport logging from 'core/js/logging';\r\nimport location from 'core/js/location';\r\nimport router from 'core/js/router';\r\nimport QuestionBank from './adapt-assessmentQuestionBank';\r\n\r\nlet givenIdCount = 0;\r\nconst assessmentConfigDefaults = {\r\n  _isEnabled: true,\r\n  _questions: {\r\n    _resetType: 'soft',\r\n    _canShowFeedback: false,\r\n    _canShowMarking: false,\r\n    _canShowModelAnswer: false\r\n  },\r\n  _suppressMarking: false,\r\n  _isPercentageBased: true,\r\n  _scoreToPass: 100,\r\n  _correctToPass: 100,\r\n  _includeInTotalScore: true,\r\n  _assessmentWeight: 1,\r\n  _isResetOnRevisit: true,\r\n  _reloadPageOnReset: true,\r\n  _attempts: 'infinite',\r\n  _allowResetIfPassed: false\r\n};\r\n\r\nconst AssessmentModel = {\r\n\r\n  _getCurrentQuestionComponents() {\r\n    return this.findDescendantModels('block')\r\n      .filter(block => block.get('_isAvailable'))\r\n      .reduce((questions, block) => questions.concat(block.findDescendantModels('question')), []);\r\n  },\r\n\r\n  _getAllQuestionComponents() {\r\n    return this.findDescendantModels('question');\r\n  },\r\n\r\n  // Private functions\r\n  _postInitialize() {\r\n    if (!this.isAssessmentEnabled()) return;\r\n\r\n    const assessmentConfig = this.getConfig();\r\n\r\n    Object.assign(this, {\r\n      _originalChildModels: null,\r\n      _questionBanks: null,\r\n      _forceResetOnRevisit: false\r\n    });\r\n\r\n    let attemptsLeft;\r\n    switch (assessmentConfig._attempts) {\r\n      case 'infinite': case 0: case undefined: case -1: case null:\r\n        attemptsLeft = 'infinite';\r\n        break;\r\n      default:\r\n        attemptsLeft = assessmentConfig._attempts;\r\n        break;\r\n    }\r\n\r\n    this.set({\r\n      _assessmentCompleteInSession: false,\r\n      _attemptInProgress: false,\r\n      _isAssessmentComplete: false,\r\n      _numberOfQuestionsAnswered: 0,\r\n      _lastAttemptScoreAsPercent: 0,\r\n      _attempts: attemptsLeft,\r\n      _attemptsLeft: attemptsLeft,\r\n      _attemptsSpent: 0\r\n    });\r\n\r\n    this.listenToOnce(Adapt, 'app:dataReady', this._onDataReady);\r\n    this.listenTo(Adapt, 'remove', this._onRemove);\r\n\r\n  },\r\n\r\n  init() {\r\n    // save original children\r\n    this._originalChildModels = this.getChildren().models;\r\n\r\n    this.setupCurrentQuestionComponents();\r\n\r\n    this._setAssessmentOwnershipOnChildrenModels();\r\n\r\n    // ensure the _questions attribute is set up (see https://github.com/adaptlearning/adapt_framework/issues/2971)\r\n    this._updateQuestionsState();\r\n  },\r\n\r\n  setupCurrentQuestionComponents() {\r\n    const assessmentQuestionsConfig = this.getConfig()._questions;\r\n    this._getAllQuestionComponents().forEach(component => {\r\n      component.set({\r\n        _canShowFeedback: assessmentQuestionsConfig._canShowFeedback,\r\n        _canShowMarking: assessmentQuestionsConfig._canShowMarking,\r\n        _canShowModelAnswer: assessmentQuestionsConfig._canShowModelAnswer\r\n      });\r\n    });\r\n  },\r\n\r\n  _setAssessmentOwnershipOnChildrenModels() {\r\n    // mark all children components as belonging to an assessment\r\n    const assessmentConfig = this.get('_assessment');\r\n    const childConfig = {\r\n      _isPartOfAssessment: true,\r\n      _assessmentId: assessmentConfig._id\r\n    };\r\n\r\n    for (const blockModel of this._originalChildModels) {\r\n      blockModel.set(childConfig);\r\n      // make sure components are set to _isPartOfAssessment for plp checking\r\n      blockModel.setOnChildren(childConfig);\r\n    }\r\n  },\r\n\r\n  // prevent default\r\n  checkIfResetOnRevisit() {},\r\n\r\n  _onDataReady() {\r\n    // register assessment\r\n    Adapt.assessment.register(this);\r\n  },\r\n\r\n  _setupAssessmentData(force, callback) {\r\n    const assessmentConfig = this.getConfig();\r\n    const state = this.getState();\r\n    const hasAttemptsLeft = (state.attemptsLeft > 0 || state.attemptsLeft === 'infinite');\r\n    const isFirstAttempt = (state.attemptsSpent === 0);\r\n    const shouldResetOnRevisit = (isFirstAttempt || assessmentConfig._isResetOnRevisit) && !this.get('_attemptInProgress');\r\n    const shouldResetAssessment = (shouldResetOnRevisit && !state.isPass && hasAttemptsLeft) || force === true;\r\n    const shouldResetQuestions = (shouldResetOnRevisit && (state.allowResetIfPassed || !state.isPass)) || force === true;\r\n    if (shouldResetAssessment || shouldResetQuestions) {\r\n      Adapt.trigger('assessments:preReset', this.getState(), this);\r\n    }\r\n    let quizModels;\r\n    if (shouldResetAssessment) {\r\n      if (isFirstAttempt || assessmentConfig?._questions?._resetType === 'hard') {\r\n        this.set({\r\n          _numberOfQuestionsAnswered: 0,\r\n          _isAssessmentComplete: false,\r\n          _assessmentCompleteInSession: false,\r\n          _score: 0\r\n        });\r\n      } else {\r\n        this.set({\r\n          _assessmentCompleteInSession: false\r\n        });\r\n      }\r\n      this.getChildren().models = this._originalChildModels;\r\n      if (assessmentConfig?._banks._isEnabled &&\r\n        assessmentConfig?._banks._split.length > 1) {\r\n        quizModels = this._setupBankedAssessment();\r\n      } else if (assessmentConfig?._randomisation._isEnabled) {\r\n        quizModels = this._setupRandomisedAssessment();\r\n      }\r\n    }\r\n    if (!quizModels) {\r\n      // leave the order as before, completed or not\r\n      quizModels = this.getChildren().models;\r\n    } else if (quizModels.length === 0) {\r\n      quizModels = this.getChildren().models;\r\n      logging.warn('assessment: Not enough unique questions to create a fresh assessment, using last selection');\r\n    }\r\n    this.getChildren().models = quizModels;\r\n    this.setupCurrentQuestionComponents();\r\n    if (shouldResetAssessment || shouldResetQuestions) {\r\n      this._resetQuestions();\r\n      this.set('_attemptInProgress', true);\r\n      Adapt.trigger('assessments:reset', this.getState(), this);\r\n    }\r\n    if (!state.isComplete) {\r\n      this.set('_attemptInProgress', true);\r\n    }\r\n    this._overrideQuestionComponentSettings();\r\n    this._setupQuestionListeners();\r\n    this._checkNumberOfQuestionsAnswered();\r\n    this._updateQuestionsState();\r\n    Adapt.assessment.saveState();\r\n    this.trigger('reset');\r\n    if (shouldResetAssessment || shouldResetQuestions) {\r\n      Adapt.trigger('assessments:postReset', this.getState(), this);\r\n    }\r\n  },\r\n\r\n  _setupBankedAssessment() {\r\n    const assessmentConfig = this.getConfig();\r\n    this._setupBanks();\r\n    // Get random questions from banks\r\n    let questionModels = this._questionBanks.flatMap(questionBank => questionBank.getRandomQuestionBlocks());\r\n    // If overall question order should be randomized\r\n    if (assessmentConfig._banks._randomisation) {\r\n      questionModels = _.shuffle(questionModels);\r\n    }\r\n    return questionModels;\r\n  },\r\n\r\n  _setupBanks() {\r\n    const assessmentConfig = this.getConfig();\r\n    const bankSplits = assessmentConfig._banks._split.split(',');\r\n    const hasBankSplitsChanged = (bankSplits.length !== this._questionBanks?.length);\r\n    if (hasBankSplitsChanged) {\r\n      // Generate new question banks if the split has changed\r\n      this._questionBanks = [];\r\n    }\r\n    bankSplits.forEach((count, index) => {\r\n      const bankId = (index + 1);\r\n      const articleId = this.get('_id');\r\n      // Keep question bank instances to preserve unused blocks over multi asessment attempts inside a session\r\n      this._questionBanks[bankId] = (this._questionBanks[bankId] || new QuestionBank(bankId, articleId));\r\n      // Recalculate available blocks incase they have changed or the count has changed in the split\r\n      this._questionBanks[bankId].calculateAvailableQuestionBlocks(count);\r\n    });\r\n  },\r\n\r\n  _setupRandomisedAssessment() {\r\n    const assessmentConfig = this.getConfig();\r\n\r\n    const randomisationModel = assessmentConfig._randomisation;\r\n    const blockModels = this.getChildren().models;\r\n\r\n    let questionModels = _.shuffle(blockModels);\r\n\r\n    if (randomisationModel._blockCount > 0) {\r\n      questionModels = questionModels.slice(0, randomisationModel._blockCount);\r\n    }\r\n\r\n    return questionModels;\r\n  },\r\n\r\n  _overrideQuestionComponentSettings() {\r\n    const newSettings = this._getMarkingSettings();\r\n\r\n    // Add any additional setting overrides here\r\n    const questionConfig = this.getConfig()._questions;\r\n    if (Object.prototype.hasOwnProperty.call(questionConfig, '_canShowFeedback')) {\r\n      newSettings._canShowFeedback = questionConfig._canShowFeedback;\r\n    }\r\n\r\n    if (!_.isEmpty(newSettings)) {\r\n      const questionComponents = this._getAllQuestionComponents();\r\n      questionComponents.forEach(model => model.set(newSettings, { pluginName: '_assessment' }));\r\n    }\r\n  },\r\n\r\n  _setupQuestionListeners() {\r\n    this._removeQuestionListeners();\r\n    this.listenTo(this, 'bubble:change:_isInteractionComplete', this._onCompletionEvent);\r\n  },\r\n\r\n  _checkNumberOfQuestionsAnswered() {\r\n    const questionComponents = this._getCurrentQuestionComponents();\r\n    const numberOfQuestionsAnswered = questionComponents.filter(model => model.get('_isInteractionComplete')).length;\r\n    this.set('_numberOfQuestionsAnswered', numberOfQuestionsAnswered);\r\n  },\r\n\r\n  _removeQuestionListeners() {\r\n    this.stopListening(this, 'bubble:change:_isInteractionComplete', this._onCompletionEvent);\r\n  },\r\n\r\n  _onCompletionEvent(event) {\r\n    if (event.target?.isTypeGroup('block')) return this._onBlockCompleted(event.target, event.value);\r\n    if (event.target?.isTypeGroup('questions')) return this._onQuestionCompleted(event.target, event.value);\r\n  },\r\n\r\n  _onBlockCompleted(blockModel, value) {\r\n    if (value === false) return;\r\n    const questionModels = blockModel.findDescendantModels('question');\r\n    questionModels.forEach(questionModel => {\r\n      this._onQuestionCompleted(questionModel, value);\r\n    });\r\n    if (!blockModel.get('_isInteractionComplete')) return;\r\n    this._checkAssessmentComplete();\r\n  },\r\n\r\n  _onQuestionCompleted(questionModel, value) {\r\n    if (value === false) return;\r\n    if (!questionModel.get('_isInteractionComplete')) return;\r\n\r\n    const numberOfQuestionsAnswered = this._getCurrentQuestionComponents().reduce((count, question) => (count += question.get('_isSubmitted') ? 1 : 0), 0);\r\n    this.set('_numberOfQuestionsAnswered', numberOfQuestionsAnswered);\r\n\r\n    this._updateQuestionsState();\r\n    Adapt.assessment.saveState();\r\n\r\n    this._checkAssessmentComplete();\r\n  },\r\n\r\n  _checkAssessmentComplete() {\r\n    const allQuestionsAdded = (this.get('_requireCompletionOf') !== Number.POSITIVE_INFINITY);\r\n    if (!allQuestionsAdded) return;\r\n    const numberOfQuestionsAnswered = this.get('_numberOfQuestionsAnswered');\r\n    const allQuestionsAnswered = (numberOfQuestionsAnswered >= this._getCurrentQuestionComponents().length);\r\n    if (!allQuestionsAnswered) return;\r\n    this._onAssessmentComplete();\r\n  },\r\n\r\n  _onAssessmentComplete() {\r\n    const wasAttemptInProgess = this.get('_attemptInProgress');\r\n    if (!wasAttemptInProgess) return;\r\n    this.set('_attemptInProgress', false);\r\n    this._spendAttempt();\r\n    const _scoreAsPercent = this._getScoreAsPercent();\r\n    const _score = this._getScore();\r\n    const _maxScore = this._getMaxScore();\r\n    const _minScore = this._getMinScore();\r\n    const _correctCount = this._getCorrectCount();\r\n    const _correctAsPercent = this._getCorrectAsPercent();\r\n    const _questionCount = this._getQuestionCount();\r\n    this.set({\r\n      _scoreAsPercent,\r\n      _score,\r\n      _maxScore,\r\n      _minScore,\r\n      _correctAsPercent,\r\n      _correctCount,\r\n      _questionCount,\r\n      _lastAttemptScoreAsPercent: _scoreAsPercent,\r\n      _assessmentCompleteInSession: true,\r\n      _isAssessmentComplete: true\r\n    });\r\n    this._updateQuestionsState();\r\n    this._checkIsPass();\r\n    this._removeQuestionListeners();\r\n    if (this._isMarkingSuppressionEnabled() && (!this._isAttemptsLeft() || this._isPassed())) {\r\n      _.defer(() => {\r\n        this._overrideMarkingSettings();\r\n        this._refreshQuestions();\r\n      });\r\n    }\r\n    Adapt.trigger('assessments:complete', this.getState(), this);\r\n  },\r\n\r\n  _updateQuestionsState() {\r\n    const questionComponents = this._getCurrentQuestionComponents();\r\n    const questions = questionComponents.map(model => ({\r\n      _id: model.get('_id'),\r\n      _isCorrect: model.get('_isCorrect') ?? null\r\n    }));\r\n    this.set('_questions', questions);\r\n  },\r\n\r\n  _checkIsPass() {\r\n    const assessmentConfig = this.getConfig();\r\n\r\n    const isPercentageBased = assessmentConfig._isPercentageBased;\r\n    const scoreToPass = assessmentConfig._scoreToPass;\r\n    const correctToPass = assessmentConfig._correctToPass || 0;\r\n\r\n    const scoreAsPercent = this.get('_scoreAsPercent');\r\n    const score = this.get('_score');\r\n    const correctAsPercent = this.get('_correctAsPercent');\r\n    const correctCount = this.get('_correctCount');\r\n\r\n    const isPass = isPercentageBased\r\n      ? (scoreAsPercent >= scoreToPass && correctAsPercent >= correctToPass)\r\n      : (score >= scoreToPass && correctCount >= correctToPass);\r\n\r\n    this.set('_isPass', isPass);\r\n  },\r\n\r\n  _getMarkingSettings() {\r\n    let markingSettings = {};\r\n\r\n    if (this._shouldSuppressMarking()) {\r\n      markingSettings = {\r\n        _canShowMarking: false,\r\n        _canShowModelAnswer: false\r\n      };\r\n    } else {\r\n      const questionConfig = this.getConfig()._questions;\r\n\r\n      if (Object.prototype.hasOwnProperty.call(questionConfig, '_canShowModelAnswer')) {\r\n        markingSettings._canShowModelAnswer = questionConfig._canShowModelAnswer;\r\n      }\r\n\r\n      if (Object.prototype.hasOwnProperty.call(questionConfig, '_canShowMarking')) {\r\n        markingSettings._canShowMarking = questionConfig._canShowMarking;\r\n      }\r\n    }\r\n\r\n    return markingSettings;\r\n  },\r\n\r\n  _overrideMarkingSettings() {\r\n    const newMarkingSettings = this._getMarkingSettings();\r\n    const questionComponents = this._getAllQuestionComponents();\r\n    questionComponents.forEach(model => model.set(newMarkingSettings, { pluginName: '_assessment' }));\r\n  },\r\n\r\n  _refreshQuestions() {\r\n    const questionComponents = this._getCurrentQuestionComponents();\r\n    questionComponents.forEach(model => model.refresh());\r\n  },\r\n\r\n  _shouldSuppressMarking() {\r\n    return this._isMarkingSuppressionEnabled() && this._isAttemptsLeft() && !this._isPassed();\r\n  },\r\n\r\n  _isMarkingSuppressionEnabled() {\r\n    const assessmentConfig = this.getConfig();\r\n    return assessmentConfig._suppressMarking;\r\n  },\r\n\r\n  _isAttemptsLeft() {\r\n    if (this.get('_attemptsLeft') === 0) return false;\r\n    return true;\r\n  },\r\n\r\n  _isPassed() {\r\n    return this.get('_isAssessmentComplete') && this.get('_isPass');\r\n  },\r\n\r\n  _spendAttempt() {\r\n    if (!this._isAttemptsLeft()) return false;\r\n\r\n    let attemptsSpent = this.get('_attemptsSpent');\r\n    this.set('_attemptsSpent', ++attemptsSpent);\r\n\r\n    if (this.get('_attempts') === 'infinite') return true;\r\n\r\n    let attemptsLeft = this.get('_attemptsLeft');\r\n    this.set('_attemptsLeft', --attemptsLeft);\r\n\r\n    return true;\r\n  },\r\n\r\n  _getScore() {\r\n    const questionComponents = this._getCurrentQuestionComponents();\r\n    const score = questionComponents.reduce((score, model) => (score += model.score || 0), 0);\r\n    return score;\r\n  },\r\n\r\n  _getMaxScore() {\r\n    const questionComponents = this._getCurrentQuestionComponents();\r\n    const maxScore = questionComponents.reduce((maxScore, model) => (maxScore += model.maxScore || 0), 0);\r\n    return maxScore;\r\n  },\r\n\r\n  _getMinScore() {\r\n    const questionComponents = this._getCurrentQuestionComponents();\r\n    const minScore = questionComponents.reduce((minScore, model) => (minScore += model.minScore || 0), 0);\r\n    return minScore;\r\n  },\r\n\r\n  _getScoreAsPercent() {\r\n    const minScore = this._getMinScore();\r\n    const maxScore = this._getMaxScore();\r\n    const score = this._getScore();\r\n    const range = (maxScore - minScore);\r\n    return (range === 0) ? 0 : Math.round(((score - minScore) / range) * 100);\r\n  },\r\n\r\n  _getCorrectCount() {\r\n    return this._getCurrentQuestionComponents().reduce((count, model) => (count += model.get('_isCorrect') ? 1 : 0), 0);\r\n  },\r\n\r\n  _getQuestionCount() {\r\n    return this._getCurrentQuestionComponents().length;\r\n  },\r\n\r\n  _getCorrectAsPercent() {\r\n    const questionCount = this._getQuestionCount();\r\n    return (questionCount === 0) ? 0 : Math.round((this._getCorrectCount() / questionCount) * 100);\r\n  },\r\n\r\n  _getLastAttemptScoreAsPercent() {\r\n    return this.get('_lastAttemptScoreAsPercent');\r\n  },\r\n\r\n  _checkReloadPage() {\r\n    if (!this.canResetInPage()) return false;\r\n\r\n    const parentId = this.getParent().get('_id');\r\n    const currentLocation = location._currentId;\r\n\r\n    // check if on assessment page and should rerender page\r\n    if (currentLocation !== parentId) return false;\r\n    if (!this.get('_isReady')) return false;\r\n\r\n    return true;\r\n  },\r\n\r\n  _reloadPage(callback) {\r\n    const assessmentConfig = this.getConfig();\r\n    this._forceResetOnRevisit = true;\r\n    this.listenToOnce(Adapt, 'pageView:ready', async () => {\r\n      if (assessmentConfig._scrollToOnReset) {\r\n        await router.navigateToElement(this.get('_id'));\r\n      }\r\n      callback();\r\n    });\r\n    _.delay(() => {\r\n      Backbone.history.navigate('#/id/' + location._currentId, { replace: true, trigger: true });\r\n    }, 250);\r\n  },\r\n\r\n  _resetQuestions() {\r\n    const assessmentConfig = this.getConfig();\r\n    const questionModels = this._getCurrentQuestionComponents();\r\n    questionModels.forEach(model => model.reset(assessmentConfig._questions._resetType, true));\r\n  },\r\n\r\n  _onRemove() {\r\n    this._removeQuestionListeners();\r\n  },\r\n\r\n  _setCompletionStatus() {\r\n    this.set({\r\n      _isComplete: true,\r\n      _isInteractionComplete: true\r\n    });\r\n  },\r\n\r\n  _checkIfQuestionsWereRestored() {\r\n    if (this.get('_assessmentCompleteInSession')) return;\r\n    if (!this.get('_isAssessmentComplete')) return;\r\n\r\n    // fix for courses that do not remember the user selections\r\n    // force assessment to reset if user revisits an assessment page in a new session which is completed\r\n    let wereQuestionsRestored = true;\r\n\r\n    const questions = this.get('_questions');\r\n    for (const question of questions) {\r\n      const questionModel = data.findById(question._id);\r\n      if (questionModel.get('_isAvailable') && !questionModel.get('_isSubmitted')) {\r\n        wereQuestionsRestored = false;\r\n        break;\r\n      }\r\n    }\r\n\r\n    if (!wereQuestionsRestored) {\r\n      this.set('_assessmentCompleteInSession', true);\r\n      return true;\r\n    }\r\n\r\n    return false;\r\n  },\r\n\r\n  // Public Functions\r\n  isAssessmentEnabled() {\r\n    if (this.get('_assessment')?._isEnabled) return true;\r\n    return false;\r\n  },\r\n\r\n  canResetInPage() {\r\n    const assessmentConfig = this.getConfig();\r\n    if (assessmentConfig._reloadPageOnReset === false) return false;\r\n    return true;\r\n  },\r\n\r\n  reset(force, callback) {\r\n\r\n    const assessmentConfig = this.getConfig();\r\n\r\n    // check if forcing reset via page revisit or force parameter\r\n    force = this._forceResetOnRevisit || force === true;\r\n    this._forceResetOnRevisit = false;\r\n\r\n    const isPageReload = this._checkReloadPage();\r\n\r\n    // stop resetting if not complete or not allowed\r\n    if (this.get('_assessmentCompleteInSession') &&\r\n      !assessmentConfig._isResetOnRevisit &&\r\n      !isPageReload &&\r\n      !force) {\r\n      // eslint-disable-next-line node/no-callback-literal\r\n      if (typeof callback === 'function') callback(false);\r\n      return false;\r\n    }\r\n\r\n    // check if new session and questions not restored\r\n    const wereQuestionsRestored = this._checkIfQuestionsWereRestored();\r\n    force = force || wereQuestionsRestored;\r\n    // the assessment is going to be reset so we must reset attempts\r\n    // otherwise assessment may not be set up properly in next session\r\n    if (force && !this._isAttemptsLeft()) {\r\n      this.set({\r\n        _attemptsLeft: this.get('_attempts'),\r\n        _attemptsSpent: 0\r\n      });\r\n    }\r\n\r\n    const allowResetIfPassed = this.get('_assessment')._allowResetIfPassed;\r\n    // stop resetting if no attempts left and allowResetIfPassed is false\r\n    if (!this._isAttemptsLeft() && !force && !allowResetIfPassed) {\r\n      // eslint-disable-next-line node/no-callback-literal\r\n      if (typeof callback === 'function') callback(false);\r\n      return false;\r\n    }\r\n\r\n    if (!isPageReload) {\r\n      this._setupAssessmentData(force);\r\n      // eslint-disable-next-line node/no-callback-literal\r\n      if (typeof callback === 'function') callback(true);\r\n    } else {\r\n      this._reloadPage(() => {\r\n        // eslint-disable-next-line node/no-callback-literal\r\n        if (typeof callback === 'function') callback(true);\r\n      });\r\n    }\r\n\r\n    return true;\r\n  },\r\n\r\n  getSaveState() {\r\n    const state = this.getState();\r\n    let blocks;\r\n    const cfg = this.getConfig();\r\n    const banksActive = cfg._banks?._isEnabled && cfg._banks._split.length > 1;\r\n    const randomisationActive = cfg._randomisation?._isEnabled;\r\n\r\n    if (!banksActive && !randomisationActive) {\r\n      // include presentation blocks in save state so that blocks without questions aren't removed\r\n      blocks = this.findDescendantModels('block');\r\n    } else {\r\n      blocks = state.questions.map(question => data.findById(question._id).getParent());\r\n    }\r\n    blocks = [...new Set(blocks)]\r\n      .filter(block => block.trackingPosition);\r\n    const blockTrackingPositions = blocks.map(block => block.trackingPosition);\r\n    const blockCompletion = blocks.map(block => {\r\n      const questions = block.findDescendantModels('question');\r\n      return questions.map(question => question.get('_isCorrect') || false);\r\n    });\r\n    const blockData = [blockTrackingPositions, blockCompletion];\r\n\r\n    const saveState = [\r\n      state.isComplete ? 1 : 0,\r\n      state.attemptsSpent,\r\n      state.maxScore || 0,\r\n      state.score,\r\n      state.attemptInProgress ? 1 : 0,\r\n      state.minScore || 0,\r\n      state.correctAsPercent || 0,\r\n      state.correctCount || 0,\r\n      state.questionCount || 0\r\n    ];\r\n\r\n    const dataPackage = [saveState, blockData];\r\n\r\n    return dataPackage;\r\n  },\r\n\r\n  setRestoreState(dataPackage) {\r\n    const restoreState = dataPackage[0];\r\n    const blockData = dataPackage[1];\r\n    const _isAssessmentComplete = restoreState[0] === 1;\r\n    const attempts = this.get('_attempts');\r\n    const _attemptsSpent = restoreState[1];\r\n    const maxScore = restoreState[2];\r\n    const score = restoreState[3];\r\n    const _scoreAsPercent = score ? Math.round(score / maxScore * 100) : 0;\r\n    const _attemptInProgress = restoreState[4] === 1;\r\n    const minScore = restoreState[5];\r\n    const correctAsPercent = restoreState[6];\r\n    const correctCount = restoreState[7];\r\n    const questionCount = restoreState[8];\r\n\r\n    const blocks = blockData[0].map(trackingPosition => {\r\n      if (typeof trackingPosition === 'number') {\r\n        // Backwards compability for courses which use _trackingId at block level\r\n        return data.findWhere({ _trackingId: trackingPosition });\r\n      }\r\n      return data.findByTrackingPosition(trackingPosition);\r\n    });\r\n\r\n    if (blocks.length) {\r\n      const nonBlockChildren = this.getChildren().models.filter(model => !model.isTypeGroup('block'));\r\n      this.getChildren().models = blocks.concat(nonBlockChildren);\r\n    }\r\n\r\n    const _questions = [];\r\n    blocks.forEach((block, blockIndex) => {\r\n      const blockQuestions = block.findDescendantModels('question');\r\n      blockQuestions.forEach((question, questionIndex) => {\r\n        _questions.push({\r\n          _id: question.get('_id'),\r\n          _isCorrect: blockData[1][blockIndex][questionIndex]\r\n        });\r\n      });\r\n    });\r\n\r\n    this.set({\r\n      _isAssessmentComplete,\r\n      _assessmentCompleteInSession: false,\r\n      _attemptsSpent,\r\n      _attemptInProgress,\r\n      _attemptsLeft: (attempts === 'infinite' ? attempts : attempts - _attemptsSpent),\r\n      _maxScore: maxScore || this._getMaxScore(),\r\n      _minScore: minScore || this._getMinScore(),\r\n      _score: score || 0,\r\n      _scoreAsPercent,\r\n      _correctAsPercent: correctAsPercent || 0,\r\n      _correctCount: correctCount || 0,\r\n      _questions,\r\n      _questionCount: questionCount || 0,\r\n      _lastAttemptScoreAsPercent: _scoreAsPercent\r\n    });\r\n\r\n    if (_isAssessmentComplete) this._checkIsPass();\r\n\r\n    Adapt.trigger('assessments:restored', this.getState(), this);\r\n\r\n  },\r\n\r\n  getState() {\r\n    // return the current state of the assessment\r\n    // create snapshot of values so as not to create memory leaks\r\n    const assessmentConfig = this.getConfig();\r\n\r\n    const state = {\r\n      id: assessmentConfig._id,\r\n      type: 'article-assessment',\r\n      pageId: this.getParent().get('_id'),\r\n      articleId: this.get('_id'),\r\n      isEnabled: assessmentConfig._isEnabled,\r\n      isComplete: this.get('_isAssessmentComplete'),\r\n      isPercentageBased: assessmentConfig._isPercentageBased,\r\n      scoreToPass: assessmentConfig._scoreToPass,\r\n      score: this.get('_score'),\r\n      scoreAsPercent: this.get('_scoreAsPercent'),\r\n      maxScore: this.get('_maxScore'),\r\n      minScore: this.get('_minScore'),\r\n      correctCount: this.get('_correctCount'),\r\n      correctAsPercent: this.get('_correctAsPercent'),\r\n      correctToPass: assessmentConfig._correctToPass,\r\n      questionCount: this.get('_questionCount'),\r\n      isPass: this.get('_isPass'),\r\n      includeInTotalScore: assessmentConfig._includeInTotalScore,\r\n      assessmentWeight: assessmentConfig._assessmentWeight,\r\n      attempts: this.get('_attempts'),\r\n      attemptsSpent: this.get('_attemptsSpent'),\r\n      attemptsLeft: this.get('_attemptsLeft'),\r\n      attemptInProgress: this.get('_attemptInProgress'),\r\n      lastAttemptScoreAsPercent: this.get('_lastAttemptScoreAsPercent'),\r\n      questions: this.get('_questions'),\r\n      resetType: assessmentConfig._questions._resetType,\r\n      allowResetIfPassed: assessmentConfig._allowResetIfPassed,\r\n      questionModels: new Backbone.Collection(this._getCurrentQuestionComponents())\r\n    };\r\n\r\n    return state;\r\n  },\r\n\r\n  getConfig() {\r\n    let assessmentConfig = this.get('_assessment');\r\n\r\n    if (!assessmentConfig) {\r\n      assessmentConfig = $.extend(true, {}, assessmentConfigDefaults);\r\n    } else {\r\n      assessmentConfig = $.extend(true, {}, assessmentConfigDefaults, assessmentConfig);\r\n    }\r\n\r\n    if (assessmentConfig._id === undefined) {\r\n      assessmentConfig._id = 'givenId' + (givenIdCount++);\r\n    }\r\n\r\n    this.set('_assessment', assessmentConfig);\r\n\r\n    return assessmentConfig;\r\n  }\r\n};\r\n\r\nexport default AssessmentModel;\r\n","import Adapt from 'core/js/adapt';\r\nimport offlineStorage from 'core/js/offlineStorage';\r\nimport wait from 'core/js/wait';\r\nimport data from 'core/js/data';\r\nimport logging from 'core/js/logging';\r\n\r\n/*\r\n  * Here we setup a registry for all assessments\r\n  */\r\nconst assessmentsConfigDefaults = {\r\n  _isPercentageBased: true,\r\n  _scoreToPass: 100,\r\n  _isDefaultsLoaded: true\r\n};\r\n\r\nclass Assessment extends Backbone.Controller {\r\n\r\n  initialize() {\r\n    this._assessments = Object.assign([], {\r\n      _byPageId: {},\r\n      _byAssessmentId: {}\r\n    });\r\n    this.listenTo(Adapt, {\r\n      'assessments:complete': this._onAssessmentsComplete,\r\n      'router:location': this._checkResetAssessmentsOnRevisit,\r\n      'router:plugin': this._handleRoute,\r\n      'app:dataReady': this._onDataReady\r\n    });\r\n  }\r\n\r\n  _onAssessmentsComplete(state) {\r\n    const assessmentId = state.id;\r\n\r\n    state.isComplete = true;\r\n\r\n    if (assessmentId === undefined) return;\r\n\r\n    if (!this._getStateByAssessmentId(assessmentId)) {\r\n      logging.warn('assessments: state was not registered when assessment was created');\r\n    }\r\n\r\n    this.saveState();\r\n\r\n    this._setPageProgress();\r\n\r\n    this._checkAssessmentsComplete();\r\n\r\n  }\r\n\r\n  _restoreModelState(assessmentModel) {\r\n\r\n    if (!this._saveStateModel) {\r\n      this._saveStateModel = offlineStorage.get('a');\r\n    }\r\n    if (this._saveStateModel) {\r\n      const state = assessmentModel.getState();\r\n      if (this._saveStateModel[state.id]) {\r\n        assessmentModel.setRestoreState(offlineStorage.deserialize(this._saveStateModel[state.id]));\r\n      }\r\n    }\r\n\r\n  }\r\n\r\n  /*\r\n    * Allow navigating to an assessment via the URL.\r\n    */\r\n  _handleRoute(plugin, id) {\r\n    if ((plugin !== 'assessment' && plugin !== 'article-assessment') || id === undefined) {\r\n      return;\r\n    }\r\n\r\n    // Check the 'id' passed is that of an article.\r\n    if (!data.findById(id)) {\r\n      // The 'id' passed may have been the assessment _id/name, not the article _id.\r\n      const assessment = Adapt.assessment._assessments._byAssessmentId[id];\r\n      if (assessment) {\r\n        // Set 'id' to the article _id.\r\n        id = assessment.get('_id');\r\n      } else {\r\n        logging.warn('Assessment not found with _id: ' + id);\r\n        return;\r\n      }\r\n    }\r\n\r\n    _.defer(() => {\r\n      // Defer this call so that the router's _canNavigate flag is true.\r\n      Backbone.history.navigate('#/id/' + id, { trigger: true, replace: true });\r\n    });\r\n  }\r\n\r\n  _checkResetAssessmentsOnRevisit(toObject) {\r\n    /*\r\n      * Here we hijack router:location to reorganise the assessment blocks\r\n      * this must happen before trickle listens to block completion\r\n      */\r\n    if (toObject._contentType !== 'page') return;\r\n\r\n    // initialize assessment on page visit before pageView:preRender (and trickle)\r\n    const pageAssessmentModels = this._getAssessmentByPageId(toObject._currentId);\r\n    if (pageAssessmentModels === undefined) return;\r\n\r\n    /*\r\n      * Here we further hijack the router to ensure the asynchronous assessment\r\n      * reset completes before routing completes\r\n      */\r\n    wait.for(function resetAllAssessments(allAssessmentHaveReset) {\r\n\r\n      const numberOfAssessments = pageAssessmentModels.length;\r\n      let numberOfResetAssessments = 0;\r\n      const forceAssessmentReset = false;\r\n\r\n      pageAssessmentModels.forEach(model => {\r\n\r\n        model.reset(forceAssessmentReset, () => {\r\n          numberOfResetAssessments++;\r\n          const haveAllModelsReset = (numberOfResetAssessments === numberOfAssessments);\r\n          if (!haveAllModelsReset) {\r\n            return;\r\n          }\r\n          allAssessmentHaveReset();\r\n        });\r\n      });\r\n    });\r\n\r\n    this._setPageProgress();\r\n  }\r\n\r\n  _onDataReady() {\r\n    this._assessments = Object.assign([], {\r\n      _byPageId: {},\r\n      _byAssessmentId: {}\r\n    });\r\n\r\n    this._restoredCount = 0;\r\n  }\r\n\r\n  _checkAssessmentsComplete() {\r\n    let allAssessmentsComplete = true;\r\n    let assessmentToPostBack = 0;\r\n    const states = this._getStatesByAssessmentId();\r\n\r\n    const assessmentStates = [];\r\n\r\n    for (const id in states) {\r\n      const state = states[id];\r\n      if (!state.includeInTotalScore) continue;\r\n      if (!state.isComplete) {\r\n        allAssessmentsComplete = false;\r\n        break;\r\n      }\r\n      assessmentToPostBack++;\r\n      assessmentStates.push(state);\r\n    }\r\n\r\n    if (!allAssessmentsComplete || assessmentToPostBack === 0) return false;\r\n\r\n    if (assessmentToPostBack === 1) {\r\n      this._setupSingleAssessmentConfiguration(assessmentStates[0]);\r\n    }\r\n\r\n    _.defer(() => Adapt.trigger('assessment:complete', this.getState()));\r\n\r\n    return true;\r\n  }\r\n\r\n  _setupSingleAssessmentConfiguration(assessmentState) {\r\n    const assessmentsConfig = Adapt.course.get('_assessment');\r\n    $.extend(true, assessmentsConfig, {\r\n      _isPercentageBased: assessmentState.isPercentageBased,\r\n      _scoreToPass: assessmentState.scoreToPass\r\n    });\r\n    Adapt.course.set('_assessment', assessmentsConfig);\r\n  }\r\n\r\n  _getAssessmentByPageId(pageId) {\r\n    return this._assessments._byPageId[pageId];\r\n  }\r\n\r\n  _getStateByAssessmentId(assessmentId) {\r\n    if (assessmentId === undefined) {\r\n      return null;\r\n    }\r\n\r\n    return this._assessments._byAssessmentId[assessmentId].getState();\r\n  }\r\n\r\n  _getStatesByAssessmentId() {\r\n    const states = {};\r\n    for (const assessmentModel of this._assessments) {\r\n      if (!assessmentModel.get('_isAvailable')) continue;\r\n      const state = assessmentModel.getState();\r\n      states[state.id] = state;\r\n    }\r\n    return states;\r\n  }\r\n\r\n  _setPageProgress() {\r\n    // set _subProgressTotal and _subProgressComplete on pages that have assessment progress indicator requirements\r\n\r\n    for (const [ id, assessments ] of Object.entries(this._assessments._byPageId)) {\r\n\r\n      const assessmentsTotal = assessments.length;\r\n      let assessmentsPassed = 0;\r\n\r\n      for (const assessment of assessments) {\r\n        const assessmentState = assessment.getState();\r\n\r\n        if (assessmentState.includeInTotalScore && !assessmentState.isPass) continue;\r\n\r\n        if (assessmentState.isComplete) {\r\n          assessmentsPassed++;\r\n        }\r\n      }\r\n\r\n      const pageModel = data.findById(id);\r\n      pageModel?.set({\r\n        _subProgressTotal: assessmentsTotal,\r\n        _subProgressComplete: assessmentsPassed\r\n      });\r\n\r\n    }\r\n  }\r\n\r\n  _addToAssessmentIdMap(id, model) {\r\n    if (id === undefined) {\r\n      logging.warn('An assessment has been registered with an undefined value for \"_id\"');\r\n      return;\r\n    }\r\n\r\n    if (id === '') {\r\n      logging.warn('An assessment has been registered with an empty value for \"_id\"');\r\n    }\r\n\r\n    if (!this._assessments._byAssessmentId[id]) {\r\n      this._assessments._byAssessmentId[id] = model;\r\n    } else {\r\n      logging.warn('An assessment with an _id of \"' + id + '\" already exists!');\r\n    }\r\n  }\r\n\r\n  _setupQuestionNumbering() {\r\n    const getRelatedQuestions = data => {\r\n      const currentAssessmentId = data._assessmentId;\r\n      const currentAssessment = Adapt.assessment.get(currentAssessmentId);\r\n      return currentAssessment.getState().questions;\r\n    };\r\n\r\n    Handlebars.registerHelper('questionNumber', function getQuestionNumber() {\r\n      const data = this.view?.model.toJSON() || this;\r\n      if (!data._isPartOfAssessment) return;\r\n\r\n      const related = _.pluck(getRelatedQuestions(data), '_id');\r\n\r\n      return related.indexOf(data._id) + 1;\r\n    });\r\n\r\n    Handlebars.registerHelper('questionCount', function getTotalQuestions() {\r\n      const data = this.view ? this.view.model.toJSON() : this;\r\n      if (!data._isPartOfAssessment) return;\r\n      return getRelatedQuestions(data).length;\r\n    });\r\n  }\r\n\r\n  // Public functions\r\n  register(assessmentModel) {\r\n    const state = assessmentModel.getState();\r\n    const assessmentId = state.id;\r\n    const pageId = state.pageId;\r\n\r\n    if (this._assessments._byPageId[pageId] === undefined) {\r\n      this._assessments._byPageId[pageId] = [];\r\n    }\r\n\r\n    this._assessments._byPageId[pageId].push(assessmentModel);\r\n\r\n    this._addToAssessmentIdMap(assessmentId, assessmentModel);\r\n\r\n    this._assessments.push(assessmentModel);\r\n\r\n    this._restoreModelState(assessmentModel);\r\n    this._restoredCount++;\r\n\r\n    Adapt.trigger('assessments:register', state, assessmentModel);\r\n\r\n    this._setPageProgress();\r\n\r\n    this._setupQuestionNumbering();\r\n\r\n    if (this._restoredCount === this._assessments.length) {\r\n      // Since all assessments have been stored, broadcast an\r\n      // event which has the collated state.\r\n      Adapt.trigger('assessment:restored', this.getState());\r\n    }\r\n  }\r\n\r\n  get(id) {\r\n    return (id === undefined)\r\n      ? this._assessments.slice(0)\r\n      : this._assessments._byAssessmentId[id];\r\n  }\r\n\r\n  saveState() {\r\n\r\n    this._saveStateModel = {};\r\n    for (const assessmentModel of this._assessments) {\r\n      const state = assessmentModel.getState();\r\n      this._saveStateModel[state.id] = offlineStorage.serialize(assessmentModel.getSaveState());\r\n    }\r\n\r\n    offlineStorage.set('a', this._saveStateModel);\r\n  }\r\n\r\n  getConfig() {\r\n    let assessmentsConfig = Adapt.course.get('_assessment');\r\n\r\n    if (assessmentsConfig?._isDefaultsLoaded) {\r\n      return assessmentsConfig;\r\n    }\r\n\r\n    if (assessmentsConfig === undefined) {\r\n      assessmentsConfig = $.extend(true, {}, assessmentsConfigDefaults);\r\n    } else {\r\n      assessmentsConfig = $.extend(true, {}, assessmentsConfigDefaults, assessmentsConfig);\r\n    }\r\n\r\n    Adapt.course.set('_assessment', assessmentsConfig);\r\n\r\n    return assessmentsConfig;\r\n  }\r\n\r\n  getState() {\r\n    const assessmentsConfig = this.getConfig();\r\n\r\n    let score = 0;\r\n    let maxScore = 0;\r\n    let minScore = 0;\r\n    let correctCount = 0;\r\n    let questionCount = 0;\r\n    let assessments = 0;\r\n    const states = this._getStatesByAssessmentId();\r\n    let assessmentsComplete = 0;\r\n\r\n    for (const id in states) {\r\n      const state = states[id];\r\n      if (!state.includeInTotalScore) continue;\r\n      if (state.isComplete) assessmentsComplete++;\r\n      assessments++;\r\n      maxScore += state.maxScore / state.assessmentWeight;\r\n      minScore += state.minScore / state.assessmentWeight;\r\n      score += state.score / state.assessmentWeight;\r\n      correctCount += state.correctCount / state.assessmentWeight;\r\n      questionCount += state.questionCount / state.assessmentWeight;\r\n    }\r\n\r\n    const isComplete = assessmentsComplete === assessments;\r\n\r\n    const scoreRange = (maxScore - minScore);\r\n    const scoreAsPercent = (scoreRange === 0) ? 0 : Math.round(((score - minScore) / scoreRange) * 100);\r\n    const correctAsPercent = (questionCount === 0) ? 0 : Math.round((correctCount / questionCount) * 100);\r\n\r\n    if (assessmentsConfig._correctToPass === undefined) {\r\n      logging.warnOnce('Assessment course config is missing _correctToPass');\r\n    }\r\n\r\n    const scoreToPass = assessmentsConfig._scoreToPass;\r\n    const correctToPass = assessmentsConfig._correctToPass || scoreToPass;\r\n    const isPercentageBased = assessmentsConfig._isPercentageBased;\r\n\r\n    const isPass = isComplete && (isPercentageBased\r\n      ? scoreAsPercent >= scoreToPass && correctAsPercent >= correctToPass\r\n      : score >= scoreToPass && correctCount >= correctToPass);\r\n\r\n    const canRetry = Object.values(states).some(state => {\r\n      const isFailed = !state.isPass;\r\n      const hasAttemptsLeft = (state.attemptsLeft > 0 || state.attemptsLeft === 'infinite');\r\n      return (isFailed && hasAttemptsLeft);\r\n    });\r\n\r\n    return {\r\n      isComplete,\r\n      isPercentageBased,\r\n      isPass,\r\n      maxScore,\r\n      minScore,\r\n      score,\r\n      scoreToPass,\r\n      scoreAsPercent,\r\n      correctCount,\r\n      correctAsPercent,\r\n      correctToPass,\r\n      questionCount,\r\n      assessmentsComplete,\r\n      assessments,\r\n      canRetry\r\n    };\r\n  }\r\n}\r\n\r\nexport default (Adapt.assessment = new Assessment());\r\n","import ArticleView from 'core/js/views/articleView';\r\nimport ArticleModel from 'core/js/models/articleModel';\r\nimport AdaptAssessmentArticleView from './adapt-assessmentArticleView';\r\nimport AdaptAssessmentArticleModel from './adapt-assessmentArticleModel';\r\nimport './assessment';\r\n\r\n/*\r\n  * Here we are extending the articleView and articleModel in Adapt.\r\n  * This is to accomodate the assessment functionality on the article.\r\n  * The advantage of this method is that the assessment behaviour can utilize all of the predefined article behaviour in both the view and the model.\r\n  */\r\n\r\n// Extends core/js/views/articleView.js\r\nconst ArticleViewInitialize = ArticleView.prototype.initialize;\r\nArticleView.prototype.initialize = function(options) {\r\n  if (this.model.get('_assessment')?._isEnabled === true) {\r\n    // extend the articleView with new functionality\r\n    Object.assign(this, AdaptAssessmentArticleView);\r\n  }\r\n  // initialize the article in the normal manner\r\n  return ArticleViewInitialize.apply(this, arguments);\r\n};\r\n\r\n// Extends core/js/models/articleModel.js\r\nconst ArticleModelInitialize = ArticleModel.prototype.initialize;\r\nArticleModel.prototype.initialize = function(options) {\r\n  if (this.get('_assessment')?._isEnabled === true) {\r\n    // extend the articleModel with new functionality\r\n    Object.assign(this, AdaptAssessmentArticleModel);\r\n\r\n    // initialize the article in the normal manner\r\n    const returnValue = ArticleModelInitialize.apply(this, arguments);\r\n\r\n    // initialize assessment article\r\n    this._postInitialize();\r\n\r\n    return returnValue;\r\n  }\r\n\r\n  // initialize the article in the normal manner if no assessment\r\n  return ArticleModelInitialize.apply(this, arguments);\r\n};\r\n","import Adapt from 'core/js/adapt';\r\nimport offlineStorage from 'core/js/offlineStorage';\r\nimport logging from 'core/js/logging';\r\nimport location from 'core/js/location';\r\nimport router from 'core/js/router';\r\nimport notify from 'core/js/notify';\r\nimport data from 'core/js/data';\r\n\r\nclass Bookmarking extends Backbone.Controller {\r\n\r\n  initialize() {\r\n    this.bookmarkLevel = null;\r\n    this.restoredLocationID = null;\r\n    this.currentLocationID = null;\r\n    this.listenToOnce(Adapt, 'router:location', this.onAdaptInitialize);\r\n  }\r\n\r\n  onAdaptInitialize() {\r\n    if (!this.checkCourseIsEnabled()) return;\r\n    this.setupEventListeners();\r\n    this.checkRestoreLocation();\r\n  }\r\n\r\n  checkCourseIsEnabled() {\r\n    const courseBookmarkModel = Adapt.course.get('_bookmarking');\r\n    if (!courseBookmarkModel || !courseBookmarkModel._isEnabled) return false;\r\n    return true;\r\n  }\r\n\r\n  setupEventListeners() {\r\n    this._onScroll = _.debounce(this.checkLocation.bind(this), 250);\r\n    this.listenTo(Adapt, {\r\n      'menuView:ready': this.setupMenu,\r\n      'pageView:preRender': this.setupPage,\r\n      'view:childAdded': this.checkLocation\r\n    });\r\n  }\r\n\r\n  checkRestoreLocation() {\r\n    this.restoredLocationID = offlineStorage.get('location');\r\n\r\n    if (!this.restoredLocationID || this.restoredLocationID === 'undefined' || !data.findById(this.restoredLocationID)) {\r\n      return;\r\n    }\r\n\r\n    this.listenToOnce(Adapt, 'pageView:ready menuView:ready', this.restoreLocation);\r\n  }\r\n\r\n  restoreLocation() {\r\n    this.stopListening(Adapt, 'pageView:ready menuView:ready', this.restoreLocation);\r\n\r\n    _.delay(() => {\r\n      if (this.isAlreadyOnScreen(this.restoredLocationID)) {\r\n        return;\r\n      }\r\n\r\n      if (Adapt.course.get('_bookmarking')._showPrompt === false) {\r\n        this.navigateToPrevious();\r\n        return;\r\n      }\r\n\r\n      this.showPrompt();\r\n\r\n    }, 500);// slight delay is necessary to allow any render & scrollTo to complete before calling isAlreadyOnScreen\r\n  }\r\n\r\n  /**\r\n   * If the learner is already at the bookmarked location, there's no need to show a prompt\r\n   * This method determines whether that is the case or not\r\n   * @param {string} id The `_id` of the item the learner needs to be returned to\r\n   * @return {boolean}\r\n   */\r\n  isAlreadyOnScreen(id) {\r\n    if (id === location._currentId) return true;\r\n\r\n    const type = data.findById(id).getTypeGroup();\r\n    if (type === 'menu' || type === 'page') {\r\n      return false;\r\n    }\r\n\r\n    const locationOnscreen = $('.' + id).onscreen();\r\n    const isLocationOnscreen = locationOnscreen && (locationOnscreen.percentInview > 0);\r\n    const isLocationFullyInview = locationOnscreen && (locationOnscreen.percentInview === 100);\r\n    if (isLocationOnscreen && isLocationFullyInview) {\r\n      return true;\r\n    }\r\n\r\n    return false;\r\n  }\r\n\r\n  showPrompt() {\r\n    const courseBookmarkModel = Adapt.course.get('_bookmarking');\r\n    const buttons = courseBookmarkModel._buttons || { yes: 'Yes', no: 'No' };\r\n\r\n    this.listenToOnce(Adapt, {\r\n      'bookmarking:continue': this.navigateToPrevious,\r\n      'bookmarking:cancel': this.navigateCancel\r\n    });\r\n\r\n    notify.prompt({\r\n      _classes: 'is-bookmarking',\r\n      _showIcon: true,\r\n      title: courseBookmarkModel.title,\r\n      body: courseBookmarkModel.body,\r\n      _prompts: [\r\n        {\r\n          promptText: buttons.yes || 'Yes',\r\n          _callbackEvent: 'bookmarking:continue'\r\n        },\r\n        {\r\n          promptText: buttons.no || 'No',\r\n          _callbackEvent: 'bookmarking:cancel'\r\n        }\r\n      ]\r\n    });\r\n  }\r\n\r\n  navigateToPrevious() {\r\n    _.defer(async () => {\r\n      const isSinglePage = (Adapt.contentObjects.models.length === 1);\r\n      try {\r\n        await router.navigateToElement(this.restoredLocationID, { trigger: true, replace: isSinglePage, duration: 400 });\r\n      } catch (err) {\r\n        logging.warn(`Bookmarking cannot navigate to id: ${this.restoredLocationID}\\n`, err);\r\n      }\r\n    });\r\n\r\n    this.stopListening(Adapt, 'bookmarking:cancel');\r\n  }\r\n\r\n  navigateCancel() {\r\n    this.stopListening(Adapt, 'bookmarking:continue');\r\n  }\r\n\r\n  resetLocationID() {\r\n    this.setLocationID('');\r\n  }\r\n\r\n  /**\r\n   * if the learner navigates to the top-level menu, clear the stored bookmark\r\n   * if it's a sub-menu, store the menu's id as the bookmark\r\n   */\r\n  setupMenu(menuView) {\r\n    const menuModel = menuView.model;\r\n\r\n    if (!menuModel.get('_parentId')) {\r\n      this.resetLocationID();\r\n      return;\r\n    }\r\n\r\n    this.setLocationID(menuModel.get('_id'));\r\n  }\r\n\r\n  /**\r\n   * Calculates what the bookmarking 'level' will be for any given page.\r\n   * First sets a default using the course-level setting (or 'component' if that's not been set)\r\n   * then checks to see if that's being overridden at page level or not\r\n   * @param {Backbone.Model} pageModel The model for the current page view\r\n   * @return {String} Either 'page', 'block', or 'component' - with 'component' being the default\r\n   */\r\n  getBookmarkLevel(pageModel) {\r\n    const defaultLevel = Adapt.course.get('_bookmarking')._level || 'component';\r\n    const bookmarkModel = pageModel.get('_bookmarking');\r\n    const isInherit = !bookmarkModel || !bookmarkModel._level || bookmarkModel._level === 'inherit';\r\n    return isInherit ? defaultLevel : bookmarkModel._level;\r\n  }\r\n\r\n  /**\r\n   * Sets up bookmarking for the page the learner just navigated to\r\n   * If bookmarking is disabled for the current page, clear the stored bookmark and return.\r\n   * Otherwise, bookmark the page then - if necessary - set up to calculate which block or component\r\n   * should be bookmarked as the learner scrolls up/down the page\r\n   * @param {Backbone.View} pageView The current page view\r\n   */\r\n  setupPage(pageView) {\r\n    const pageBookmarkModel = pageView.model.get('_bookmarking');\r\n    if (pageBookmarkModel?._isEnabled === false) {\r\n      this.resetLocationID();\r\n      return;\r\n    }\r\n\r\n    this.setLocationID(pageView.model.get('_id'));\r\n\r\n    this.bookmarkLevel = this.getBookmarkLevel(pageView.model);\r\n    if (this.bookmarkLevel === 'page') {\r\n      return;\r\n    }\r\n\r\n    this.listenToOnce(Adapt, 'remove', this.releaseViews);\r\n\r\n    $(window).on('scroll', this._onScroll);\r\n  }\r\n\r\n  setLocationID(id) {\r\n    if (this.currentLocationID === id) return;\r\n    offlineStorage.set('location', id);\r\n    this.currentLocationID = id;\r\n  }\r\n\r\n  releaseViews() {\r\n    this.stopListening(Adapt, 'remove', this.releaseViews);\r\n    $(window).off('scroll', this._onScroll);\r\n  }\r\n\r\n  checkLocation() {\r\n    const contentObjectBookmarkModel = Adapt.parentView?.model?.get('_bookmarking');\r\n    if (contentObjectBookmarkModel?._isEnabled === false) {\r\n      this.resetLocationID();\r\n      return;\r\n    }\r\n    const currentModel = location._currentModel;\r\n    if (!currentModel || !this.bookmarkLevel) return;\r\n    const possibleViewIds = currentModel.findDescendantModels(this.bookmarkLevel)\r\n      .filter(desc => desc.get('_isTrackable') !== false) // Filter trickle buttons\r\n      .map(desc => desc.get('_id'));\r\n\r\n    let highestOnscreen = 0;\r\n    let highestOnscreenLocation = '';\r\n    possibleViewIds.forEach(id => {\r\n      const element = $(`[data-adapt-id=${id}]`);\r\n      if (!element.length) return;\r\n      const measurements = element.onscreen();\r\n      if (!measurements.onscreen) return;\r\n      if (measurements.percentInview <= highestOnscreen) return;\r\n      highestOnscreen = measurements.percentInview;\r\n      highestOnscreenLocation = id;\r\n    });\r\n\r\n    // set location as most inview component\r\n    if (highestOnscreenLocation) this.setLocationID(highestOnscreenLocation);\r\n  }\r\n}\r\n\r\nexport default new Bookmarking();\r\n","import Adapt from 'core/js/adapt';\r\n\r\nexport default class NavigationView extends Backbone.View {\r\n\r\n  className() {\r\n    return 'nav';\r\n  }\r\n\r\n  attributes() {\r\n    return {\r\n      role: 'navigation'\r\n    };\r\n  }\r\n\r\n  initialize() {\r\n    this.template = 'languagePickerNavigation';\r\n    this.setupHelpers();\r\n    this.preRender();\r\n  }\r\n\r\n  preRender() {\r\n    Adapt.trigger('navigationView:preRender', this);\r\n    this.render();\r\n  }\r\n\r\n  render() {\r\n    const template = Handlebars.templates[this.template];\r\n    this.$el.html(template({\r\n      _config: this.model.get('_accessibility'),\r\n      _accessibility: Adapt.config.get('_accessibility')\r\n    })).insertBefore('#app');\r\n\r\n    _.defer(() => Adapt.trigger('navigationView:postRender', this));\r\n\r\n    return this;\r\n  }\r\n\r\n  setupHelpers() {\r\n    Handlebars.registerHelper('a11y_aria_label', text => {\r\n      return `<div class=\"aria-label\">${text}</div>`;\r\n    });\r\n  }\r\n\r\n}\r\n","import Adapt from 'core/js/adapt';\r\nimport NavigationView from './languagePickerNavigationView';\r\n\r\nexport default class LanguagePickerView extends Backbone.View {\r\n\r\n  get template() {\r\n    return 'languagePickerView';\r\n  }\r\n\r\n  events() {\r\n    return {\r\n      'click .js-languagepicker-btn-click': 'onLanguageClick'\r\n    };\r\n  }\r\n\r\n  className() {\r\n    return 'languagepicker';\r\n  }\r\n\r\n  initialize() {\r\n    this.initializeNavigation();\r\n    $('html').addClass('in-languagepicker');\r\n    this.listenTo(Adapt, 'remove', this.remove);\r\n    this.render();\r\n  }\r\n\r\n  render() {\r\n    const data = this.model.toJSON();\r\n    const template = Handlebars.templates[this.template];\r\n    this.$el.html(template(data));\r\n    this.$el.addClass(data._classes);\r\n\r\n    document.title = this.model.get('title') || '';\r\n\r\n    _.defer(this.postRender.bind(this));\r\n  }\r\n\r\n  postRender() {\r\n    $('.js-loading').hide();\r\n  }\r\n\r\n  onLanguageClick(event) {\r\n    this.destroyNavigation();\r\n    const lang = event.currentTarget.value;\r\n    this.model.setLanguage(lang);\r\n  }\r\n\r\n  initializeNavigation() {\r\n    this.navigationView = new NavigationView({ model: this.model });\r\n  }\r\n\r\n  destroyNavigation() {\r\n    this.navigationView.remove();\r\n  }\r\n\r\n  remove() {\r\n    $('html').removeClass('in-languagepicker');\r\n\r\n    super.remove();\r\n  }\r\n\r\n}\r\n","import Adapt from 'core/js/adapt';\r\nimport a11y from 'core/js/a11y';\r\nimport notify from 'core/js/notify';\r\n\r\nexport default class LanguagePickerDrawerView extends Backbone.View {\r\n\r\n  get template() {\r\n    return 'languagePickerDrawerView';\r\n  }\r\n\r\n  events() {\r\n    return {\r\n      'click .js-languagepicker-item-btn': 'onButtonClick'\r\n    };\r\n  }\r\n\r\n  initialize() {\r\n    this.listenTo(Adapt, 'remove', this.remove);\r\n    this.render();\r\n  }\r\n\r\n  render() {\r\n    const data = this.model.toJSON();\r\n    const template = Handlebars.templates[this.template];\r\n    this.$el.html(template(data));\r\n  }\r\n\r\n  onButtonClick(event) {\r\n    const newLanguage = this.$(event.currentTarget).attr('data-language');\r\n    this.model.set('newLanguage', newLanguage);\r\n    this.promptObject = this.getPromptObject(newLanguage);\r\n    this.listenToOnce(Adapt, 'drawer:closed', this.onDrawerClosed);\r\n    Adapt.trigger('drawer:closeDrawer');\r\n  }\r\n\r\n  onDrawerClosed() {\r\n    // wait for drawer to fully close\r\n    _.delay(() => {\r\n      this.listenToOnce(Adapt, {\r\n        'popup:opened': this.onPopupOpened,\r\n        'languagepicker:changelanguage:yes': this.onDoChangeLanguage,\r\n        'languagepicker:changelanguage:no': this.onDontChangeLanguage\r\n      });\r\n      // show yes/no popup\r\n      notify.prompt(this.promptObject);\r\n    }, 250);\r\n  }\r\n\r\n  onPopupOpened() {\r\n    // move popup close focus to #focuser\r\n    // keep active element incase the user cancels - usually navigation bar icon\r\n    this.$finishFocus = a11y.setPopupCloseTo($('#a11y-focuser'));\r\n  }\r\n\r\n  onDoChangeLanguage() {\r\n    const newLanguage = this.model.get('newLanguage');\r\n    this.model.setTrackedData();\r\n    this.model.setLanguage(newLanguage);\r\n    this.remove();\r\n  }\r\n\r\n  /**\r\n   * If the learner selects 'no' in the 'confirm language change' prompt,\r\n   * wait for notify to close completely then send focus to the\r\n   * navigation bar icon\r\n   */\r\n  onDontChangeLanguage() {\r\n    this.remove();\r\n    _.delay(() => a11y.focusFirst(this.$finishFocus), 500);\r\n  }\r\n\r\n  getPromptObject(newLanguage) {\r\n    const data = this.model.getLanguageDetails(newLanguage);\r\n    return {\r\n      _attributes: { lang: newLanguage },\r\n      _classes: `is-lang-${newLanguage} ${data._direction === 'rtl' ? 'is-rtl' : 'is-ltr'}`,\r\n      title: data.warningTitle,\r\n      body: data.warningMessage,\r\n      _prompts: [\r\n        {\r\n          promptText: data._buttons.yes,\r\n          _callbackEvent: 'languagepicker:changelanguage:yes'\r\n        },\r\n        {\r\n          promptText: data._buttons.no,\r\n          _callbackEvent: 'languagepicker:changelanguage:no'\r\n        }\r\n      ],\r\n      _showIcon: true\r\n    };\r\n  }\r\n\r\n}\r\n","import Adapt from 'core/js/adapt';\r\nimport drawer from 'core/js/drawer';\r\nimport LanguagePickerDrawerView from './languagePickerDrawerView';\r\n\r\nexport default class LanguagePickerNavView extends Backbone.View {\r\n\r\n  tagName() {\r\n    return 'button';\r\n  }\r\n\r\n  className() {\r\n    const classNames = 'btn-icon nav__btn nav__languagepicker-btn js-languagepicker-nav-btn icon';\r\n    const customClass = this.model.get('_languagePickerIconClass') || 'icon-language-2';\r\n\r\n    return `${classNames} ${customClass}`;\r\n  }\r\n\r\n  events() {\r\n    return {\r\n      click: 'onClick'\r\n    };\r\n  }\r\n\r\n  initialize() {\r\n    this.listenTo(Adapt, 'remove', this.remove);\r\n  }\r\n\r\n  onClick(event) {\r\n    drawer.triggerCustomView(new LanguagePickerDrawerView({ model: this.model }).$el, false);\r\n  }\r\n\r\n}\r\n","import Adapt from 'core/js/adapt';\r\nimport offlineStorage from 'core/js/offlineStorage';\r\nimport data from 'core/js/data';\r\nimport logging from 'core/js/logging';\r\nimport router from 'core/js/router';\r\n\r\nexport default class LanguagePickerModel extends Backbone.Model {\r\n  preinitialize() {\r\n    /**\r\n     * @deprecated\r\n     */\r\n    this.trackedData = {\r\n      components: [],\r\n      blocks: []\r\n    };\r\n    /**\r\n     * @deprecated\r\n     */\r\n    this.locationId = null;\r\n  }\r\n\r\n  defaults() {\r\n    return {\r\n      _isEnabled: false,\r\n      displayTitle: '',\r\n      body: '',\r\n      _languages: []\r\n    };\r\n  }\r\n\r\n  initialize() {\r\n    this.listenTo(Adapt.config, 'change:_activeLanguage', this.markLanguageAsSelected);\r\n    this.listenTo(Adapt, 'app:dataLoaded', this.onDataLoaded);\r\n  }\r\n\r\n  getLanguageDetails(language) {\r\n    return this.get('_languages').find(({ _language }) => _language === language);\r\n  }\r\n\r\n  setLanguage(language, { canReset = true } = {}) {\r\n    Adapt.config.set({\r\n      _activeLanguage: language,\r\n      _defaultDirection: this.getLanguageDetails(language)._direction\r\n    });\r\n    if (canReset) this.checkResetOnLanguageChange();\r\n  }\r\n\r\n  checkResetOnLanguageChange() {\r\n    const shouldReset = !this.get('_restoreStateOnLanguageChange');\r\n    const hasOfflineStorageClear = Boolean(offlineStorage.clear);\r\n    if (!shouldReset || !hasOfflineStorageClear) return;\r\n    // New reset functionality\r\n    offlineStorage.clear();\r\n  }\r\n\r\n  markLanguageAsSelected(model, language) {\r\n    this.get('_languages').forEach(item => {\r\n      item._isSelected = (item._language === language);\r\n    });\r\n  }\r\n\r\n  /**\r\n   * @deprecated\r\n   */\r\n  onDataLoaded() {\r\n    const shouldReset = !this.get('_restoreStateOnLanguageChange');\r\n    const hasOfflineStorageClear = Boolean(Adapt.offlineStorage.clear);\r\n    if (hasOfflineStorageClear || shouldReset) return;\r\n    // Deprecated legacy restoration mechanism\r\n    // Not compatible with branching / trickle\r\n    _.defer(() => {\r\n      this.locationId = offlineStorage.get('location') || null;\r\n      this.restoreState();\r\n    });\r\n  }\r\n\r\n  /**\r\n   * @deprecated\r\n   */\r\n  restoreLocation() {\r\n    if (!data.findById(this.locationId)) return;\r\n    _.defer(() => router.navigateToElement('.' + this.locationId));\r\n  }\r\n\r\n  /**\r\n   * Restore course progress on language change.\r\n   * @deprecated\r\n   */\r\n  restoreState() {\r\n\r\n    if (this.isTrackedDataEmpty()) return;\r\n\r\n    this.trackedData.components?.forEach(this.setTrackableState);\r\n    this.trackedData.blocks?.forEach(this.setTrackableState);\r\n  }\r\n\r\n  /**\r\n   * @deprecated\r\n   */\r\n  isTrackedDataEmpty() {\r\n    return _.isEqual(this.trackedData, {\r\n      components: [],\r\n      blocks: []\r\n    });\r\n  }\r\n\r\n  /**\r\n   * @deprecated\r\n   */\r\n  getTrackableState() {\r\n    return {\r\n      components: this.getState(Adapt.components.models).filter(Boolean),\r\n      blocks: this.getState(Adapt.blocks.models).filter(Boolean)\r\n    };\r\n  }\r\n\r\n  /**\r\n   * @deprecated\r\n   */\r\n  getState(models) {\r\n    return models.map(model => model.get('_isComplete') && model.getTrackableState());\r\n  }\r\n\r\n  /**\r\n   * @deprecated\r\n   */\r\n  setTrackedData() {\r\n    if (!this.get('_restoreStateOnLanguageChange')) {\r\n      return;\r\n    }\r\n    this.listenToOnce(Adapt, 'contentObjectView:ready', this.restoreLocation);\r\n    this.trackedData = this.getTrackableState();\r\n  }\r\n\r\n  /**\r\n   * @deprecated\r\n   */\r\n  setTrackableState(stateObject) {\r\n    const restoreModel = data.findById(stateObject._id);\r\n    if (!restoreModel) {\r\n      logging.warn('LanguagePicker unable to restore state for: ' + stateObject._id);\r\n      return;\r\n    }\r\n\r\n    restoreModel.setTrackableState(stateObject);\r\n  }\r\n}\r\n","import Adapt from 'core/js/adapt';\r\nimport offlineStorage from 'core/js/offlineStorage';\r\nimport LanguagePickerView from './languagePickerView';\r\nimport LanguagePickerNavView from './languagePickerNavView';\r\nimport LanguagePickerModel from './languagePickerModel';\r\n\r\nclass LanguagePicker extends Backbone.Controller {\r\n\r\n  initialize() {\r\n    this.listenTo(Adapt, 'configModel:dataLoaded', this.onConfigLoaded);\r\n  }\r\n\r\n  /**\r\n   * Once the Adapt config has loaded, check to see if the language picker is enabled. If it is:\r\n   * - stop the rest of the .json from loading\r\n   * - set up the language picker model\r\n   * - register for events to allow us to display the language picker icon in the navbar on pages and menus\r\n   * - wait for offline storage to be ready so that we can check to see if there's a stored language choice or not\r\n   */\r\n  onConfigLoaded() {\r\n    const config = Adapt.config.get('_languagePicker');\r\n    if (!config?._isEnabled) return;\r\n\r\n    this.languagePickerModel = new LanguagePickerModel(config);\r\n\r\n    this.listenTo(Adapt, 'router:menu router:page', this.setupNavigationView);\r\n\r\n    const params = new URLSearchParams(window.location.search);\r\n    const paramLang = params.get('lang');\r\n\r\n    if (paramLang && Adapt.build.get('availableLanguageNames').includes(paramLang)) return;\r\n\r\n    Adapt.config.set('_canLoadData', false);\r\n\r\n    if (offlineStorage.ready) { // on the offchance that it may already be ready...\r\n      this.onOfflineStorageReady();\r\n      return;\r\n    }\r\n\r\n    this.listenToOnce(Adapt, 'offlineStorage:ready', this.onOfflineStorageReady);\r\n  }\r\n\r\n  /**\r\n   * Once offline storage is ready, check to see if a language was previously selected by the user\r\n   * If it was, load it. If it wasn't, show the language picker\r\n   */\r\n  async onOfflineStorageReady() {\r\n    await Adapt.wait.queue();\r\n    const storedLanguage = offlineStorage.get('lang');\r\n\r\n    if (storedLanguage) {\r\n      this.languagePickerModel.setLanguage(storedLanguage, { canReset: false });\r\n      return;\r\n    }\r\n\r\n    if (this.languagePickerModel.get('_showOnCourseLoad') === false) {\r\n      this.languagePickerModel.setLanguage(Adapt.config.get('_defaultLanguage'), { canReset: false });\r\n      return;\r\n    }\r\n\r\n    this.showLanguagePickerView();\r\n  }\r\n\r\n  showLanguagePickerView() {\r\n    const languagePickerView = new LanguagePickerView({\r\n      model: this.languagePickerModel\r\n    });\r\n\r\n    languagePickerView.$el.appendTo('#wrapper');\r\n  }\r\n\r\n  setupNavigationView() {\r\n    /*\r\n      * On the framework this isn't an issue, but courses built in the authoring tool before the ARIA label\r\n      * was added will break unless the extension is removed then added again.\r\n      */\r\n    const courseGlobals = Adapt.course.get('_globals')._extensions;\r\n    let navigationBarLabel = '';\r\n    if (courseGlobals._languagePicker) {\r\n      navigationBarLabel = courseGlobals._languagePicker.navigationBarLabel;\r\n    }\r\n\r\n    const languagePickerNavView = new LanguagePickerNavView({\r\n      model: this.languagePickerModel,\r\n      attributes: {\r\n        'aria-label': navigationBarLabel\r\n      }\r\n    });\r\n\r\n    languagePickerNavView.$el.appendTo('.nav__inner');\r\n  }\r\n}\r\n\r\nexport default new LanguagePicker();\r\n","import Adapt from 'core/js/adapt';\r\n\r\nclass Completion extends Backbone.Controller {\r\n\r\n  initialize() {\r\n    this.subProgressCompleted = 0;\r\n    this.subProgressTotal = 0;\r\n    this.nonAssessmentCompleted = 0;\r\n    this.nonAssessmentTotal = 0;\r\n    this.assessmentCompleted = 0;\r\n    this.assessmentTotal = 0;\r\n  }\r\n\r\n  // Calculate completion of a contentObject\r\n  calculateCompletion(contentObjectModel) {\r\n\r\n    const completion = Adapt.completion;\r\n\r\n    const viewType = contentObjectModel.get('_type');\r\n    const isComplete = contentObjectModel.get('_isComplete') ? 1 : 0;\r\n    let children;\r\n\r\n    switch (viewType) {\r\n      case 'page': {\r\n        // If it's a page\r\n        children = contentObjectModel.getAllDescendantModels().filter(model => {\r\n          return model.get('_isAvailable') && !model.get('_isOptional');\r\n        });\r\n\r\n        const availableChildren = this.filterAvailableChildren(children);\r\n        const components = this.getPageLevelProgressEnabledModels(availableChildren);\r\n        const nonAssessmentComponents = this.getNonAssessmentComponents(components);\r\n\r\n        completion.nonAssessmentTotal = nonAssessmentComponents.length;\r\n        completion.nonAssessmentCompleted = this.getComponentsCompleted(nonAssessmentComponents).length;\r\n\r\n        const assessmentComponents = this.getAssessmentComponents(components);\r\n\r\n        completion.assessmentTotal = assessmentComponents.length;\r\n        completion.assessmentCompleted = this.getComponentsInteractionCompleted(assessmentComponents).length;\r\n\r\n        if (contentObjectModel.get('_pageLevelProgress')._excludeAssessments !== true) {\r\n          completion.subProgressCompleted = contentObjectModel.get('_subProgressComplete') || 0;\r\n          completion.subProgressTotal = contentObjectModel.get('_subProgressTotal') || 0;\r\n        }\r\n\r\n        const showPageCompletionCourse = Adapt.course.get('_pageLevelProgress')?._showPageCompletion !== false;\r\n        const showPageCompletionPage = contentObjectModel.get('_pageLevelProgress')?._showPageCompletion !== false;\r\n\r\n        if (showPageCompletionCourse && showPageCompletionPage) {\r\n          // optionally add one point extra for page completion to eliminate incomplete pages and full progress bars\r\n          // if _showPageCompletion is true then the progress bar should also consider it so add 1 to nonAssessmentTotal\r\n          completion.nonAssessmentCompleted += isComplete;\r\n          completion.nonAssessmentTotal += 1;\r\n        }\r\n\r\n        break;\r\n      }\r\n      case 'menu': case 'course': {\r\n        // If it's a sub-menu\r\n        children = contentObjectModel.getChildren().models;\r\n        children.forEach(contentObject => {\r\n          const completionObject = Adapt.completion.calculateCompletion(contentObject);\r\n          completion.subProgressCompleted += completionObject.subProgressCompleted || 0;\r\n          completion.subProgressTotal += completionObject.subProgressTotal || 0;\r\n          completion.nonAssessmentTotal += completionObject.nonAssessmentTotal;\r\n          completion.nonAssessmentCompleted += completionObject.nonAssessmentCompleted;\r\n          completion.assessmentTotal += completionObject.assessmentTotal;\r\n          completion.assessmentCompleted += completionObject.assessmentCompleted;\r\n        });\r\n        break;\r\n      }\r\n\r\n    }\r\n\r\n    return completion;\r\n  }\r\n\r\n  getNonAssessmentComponents(models) {\r\n    return models.filter(model => {\r\n      return !model.get('_isPartOfAssessment');\r\n    });\r\n  }\r\n\r\n  getAssessmentComponents(models) {\r\n    return models.filter(model => {\r\n      return model.get('_isPartOfAssessment');\r\n    });\r\n  }\r\n\r\n  getComponentsCompleted(models) {\r\n    return models.filter(item => {\r\n      return item.get('_isComplete');\r\n    });\r\n  }\r\n\r\n  getComponentsInteractionCompleted(models) {\r\n    return models.filter(item => {\r\n      return item.get('_isComplete');\r\n    });\r\n  }\r\n\r\n  // Get only those models who were enabled for pageLevelProgress\r\n  getPageLevelProgressEnabledModels(models) {\r\n    return models.filter(model => {\r\n      const config = model.get('_pageLevelProgress');\r\n      return config?._isEnabled;\r\n    });\r\n  }\r\n\r\n  unavailableInHierarchy(parents) {\r\n    if (!parents) return;\r\n    return parents.some(parent => {\r\n      return !parent.get('_isAvailable');\r\n    });\r\n  }\r\n\r\n  filterAvailableChildren(children) {\r\n    const availableChildren = [];\r\n\r\n    for (let i = 0, count = children.length; i < count; i++) {\r\n      const parents = children[i].getAncestorModels();\r\n      if (this.unavailableInHierarchy(parents)) continue;\r\n      availableChildren.push(children[i]);\r\n    }\r\n\r\n    return availableChildren;\r\n  }\r\n\r\n  calculatePercentageComplete(model) {\r\n    const completionObject = this.calculateCompletion(model);\r\n    // take all assessment, nonassessment and subprogress into percentage\r\n    // this allows the user to see if assessments have been passed, if assessment components can be retaken, and all other component's completion\r\n    const completed = completionObject.nonAssessmentCompleted + completionObject.assessmentCompleted + completionObject.subProgressCompleted;\r\n    const total = completionObject.nonAssessmentTotal + completionObject.assessmentTotal + completionObject.subProgressTotal;\r\n    const percentageComplete = Math.floor((completed / total) * 100);\r\n    return percentageComplete;\r\n  }\r\n\r\n}\r\n\r\nexport default (Adapt.completion = new Completion());\r\n","import Adapt from 'core/js/adapt';\r\n\r\nclass PageLevelProgressIndicatorView extends Backbone.View {\r\n\r\n  tagName() {\r\n    return 'span';\r\n  }\r\n\r\n  initialize(options) {\r\n    options = options || {};\r\n    this.parent = options.parent;\r\n    this.calculatePercentage = options.calculatePercentage || this.calculatePercentage;\r\n    this.ariaLabel = options.ariaLabel || '';\r\n    this.type = options.type || this.model.get('_type');\r\n    this.addClasses();\r\n    this.setUpEventListeners();\r\n    this.setPercentageComplete();\r\n    this.render();\r\n    this.refresh();\r\n  }\r\n\r\n  addClasses() {\r\n    this.$el.addClass([\r\n      'pagelevelprogress__indicator',\r\n      'is-' + this.type\r\n    ].join(' '));\r\n  }\r\n\r\n  checkAria() {\r\n    if (!this.ariaLabel) {\r\n      this.$el.attr('aria-hidden', true);\r\n      return;\r\n    }\r\n    const data = this.getRenderData();\r\n    this.$('.js-indicator-aria-label').html(Handlebars.compile(this.ariaLabel)(data));\r\n  }\r\n\r\n  setUpEventListeners() {\r\n    if (this.parent) {\r\n      this.listenToOnce(this.parent, 'postRemove', this.remove);\r\n    } else {\r\n      this.listenTo(Adapt, 'remove', this.remove);\r\n    }\r\n    this.listenTo(this.model, 'change:_isComplete', this.refresh);\r\n    if (!this.collection) return;\r\n    this.listenTo(this.collection, 'change:_isComplete', this.refresh);\r\n  }\r\n\r\n  setPercentageComplete() {\r\n    const percentage = this.calculatePercentage();\r\n    this.model.set('percentageComplete', percentage);\r\n    return percentage;\r\n  }\r\n\r\n  calculatePercentage() {\r\n    return this.model.get('_isComplete') ? 100 : 0;\r\n  }\r\n\r\n  render() {\r\n    const data = this.getRenderData();\r\n    const template = Handlebars.templates[this.constructor.template];\r\n    this.$el.html(template(data));\r\n  }\r\n\r\n  getRenderData() {\r\n    const data = this.model.toJSON();\r\n    data.ariaLabel = this.ariaLabel;\r\n    data.type = this.type;\r\n    return data;\r\n  }\r\n\r\n  refresh() {\r\n    this.checkCompletion();\r\n    this.checkAria();\r\n    this.$('.js-indicator-bar').css({\r\n      width: this.calculatePercentage() + '%'\r\n    });\r\n  }\r\n\r\n  checkCompletion() {\r\n    const percentage = this.setPercentageComplete();\r\n    this.$el\r\n      .toggleClass('is-complete', percentage === 100)\r\n      .toggleClass('is-incomplete', percentage !== 100);\r\n  }\r\n\r\n}\r\n\r\nPageLevelProgressIndicatorView.template = 'pageLevelProgressIndicator';\r\n\r\nexport default PageLevelProgressIndicatorView;\r\n","import Adapt from 'core/js/adapt';\r\nimport PageLevelProgressIndicatorView from './PageLevelProgressIndicatorView';\r\n\r\nclass PageLevelProgressItemView extends Backbone.View {\r\n\r\n  className() {\r\n    return [\r\n      'pagelevelprogress__item drawer__item',\r\n      this.model.get('_type') + '__indicator'\r\n    ].join(' ');\r\n  }\r\n\r\n  attributes() {\r\n    return {\r\n      role: 'listitem'\r\n    };\r\n  }\r\n\r\n  initialize() {\r\n    this.listenTo(Adapt, 'remove', this.remove);\r\n    this.render();\r\n    this.addIndicator();\r\n  }\r\n\r\n  render() {\r\n    const data = this.model.toJSON();\r\n    const template = Handlebars.templates[this.constructor.template];\r\n    this.$el.html(template(data));\r\n  }\r\n\r\n  addIndicator() {\r\n    if (this.model.get('_isOptional')) return;\r\n    const item = new PageLevelProgressIndicatorView({\r\n      model: this.model\r\n    });\r\n    this.$('.js-indicator').append(item.$el);\r\n  }\r\n\r\n}\r\n\r\nPageLevelProgressItemView.template = 'pageLevelProgressItem';\r\n\r\nexport default PageLevelProgressItemView;\r\n","import Adapt from 'core/js/adapt';\r\nimport data from 'core/js/data';\r\nimport router from 'core/js/router';\r\nimport PageLevelProgressItemView from './PageLevelProgressItemView';\r\n\r\nexport default class PageLevelProgressView extends Backbone.View {\r\n\r\n  className() {\r\n    return 'pagelevelprogress';\r\n  }\r\n\r\n  events() {\r\n    return {\r\n      'click .js-pagelevelprogress-item-click': 'scrollToPageElement'\r\n    };\r\n  }\r\n\r\n  initialize() {\r\n    this.listenTo(Adapt, 'remove', this.remove);\r\n    this.render();\r\n    this.addChildren();\r\n  }\r\n\r\n  async scrollToPageElement(event) {\r\n    if (event && event.preventDefault) event.preventDefault();\r\n\r\n    const $target = $(event.currentTarget);\r\n    if ($target.is('.is-disabled')) return;\r\n\r\n    const id = $target.attr('data-pagelevelprogress-id');\r\n    const model = data.findById(id);\r\n\r\n    if (!model.get('_isRendered')) {\r\n      try {\r\n        await Adapt.parentView.renderTo(id);\r\n      } catch (err) {\r\n        return;\r\n      }\r\n    }\r\n\r\n    const currentComponentSelector = `.${id}`;\r\n\r\n    Adapt.once('drawer:closed', () => {\r\n      router.navigateToElement(currentComponentSelector, { duration: 400 });\r\n    }).trigger('drawer:closeDrawer', $(currentComponentSelector));\r\n  }\r\n\r\n  render() {\r\n    const template = Handlebars.templates.pageLevelProgress;\r\n    this.$el.html(template({}));\r\n  }\r\n\r\n  addChildren() {\r\n    const $children = this.$('.js-children');\r\n    this.collection.each(model => {\r\n      $children.append(new PageLevelProgressItemView({\r\n        model\r\n      }).$el);\r\n    });\r\n  }\r\n\r\n}\r\n","import Adapt from 'core/js/adapt';\r\nimport drawer from 'core/js/drawer';\r\nimport completionCalculations from './completionCalculations';\r\nimport PageLevelProgressView from './PageLevelProgressView';\r\nimport PageLevelProgressIndicatorView from './PageLevelProgressIndicatorView';\r\n\r\nexport default class PageLevelProgressNavigationView extends Backbone.View {\r\n\r\n  tagName() {\r\n    return 'button';\r\n  }\r\n\r\n  className() {\r\n    return 'btn-icon nav__btn nav__pagelevelprogress-btn pagelevelprogress__nav-btn';\r\n  }\r\n\r\n  attributes() {\r\n    return {\r\n      'data-order': (Adapt.course.get('_globals')?._extensions?._pageLevelProgress?._navOrder || 0)\r\n    };\r\n  }\r\n\r\n  events() {\r\n    return {\r\n      click: 'onProgressClicked'\r\n    };\r\n  }\r\n\r\n  initialize() {\r\n    _.bindAll(this, 'updateProgressBar');\r\n    this.setUpEventListeners();\r\n    this.render();\r\n    this.addIndicator();\r\n    this.deferredUpdate();\r\n  }\r\n\r\n  setUpEventListeners() {\r\n    this.listenTo(Adapt, {\r\n      remove: this.remove,\r\n      'router:location': this.updateProgressBar,\r\n      'view:childAdded pageLevelProgress:update': this.refreshProgressBar\r\n    });\r\n  }\r\n\r\n  render() {\r\n    const template = Handlebars.templates.pageLevelProgressNavigation;\r\n    this.$el.html(template({}));\r\n  }\r\n\r\n  addIndicator() {\r\n    this.indicatorView = new PageLevelProgressIndicatorView({\r\n      model: this.model,\r\n      collection: this.collection,\r\n      calculatePercentage: this._getPageCompletionPercentage,\r\n      ariaLabel: Adapt.course.get('_globals')._extensions._pageLevelProgress.pageLevelProgressIndicatorBar\r\n    });\r\n    this.$el.prepend(this.indicatorView.$el);\r\n  }\r\n\r\n  _getPageCompletionPercentage() {\r\n    return completionCalculations.calculatePercentageComplete(this.model);\r\n  }\r\n\r\n  deferredUpdate() {\r\n    _.defer(this.updateProgressBar);\r\n  }\r\n\r\n  updateProgressBar() {\r\n    this.indicatorView.refresh();\r\n  }\r\n\r\n  refreshProgressBar() {\r\n    this.collection.repopulate();\r\n    this.updateProgressBar();\r\n  }\r\n\r\n  onProgressClicked(event) {\r\n    if (event && event.preventDefault) event.preventDefault();\r\n    drawer.triggerCustomView(new PageLevelProgressView({\r\n      collection: this.collection\r\n    }).$el, false);\r\n  }\r\n\r\n  remove() {\r\n    super.remove();\r\n    this.collection.reset();\r\n  }\r\n\r\n}\r\n","import Adapt from 'core/js/adapt';\r\nimport completionCalculations from './completionCalculations';\r\n\r\nexport default class PageLevelProgressCollection extends Backbone.Collection {\r\n\r\n  initialize(models, options) {\r\n    this.listenTo(Adapt, 'remove', this.reset);\r\n    if (!options?.pageModel) return;\r\n    this._pageModel = options.pageModel;\r\n    this.repopulate();\r\n  }\r\n\r\n  repopulate() {\r\n    this.reset();\r\n    if (!this._pageModel) return;\r\n\r\n    const allDescendants = this._pageModel.getAllDescendantModels(true);\r\n    const currentPageItems = allDescendants.filter(item => {\r\n      return item.get('_isAvailable') === true;\r\n    });\r\n    const availableItems = completionCalculations.filterAvailableChildren(currentPageItems);\r\n    const enabledProgressItems = completionCalculations.getPageLevelProgressEnabledModels(availableItems);\r\n\r\n    this.add(enabledProgressItems);\r\n  }\r\n\r\n}\r\n","import Adapt from 'core/js/adapt';\r\nimport data from 'core/js/data';\r\nimport location from 'core/js/location';\r\nimport completionCalculations from './completionCalculations';\r\nimport PageLevelProgressNavigationView from './PageLevelProgressNavigationView';\r\nimport PageLevelProgressIndicatorView from './PageLevelProgressIndicatorView';\r\nimport PageLevelProgressCollection from './PageLevelProgressCollection';\r\n\r\nclass PageLevelProgress extends Backbone.Controller {\r\n\r\n  initialize() {\r\n    this.listenTo(Adapt, {\r\n      'app:dataReady': this.onDataReady,\r\n      'app:languageChanged': this.onLanguageChange\r\n    });\r\n  }\r\n\r\n  getCourseConfig() {\r\n    return Adapt.course.get('_pageLevelProgress');\r\n  }\r\n\r\n  onDataReady() {\r\n    // Do not proceed if pageLevelProgress is not enabled in course.json\r\n    const coursePLPConfig = this.getCourseConfig();\r\n    if (!coursePLPConfig?._isEnabled) return;\r\n    this.setUpEventListeners();\r\n  }\r\n\r\n  onLanguageChange() {\r\n    this.stopListening();\r\n    this.initialize();\r\n  }\r\n\r\n  setUpEventListeners() {\r\n    const headerIndicatorTypes = [\r\n      'menu',\r\n      'menuItem',\r\n      'page',\r\n      'article',\r\n      'block',\r\n      'component'\r\n    ];\r\n\r\n    const headerIndicatorEventNames = headerIndicatorTypes\r\n      .concat([''])\r\n      .join('View:render ');\r\n\r\n    this.listenTo(Adapt, headerIndicatorEventNames, this.renderHeaderIndicatorView);\r\n\r\n    this.listenTo(Adapt, {\r\n      'menuItemView:postRender': this.renderMenuItemIndicatorView,\r\n      'router:page': this.renderNavigationView\r\n    });\r\n\r\n    this.listenTo(Adapt.course, 'bubble:change:_isComplete', this.onCompletionChange);\r\n  }\r\n\r\n  onCompletionChange(event) {\r\n    if (!location._currentId) return;\r\n\r\n    const currentModel = data.findById(location._currentId);\r\n    const completionState = {\r\n      currentLocation: completionCalculations.calculatePercentageComplete(currentModel),\r\n      course: completionCalculations.calculatePercentageComplete(Adapt.course)\r\n    };\r\n    const hasChanged = !_.isMatch(this._previousCompletionState, completionState);\r\n    if (!hasChanged) return;\r\n\r\n    this._previousCompletionState = completionState;\r\n    Adapt.trigger('pageLevelProgress:percentageCompleteChange', completionState);\r\n  }\r\n\r\n  renderHeaderIndicatorView(view) {\r\n    const model = view.model;\r\n    const config = model.get('_pageLevelProgress');\r\n    if (!config?._isEnabled || !config?._isCompletionIndicatorEnabled) return;\r\n\r\n    const pageModel = model.findAncestor('contentobject');\r\n    const pageConfig = pageModel && pageModel.get('_pageLevelProgress');\r\n    if (!pageConfig?._isEnabled) return;\r\n\r\n    const $headings = view.$('.js-heading');\r\n    $headings.each((index, el) => {\r\n      const $el = $(el);\r\n      const indicatorView = new PageLevelProgressIndicatorView({\r\n        parent: view,\r\n        model\r\n      });\r\n      indicatorView.$el.insertAfter($el);\r\n    });\r\n  }\r\n\r\n  // This should add/update progress on menuView\r\n  renderMenuItemIndicatorView(view) {\r\n    // Do not render on menu, only render on menu items\r\n    if (view.model.get('_id') === location._currentId) return;\r\n\r\n    // Progress bar should not render for course viewType\r\n    const viewType = view.model.get('_type');\r\n    if (viewType === 'course') return;\r\n\r\n    // Do not proceed if pageLevelProgress is not enabled for the content object\r\n    const pageLevelProgress = view.model.get('_pageLevelProgress');\r\n    if (!pageLevelProgress?._isEnabled) return;\r\n\r\n    view.$el.find('.js-menu-item-progress').append(new PageLevelProgressIndicatorView({\r\n      parent: view,\r\n      model: view.model,\r\n      type: 'menu-item',\r\n      calculatePercentage: this._getMenuItemCompletionPercentage.bind(view),\r\n      ariaLabel: Adapt.course.get('_globals')._extensions._pageLevelProgress.pageLevelProgressMenuBar\r\n    }).$el);\r\n  }\r\n\r\n  _getMenuItemCompletionPercentage() {\r\n    return completionCalculations.calculatePercentageComplete(this.model);\r\n  }\r\n\r\n  // This should add/update progress on page navigation bar\r\n  renderNavigationView(pageModel) {\r\n    // Do not render if turned off at course level\r\n    const coursePLPConfig = this.getCourseConfig();\r\n    if (coursePLPConfig?._isShownInNavigationBar === false) return;\r\n\r\n    // Do not proceed if pageLevelProgress is not enabled for the content object\r\n    const pagePLPConfig = pageModel.get('_pageLevelProgress');\r\n    if (!pagePLPConfig?._isEnabled) return;\r\n\r\n    const collection = new PageLevelProgressCollection(null, {\r\n      pageModel\r\n    });\r\n\r\n    if (collection.length === 0) return;\r\n\r\n    $('.nav__drawer-btn').after(new PageLevelProgressNavigationView({\r\n      model: pageModel,\r\n      collection\r\n    }).$el);\r\n  }\r\n\r\n}\r\n\r\nexport default (Adapt.pageLevelProgress = new PageLevelProgress());\r\n","import Adapt from 'core/js/adapt';\r\nimport a11y from 'core/js/a11y';\r\n\r\nexport default class ResourcesView extends Backbone.View {\r\n\r\n  className() {\r\n    return 'resources';\r\n  }\r\n\r\n  initialize() {\r\n    this.listenTo(Adapt, 'remove', this.remove);\r\n    this.render();\r\n  }\r\n\r\n  events() {\r\n    return {\r\n      'click .js-resources-filter-btn-click': 'onFilterClicked'\r\n    };\r\n  }\r\n\r\n  render() {\r\n    this.$el.html(Handlebars.templates.resources({\r\n      model: this.model.toJSON(),\r\n      resources: this.collection.toJSON()\r\n    }));\r\n\r\n    _.defer(() => {\r\n      this.listenTo(Adapt, 'drawer:triggerCustomView', this.remove);\r\n    });\r\n\r\n    return this;\r\n  }\r\n\r\n  onFilterClicked(e) {\r\n    if (e && e.preventDefault) e.preventDefault();\r\n\r\n    const $resources = this.$('#resources');\r\n    const $clickedButton = this.$(e.currentTarget);\r\n    const clickedTabId = $clickedButton.attr('id');\r\n\r\n    this.$('.js-resources-filter-btn-click').removeClass('is-selected').attr('aria-selected', false);\r\n    \r\n    $resources.attr('aria-labelledby', clickedTabId);\r\n    $clickedButton.attr('aria-selected', true);\r\n\r\n    let items;\r\n    const filter = $clickedButton.addClass('is-selected').attr('data-filter');\r\n    if (filter === 'all') {\r\n      items = this.$('.js-resources-item').removeClass('u-display-none');\r\n    } else {\r\n      this.$('.js-resources-item')\r\n        .removeClass('u-display-none').not('.is-' + filter)\r\n        .addClass('u-display-none');\r\n      items = this.$('.js-resources-item.is-' + filter);\r\n    }\r\n\r\n    if (items.length < 0) return;\r\n    a11y.focusFirst($(items[0]));\r\n  }\r\n}\r\n","import Handlebars from 'handlebars';\r\nimport device from 'core/js/device';\r\n\r\nconst helpers = {\r\n\r\n  resources_has_type(resources, type, block) {\r\n    const hasType = resources.some(_.matcher({ _type: type }));\r\n    return hasType ? block.fn(this) : block.inverse(this);\r\n  },\r\n\r\n  resources_has_multiple_types(resources, block) {\r\n    if (resources.length === 1) return block.inverse(this);\r\n\r\n    const allSameType = resources.every(_.matcher({ _type: resources[0]._type }));\r\n    return allSameType ? block.inverse(this) : block.fn(this);\r\n  },\r\n\r\n  resources_get_column_count(resources) {\r\n    return _.uniq(_.pluck(resources, '_type')).length + 1;// add 1 for the 'All' button column\r\n  },\r\n\r\n  /**\r\n   * IE doesn't support the 'download' attribute\r\n   * https://github.com/adaptlearning/adapt_framework/issues/1559\r\n   * and iOS just opens links with that attribute in the same window\r\n   * https://github.com/adaptlearning/adapt_framework/issues/1852\r\n   */\r\n  resources_force_download(resource, block) {\r\n    if (device.browser === 'internet explorer' || device.OS === 'ios') {\r\n      return block.inverse(this);\r\n    }\r\n\r\n    return (resource._forceDownload || resource.filename) ? block.fn(this) : block.inverse(this);\r\n  }\r\n\r\n};\r\n\r\nfor (const name in helpers) {\r\n  Handlebars.registerHelper(name, helpers[name]);\r\n}\r\n\r\nexport default helpers;\r\n","import Adapt from 'core/js/adapt';\r\nimport drawer from 'core/js/drawer';\r\nimport ResourcesView from './ResourcesView';\r\nimport './ResourcesHelpers';\r\n\r\nclass Resources extends Backbone.Controller {\r\n\r\n  initialize() {\r\n    this.listenTo(Adapt, 'adapt:start', this.initResources);\r\n  }\r\n\r\n  initResources() {\r\n    const courseResources = Adapt.course.get('_resources');\r\n\r\n    // do not proceed until resource set on course.json\r\n    if (!courseResources || courseResources._isEnabled === false) return;\r\n\r\n    const drawerObject = {\r\n      title: courseResources.title,\r\n      description: courseResources.description,\r\n      className: 'is-resources',\r\n      drawerOrder: courseResources._drawerOrder || 0\r\n    };\r\n\r\n    drawer.addItem(drawerObject, 'resources:showResources');\r\n\r\n    this.setupResources(courseResources);\r\n  }\r\n\r\n  setupResources(resourcesData) {\r\n    const model = new Backbone.Model(resourcesData);\r\n    const collection = new Backbone.Collection(model.get('_resourcesItems'));\r\n\r\n    this.listenTo(Adapt, 'resources:showResources', () => {\r\n      drawer.triggerCustomView(new ResourcesView({\r\n        model,\r\n        collection\r\n      }).$el);\r\n    });\r\n  }\r\n}\r\n\r\nexport default new Resources();\r\n","class Logger {\r\n\r\n  constructor() {\r\n    this.logArr = [];\r\n    this.registeredViews = [];\r\n  }\r\n\r\n  static getInstance() {\r\n    if (Logger.instance === null) {\r\n      Logger.instance = new Logger();\r\n    }\r\n    return Logger.instance;\r\n  }\r\n\r\n  getEntries() {\r\n    return this.logArr;\r\n  }\r\n\r\n  getLastEntry() {\r\n    return this.logArr[this.logArr.length - 1];\r\n  }\r\n\r\n  info(str) {\r\n    this.logArr[this.logArr.length] = { str: str, type: Logger.LOG_TYPE_INFO, time: Date.now() };\r\n    this.updateViews();\r\n  }\r\n\r\n  warn(str) {\r\n    this.logArr[this.logArr.length] = { str: str, type: Logger.LOG_TYPE_WARN, time: Date.now() };\r\n    this.updateViews();\r\n  }\r\n\r\n  error(str) {\r\n    this.logArr[this.logArr.length] = { str: str, type: Logger.LOG_TYPE_ERROR, time: Date.now() };\r\n    this.updateViews();\r\n  }\r\n\r\n  debug(str) {\r\n    this.logArr[this.logArr.length] = { str: str, type: Logger.LOG_TYPE_DEBUG, time: Date.now() };\r\n    this.updateViews();\r\n  }\r\n\r\n  registerView(_view) {\r\n    this.registeredViews[this.registeredViews.length] = _view;\r\n  }\r\n\r\n  unregisterView(_view) {\r\n    for (let i = 0, l = this.registeredViews.length; i < l; i++) {\r\n      if (this.registeredViews[i] !== _view) continue;\r\n      this.registeredViews.splice(i, 1);\r\n      i--;\r\n    }\r\n  }\r\n\r\n  updateViews() {\r\n    for (let i = 0, l = this.registeredViews.length; i < l; i++) {\r\n      if (!this.registeredViews[i]) continue;\r\n      this.registeredViews[i].update(this);\r\n    }\r\n  }\r\n\r\n}\r\n\r\nLogger.instance = null;\r\nLogger.LOG_TYPE_INFO = 0;\r\nLogger.LOG_TYPE_WARN = 1;\r\nLogger.LOG_TYPE_ERROR = 2;\r\nLogger.LOG_TYPE_DEBUG = 3;\r\n\r\n// Assign global reference for debug window\r\nexport default (window.Logger = Logger);\r\n","class ScormError {\r\n\r\n  constructor(name, data = {}) {\r\n    this.name = name;\r\n    this.data = data;\r\n  }\r\n\r\n}\r\n\r\nScormError.CLIENT_COULD_NOT_CONNECT = 'CLIENT_COULD_NOT_CONNECT';\r\nScormError.SERVER_STATUS_UNSUPPORTED = 'SERVER_STATUS_UNSUPPORTED'; // status\r\nScormError.CLIENT_STATUS_UNSUPPORTED = 'CLIENT_STATUS_UNSUPPORTED'; // status\r\nScormError.CLIENT_COULD_NOT_COMMIT = 'CLIENT_COULD_NOT_COMMIT'; // errorCode, errorInfo, diagnosticInfo\r\nScormError.CLIENT_NOT_CONNECTED = 'CLIENT_NOT_CONNECTED';\r\nScormError.CLIENT_COULD_NOT_FINISH = 'CLIENT_COULD_NOT_FINISH'; // errorCode, errorInfo, diagnosticInfo\r\nScormError.CLIENT_COULD_NOT_GET_PROPERTY = 'CLIENT_COULD_NOT_GET_PROPERTY'; // property, errorCode, errorInfo, diagnosticInfo\r\nScormError.CLIENT_COULD_NOT_SET_PROPERTY = 'CLIENT_COULD_NOT_SET_PROPERTY'; // property, value, errorCode, errorInfo, diagnosticInfo\r\nScormError.CLIENT_INVALID_CHOICE_VALUE = 'CLIENT_INVALID_CHOICE_VALUE';\r\n\r\nScormError.defaultMessages = {\r\n  title: 'An error has occurred',\r\n  pressOk: 'Press \\'OK\\' to view detailed debug information to send to technical support.',\r\n  CLIENT_COULD_NOT_CONNECT: 'The course could not connect to the Learning Management System',\r\n  SERVER_STATUS_UNSUPPORTED: 'An invalid lesson status of \\'{{{status}}}\\' was received from Learning Management System',\r\n  CLIENT_STATUS_UNSUPPORTED: 'The status \\'{{{status}}}\\' is not supported.',\r\n  CLIENT_COULD_NOT_COMMIT: 'There was a problem saving data to the Learning Management System\\n\\nError: {{errorCode}} - {{{errorInfo}}}\\nLMS Error Info: {{{diagnosticInfo}}}',\r\n  CLIENT_NOT_CONNECTED: 'The course is not connected to the Learning Management System',\r\n  CLIENT_COULD_NOT_FINISH: 'The course was unable to terminate the learning session\\n\\nError: {{errorCode}} - {{{errorInfo}}}\\nLMS Error Info: {{{diagnosticInfo}}}',\r\n  CLIENT_COULD_NOT_GET_PROPERTY: 'Unable to get the value of {{property}} from the Learning Management System\\n\\nError: {{errorCode}} - {{{errorInfo}}}\\nLMS Error Info: {{{diagnosticInfo}}}',\r\n  CLIENT_COULD_NOT_SET_PROPERTY: 'Unable to set {{property}} to: \\'{{{value}}}\\'\\n\\nError: {{errorCode}} - {{{errorInfo}}}\\nLMS Error Info: {{{diagnosticInfo}}}',\r\n  CLIENT_INVALID_CHOICE_VALUE: 'Numeric choice/matching response elements must use a value from 0 to 35 in SCORM 1.2'\r\n};\r\n\r\nexport default ScormError;\r\n","import Adapt from 'core/js/adapt';\r\nimport notify from 'core/js/notify';\r\nimport pipwerks from 'libraries/SCORM_API_wrapper';\r\nimport Logger from './logger';\r\nimport ScormError from './error';\r\n\r\nconst {\r\n  CLIENT_COULD_NOT_CONNECT,\r\n  SERVER_STATUS_UNSUPPORTED,\r\n  CLIENT_STATUS_UNSUPPORTED,\r\n  CLIENT_COULD_NOT_COMMIT,\r\n  CLIENT_NOT_CONNECTED,\r\n  CLIENT_COULD_NOT_FINISH,\r\n  CLIENT_COULD_NOT_GET_PROPERTY,\r\n  CLIENT_COULD_NOT_SET_PROPERTY,\r\n  CLIENT_INVALID_CHOICE_VALUE\r\n} = ScormError;\r\n\r\n/**\r\n * IMPORTANT: This wrapper uses the Pipwerks SCORM wrapper and should therefore support both SCORM 1.2 and 2004. Ensure any changes support both versions.\r\n */\r\nclass ScormWrapper {\r\n\r\n  constructor() {\r\n    /* configuration */\r\n    this.setCompletedWhenFailed = true;// this only applies to SCORM 2004\r\n    /**\r\n     * whether to commit each time there's a change to lesson_status or not\r\n     */\r\n    this.commitOnStatusChange = true;\r\n    /**\r\n     * whether to commit each time there's a change to any value\r\n     */\r\n    this.commitOnAnyChange = false;\r\n    /**\r\n     * how frequently (in minutes) to commit automatically. set to 0 to disable.\r\n     */\r\n    this.timedCommitFrequency = 10;\r\n    /**\r\n     * how many times to retry if a commit fails\r\n     */\r\n    this.maxCommitRetries = 5;\r\n    /**\r\n     * time (in milliseconds) to wait between retries\r\n     */\r\n    this.commitRetryDelay = 1000;\r\n\r\n    /**\r\n     * prevents commit from being called if there's already a 'commit retry' pending.\r\n     */\r\n    this.commitRetryPending = false;\r\n    /**\r\n     * how many times we've done a 'commit retry'\r\n     */\r\n    this.commitRetries = 0;\r\n    /**\r\n     * not currently used - but you could include in an error message to show when data was last saved\r\n     */\r\n    this.lastCommitSuccessTime = null;\r\n    /**\r\n     * The exit state to use when course isn't completed yet\r\n     */\r\n    this.exitStateIfIncomplete = 'auto';\r\n    /**\r\n     * The exit state to use when the course has been completed/passed\r\n     */\r\n    this.exitStateIfComplete = 'auto';\r\n\r\n    this.timedCommitIntervalID = null;\r\n    this.retryCommitTimeoutID = null;\r\n    this.logOutputWin = null;\r\n    this.startTime = null;\r\n    this.endTime = null;\r\n\r\n    this.lmsConnected = false;\r\n    this.finishCalled = false;\r\n\r\n    this.logger = Logger.getInstance();\r\n    this.scorm = pipwerks.SCORM;\r\n    /**\r\n     * Prevent the Pipwerks SCORM API wrapper's handling of the exit status\r\n     */\r\n    this.scorm.handleExitMode = false;\r\n\r\n    this.suppressErrors = false;\r\n    this.debouncedCommit = _.debounce(this.commit.bind(this), 100);\r\n    if (window.__debug) {\r\n      this.showDebugWindow();\r\n    }\r\n\r\n    if (!(window.API?.__offlineAPIWrapper && window?.API_1484_11?.__offlineAPIWrapper)) return;\r\n    this.logger.error('Offline SCORM API is being used. No data will be reported to the LMS!');\r\n  }\r\n\r\n  // ******************************* public methods *******************************\r\n\r\n  static getInstance() {\r\n    if (ScormWrapper.instance === null) {\r\n      ScormWrapper.instance = new ScormWrapper();\r\n    }\r\n\r\n    return ScormWrapper.instance;\r\n  }\r\n\r\n  getVersion() {\r\n    return this.scorm.version;\r\n  }\r\n\r\n  setVersion(value) {\r\n    this.logger.debug(`ScormWrapper::setVersion: ${value}`);\r\n    this.scorm.version = value;\r\n  }\r\n\r\n  initialize() {\r\n    this.logger.debug('ScormWrapper::initialize');\r\n    this.lmsConnected = this.scorm.init();\r\n\r\n    if (!this.lmsConnected) {\r\n      this.handleError(new ScormError(CLIENT_COULD_NOT_CONNECT));\r\n      return this.lmsConnected;\r\n    }\r\n\r\n    this.startTime = new Date();\r\n    this.initTimedCommit();\r\n\r\n    return this.lmsConnected;\r\n  }\r\n\r\n  /**\r\n   * allows you to check if this is the user's first ever 'session' of a SCO, even after the lesson_status has been set to 'incomplete'\r\n   */\r\n  isFirstSession() {\r\n    return (this.getValue(this.isSCORM2004() ? 'cmi.entry' : 'cmi.core.entry') === 'ab-initio');\r\n  }\r\n\r\n  setIncomplete() {\r\n    this.setValue(this.isSCORM2004() ? 'cmi.completion_status' : 'cmi.core.lesson_status', 'incomplete');\r\n\r\n    if (this.commitOnStatusChange && !this.commitOnAnyChange) this.commit();\r\n  }\r\n\r\n  setCompleted() {\r\n    this.setValue(this.isSCORM2004() ? 'cmi.completion_status' : 'cmi.core.lesson_status', 'completed');\r\n\r\n    if (this.commitOnStatusChange && !this.commitOnAnyChange) this.commit();\r\n  }\r\n\r\n  setPassed() {\r\n    if (this.isSCORM2004()) {\r\n      this.setValue('cmi.completion_status', 'completed');\r\n      this.setValue('cmi.success_status', 'passed');\r\n    } else {\r\n      this.setValue('cmi.core.lesson_status', 'passed');\r\n    }\r\n\r\n    if (this.commitOnStatusChange && !this.commitOnAnyChange) this.commit();\r\n  }\r\n\r\n  setFailed() {\r\n    if (this.isSCORM2004()) {\r\n      this.setValue('cmi.success_status', 'failed');\r\n\r\n      if (this.setCompletedWhenFailed) {\r\n        this.setValue('cmi.completion_status', 'completed');\r\n      }\r\n    } else {\r\n      this.setValue('cmi.core.lesson_status', 'failed');\r\n    }\r\n\r\n    if (this.commitOnStatusChange && !this.commitOnAnyChange) this.commit();\r\n  }\r\n\r\n  getStatus() {\r\n    const status = this.getValue(this.isSCORM2004() ? 'cmi.completion_status' : 'cmi.core.lesson_status');\r\n\r\n    switch (status.toLowerCase()) { // workaround for some LMSes (e.g. Arena) not adhering to the all-lowercase rule\r\n      case 'passed':\r\n      case 'completed':\r\n      case 'incomplete':\r\n      case 'failed':\r\n      case 'browsed':\r\n      case 'not attempted':\r\n      case 'not_attempted': // mentioned in SCORM 2004 docs but not sure it ever gets used\r\n      case 'unknown': // the SCORM 2004 version of not attempted\r\n        return status;\r\n      default:\r\n        this.handleError(new ScormError(SERVER_STATUS_UNSUPPORTED, { status }));\r\n        return null;\r\n    }\r\n  }\r\n\r\n  setStatus(status) {\r\n    switch (status.toLowerCase()) {\r\n      case 'incomplete':\r\n        this.setIncomplete();\r\n        break;\r\n      case 'completed':\r\n        this.setCompleted();\r\n        break;\r\n      case 'passed':\r\n        this.setPassed();\r\n        break;\r\n      case 'failed':\r\n        this.setFailed();\r\n        break;\r\n      default:\r\n        this.handleError(new ScormError(CLIENT_STATUS_UNSUPPORTED, { status }));\r\n    }\r\n  }\r\n\r\n  getScore() {\r\n    return this.getValue(this.isSCORM2004() ? 'cmi.score.raw' : 'cmi.core.score.raw');\r\n  }\r\n\r\n  setScore(score, minScore = 0, maxScore = 100) {\r\n    if (this.isSCORM2004()) {\r\n      this.setValue('cmi.score.raw', score);\r\n      this.setValue('cmi.score.min', minScore);\r\n      this.setValue('cmi.score.max', maxScore);\r\n\r\n      const range = maxScore - minScore;\r\n      const scaledScore = ((score - minScore) / range).toFixed(7);\r\n      this.setValue('cmi.score.scaled', scaledScore);\r\n      return;\r\n    }\r\n    // SCORM 1.2\r\n    this.setValue('cmi.core.score.raw', score);\r\n    if (this.isSupported('cmi.core.score.min')) this.setValue('cmi.core.score.min', minScore);\r\n    if (this.isSupported('cmi.core.score.max')) this.setValue('cmi.core.score.max', maxScore);\r\n  }\r\n\r\n  getLessonLocation() {\r\n    return this.getValue(this.isSCORM2004() ? 'cmi.location' : 'cmi.core.lesson_location');\r\n  }\r\n\r\n  setLessonLocation(location) {\r\n    this.setValue(this.isSCORM2004() ? 'cmi.location' : 'cmi.core.lesson_location', location);\r\n  }\r\n\r\n  getSuspendData() {\r\n    return this.getValue('cmi.suspend_data');\r\n  }\r\n\r\n  setSuspendData(data) {\r\n    this.setValue('cmi.suspend_data', data);\r\n  }\r\n\r\n  getStudentName() {\r\n    return this.getValue(this.isSCORM2004() ? 'cmi.learner_name' : 'cmi.core.student_name');\r\n  }\r\n\r\n  getStudentId() {\r\n    return this.getValue(this.isSCORM2004() ? 'cmi.learner_id' : 'cmi.core.student_id');\r\n  }\r\n\r\n  setLanguage(lang) {\r\n    if (this.isSCORM2004()) {\r\n      this.setValue('cmi.learner_preference.language', lang);\r\n      return;\r\n    }\r\n    if (!this.isSupported('cmi.student_preference.language')) return;\r\n    this.setValue('cmi.student_preference.language', lang);\r\n  }\r\n\r\n  commit() {\r\n    this.logger.debug('ScormWrapper::commit');\r\n\r\n    if (!this.lmsConnected) {\r\n      this.handleError(new ScormError(ScormError.CLIENT_NOT_CONNECTED));\r\n      return;\r\n    }\r\n\r\n    if (this.commitRetryPending) {\r\n      this.logger.debug('ScormWrapper::commit: skipping this commit call as one is already pending.');\r\n      return;\r\n    }\r\n\r\n    if (this.scorm.save()) {\r\n      this.commitRetries = 0;\r\n      this.lastCommitSuccessTime = new Date();\r\n      Adapt.trigger('spoor:commit', this);\r\n      return;\r\n    }\r\n\r\n    if (this.commitRetries < this.maxCommitRetries && !this.finishCalled) {\r\n      this.commitRetries++;\r\n      this.initRetryCommit();\r\n      return;\r\n    }\r\n\r\n    const errorCode = this.scorm.debug.getCode();\r\n    this.handleError(new ScormError(CLIENT_COULD_NOT_COMMIT, {\r\n      errorCode,\r\n      errorInfo: this.scorm.debug.getInfo(errorCode),\r\n      diagnosticInfo: this.scorm.debug.getDiagnosticInfo(errorCode)\r\n    }));\r\n  }\r\n\r\n  finish() {\r\n    this.logger.debug('ScormWrapper::finish');\r\n\r\n    if (!this.lmsConnected || this.finishCalled) {\r\n      this.handleError(new ScormError(CLIENT_NOT_CONNECTED));\r\n      return;\r\n    }\r\n\r\n    this.finishCalled = true;\r\n\r\n    if (this.timedCommitIntervalID !== null) {\r\n      window.clearInterval(this.timedCommitIntervalID);\r\n    }\r\n\r\n    if (this.commitRetryPending) {\r\n      window.clearTimeout(this.retryCommitTimeoutID);\r\n      this.commitRetryPending = false;\r\n    }\r\n\r\n    if (this.logOutputWin && !this.logOutputWin.closed) {\r\n      this.logOutputWin.close();\r\n    }\r\n\r\n    this.endTime = new Date();\r\n\r\n    if (this.isSCORM2004()) {\r\n      this.scorm.set('cmi.session_time', this.convertToSCORM2004Time(this.endTime.getTime() - this.startTime.getTime()));\r\n      this.scorm.set('cmi.exit', this.getExitState());\r\n    } else {\r\n      this.scorm.set('cmi.core.session_time', this.convertToSCORM12Time(this.endTime.getTime() - this.startTime.getTime()));\r\n      this.scorm.set('cmi.core.exit', this.getExitState());\r\n    }\r\n\r\n    // api no longer available from this point\r\n    this.lmsConnected = false;\r\n\r\n    if (this.scorm.quit()) return;\r\n    const errorCode = this.scorm.debug.getCode();\r\n    this.handleError(new ScormError(CLIENT_COULD_NOT_FINISH, {\r\n      errorCode,\r\n      errorInfo: this.scorm.debug.getInfo(errorCode),\r\n      diagnosticInfo: this.scorm.debug.getDiagnosticInfo(errorCode)\r\n    }));\r\n  }\r\n\r\n  recordInteraction(id, response, correct, latency, type) {\r\n    if (!this.isSupported('cmi.interactions._count')) {\r\n      this.logger.info('ScormWrapper::recordInteraction: cmi.interactions are not supported by this LMS...');\r\n      return;\r\n    }\r\n\r\n    switch (type) {\r\n      case 'choice':\r\n        this.recordInteractionMultipleChoice.apply(this, arguments);\r\n        break;\r\n\r\n      case 'matching':\r\n        this.recordInteractionMatching.apply(this, arguments);\r\n        break;\r\n\r\n      case 'numeric':\r\n        this.isSCORM2004() ? this.recordInteractionScorm2004.apply(this, arguments) : this.recordInteractionScorm12.apply(this, arguments);\r\n        break;\r\n\r\n      case 'fill-in':\r\n        this.recordInteractionFillIn.apply(this, arguments);\r\n        break;\r\n\r\n      default:\r\n        console.error(`ScormWrapper.recordInteraction: unknown interaction type of '${type}' encountered...`);\r\n    }\r\n  }\r\n\r\n  // ****************************** private methods ******************************\r\n\r\n  getValue(property) {\r\n    this.logger.debug(`ScormWrapper::getValue: _property=${property}`);\r\n\r\n    if (this.finishCalled) {\r\n      this.logger.debug('ScormWrapper::getValue: ignoring request as \\'finish\\' has been called');\r\n      return;\r\n    }\r\n\r\n    if (!this.lmsConnected) {\r\n      this.handleError(new ScormError(CLIENT_NOT_CONNECTED));\r\n      return;\r\n    }\r\n\r\n    const value = this.scorm.get(property);\r\n    const errorCode = this.scorm.debug.getCode();\r\n\r\n    switch (errorCode) {\r\n      case 0:\r\n        break;\r\n      case 403:\r\n        // 403 errors are common (and normal) when targetting SCORM 2004 - they are triggered on any\r\n        // attempt to get the value of a data model element that hasn't yet been assigned a value.\r\n        this.logger.warn('ScormWrapper::getValue: data model element not initialized');\r\n        break;\r\n      default:\r\n        this.handleError(new ScormError(CLIENT_COULD_NOT_GET_PROPERTY, {\r\n          property,\r\n          errorCode,\r\n          errorInfo: this.scorm.debug.getInfo(errorCode),\r\n          diagnosticInfo: this.scorm.debug.getDiagnosticInfo(errorCode)\r\n        }));\r\n    }\r\n    this.logger.debug(`ScormWrapper::getValue: returning ${value}`);\r\n    return value + '';\r\n  }\r\n\r\n  setValue(property, value) {\r\n    this.logger.debug(`ScormWrapper::setValue: _property=${property} _value=${value}`);\r\n\r\n    if (this.finishCalled) {\r\n      this.logger.debug('ScormWrapper::setValue: ignoring request as \\'finish\\' has been called');\r\n      return;\r\n    }\r\n\r\n    if (!this.lmsConnected) {\r\n      this.handleError(new ScormError(CLIENT_NOT_CONNECTED));\r\n      return;\r\n    }\r\n\r\n    const success = this.scorm.set(property, value);\r\n    if (!success) {\r\n      // Some LMSes have an annoying tendency to return false from a set call even when it actually worked fine.\r\n      // So we should only throw an error if there was a valid error code...\r\n      const errorCode = this.scorm.debug.getCode();\r\n      if (errorCode !== 0) {\r\n        this.handleError(new ScormError(CLIENT_COULD_NOT_SET_PROPERTY, {\r\n          property,\r\n          value,\r\n          errorCode,\r\n          errorInfo: this.scorm.debug.getInfo(errorCode),\r\n          diagnosticInfo: this.scorm.debug.getDiagnosticInfo(errorCode)\r\n        }));\r\n        return success;\r\n      }\r\n      this.logger.warn('ScormWrapper::setValue: LMS reported that the \\'set\\' call failed but then said there was no error!');\r\n    }\r\n\r\n    if (this.commitOnAnyChange) this.debouncedCommit();\r\n\r\n    return success;\r\n  }\r\n\r\n  /**\r\n   * used for checking any data field that is not 'LMS Mandatory' to see whether the LMS we're running on supports it or not.\r\n   * Note that the way this check is being performed means it wouldn't work for any element that is\r\n   * 'write only', but so far we've not had a requirement to check for any optional elements that are.\r\n   */\r\n  isSupported(property) {\r\n    this.logger.debug(`ScormWrapper::isSupported: _property=${property}`);\r\n\r\n    if (this.finishCalled) {\r\n      this.logger.debug('ScormWrapper::isSupported: ignoring request as \\'finish\\' has been called');\r\n      return;\r\n    }\r\n\r\n    if (!this.lmsConnected) {\r\n      this.handleError(new ScormError(CLIENT_NOT_CONNECTED));\r\n      return false;\r\n    }\r\n\r\n    this.scorm.get(property);\r\n\r\n    return (this.scorm.debug.getCode() !== 401); // 401 is the 'not implemented' error code\r\n  }\r\n\r\n  initTimedCommit() {\r\n    this.logger.debug('ScormWrapper::initTimedCommit');\r\n\r\n    if (!this.commitOnAnyChange && this.timedCommitFrequency > 0) {\r\n      const delay = this.timedCommitFrequency * (60 * 1000);\r\n      this.timedCommitIntervalID = window.setInterval(this.commit.bind(this), delay);\r\n    }\r\n  }\r\n\r\n  initRetryCommit() {\r\n    this.logger.debug(`ScormWrapper::initRetryCommit ${this.commitRetries} out of ${this.maxCommitRetries}`);\r\n\r\n    this.commitRetryPending = true;// stop anything else from calling commit until this is done\r\n\r\n    this.retryCommitTimeoutID = window.setTimeout(this.doRetryCommit.bind(this), this.commitRetryDelay);\r\n  }\r\n\r\n  doRetryCommit() {\r\n    this.logger.debug('ScormWrapper::doRetryCommit');\r\n\r\n    this.commitRetryPending = false;\r\n\r\n    this.commit();\r\n  }\r\n\r\n  handleError(error) {\r\n\r\n    if (!Adapt.get('_isStarted')) {\r\n      Adapt.once('contentObjectView:ready', this.handleError.bind(this, error));\r\n      return;\r\n    }\r\n\r\n    if ('value' in error.data) {\r\n      // because some browsers (e.g. Firefox) don't like displaying very long strings in the window.confirm dialog\r\n      if (error.data.value.length && error.data.value.length > 80) error.data.value = error.data.value.slice(0, 80) + '...';\r\n      // if the value being set is an empty string, ensure it displays in the error as ''\r\n      if (error.data.value === '') error.data.value = '\\'\\'';\r\n    }\r\n\r\n    const config = Adapt.course.get('_spoor');\r\n    const messages = Object.assign({}, ScormError.defaultMessages, config && config._messages);\r\n    const message = Handlebars.compile(messages[error.name])(error.data);\r\n\r\n    switch (error.name) {\r\n      case CLIENT_COULD_NOT_CONNECT:\r\n        notify.popup({\r\n          _isCancellable: false,\r\n          title: messages.title,\r\n          body: message\r\n        });\r\n        return;\r\n    }\r\n\r\n    this.logger.error(message);\r\n\r\n    if (!this.suppressErrors && (!this.logOutputWin || this.logOutputWin.closed) && confirm(`${messages.title}:\\n\\n${message}\\n\\n${messages.pressOk}`)) {\r\n      this.showDebugWindow();\r\n    }\r\n\r\n  }\r\n\r\n  getInteractionCount() {\r\n    const count = this.getValue('cmi.interactions._count');\r\n    return count === '' ? 0 : count;\r\n  }\r\n\r\n  recordInteractionScorm12(id, response, correct, latency, type) {\r\n\r\n    id = id.trim();\r\n\r\n    const cmiPrefix = `cmi.interactions.${this.getInteractionCount()}`;\r\n\r\n    this.setValue(`${cmiPrefix}.id`, id);\r\n    this.setValue(`${cmiPrefix}.type`, type);\r\n    this.setValue(`${cmiPrefix}.student_response`, response);\r\n    this.setValue(`${cmiPrefix}.result`, correct ? 'correct' : 'wrong');\r\n    if (latency !== null && latency !== undefined) this.setValue(`${cmiPrefix}.latency`, this.convertToSCORM12Time(latency));\r\n    this.setValue(`${cmiPrefix}.time`, this.getCMITime());\r\n  }\r\n\r\n  recordInteractionScorm2004(id, response, correct, latency, type) {\r\n\r\n    id = id.trim();\r\n\r\n    const cmiPrefix = `cmi.interactions.${this.getInteractionCount()}`;\r\n\r\n    this.setValue(`${cmiPrefix}.id`, id);\r\n    this.setValue(`${cmiPrefix}.type`, type);\r\n    this.setValue(`${cmiPrefix}.learner_response`, response);\r\n    this.setValue(`${cmiPrefix}.result`, correct ? 'correct' : 'incorrect');\r\n    if (latency !== null && latency !== undefined) this.setValue(`${cmiPrefix}.latency`, this.convertToSCORM2004Time(latency));\r\n    this.setValue(`${cmiPrefix}.timestamp`, this.getISO8601Timestamp());\r\n  }\r\n\r\n  recordInteractionMultipleChoice(id, response, correct, latency, type) {\r\n\r\n    if (this.isSCORM2004()) {\r\n      response = response.replace(/,|#/g, '[,]');\r\n    } else {\r\n      response = response.replace(/#/g, ',');\r\n      response = this.checkResponse(response, 'choice');\r\n    }\r\n\r\n    const scormRecordInteraction = this.isSCORM2004() ? this.recordInteractionScorm2004 : this.recordInteractionScorm12;\r\n\r\n    scormRecordInteraction.call(this, id, response, correct, latency, type);\r\n  }\r\n\r\n  recordInteractionMatching(id, response, correct, latency, type) {\r\n\r\n    response = response.replace(/#/g, ',');\r\n\r\n    if (this.isSCORM2004()) {\r\n      response = response.replace(/,/g, '[,]');\r\n      response = response.replace(/\\./g, '[.]');\r\n    } else {\r\n      response = this.checkResponse(response, 'matching');\r\n    }\r\n\r\n    const scormRecordInteraction = this.isSCORM2004() ? this.recordInteractionScorm2004 : this.recordInteractionScorm12;\r\n\r\n    scormRecordInteraction.call(this, id, response, correct, latency, type);\r\n  }\r\n\r\n  recordInteractionFillIn(id, response, correct, latency, type) {\r\n\r\n    const maxLength = this.isSCORM2004() ? 250 : 255;\r\n\r\n    if (response.length > maxLength) {\r\n      response = response.substr(0, maxLength);\r\n\r\n      this.logger.warn(`ScormWrapper::recordInteractionFillIn: response data for ${id} is longer than the maximum allowed length of ${maxLength} characters; data will be truncated to avoid an error.`);\r\n    }\r\n\r\n    const scormRecordInteraction = this.isSCORM2004() ? this.recordInteractionScorm2004 : this.recordInteractionScorm12;\r\n\r\n    scormRecordInteraction.call(this, id, response, correct, latency, type);\r\n  }\r\n\r\n  showDebugWindow() {\r\n\r\n    if (this.logOutputWin && !this.logOutputWin.closed) {\r\n      this.logOutputWin.close();\r\n    }\r\n\r\n    this.logOutputWin = window.open('log_output.html', 'Log', 'width=600,height=300,status=no,scrollbars=yes,resizable=yes,menubar=yes,toolbar=yes,location=yes,top=0,left=0');\r\n\r\n    if (!this.logOutputWin) return;\r\n    this.logOutputWin.focus();\r\n  }\r\n\r\n  convertToSCORM12Time(msConvert) {\r\n\r\n    const msPerSec = 1000;\r\n    const msPerMin = msPerSec * 60;\r\n    const msPerHour = msPerMin * 60;\r\n\r\n    const ms = msConvert % msPerSec;\r\n    msConvert = msConvert - ms;\r\n\r\n    let secs = msConvert % msPerMin;\r\n    msConvert = msConvert - secs;\r\n    secs = secs / msPerSec;\r\n\r\n    let mins = msConvert % msPerHour;\r\n    msConvert = msConvert - mins;\r\n    mins = mins / msPerMin;\r\n\r\n    const hrs = msConvert / msPerHour;\r\n\r\n    if (hrs > 9999) {\r\n      return '9999:99:99.99';\r\n    }\r\n\r\n    const str = [ this.padWithZeroes(hrs, 4), this.padWithZeroes(mins, 2), this.padWithZeroes(secs, 2) ].join(':');\r\n    return (`${str}.${Math.floor(ms / 10)}`);\r\n  }\r\n\r\n  /**\r\n   * Converts milliseconds into the SCORM 2004 data type 'timeinterval (second, 10,2)'\r\n   * this will output something like 'P1DT3H5M0S' which indicates a period of time of 1 day, 3 hours and 5 minutes\r\n   * or 'PT2M10.1S' which indicates a period of time of 2 minutes and 10.1 seconds\r\n   */\r\n  convertToSCORM2004Time(msConvert) {\r\n    let csConvert = Math.floor(msConvert / 10);\r\n    const csPerSec = 100;\r\n    const csPerMin = csPerSec * 60;\r\n    const csPerHour = csPerMin * 60;\r\n    const csPerDay = csPerHour * 24;\r\n\r\n    let days = Math.floor(csConvert / csPerDay);\r\n    csConvert -= days * csPerDay;\r\n    days = days ? days + 'D' : '';\r\n\r\n    let hours = Math.floor(csConvert / csPerHour);\r\n    csConvert -= hours * csPerHour;\r\n    hours = hours ? hours + 'H' : '';\r\n\r\n    let mins = Math.floor(csConvert / csPerMin);\r\n    csConvert -= mins * csPerMin;\r\n    mins = mins ? mins + 'M' : '';\r\n\r\n    let secs = Math.floor(csConvert / csPerSec);\r\n    csConvert -= secs * csPerSec;\r\n    secs = secs || '0';\r\n\r\n    let cs = csConvert;\r\n    cs = cs ? '.' + cs : '';\r\n\r\n    const seconds = secs + cs + 'S';\r\n\r\n    const hms = [ hours, mins, seconds ].join('');\r\n\r\n    return 'P' + days + 'T' + hms;\r\n  }\r\n\r\n  getCMITime() {\r\n\r\n    const date = new Date();\r\n\r\n    const hours = this.padWithZeroes(date.getHours(), 2);\r\n    const min = this.padWithZeroes(date.getMinutes(), 2);\r\n    const sec = this.padWithZeroes(date.getSeconds(), 2);\r\n\r\n    return [ hours, min, sec ].join(':');\r\n  }\r\n\r\n  /**\r\n   * returns the current date & time in the format YYYY-MM-DDTHH:mm:ss\r\n   */\r\n  getISO8601Timestamp() {\r\n    const date = new Date().toISOString();\r\n    return date.replace(/.\\d\\d\\dZ/, ''); // Date.toISOString returns the date in the format YYYY-MM-DDTHH:mm:ss.sssZ so we need to drop the last bit to make it SCORM 2004 conformant\r\n  }\r\n\r\n  padWithZeroes(numToPad, padBy) {\r\n\r\n    let len = padBy;\r\n\r\n    while (--len) {\r\n      numToPad = '0' + numToPad;\r\n    }\r\n\r\n    return numToPad.slice(-padBy);\r\n  }\r\n\r\n  isSCORM2004() {\r\n    return this.scorm.version === '2004';\r\n  }\r\n\r\n  /**\r\n   * SCORM 1.2 requires that the identifiers in cmi.interactions.n.student_response for choice and matching activities be a character from [0-9a-z].\r\n   * When numeric identifiers are used this function attempts to map identifiers 10 to 35 to [a-z]. Resolves issues/1376.\r\n   */\r\n  checkResponse(response, responseType) {\r\n    if (!response) return response;\r\n    if (responseType !== 'choice' && responseType !== 'matching') return response;\r\n\r\n    response = response.split(/,|#/);\r\n\r\n    const self = this;\r\n\r\n    if (responseType === 'choice') {\r\n      response = response.map(checkIdentifier);\r\n    } else {\r\n      response = response.map(r => {\r\n        const identifiers = r.split('.');\r\n        return checkIdentifier(identifiers[0]) + '.' + checkIdentifier(identifiers[1]);\r\n      });\r\n    }\r\n\r\n    function checkIdentifier(r) {\r\n      // if [0-9] then ok\r\n      if (r.length === 1 && r >= '0' && r <= '9') return r;\r\n\r\n      // if [a-z] then ok\r\n      if (r.length === 1 && r >= 'a' && r <= 'z') return r;\r\n\r\n      // try to map integers 10-35 to [a-z]\r\n      const i = parseInt(r);\r\n\r\n      if (isNaN(i) || i < 10 || i > 35) {\r\n        self.handleError(new ScormError(CLIENT_INVALID_CHOICE_VALUE));\r\n      }\r\n\r\n      return Number(i).toString(36); // 10 maps to 'a', 11 maps to 'b', ..., 35 maps to 'z'\r\n    }\r\n\r\n    return response.join(',');\r\n  }\r\n\r\n  getExitState() {\r\n    const completionStatus = this.scorm.data.completionStatus;\r\n    const isIncomplete = completionStatus === 'incomplete' || completionStatus === 'not attempted';\r\n    const exitState = isIncomplete ? this.exitStateIfIncomplete : this.exitStateIfComplete;\r\n\r\n    if (exitState !== 'auto') return exitState;\r\n\r\n    if (this.isSCORM2004()) return (isIncomplete ? 'suspend' : 'normal');\r\n\r\n    return '';\r\n  }\r\n\r\n}\r\n\r\n// static\r\nScormWrapper.instance = null;\r\n\r\nexport default ScormWrapper;\r\n","define([\r\n  'underscore',\r\n  'libraries/lzma-min',\r\n  'libraries/lzma_worker-min.js'\r\n], function(_) {\r\n  const LZMAWorker = window.LZMAFactory('./libraries/lzma_worker-min.js');\r\n  /**\r\n   * 2020/05/06 SCORMSuspendData\r\n   *\r\n   * Serialize and deserialize arrays, booleans and numbers into a base64 string\r\n   * for transport over SCORM 1.2 based systems where storage space is restricted\r\n   * to only 4096 characters or 4KB.\r\n   *\r\n   * The algorithm is weighted heavily in efficiency towards storing data by\r\n   * its occurrence frequency when it is used to save Adapt question responses,\r\n   * booleans, arrays of <16 length and numbers of <4 value.\r\n   *\r\n   * Numbers can be 2 precision decimals, positive and negative numbers between\r\n   * -4294967295.99 and 4294967295.99. Arrays can have 0 to 65535 entries. Arrays\r\n   * can be nested. All arrays must have the same ES type (boolean, number or array).\r\n   *\r\n   * The appropriate binary type is chosen for each array according to the following table,\r\n   * an array must have one type which best fits its values:\r\n   *\r\n   *           VALUES                                VALUETYPE     PER ENTRY\r\n   * VALUETYPE MIN           MAX            DECIMAL  BITS          MIN BITS  MAX BITS  STORES\r\n   * ARRAY     0             65535 (items)  NO       2             6         23        Array length and valuetype\r\n   * BOOLEAN   0             1              NO       1             1         1         Entry value\r\n   * UINT3     0             7              NO       4             3         3         Entry value\r\n   * VINT8+    0             255            NO       3             3         9         Entry value\r\n   * VINT8-   -255           0              NO       6             3         9         Entry value\r\n   * SDEC15   -255.99        255.99         NO       6             8         22        Entry value\r\n   * SINT32   -4294967295    4294967295     NO       6             5         35        Entry value\r\n   * SDEC39   -4294967295.99 4294967295.99  YES      6             10        48        Entry value\r\n   *\r\n   * Output construction map:\r\n   *\r\n   *  OUTPUT = VALUETYPE + DATA\r\n   *  DATA = ( ARRAY | BOOLEAN | UINT3 | VINT8+ | VINT8- | SDEC15 | SINT32 | SDEC39 )\r\n   *  ARRAY = IS_SMALL_BIT( BOOLEAN ) + LENGTH( UINT4 | UINT16 ) + VALUETYPE + DATA[0-65535]\r\n   *\r\n   *  VALUETYPE = 0 to 111111\r\n   *   Signifies the type of value for the output or array data.\r\n   *\r\n   *   BINARY  NAME        USAGE RANKING\r\n   *   10      ARRAY       2\r\n   *   0       BOOLEAN     1\r\n   *   1110    UINT3       4\r\n   *   110     VINT8+      3\r\n   *   111100  VINT8-      7\r\n   *   111101  SDEC15      5\r\n   *   111110  SINT32      6\r\n   *   111111  SDEC39      8\r\n   *\r\n   *  ARRAY\r\n   *   Stores the number and type of items.\r\n   *\r\n   *          BINARY\r\n   *   BITS | SMALL LENGTH (UINT4/16) VALUETYPE = VALUE\r\n   *   6    | 1     0000              0         = zero length boolean array\r\n   *   6    | 1     1111              0         = 15 length boolean array\r\n   *   23   | 0     1000000000000000  111111    = 8 length sdec39 array\r\n   *   23   | 0     1111111111111111  111111    = 65535 length sdec39 array\r\n   *\r\n   *  BOOLEAN\r\n   *   A value of true or false.\r\n   *\r\n   *          BINARY\r\n   *   BITS | BOOL  = VALUE\r\n   *   1    | 0     = false\r\n   *   1    | 1     = true\r\n   *\r\n   *  UINT3\r\n   *   A value from 0 to 7 with a 3 bit fixed length output.\r\n   *\r\n   *          BINARY\r\n   *   BITS | INT (UINT3) = VALUE\r\n   *   3    | 000         = 0\r\n   *   3    | 111         = 7\r\n   *\r\n   *  UINT4\r\n   *   An array length from 0 to 15 with a 4 bit fixed length output.\r\n   *\r\n   *          BINARY\r\n   *   BITS | INT (UINT4) = VALUE\r\n   *   4    | 0000        = 0\r\n   *   4    | 1111        = 15\r\n   *\r\n   *  VINT8+\r\n   *   A value from 0 to 255 with variable length output.\r\n   *   Output is a UINT2/8 bit integer with a 1 bit header.\r\n   *\r\n   *          BINARY\r\n   *   BITS | SMALL INT (UINT2/8) = VALUE\r\n   *   3    | 1     00           =  0\r\n   *   3    | 1     11           =  3\r\n   *   9    | 0     00000100     =  4\r\n   *   9    | 0     11111111     =  255\r\n   *\r\n   *  VINT8-\r\n   *   A value from -255 to 0 with variable length output.\r\n   *   Output is a UINT2/8 bit integer with a 1 bit header.\r\n   *\r\n   *   BITS | SMALL INT (UINT2/8) = VALUE\r\n   *   3    | 1     00            =  0\r\n   *   3    | 1     11            = -3\r\n   *   9    | 0     00000100      = -4\r\n   *   9    | 0     11111111      = -255\r\n   *\r\n   *  SDEC15\r\n   *   A value from -255.99 to 255.99 preserving 2 decimals places\r\n   *   places and with variable length output.\r\n   *\r\n   *   BITS | SIGN INTSIZE INT (UINT2/8) DECSIZE DEC (UINT0/7)   = VALUE\r\n   *   5    | 0    0       00            0                       =  0\r\n   *   12   | 0    0       00            0       0000001         =  0.01\r\n   *   12   | 1    0       00            0       0000001         = -0.01\r\n   *   12   | 1    0       00            1       1100011         = -0.99\r\n   *   18   | 0    1       00001000      1       0000001         =  8.01\r\n   *   18   | 1    1       00001000      1       1100011         = -8.99\r\n   *   18   | 0    1       11111111      1       1100011         =  255.99\r\n   *   18   | 1    1       11111111      1       1100011         = -255.99\r\n   *\r\n   *  UINT16\r\n   *   An array length from 0 to 65535 with a 16 bit fixed length output.\r\n   *\r\n   *          BINARY\r\n   *   BITS | INT (UINT16)       = VALUE\r\n   *   16   | 0000000000000000  = 0\r\n   *   16   | 1111111111111111  = 65535\r\n   *\r\n   *  SINT32\r\n   *   A value from -4294967295 to 4294967295 with variable length output.\r\n   *   Output is a UINT2/4/16/32 bit integer with a 3 bit header.\r\n   *\r\n   *   BITS | SIGN SIZE  INT (UINT2/4/16/32)              = VALUE\r\n   *   5    | 0    00    00                               =  0\r\n   *   5    | 1    00    11                               = -3\r\n   *   7    | 0    01    1000                             =  8\r\n   *   7    | 1    01    1111                             = -15\r\n   *   19   | 0    10    0000000100000000                 =  256\r\n   *   19   | 1    10    1111111111111111                 = -65535\r\n   *   35   | 1    11    11111111111111111111111111111111 = -4294967295\r\n   *   35   | 0    11    11111111111111111111111111111111 =  4294967295\r\n   *\r\n   *  SDEC39\r\n   *   A value from -4294967295.99 to 4294967295.99 preserving 2 decimals places\r\n   *   places and with variable length output.\r\n   *\r\n   *   BITS | SIGN INTSIZE INT (UINT2/4/16/32)              DECSIZE DEC (UINT0/7)   = VALUE\r\n   *   6    | 0    00      00                               0                       =  0\r\n   *   13   | 0    00      11                               0       0000001         =  3.01\r\n   *   13   | 1    01      1000                             0       0000001         = -8.01\r\n   *   13   | 1    01      1111                             1       1100011         = -15.99\r\n   *   27   | 0    10      0000000100000000                 1       0000001         =  256.01\r\n   *   27   | 1    10      1111111111111111                 1       1100011         = -65535.99\r\n   *   37   | 0    11      11111111111111111111111111111111 0                       =  4294967295\r\n   *   37   | 1    11      11111111111111111111111111111111 0                       = -4294967295\r\n   *   43   | 0    11      11111111111111111111111111111111 1       1100011         =  4294967295.99\r\n   *   43   | 1    11      11111111111111111111111111111111 1       1100011         = -4294967295.99\r\n   *\r\n   * Output byte count formula:\r\n   *\r\n   *  byte_count = (bit_count * 1.5base64_expansion) / 8bits_per_byte\r\n   *\r\n   *  The output is in base64 so bit counts are always inflated by 1.5 from byte to base64.\r\n   *\r\n   * Example:\r\n   *\r\n   * [\r\n   *   [\r\n   *     0,\r\n   *     7,\r\n   *     1,\r\n   *     0\r\n   *   ],\r\n   *   [\r\n   *     true,\r\n   *     true,\r\n   *     true,\r\n   *     true,\r\n   *     true\r\n   *   ],\r\n   *   [\r\n   *     true,\r\n   *     false,\r\n   *     false,\r\n   *     false\r\n   *   ]\r\n   * ]\r\n   *\r\n   * In this example the parent array represents a completed question state for a\r\n   * single question. The first child number-array stores the block location,\r\n   * tracking id, score and attemptsLeft. The second child boolean-array stores\r\n   * the completion, correctness, submission state and user answer states. The\r\n   * third child boolean-array stores the user selections for a multiple choice question.\r\n   *\r\n   * When serialized with SCORMSuspendData.serialize() it becomes the following\r\n   * 10 characters:\r\n   *\r\n   *   hxOHIK-RAA\r\n   *\r\n   * These characters can be deserialized back into the nested arrays above using\r\n   * SCORMSuspendData.deserialize(\"hxOHIK-RAA\");\r\n   *\r\n   * In JSON this array would usually be 63 characters minified, at 10 characters this is\r\n   * a reduction of about 84%. At the worse case, storing an array containing just\r\n   * the largest possible number ([-4294967295.99]) the output will only be reduced\r\n   * by about 37% (g///////4w) when compared to the equivalent JSON. It is possible\r\n   * to store 500 of the above mcq state arrays in just 4088 characters. About 250\r\n   * question states will occupy about half of the available space in SCORM's 4096\r\n   * character suspend data.\r\n   */\r\n\r\n  // Cache for zero strings of various lengths\r\n  const ZeroString = {};\r\n  /**\r\n   * Make and cache a zero string up to the supplied length\r\n   * @param {number} length\r\n   * @returns {string}\r\n   */\r\n  function makeZeroString(length) {\r\n    ZeroString[length] = ZeroString[length] || (new Array(length + 1)).join('0');\r\n    return ZeroString[length];\r\n  }\r\n  // Initialize zero string cache up to 64 characters in length\r\n  for (let i = 1, l = 64; i <= l; i++) {\r\n    makeZeroString(i);\r\n  }\r\n\r\n  /**\r\n   * Zero pads to the right, making up to the supplied length\r\n   * @param {string} string\r\n   * @param {number} length\r\n   * @returns {string}\r\n   */\r\n  function zeroPadRightToLength(string, length) {\r\n    const padLength = (length - string.length);\r\n    if (padLength > 0) {\r\n      string += makeZeroString(padLength);\r\n    }\r\n    return string;\r\n  }\r\n\r\n  /**\r\n   * Zero pads to the left, making up to the supplied length\r\n   * @param {string} string\r\n   * @param {number} length\r\n   * @returns {string}\r\n   */\r\n  function zeroPadLeftToLength(string, length) {\r\n    const padLength = (length - string.length);\r\n    if (padLength > 0) {\r\n      string = makeZeroString(padLength) + string;\r\n    }\r\n    return string;\r\n  }\r\n\r\n  /**\r\n   * Zero pads to the right at even multiples\r\n   * @param {string} string\r\n   * @param {number} multiple\r\n   * @returns {string}\r\n   */\r\n  function zeroPadRightToMultiple(string, multiple) {\r\n    const padLength = multiple - (string.length % multiple);\r\n    if (padLength !== multiple) {\r\n      string += makeZeroString(padLength);\r\n    }\r\n    return string;\r\n  }\r\n\r\n  /**\r\n   * Returns a positive integer from the supplied binary string and binaryLength\r\n   * @param {string} binary\r\n   * @param {number} binaryLength\r\n   * @returns {number}\r\n   */\r\n  function binaryToUnsignedInteger(binary, binaryLength) {\r\n    if (binaryLength === 0) {\r\n      return 0;\r\n    }\r\n    binary = zeroPadLeftToLength(binary, binaryLength);\r\n    const integer = parseInt(binary.slice(0, binaryLength), 2);\r\n    return integer;\r\n  }\r\n\r\n  /**\r\n   * Shifts a positive integer from the supplied binary string and binaryLength,\r\n   * returning the shifted integer and the next part of the binary string\r\n   * @param {string} binary\r\n   * @param {number} binaryLength\r\n   * @returns {[number, string]}\r\n   */\r\n  function shiftUnsignedIntegerFromBinary(binary, binaryLength) {\r\n    if (binaryLength === 0) {\r\n      return [0, binary];\r\n    }\r\n    binary = zeroPadLeftToLength(binary, binaryLength);\r\n    const integer = parseInt(binary.slice(0, binaryLength), 2);\r\n    binary = binary.slice(binaryLength);\r\n    return [integer, binary];\r\n  }\r\n\r\n  /**\r\n   * Shifts binaryLength characters from the supplied binary string, returning the\r\n   * shifted binary string and the next part of the binary string\r\n   * @param {string} binary\r\n   * @param {number} binaryLength\r\n   * @returns {[string, string]}\r\n   */\r\n  function shiftBinary(binary, binaryLength) {\r\n    if (binaryLength === 0) {\r\n      return ['', binary];\r\n    }\r\n    binary = zeroPadLeftToLength(binary, binaryLength);\r\n    const shifted = binary.slice(0, binaryLength);\r\n    binary = binary.slice(binaryLength);\r\n    return [shifted, binary];\r\n  }\r\n\r\n  /**\r\n   * Converts a positive integer to a binary string\r\n   * @param {number} integer\r\n   * @param {number} [binaryLength] Length of the output string\r\n   */\r\n  function unsignedIntegerToBinary(integer, binaryLength) {\r\n    if (binaryLength === 0) {\r\n      return '';\r\n    }\r\n    let binary = Math.abs(integer).toString(2);\r\n    if (typeof binaryLength === 'undefined') {\r\n      return binary;\r\n    }\r\n    const length = binary.length;\r\n    if (length > binaryLength) {\r\n      throw new Error(`Integer too big for specified binary length. integer: ${integer} binarylen: ${binaryLength}`);\r\n    }\r\n    binary = zeroPadLeftToLength(binary, binaryLength);\r\n    return binary;\r\n  }\r\n\r\n  /**\r\n   * Converts a byte array to a string\r\n   * @param {[number]} array\r\n   * @returns {string}\r\n   */\r\n  function byteArrayToString(array) {\r\n    const arrayLength = array.length;\r\n    let string = new Array(arrayLength);\r\n    for (let i = 0, l = arrayLength; i < l; i++) {\r\n      string[i] = String.fromCharCode(array[i]);\r\n    }\r\n    string = string.join('');\r\n    return string;\r\n  }\r\n\r\n  /**\r\n   * Converts a string to a byte array\r\n   * @param {string} string\r\n   * @returns {[number]}\r\n   */\r\n  function stringToByteArray(string) {\r\n    const stringLength = string.length;\r\n    const array = new Array(stringLength);\r\n    for (let i = 0, l = stringLength; i < l; i++) {\r\n      array[i] = string.charCodeAt(i);\r\n    }\r\n    return array;\r\n  }\r\n\r\n  /** @type {number} Number of bits per byte */\r\n  const BYTE_BIT_LENGTH = 8;\r\n\r\n  /**\r\n   * Converts a binary string or nested arrays of binary strings to a base64 string\r\n   * @param {string|[string]} binary\r\n   * @returns {string}\r\n   */\r\n  function binaryToBase64(binary) {\r\n    binary = _.flatten(binary).join('');\r\n    binary = zeroPadRightToMultiple(binary, BYTE_BIT_LENGTH);\r\n    const bytesCount = binary.length / BYTE_BIT_LENGTH;\r\n    const charCodes = new Array(bytesCount);\r\n    for (let i = 0, l = bytesCount; i < l; i++) {\r\n      [ charCodes[i], binary ] = shiftUnsignedIntegerFromBinary(binary, BYTE_BIT_LENGTH);\r\n    }\r\n    let base64 = btoa(byteArrayToString(charCodes));\r\n    // Remove padding = or == as not necessary here\r\n    base64 = base64.replace(/=/g, '');\r\n    // Can't handle base64 with the + sign so swap with a -\r\n    base64 = base64.replace(/\\+/g, '-');\r\n    return base64;\r\n  }\r\n\r\n  /**\r\n   * Converts a base64 string to a binary string\r\n   * @param {string} base64\r\n   * @returns {string}\r\n   */\r\n  function base64ToBinary(base64) {\r\n    // base64 should have a + instead of a -\r\n    base64 = base64.replace(/-/g, '+');\r\n    const charCodes = stringToByteArray(atob(base64));\r\n    const bytesCount = charCodes.length;\r\n    let binary = new Array(bytesCount);\r\n    for (let i = 0, l = bytesCount; i < l; i++) {\r\n      binary[i] = unsignedIntegerToBinary(charCodes[i], BYTE_BIT_LENGTH);\r\n    }\r\n    binary = binary.join('');\r\n    return binary;\r\n  }\r\n\r\n  // Console output store\r\n  const logs = {\r\n    usedTypes: {},\r\n    typeLengths: {},\r\n    binarySamples: {}\r\n  };\r\n\r\n  /**\r\n   * An abstract base class for a ValueType value to and from binary string converter\r\n   */\r\n  class AbstractValueType {\r\n\r\n    /**\r\n     * @param {Object} options\r\n     * @param {string} options.name Name identifying the type\r\n     * @param {string} options.binaryType Binary string identifying the type\r\n     */\r\n    constructor(options) {\r\n      Object.assign(this, options);\r\n      this.binaryTypeLength = this.binaryType.length;\r\n    }\r\n\r\n    /**\r\n     * Adds a record of the binary string production to the logging store\r\n     * @param {[Array|string]} binary\r\n     */\r\n    log(binary) {\r\n      const name = this.name;\r\n      logs.usedTypes[name] = logs.usedTypes[name] || 0;\r\n      logs.usedTypes[name]++;\r\n      logs.binarySamples[name] = logs.binarySamples[name] || [];\r\n      logs.binarySamples[name].push(binary);\r\n    }\r\n\r\n  };\r\n\r\n  /**\r\n   * Converts a fixed length positive integer to and from a binary string.\r\n   */\r\n  class FixedIntegerType extends AbstractValueType {\r\n\r\n    /**\r\n     * @param {Object} options\r\n     * @param {string} options.name Name identifying the type\r\n     * @param {string} options.binaryType Binary string identifying the type\r\n     * @param {number} options.valueBinaryLength Bit length of the integer\r\n     */\r\n    constructor(options) {\r\n      super(options);\r\n      this.esType = 'number';\r\n      if (!this.valueBinaryLength) {\r\n        return;\r\n      }\r\n      this.minValue = options.minValue || 0;\r\n      this.maxValue = options.maxValue || Math.pow(2, this.valueBinaryLength) - 1;\r\n    }\r\n\r\n    /**\r\n     * Converts a fixed length positive integer to an array of binary strings\r\n     * @param {number} integer\r\n     * @param {boolean} [logStats] Log the type usage for output to the console\r\n     * @returns {[string]}\r\n     */\r\n    valueToBinary(integer, logStats = null) {\r\n      let binary = unsignedIntegerToBinary(integer, this.valueBinaryLength);\r\n      if (logStats) {\r\n        this.log(binary);\r\n      }\r\n      binary = [binary];\r\n      return binary;\r\n    }\r\n\r\n    /**\r\n     * Shifts a fixed length positive integer from the binary string, returning\r\n     * the integer and the next part of the binary string.\r\n     * @param {string} binary\r\n     * @returns {[number, string]}\r\n     */\r\n    shiftValueFromBinary(binary) {\r\n      let integer;\r\n      [integer, binary] = shiftUnsignedIntegerFromBinary(binary, this.valueBinaryLength);\r\n      return [integer, binary];\r\n    }\r\n\r\n  }\r\n\r\n  /**\r\n   * Converts a boolean to and from a binary string\r\n   */\r\n  class FixedBooleanType extends FixedIntegerType {\r\n\r\n    /**\r\n     * @param {Object} options\r\n     * @param {string} options.name Name identifying the type\r\n     * @param {string} options.binaryType Binary string identifying the type\r\n     */\r\n    constructor(options) {\r\n      options.valueBinaryLength = 1;\r\n      super(options);\r\n      this.esType = 'boolean';\r\n    }\r\n\r\n    /**\r\n     * Shifts a boolean from the binary string, returning\r\n     * the boolean and the next part of the binary string\r\n     * @param {string} binary\r\n     * @returns {[boolean, string]}\r\n     */\r\n    shiftValueFromBinary(binary) {\r\n      const bool = (binary[0] === '1');\r\n      binary = binary.slice(1);\r\n      return [bool, binary];\r\n    }\r\n\r\n  }\r\n\r\n  /**\r\n   * A helper for converting variable length positive integers to and from a binary string\r\n   */\r\n  class LengthAndValueBinary {\r\n\r\n    /**\r\n     * @param {string} parent The parent AbstractValueType\r\n     * @param {string} name The sub parent value part name \"integer\" or \"decimal\"\r\n     * @param {[number]} bitSizes An ordered array of expressible bit lengths\r\n     */\r\n    constructor(parent, name, bitSizes) {\r\n      this.parent = parent;\r\n      this.name = name;\r\n      this.bitSizes = bitSizes;\r\n      this.maxValues = _.flatten(this.bitSizes).map(value => (Math.pow(2, value) - 1));\r\n      this.maxValue = this.maxValues[this.maxValues.length - 1];\r\n      this.sizeBinaryLength = unsignedIntegerToBinary(this.bitSizes.length - 1).length;\r\n    }\r\n\r\n    /**\r\n     * Converts a positive integer to a binary string array\r\n     * @param {number} integer\r\n     * @param {boolean} [logStats] Log the type usage for output to the console\r\n     * @returns {[string]}\r\n     */\r\n    valueToBinary(integer, logStats = null) {\r\n      const parentName = this.parent.name;\r\n      const sizeIndex = this.maxValues.findIndex(maxValue => (integer <= maxValue));\r\n      if (sizeIndex === -1) {\r\n        throw new Error(`Value is too large for type: ${parentName} value: ${integer} max: ${this.maxValue}`);\r\n      }\r\n      const sizeBinary = unsignedIntegerToBinary(sizeIndex, this.sizeBinaryLength);\r\n      const valueLength = this.bitSizes[sizeIndex];\r\n      const name = this.name;\r\n      if (logStats) {\r\n        logs.typeLengths[parentName] = logs.typeLengths[parentName] || {};\r\n        logs.typeLengths[parentName][name] = logs.typeLengths[parentName][name] || {};\r\n        logs.typeLengths[parentName][name][valueLength] = logs.typeLengths[parentName][name][valueLength] || 0;\r\n        logs.typeLengths[parentName][name][valueLength]++;\r\n      }\r\n      const integerBinary = unsignedIntegerToBinary(integer, valueLength);\r\n      const binary = [sizeBinary, integerBinary];\r\n      return binary;\r\n    }\r\n\r\n    /**\r\n     * Shifts a positive integer from the binary string, returning\r\n     * the integer and the next part of the binary string\r\n     * @param {string} binary\r\n     * @returns {[number, string]}\r\n     */\r\n    shiftValueFromBinary(binary) {\r\n      let sizeBinary;\r\n      [sizeBinary, binary] = shiftBinary(binary, this.sizeBinaryLength);\r\n      const sizeIndex = binaryToUnsignedInteger(sizeBinary);\r\n      const valueLength = this.bitSizes[sizeIndex];\r\n      let integer;\r\n      [integer, binary] = shiftUnsignedIntegerFromBinary(binary, valueLength);\r\n      return [integer, binary];\r\n    }\r\n\r\n  }\r\n\r\n  /**\r\n   * Converts a variable length positive or negative integer to and from a\r\n   * binary string\r\n   */\r\n  class VariableIntegerType extends FixedIntegerType {\r\n\r\n    /**\r\n     * @param {Object} options\r\n     * @param {string} options.name Name identifying the type\r\n     * @param {string} options.binaryType Binary string identifying the type\r\n     * @param {number} options.minValue Minimum value for the integer\r\n     * @param {number} options.maxValue Maximum value for the integer\r\n     * @param {[number]} options.integerBitSizes Expressible storage bit sizes\r\n     */\r\n    constructor(options) {\r\n      super(options);\r\n      this.isNegative = (this.minValue < 0 && this.maxValue === 0);\r\n      this.integer = new LengthAndValueBinary(this, 'integer', options.integerBitSizes);\r\n    }\r\n\r\n    /**\r\n     * Converts a positive or negative integer to a array of binary strings\r\n     * @param {number} integer\r\n     * @param {boolean} [logStats] Log the type usage for output to the console\r\n     * @returns {[string]}\r\n     */\r\n    valueToBinary(integer, logStats = null) {\r\n      integer = integer.toFixed(0);\r\n      const binary = this.integer.valueToBinary(Math.abs(integer), logStats);\r\n      if (logStats) {\r\n        this.log(binary);\r\n      }\r\n      return binary;\r\n    }\r\n\r\n    /**\r\n     * Shifts a positive or negative integer from the binary string, returning\r\n     * the integer and the next part of the binary string\r\n     * @param {string} binary\r\n     * @returns {[number, string]}\r\n     */\r\n    shiftValueFromBinary(binary) {\r\n      let integer;\r\n      [integer, binary] = this.integer.shiftValueFromBinary(binary);\r\n      if (this.isNegative) {\r\n        integer = -integer;\r\n      }\r\n      return [integer, binary];\r\n    }\r\n\r\n  }\r\n\r\n  /**\r\n   * Converts a variable length array to and from a binary string\r\n   */\r\n  class VariableArrayType extends VariableIntegerType {\r\n\r\n    /**\r\n     * @param {Object} options\r\n     * @param {string} options.name Name identifying the type\r\n     * @param {string} options.binaryType Binary string identifying the type\r\n     * @param {[number]} options.integerBitSizes Expressible storage bit sizes\r\n     */\r\n    constructor(options) {\r\n      super(options);\r\n      this.esType = 'array';\r\n    }\r\n\r\n    /**\r\n     * Converts an array to an array of binary strings\r\n     * @param {Array} array\r\n     * @param {boolean} [logStats] Log the type usage for output to the console\r\n     * @returns {[Array|string]}\r\n     */\r\n    valueToBinary(array, logStats = null) {\r\n      const arrayLength = array.length;\r\n      const binary = super.valueToBinary(arrayLength);\r\n      if (arrayLength) {\r\n        const valueType = findValueTypeFromValues(array);\r\n        binary.push(valueType.binaryType);\r\n        binary.type = valueType.name;\r\n        binary.push(array.map(value => valueType.valueToBinary(value, logStats)));\r\n      }\r\n      if (logStats) {\r\n        this.log(binary);\r\n      }\r\n      return binary;\r\n    }\r\n\r\n    /**\r\n     * Shifts an array from the binary string, returning\r\n     * the array and the next part of the binary string\r\n     * @param {string} binary\r\n     * @returns {[Array, string]}\r\n     */\r\n    shiftValueFromBinary(binary) {\r\n      let arrayLength;\r\n      [arrayLength, binary] = super.shiftValueFromBinary(binary);\r\n      const value = new Array(arrayLength);\r\n      if (arrayLength) {\r\n        let valueType;\r\n        [valueType, binary] = shiftValueTypeFromBinary(binary);\r\n        for (let i = 0, l = arrayLength; i < l; i++) {\r\n          [value[i], binary] = valueType.shiftValueFromBinary(binary);\r\n        }\r\n      }\r\n      return [value, binary];\r\n    }\r\n\r\n  }\r\n\r\n  /**\r\n   * Converts a variable length signed integer to and from a binary string\r\n   */\r\n  class VariableSignedIntegerType extends VariableIntegerType {\r\n\r\n    /**\r\n     * Converts a signed positive or negative integer to a binary string array\r\n     * @param {number} integer\r\n     * @param {boolean} [logStats] Log the type usage for output to the console\r\n     * @returns {[string]}\r\n     */\r\n    valueToBinary(integer, logStats = null) {\r\n      integer = integer.toFixed(0);\r\n      const isNegative = (integer < 0);\r\n      const signBinary = isNegative ? '1' : '0';\r\n      const integerBinary = this.integer.valueToBinary(Math.abs(integer), logStats);\r\n      const binary = [signBinary, integerBinary];\r\n      if (logStats) {\r\n        this.log(binary);\r\n      }\r\n      return binary;\r\n    }\r\n\r\n    /**\r\n     * Shifts the first signed integer value from the binary string, returning\r\n     * the integer value and the next part of the binary string\r\n     * @param {string} binary\r\n     * @returns {[number, string]}\r\n     */\r\n    shiftValueFromBinary(binary) {\r\n      let isNegative;\r\n      [isNegative, binary] = shiftUnsignedIntegerFromBinary(binary, 1);\r\n      let integer;\r\n      [integer, binary] = this.integer.shiftValueFromBinary(binary);\r\n      if (isNegative) {\r\n        integer = -integer;\r\n      }\r\n      return [integer, binary];\r\n    }\r\n\r\n  }\r\n\r\n  /**\r\n   * Converts a variable length 2 precision decimal to and from a binary string\r\n   */\r\n  class VariableDecimalType extends VariableIntegerType {\r\n\r\n    /**\r\n     * @param {Object} options\r\n     * @param {string} options.name Name identifying the type\r\n     * @param {string} options.binaryType Binary string identifying the type\r\n     * @param {number} options.minValue Minimum value for the integer\r\n     * @param {number} options.maxValue Maximum value for the integer\r\n     * @param {[number]} options.integerBitSizes Expressible integer storage bit sizes\r\n     * @param {[number]} options.decimalBitSizes Expressible decimal storage bit sizes\r\n     */\r\n    constructor(options) {\r\n      super(options);\r\n      this.isFloat = true;\r\n      this.decimal = new LengthAndValueBinary(this, 'decimal', options.decimalBitSizes);\r\n    }\r\n\r\n    /**\r\n     * Converts a signed 2 precision decimal to an array of binary strings\r\n     * @param {number} float\r\n     * @param {boolean} [logStats] Log the type usage for output to the console\r\n     * @returns {[string]}\r\n     */\r\n    valueToBinary(float, logStats = null) {\r\n      float = float.toFixed(2);\r\n      const isNegative = (float < 0);\r\n      float = Math.abs(float);\r\n      const parts = String(float).split('.');\r\n      const higherInteger = parseInt(parts[0]);\r\n      const lowerInteger = parseInt(zeroPadRightToLength(parts[1] || 0, 2));\r\n      const signBinary = isNegative ? '1' : '0';\r\n      const integerValueBinary = this.integer.valueToBinary(higherInteger, logStats);\r\n      const decimalValueBinary = this.decimal.valueToBinary(lowerInteger, logStats);\r\n      const binary = [signBinary, integerValueBinary, decimalValueBinary];\r\n      if (logStats) {\r\n        this.log(binary);\r\n      }\r\n      return binary;\r\n    }\r\n\r\n    /**\r\n     * Shifts the first signed 2 precision decimal value from the binary string,\r\n     * returning the decimal value and the next part of the binary string\r\n     * @param {string} binary\r\n     * @returns {[number, string]}\r\n     */\r\n    shiftValueFromBinary(binary) {\r\n      let isNegative;\r\n      [isNegative, binary] = shiftUnsignedIntegerFromBinary(binary, 1);\r\n      let higherInteger;\r\n      [higherInteger, binary] = this.integer.shiftValueFromBinary(binary);\r\n      let lowerInteger;\r\n      [lowerInteger, binary] = this.decimal.shiftValueFromBinary(binary);\r\n      lowerInteger = zeroPadLeftToLength(String(lowerInteger), 2);\r\n      let float = parseFloat(higherInteger + '.' + lowerInteger);\r\n      if (isNegative) {\r\n        float = -float;\r\n      }\r\n      return [float, binary];\r\n    }\r\n\r\n  }\r\n\r\n  const arrayType = new VariableArrayType({\r\n    name: 'array',\r\n    binaryType: '10',\r\n    integerBitSizes: [4, 16]\r\n  });\r\n\r\n  const booleanType = new FixedBooleanType({\r\n    name: 'boolean',\r\n    binaryType: '0'\r\n  });\r\n\r\n  /**\r\n   * @type {[FixedIntegerType|VariableIntegerType]}\r\n   */\r\n  const integerTypes = [\r\n    new FixedIntegerType({\r\n      name: 'uint3',\r\n      binaryType: '1110',\r\n      valueBinaryLength: 3\r\n    }),\r\n    new VariableIntegerType({\r\n      name: 'vint8+',\r\n      binaryType: '110',\r\n      minValue: 0,\r\n      maxValue: 255,\r\n      integerBitSizes: [2, 8]\r\n    }),\r\n    new VariableIntegerType({\r\n      name: 'vint8-',\r\n      binaryType: '111100',\r\n      minValue: -255,\r\n      maxValue: 0,\r\n      integerBitSizes: [2, 8]\r\n    }),\r\n    new VariableSignedIntegerType({\r\n      name: 'sint32',\r\n      binaryType: '111110',\r\n      minValue: -4294967295,\r\n      maxValue: 4294967295,\r\n      integerBitSizes: [2, 4, 16, 32]\r\n    })\r\n  ];\r\n\r\n  /**\r\n   * @type {[VariableDecimalType]}\r\n   */\r\n  const decimalTypes = [\r\n    new VariableDecimalType({\r\n      name: 'sdec15',\r\n      binaryType: '111101',\r\n      minValue: -255.99,\r\n      maxValue: 255.99,\r\n      integerBitSizes: [2, 8],\r\n      decimalBitSizes: [0, 7]\r\n    }),\r\n    new VariableDecimalType({\r\n      name: 'sdec39',\r\n      binaryType: '111111',\r\n      minValue: -4294967295.99,\r\n      maxValue: 4294967295.99,\r\n      integerBitSizes: [2, 4, 16, 32],\r\n      decimalBitSizes: [0, 7]\r\n    })\r\n  ];\r\n\r\n  // Store and index all of the value types for searching by binaryType and name\r\n  const ValueTypes = [booleanType, arrayType].concat(integerTypes).concat(decimalTypes);\r\n  ValueTypes.nameIndex = {};\r\n  ValueTypes.forEach(valueType => (ValueTypes.nameIndex[valueType.name] = valueType));\r\n\r\n  /**\r\n   * Extends the native typeof keyword with array and null\r\n   * @param {*} value\r\n   * @returns {string} \"undefined\"|\"null\"|\"boolean\"|\"number\"|\"array\"|\"object\"\r\n   */\r\n  function esTypeOf(value) {\r\n    if (Array.isArray(value)) {\r\n      return 'array';\r\n    }\r\n    if (value === null) {\r\n      return 'null';\r\n    }\r\n    return typeof value;\r\n  }\r\n\r\n  /**\r\n   * Returns matching ValueType for the given name\r\n   * @param {string} name\r\n   * @returns {AbstractValueType}\r\n   */\r\n  function findValueTypeFromName(name) {\r\n    return ValueTypes.nameIndex[name.toLowerCase()];\r\n  }\r\n\r\n  /**\r\n   * Returns matching ValueType for the given value\r\n   * @param {number|boolean|Array} value\r\n   * @returns {AbstractValueType}\r\n   */\r\n  function findValueTypeFromValue(value) {\r\n    const esType = esTypeOf(value);\r\n    switch (esType) {\r\n      case 'array':\r\n        return arrayType;\r\n      case 'boolean':\r\n        return booleanType;\r\n    }\r\n    value = value.toFixed(2);\r\n    const isFloat = !Number.isInteger(value);\r\n    const isValueInValueTypeRange = valueType => (value >= valueType.minValue && value <= valueType.maxValue);\r\n    const valueType = isFloat ?\r\n      decimalTypes.find(isValueInValueTypeRange) :\r\n      integerTypes.find(isValueInValueTypeRange);\r\n    if (!valueType) {\r\n      throw new Error(`Cannot find type from value: ${value}`);\r\n    }\r\n    return valueType;\r\n  }\r\n\r\n  /**\r\n   * Returns a common ValueType for an array of values\r\n   * @param {Array} values\r\n   * @returns {AbstractValueType}\r\n   */\r\n  function findValueTypeFromValues(values) {\r\n    if (!values.length) {\r\n      return;\r\n    }\r\n    let minValue = 0;\r\n    let maxValue = 0;\r\n    let isFloat = false;\r\n    const esTypes = values.map(value => {\r\n      const valueType = findValueTypeFromValue(value, isFloat);\r\n      if (valueType.esType === 'number') {\r\n        minValue = Math.min(value, minValue);\r\n        maxValue = Math.max(value, maxValue);\r\n        isFloat = isFloat || !Number.isInteger(value);\r\n      }\r\n      return valueType.esType;\r\n    });\r\n    const uniqESTypes = [...new Set(esTypes)];\r\n    if (uniqESTypes.length > 1) {\r\n      throw new Error(`Cannot resolve array to one type: ${uniqESTypes.join()}`);\r\n    }\r\n    const esType = uniqESTypes[0];\r\n    switch (esType) {\r\n      case 'array':\r\n        return arrayType;\r\n      case 'boolean':\r\n        return booleanType;\r\n    }\r\n    const isRangeInValueTypeRange = valueType => (minValue >= valueType.minValue && maxValue <= valueType.maxValue);\r\n    const valueType = isFloat ?\r\n      decimalTypes.find(isRangeInValueTypeRange) :\r\n      integerTypes.find(isRangeInValueTypeRange);\r\n    if (!valueType) {\r\n      throw new Error(`Cannot find type from value. min: ${minValue} max: ${maxValue} isfloat: ${isFloat}`);\r\n    }\r\n    return valueType;\r\n  }\r\n\r\n  /**\r\n   * Shifts the first value type representation from the binary string, returning\r\n   * the the ValueType found and next part of the binary string\r\n   * @param {string} binary\r\n   * @returns {[AbstractValueType, string]}\r\n   */\r\n  function shiftValueTypeFromBinary(binary) {\r\n    const valueType = ValueTypes.find(valueType => {\r\n      const binaryType = binary.slice(0, valueType.binaryTypeLength);\r\n      return (binaryType === valueType.binaryType);\r\n    });\r\n    if (!valueType) {\r\n      throw new Error(`Cannot find type from binary: ${binary.slice(0, 6)}...`);\r\n    }\r\n    binary = binary.slice(valueType.binaryTypeLength);\r\n    return [valueType, binary];\r\n  }\r\n\r\n  /**\r\n   * Sanitize the input throwing errors on any incorrect variable types whilst\r\n   * cloning the input arrays\r\n   * @param {number|boolean|Array} value\r\n   * @returns {number|boolean|Array}\r\n   */\r\n  function convertValuesToNumbers(value) {\r\n    const esType = esTypeOf(value);\r\n    switch (esType) {\r\n      case 'array':\r\n        return value.map(convertValuesToNumbers);\r\n      case 'undefined':\r\n      case 'null':\r\n        return (value ? 1 : 0);\r\n      case 'boolean':\r\n      case 'number':\r\n        return value;\r\n    }\r\n    throw new Error(`Cannot convert ${esType} to number`);\r\n  }\r\n\r\n  /**\r\n   * Main API\r\n   */\r\n  class Converter {\r\n\r\n    /**\r\n     * Checks the given value for conversion errors and returns the error\r\n     * @param {string|number|Array} value\r\n     * @returns {undefined|Error}\r\n     */\r\n    getInvalidTypeError(value) {\r\n      try {\r\n        value = convertValuesToNumbers(value);\r\n        (esTypeOf(value) === 'array') ?\r\n          findValueTypeFromValues(value) :\r\n          findValueTypeFromValue(value);\r\n        return;\r\n      } catch (err) {\r\n        return err;\r\n      }\r\n    }\r\n\r\n    /**\r\n     * Convert an array, boolean or number into a string binary representation\r\n     * @param {number|boolean|Array} value\r\n     * @param {string} [typeName] To force an internal data type for testing\r\n     * @param {boolean} [logStats] Console logs statistics on type use\r\n     * @returns {string}\r\n     */\r\n    valueToBinary(value, typeName = null, logStats = null) {\r\n      this.clearLog();\r\n      const hasInitialType = (typeof typeName === 'string');\r\n      value = convertValuesToNumbers(value);\r\n      const valueType = hasInitialType ?\r\n        findValueTypeFromName(typeName) :\r\n        findValueTypeFromValue(value);\r\n      if (!valueType) {\r\n        throw new Error(`Could not find value type from ${hasInitialType ? `name ${typeName}` : `value ${value}`} accepts: ${Object.keys(ValueTypes.nameIndex)}. Leave typeName empty for auto-detect.`);\r\n      }\r\n      const binary = valueType.valueToBinary(value, logStats);\r\n      if (!hasInitialType) {\r\n        binary.unshift(valueType.binaryType);\r\n      }\r\n      if (logStats) {\r\n        this.printLog();\r\n      }\r\n      return binary;\r\n    }\r\n\r\n    /**\r\n     * Convert the string binary representation back into an array, boolean or number\r\n     * @param {string} binary A string binary representation of data from valueToBinary\r\n     * @param {string} [typeName] To force an internal data type for testing\r\n     * @returns {number|boolean|Array}\r\n     */\r\n    valueFromBinary(binary, typeName = null) {\r\n      binary = _.flatten(binary).join('');\r\n      const hasInitialType = typeof typeName === 'string';\r\n      let valueType;\r\n      if (hasInitialType) {\r\n        valueType = findValueTypeFromName(typeName);\r\n      } else {\r\n        [valueType, binary] = shiftValueTypeFromBinary(binary);\r\n      }\r\n      if (!valueType || !(valueType instanceof AbstractValueType)) {\r\n        throw new Error(`Could not find value type from ${hasInitialType ? `name \"${typeName}\"` : `binary \"${binary.slice(0, 8)}\"...`} accepts: ${Object.keys(ValueTypes.nameIndex)}. Leave typeName empty for auto-detect.`);\r\n      }\r\n      const [value] = valueType.shiftValueFromBinary(binary);\r\n      return value;\r\n    }\r\n\r\n    /**\r\n     * Clears any previous logs\r\n     */\r\n    clearLog() {\r\n      logs.usedTypes = {};\r\n      logs.typeLengths = {};\r\n      logs.binarySamples = {};\r\n    }\r\n\r\n    /**\r\n     * Prints logs from last run\r\n     */\r\n    printLog() {\r\n      console.log('Types used count:', logs.usedTypes);\r\n      console.log('Type lengths used count:', logs.typeLengths);\r\n      console.log('Type binary samples:', logs.binarySamples);\r\n    }\r\n\r\n    /**\r\n     * Convert an array, boolean or number into a base64 string\r\n     * @param {number|boolean|Array} value\r\n     * @param {string} [typeName] To force an internal data type for testing\r\n     * @param {boolean} [logStats] Console logs statistics on type use\r\n     * @returns {string}\r\n     */\r\n    serialize(value, typeName = null, logStats = null) {\r\n      const binary = this.valueToBinary(value, typeName, logStats);\r\n      const base64 = binaryToBase64(binary);\r\n      return base64;\r\n    }\r\n\r\n    /**\r\n     * Convert an array, boolean or number into a base64 string, asynchronously\r\n     * @param {number|boolean|Array} value\r\n     * @returns {string}\r\n     */\r\n    async serializeAsync(value, typeName = null, logStats = null) {\r\n      const binary = this.valueToBinary(value, null, null);\r\n      const base64 = binaryToBase64(binary);\r\n      const isLargeArray = (Array.isArray(value) && value.length > 10);\r\n      if (isLargeArray) {\r\n        return new Promise(resolve => {\r\n          LZMAWorker.compress(JSON.stringify(value), 1, data => {\r\n            const compressedBase64 = `#${window.btoa(data.map(i => String.fromCharCode(i + 128)).join('')).replace(/=/g, '')}`;\r\n            const isCompressedSmaller = (compressedBase64.length < base64.length);\r\n            if (isCompressedSmaller) return resolve(compressedBase64);\r\n            return resolve(base64);\r\n          });\r\n        });\r\n      }\r\n      return base64;\r\n    }\r\n\r\n    /**\r\n     * Convert the base64 string back into an array, boolean or number\r\n     * @param {string} base64 A string representation of data from serialize\r\n     * @param {string} [typeName] To force an internal data type for testing\r\n     * @returns {number|boolean|Array}\r\n     */\r\n    deserialize(base64, typeName = null) {\r\n      const isLZMACompressed = (base64[0] === '#');\r\n      if (isLZMACompressed) return JSON.parse(window.LZMA.decompress(window.atob(base64.slice(1)).split('').map(c => c.charCodeAt(0) - 128)));\r\n      const binary = base64ToBinary(base64);\r\n      const value = this.valueFromBinary(binary, typeName);\r\n      return value;\r\n    }\r\n\r\n  }\r\n\r\n  return (window.SCORMSuspendData = new Converter());\r\n});\r\n","import logging from 'core/js/logging';\r\nimport data from 'core/js/data';\r\nimport SCORMSuspendData from './SCORMSuspendData';\r\n\r\nexport default class ComponentSerializer extends Backbone.Controller {\r\n\r\n  initialize(trackingIdType, shouldCompress) {\r\n    this.trackingIdType = trackingIdType;\r\n    this.shouldCompress = shouldCompress;\r\n  }\r\n\r\n  async serialize(shouldStoreResponses, shouldStoreAttempts) {\r\n    if (shouldStoreAttempts && !shouldStoreResponses) {\r\n      logging.warnOnce('SPOOR configuration error, cannot use \\'_shouldStoreAttempts\\' without \\'_shouldStoreResponses\\'');\r\n    }\r\n    const states = [];\r\n    data.each(model => {\r\n      if (model.get('_type') !== this.trackingIdType) {\r\n        return;\r\n      }\r\n      const trackingId = model.get('_trackingId');\r\n      if (typeof trackingId === 'undefined') {\r\n        return;\r\n      }\r\n      const isContainer = model.hasManagedChildren;\r\n      let components = isContainer ?\r\n        model.findDescendantModels('component') :\r\n        [model];\r\n      components = components.filter(component => component.get('_isTrackable') !== false);\r\n      components.forEach((component, index) => {\r\n        if (component.get('_isTrackable') === false) {\r\n          return;\r\n        }\r\n        if (!shouldStoreResponses) {\r\n          // Store only component completion\r\n          const state = [\r\n            [ trackingId, index ],\r\n            [ component.get('_isComplete') ]\r\n          ];\r\n          states.push(state);\r\n          return;\r\n        }\r\n        let modelState = null;\r\n        if (!component.getAttemptState) {\r\n          // Legacy components without getAttemptState API\r\n          modelState = component.get('_isQuestionType') ?\r\n            [\r\n              [\r\n                component.get('_score') || 0,\r\n                component.get('_attemptsLeft') || 0\r\n              ],\r\n              [\r\n                component.get('_isComplete') || false,\r\n                component.get('_isInteractionComplete') || false,\r\n                component.get('_isSubmitted') || false,\r\n                component.get('_isCorrect') || false\r\n              ],\r\n              [\r\n                component.get('_userAnswer')\r\n              ]\r\n            ] :\r\n            [\r\n              [],\r\n              [\r\n                component.get('_isComplete') || false,\r\n                component.get('_isInteractionComplete') || false\r\n              ],\r\n              [\r\n                component.get('_userAnswer')\r\n              ]\r\n            ];\r\n        } else {\r\n          modelState = component.getAttemptState();\r\n        }\r\n        // Correct the _userAnswer array as it is sometimes not an array\r\n        // incomplete components are undefined and slider is a number\r\n        const userAnswer = modelState[2][0];\r\n        const hasUserAnswer = typeof userAnswer !== 'undefined' && userAnswer !== null;\r\n        const isUserAnswerArray = Array.isArray(userAnswer);\r\n        if (!hasUserAnswer) {\r\n          modelState[2][0] = [];\r\n        } else if (!isUserAnswerArray) {\r\n          modelState[2][0] = [modelState[2][0]];\r\n        }\r\n        // _attemptStates is empty if not a question or not attempted\r\n        const attemptStates = component.get('_attemptStates');\r\n        const hasAttemptStates = shouldStoreAttempts && Array.isArray(attemptStates);\r\n        if (hasAttemptStates) {\r\n          modelState[2][1] = attemptStates;\r\n        }\r\n        // Create the restoration state object\r\n        const state = [\r\n          [ trackingId, index ],\r\n          [ hasUserAnswer, isUserAnswerArray, hasAttemptStates ],\r\n          modelState\r\n        ];\r\n        states.push(state);\r\n      });\r\n    });\r\n    if (this.shouldCompress) return await SCORMSuspendData.serializeAsync(states);\r\n    return SCORMSuspendData.serialize(states);\r\n  }\r\n\r\n  deserialize(binary) {\r\n    // Build a table of models and their tracking ids\r\n    const trackingIdMap = data.toArray().reduce((trackingIdMap, model) => {\r\n      const trackingId = model.get('_trackingId');\r\n      if (typeof trackingId === 'undefined') return trackingIdMap;\r\n      trackingIdMap[trackingId] = model;\r\n      return trackingIdMap;\r\n    }, {});\r\n    const states = SCORMSuspendData.deserialize(binary);\r\n    // Derive the storage settings of the data from the states array, this will allow changes\r\n    // in the spoor configuration for _shouldStoreResponses and _shouldStoreAttempts\r\n    // to be non-breaking\r\n    const shouldStoreResponses = (states[0].length > 2);\r\n    states.forEach(state => {\r\n      const [ trackingId, index ] = state[0];\r\n      const model = trackingIdMap[trackingId];\r\n      if (!model) {\r\n        // Ignore any recently missing tracking ids if a course has been updated\r\n        return;\r\n      }\r\n      const isContainer = model.hasManagedChildren;\r\n      let components = isContainer ?\r\n        model.findDescendantModels('component') :\r\n        [model];\r\n      components = components.filter(component => component.get('_isTrackable') !== false);\r\n      const component = components[index];\r\n      if (!component) {\r\n        logging.warn(`SPOOR could not restore tracking id: ${trackingId}, index: ${index}`);\r\n        return;\r\n      }\r\n      if (!shouldStoreResponses) {\r\n        // Restore only component completion\r\n        const isComplete = state[1][0];\r\n        component.set('_isComplete', isComplete);\r\n        return;\r\n      }\r\n      const [ hasUserAnswer, isUserAnswerArray, hasAttemptStates ] = state[1];\r\n      const modelState = state[2];\r\n      // Correct the _userAnswer value if it wasn't an array originally\r\n      if (!hasUserAnswer) {\r\n        modelState[2][0] = null;\r\n      } else if (!isUserAnswerArray) {\r\n        modelState[2][0] = modelState[2][0][0];\r\n      }\r\n      // Allow empty _attemptStates\r\n      if (!hasAttemptStates) {\r\n        modelState[2][1] = null;\r\n      }\r\n      if (component.setAttemptObject) {\r\n        // Restore component state with setAttemptObject API\r\n        component.set('_attemptStates', modelState[2][1]);\r\n        const attemptObject = component.getAttemptObject(modelState);\r\n        component.setAttemptObject(attemptObject, false);\r\n        return;\r\n      }\r\n      // Legacy components without getAttemptState\r\n      component.get('_isQuestionType') ?\r\n        component.set({\r\n          _score: modelState[0][0],\r\n          _attemptsLeft: modelState[0][1],\r\n          _isComplete: modelState[1][0],\r\n          _isInteractionComplete: modelState[1][1],\r\n          _isSubmitted: modelState[1][2],\r\n          _isCorrect: modelState[1][3],\r\n          _userAnswer: modelState[2][0],\r\n          _attemptStates: modelState[2][1]\r\n        }) :\r\n        component.set({\r\n          _isComplete: modelState[1][0],\r\n          _isInteractionComplete: modelState[1][1],\r\n          _userAnswer: modelState[2][0],\r\n          _attemptStates: modelState[2][1]\r\n        });\r\n    });\r\n  }\r\n\r\n}\r\n","import Adapt from 'core/js/adapt';\r\nimport data from 'core/js/data';\r\nimport logging from 'core/js/logging';\r\nimport ScormWrapper from './scorm/wrapper';\r\nimport COMPLETION_STATE from 'core/js/enums/completionStateEnum';\r\nimport ComponentSerializer from './serializers/ComponentSerializer';\r\nimport SCORMSuspendData from './serializers/SCORMSuspendData';\r\nimport offlineStorage from 'core/js/offlineStorage';\r\n\r\nexport default class StatefulSession extends Backbone.Controller {\r\n\r\n  initialize() {\r\n    _.bindAll(this, 'beginSession', 'onVisibilityChange', 'endSession');\r\n    this.debouncedSaveSession = _.debounce(this.saveSessionState.bind(this), 1);\r\n    this.scorm = ScormWrapper.getInstance();\r\n    this._trackingIdType = 'block';\r\n    this._componentSerializer = null;\r\n    this._shouldCompress = false;\r\n    this._shouldStoreResponses = true;\r\n    this._shouldStoreAttempts = false;\r\n    this._shouldRecordInteractions = true;\r\n    this.beginSession();\r\n  }\r\n\r\n  beginSession() {\r\n    this.listenTo(Adapt, 'app:dataReady', this.restoreSession);\r\n    this._trackingIdType = Adapt.build.get('trackingIdType') || 'block';\r\n    // suppress SCORM errors if 'nolmserrors' is found in the querystring\r\n    if (window.location.search.indexOf('nolmserrors') !== -1) {\r\n      this.scorm.suppressErrors = true;\r\n    }\r\n    const config = Adapt.spoor.config;\r\n    if (!config) return;\r\n    const tracking = config._tracking;\r\n    this._shouldStoreResponses = (tracking && tracking._shouldStoreResponses) || false;\r\n    this._shouldStoreAttempts = (tracking && tracking._shouldStoreAttempts) || false;\r\n    this._shouldCompress = (tracking && tracking._shouldCompress) || false;\r\n    this._componentSerializer = new ComponentSerializer(this._trackingIdType, this._shouldCompress);\r\n    // Default should be to record interactions, so only avoid doing that if\r\n    // _shouldRecordInteractions is set to false\r\n    if (tracking?._shouldRecordInteractions === false) {\r\n      this._shouldRecordInteractions = false;\r\n    }\r\n    const settings = config._advancedSettings;\r\n    if (!settings) {\r\n      // force use of SCORM 1.2 by default - some LMSes (SABA/Kallidus for instance)\r\n      // present both APIs to the SCO and, if given the choice, the pipwerks\r\n      // code will automatically select the SCORM 2004 API - which can lead to\r\n      // unexpected behaviour.\r\n      this.scorm.setVersion('1.2');\r\n      this.scorm.initialize();\r\n      return;\r\n    }\r\n    if (settings._showDebugWindow) {\r\n      this.scorm.showDebugWindow();\r\n    }\r\n    this.scorm.setVersion(settings._scormVersion || '1.2');\r\n    if (_.isBoolean(settings._suppressErrors)) {\r\n      this.scorm.suppressErrors = settings._suppressErrors;\r\n    }\r\n    if (_.isBoolean(settings._commitOnStatusChange)) {\r\n      this.scorm.commitOnStatusChange = settings._commitOnStatusChange;\r\n    }\r\n    if (_.isBoolean(settings._commitOnAnyChange)) {\r\n      this.scorm.commitOnAnyChange = settings._commitOnAnyChange;\r\n    }\r\n    if (_.isFinite(settings._timedCommitFrequency)) {\r\n      this.scorm.timedCommitFrequency = settings._timedCommitFrequency;\r\n    }\r\n    if (_.isFinite(settings._maxCommitRetries)) {\r\n      this.scorm.maxCommitRetries = settings._maxCommitRetries;\r\n    }\r\n    if (_.isFinite(settings._commitRetryDelay)) {\r\n      this.scorm.commitRetryDelay = settings._commitRetryDelay;\r\n    }\r\n    if ('_exitStateIfIncomplete' in settings) {\r\n      this.scorm.exitStateIfIncomplete = settings._exitStateIfIncomplete;\r\n    }\r\n    if ('_exitStateIfComplete' in settings) {\r\n      this.scorm.exitStateIfComplete = settings._exitStateIfComplete;\r\n    }\r\n    this.scorm.initialize();\r\n  }\r\n\r\n  restoreSession() {\r\n    this.setupLearnerInfo();\r\n    this.restoreSessionState();\r\n    // defer call because AdaptModel.check*Status functions are asynchronous\r\n    _.defer(this.setupEventListeners.bind(this));\r\n  }\r\n\r\n  setupLearnerInfo() {\r\n    // Replace the hard-coded _learnerInfo data in _globals with the actual data\r\n    // from the LMS\r\n    // If the course has been published from the AT, the _learnerInfo object\r\n    // won't exist so we'll need to create it\r\n    const globals = Adapt.course.get('_globals');\r\n    if (!globals._learnerInfo) {\r\n      globals._learnerInfo = {};\r\n    }\r\n    Object.assign(globals._learnerInfo, offlineStorage.get('learnerinfo'));\r\n  }\r\n\r\n  restoreSessionState() {\r\n    const sessionPairs = offlineStorage.get();\r\n    const hasNoPairs = !Object.keys(sessionPairs).length;\r\n    if (hasNoPairs) return;\r\n    if (sessionPairs.c) {\r\n      const [ _isComplete, _isAssessmentPassed ] = SCORMSuspendData.deserialize(sessionPairs.c);\r\n      Adapt.course.set({\r\n        _isComplete,\r\n        _isAssessmentPassed\r\n      });\r\n    }\r\n    if (!sessionPairs.q) return;\r\n    this._componentSerializer?.deserialize(sessionPairs.q);\r\n  }\r\n\r\n  setupEventListeners() {\r\n    this.removeEventListeners();\r\n    this.listenTo(Adapt.components, 'change:_isComplete', this.debouncedSaveSession);\r\n    this.listenTo(Adapt.course, 'change:_isComplete', this.debouncedSaveSession);\r\n    if (this._shouldStoreResponses) {\r\n      this.listenTo(data, 'change:_isSubmitted change:_userAnswer', this.debouncedSaveSession);\r\n    }\r\n    this.listenTo(Adapt, {\r\n      'app:dataReady': this.restoreSession,\r\n      'app:languageChanged': this.onLanguageChanged,\r\n      'questionView:recordInteraction': this.onQuestionRecordInteraction,\r\n      'tracking:complete': this.onTrackingComplete\r\n    });\r\n    const config = Adapt.spoor.config;\r\n    const advancedSettings = config._advancedSettings;\r\n    const shouldCommitOnVisibilityChange = (!advancedSettings ||\r\n        advancedSettings._commitOnVisibilityChangeHidden !== false);\r\n    if (shouldCommitOnVisibilityChange) {\r\n      document.addEventListener('visibilitychange', this.onVisibilityChange);\r\n    }\r\n    $(window).on('beforeunload unload', this.endSession);\r\n  }\r\n\r\n  async saveSessionState() {\r\n    const isMidRender = !Adapt.parentView?.model.get('_isReady');\r\n    // Wait until finished rendering to save\r\n    if (isMidRender) return this.debouncedSaveSession();\r\n    const courseState = SCORMSuspendData.serialize([\r\n      Boolean(Adapt.course.get('_isComplete')),\r\n      Boolean(Adapt.course.get('_isAssessmentPassed'))\r\n    ]);\r\n    const componentStates = await this._componentSerializer?.serialize(this._shouldStoreResponses, this._shouldStoreAttempts);\r\n    const sessionPairs = {\r\n      c: courseState,\r\n      q: componentStates\r\n    };\r\n    offlineStorage.set(sessionPairs);\r\n    this.printCompletionInformation(sessionPairs);\r\n  }\r\n\r\n  printCompletionInformation(suspendData) {\r\n    if (typeof suspendData === 'string') {\r\n      // In-case LMS data is passed as a string\r\n      suspendData = JSON.parse(suspendData);\r\n    }\r\n    const courseState = SCORMSuspendData.deserialize(suspendData.c);\r\n    const courseComplete = courseState[0];\r\n    const assessmentPassed = courseState[1];\r\n    const trackingIdModels = data.filter(model => model.get('_type') === this._trackingIdType && model.has('_trackingId'));\r\n    const trackingIds = trackingIdModels.map(model => model.get('_trackingId'));\r\n    if (!trackingIds.length) {\r\n      logging.info(`course._isComplete: ${courseComplete}, course._isAssessmentPassed: ${assessmentPassed}, ${this._trackingIdType} completion: no tracking ids found`);\r\n      return;\r\n    }\r\n    const completionData = SCORMSuspendData.deserialize(suspendData.q);\r\n    const max = Math.max(...completionData.map(item => item[0][0]));\r\n    const shouldStoreResponses = (completionData[0].length === 3);\r\n    const completionString = completionData.reduce((markers, item) => {\r\n      const trackingId = item[0][0];\r\n      const isComplete = shouldStoreResponses ?\r\n        item[2][1][0] :\r\n        item[1][0];\r\n      const mark = isComplete ? '1' : '0';\r\n      markers[trackingId] = (markers[trackingId] === '-' || markers[trackingId] === '1') ?\r\n        mark :\r\n        '0';\r\n      return markers;\r\n    }, (new Array(max + 1).join('-').split(''))).join('');\r\n    logging.info(`course._isComplete: ${courseComplete}, course._isAssessmentPassed: ${assessmentPassed}, ${this._trackingIdType} completion: ${completionString}`);\r\n  }\r\n\r\n  onLanguageChanged() {\r\n    const config = Adapt.spoor.config;\r\n    if (config?._reporting?._resetStatusOnLanguageChange !== true) return;\r\n    offlineStorage.set('status', 'incomplete');\r\n  }\r\n\r\n  onVisibilityChange() {\r\n    if (document.visibilityState === 'hidden') this.scorm.commit();\r\n  }\r\n\r\n  onQuestionRecordInteraction(questionView) {\r\n    if (!this._shouldRecordInteractions) return;\r\n    // View functions are deprecated: getResponseType, getResponse, isCorrect, getLatency\r\n    const questionModel = questionView.model;\r\n    const responseType = (questionModel.getResponseType ? questionModel.getResponseType() : questionView.getResponseType());\r\n    // If responseType doesn't contain any data, assume that the question\r\n    // component hasn't been set up for cmi.interaction tracking\r\n    if (_.isEmpty(responseType)) return;\r\n    const id = questionModel.get('_id');\r\n    const response = (questionModel.getResponse ? questionModel.getResponse() : questionView.getResponse());\r\n    const result = (questionModel.isCorrect ? questionModel.isCorrect() : questionView.isCorrect());\r\n    const latency = (questionModel.getLatency ? questionModel.getLatency() : questionView.getLatency());\r\n    offlineStorage.set('interaction', id, response, result, latency, responseType);\r\n  }\r\n\r\n  onTrackingComplete(completionData) {\r\n    const config = Adapt.spoor.config;\r\n    this.saveSessionState();\r\n    let completionStatus = completionData.status.asLowerCase;\r\n    // The config allows the user to override the completion state.\r\n    switch (completionData.status) {\r\n      case COMPLETION_STATE.COMPLETED:\r\n      case COMPLETION_STATE.PASSED: {\r\n        if (!config?._reporting?._onTrackingCriteriaMet) {\r\n          logging.warn(`No value defined for '_onTrackingCriteriaMet', so defaulting to '${completionStatus}'`);\r\n        } else {\r\n          completionStatus = config._reporting._onTrackingCriteriaMet;\r\n        }\r\n\r\n        break;\r\n      }\r\n      case COMPLETION_STATE.FAILED: {\r\n        if (!config?._reporting?._onAssessmentFailure) {\r\n          logging.warn(`No value defined for '_onAssessmentFailure', so defaulting to '${completionStatus}'`);\r\n        } else {\r\n          completionStatus = config._reporting._onAssessmentFailure;\r\n        }\r\n      }\r\n    }\r\n    offlineStorage.set('status', completionStatus);\r\n  }\r\n\r\n  endSession() {\r\n    if (!this.scorm.finishCalled) {\r\n      this.scorm.finish();\r\n    }\r\n    this.removeEventListeners();\r\n  }\r\n\r\n  removeEventListeners() {\r\n    $(window).off('beforeunload unload', this.endSession);\r\n    document.removeEventListener('visibilitychange', this.onVisibilityChange);\r\n    this.stopListening();\r\n  }\r\n\r\n}\r\n","import Adapt from 'core/js/adapt';\r\nimport ScormWrapper from './scorm/wrapper';\r\nimport SCORMSuspendData from './serializers/SCORMSuspendData';\r\nimport offlineStorage from 'core/js/offlineStorage';\r\n\r\n/**\r\n * SCORM handler for offlineStorage interface.\r\n */\r\nexport default class OfflineStorageScorm extends Backbone.Controller {\r\n\r\n  initialize(statefulSession) {\r\n    this.offlineStorage = offlineStorage;\r\n    this.scorm = ScormWrapper.getInstance();\r\n    this.statefulSession = statefulSession;\r\n    this.temporaryStore = {};\r\n    this.suspendDataStore = {};\r\n    this.suspendDataRestored = false;\r\n    offlineStorage.initialize(this);\r\n  }\r\n\r\n  save() {\r\n    this.statefulSession.saveSessionState();\r\n    this.scorm.commit();\r\n  }\r\n\r\n  serialize(...args) {\r\n    return SCORMSuspendData.serialize(...args);\r\n  }\r\n\r\n  deserialize(...args) {\r\n    return SCORMSuspendData.deserialize(...args);\r\n  }\r\n\r\n  get(name) {\r\n    if (name === undefined) {\r\n      // If not connected return just temporary store.\r\n      if (this.useTemporaryStore()) return this.temporaryStore;\r\n\r\n      // Get all values as a combined object\r\n      this.suspendDataStore = this.getCustomStates();\r\n\r\n      const data = Object.assign(_.clone(this.suspendDataStore), {\r\n        location: this.scorm.getLessonLocation(),\r\n        score: this.scorm.getScore(),\r\n        status: this.scorm.getStatus(),\r\n        student: this.scorm.getStudentName(),\r\n        learnerInfo: this.getLearnerInfo()\r\n      });\r\n\r\n      this.suspendDataRestored = true;\r\n\r\n      return data;\r\n    }\r\n\r\n    // If not connected return just temporary store value.\r\n    if (this.useTemporaryStore()) return this.temporaryStore[name];\r\n\r\n    // Get by name\r\n    let courseState;\r\n    switch (name.toLowerCase()) {\r\n      case 'location':\r\n        return this.scorm.getLessonLocation();\r\n      case 'score':\r\n        return this.scorm.getScore();\r\n      case 'status':\r\n        return this.scorm.getStatus();\r\n      case 'student':\r\n        // for backwards-compatibility. learnerInfo is preferred now and will\r\n        // give you more information\r\n        return this.scorm.getStudentName();\r\n      case 'learnerinfo':\r\n        return this.getLearnerInfo();\r\n      case 'coursestate': {\r\n        courseState = this.getCustomState('c');\r\n        const stateArray = (courseState && SCORMSuspendData.deserialize(courseState)) || [];\r\n        return {\r\n          _isCourseComplete: Boolean(stateArray.slice(0, 1).map(Number)[0]),\r\n          _isAssessmentPassed: Boolean(stateArray.slice(1, 2).map(Number)[0]),\r\n          completion: stateArray.slice(2).map(Number).map(String).join('') || ''\r\n        };\r\n      }\r\n      case 'completion':\r\n        courseState = this.getCustomState('c');\r\n        return (courseState && SCORMSuspendData\r\n          .deserialize(courseState)\r\n          .slice(2)\r\n          .map(Number)\r\n          .map(String)\r\n          .join('')) || '';\r\n      case '_iscoursecomplete':\r\n        courseState = this.getCustomState('c');\r\n        return Boolean(courseState && SCORMSuspendData\r\n          .deserialize(courseState)\r\n          .slice(0, 1)\r\n          .map(Number)[0]);\r\n      case '_isassessmentpassed':\r\n        courseState = this.getCustomState('c');\r\n        return Boolean(courseState && SCORMSuspendData\r\n          .deserialize(courseState)\r\n          .slice(1, 2)\r\n          .map(Number)[0]);\r\n      case 'questions': {\r\n        const questionsState = this.getCustomState('q');\r\n        return questionsState || '';\r\n      }\r\n      default:\r\n        return this.getCustomState(name);\r\n    }\r\n  }\r\n\r\n  set(name, value) {\r\n    // Convert arguments to array and drop the 'name' parameter\r\n    const args = [...arguments].slice(1);\r\n    const isObject = typeof name === 'object';\r\n\r\n    if (isObject) {\r\n      value = name;\r\n      name = 'suspendData';\r\n    }\r\n\r\n    if (this.useTemporaryStore()) {\r\n      if (isObject) {\r\n        Object.assign(this.temporaryStore, value);\r\n      } else {\r\n        this.temporaryStore[name] = value;\r\n      }\r\n\r\n      return true;\r\n    }\r\n\r\n    switch (name.toLowerCase()) {\r\n      case 'interaction':\r\n        return this.scorm.recordInteraction(...args);\r\n      case 'location':\r\n        return this.scorm.setLessonLocation(...args);\r\n      case 'score':\r\n        return this.scorm.setScore(...args);\r\n      case 'status':\r\n        return this.scorm.setStatus(...args);\r\n      case 'student':\r\n      case 'learnerinfo':\r\n        return false;// these properties are read-only\r\n      case 'lang':\r\n        this.scorm.setLanguage(value);\r\n        // fall-through so that lang gets stored in suspend_data as well:\r\n        // because in SCORM 1.2 cmi.student_preference.language is an optional\r\n        // data element so we can't rely on the LMS having support for it.\r\n        // If it does support it we may as well save the user's choice there\r\n        // purely for reporting purposes\r\n        break;\r\n      case 'suspenddata':\r\n        break;\r\n    }\r\n\r\n    if (isObject) {\r\n      Object.assign(this.suspendDataStore, value);\r\n    } else {\r\n      this.suspendDataStore[name] = value;\r\n    }\r\n\r\n    const dataAsString = JSON.stringify(this.suspendDataStore);\r\n    return (this.suspendDataRestored) ? this.scorm.setSuspendData(dataAsString) : false;\r\n  }\r\n\r\n  clear() {\r\n    this.temporaryStore = {};\r\n    this.suspendDataStore = {};\r\n    const dataAsString = JSON.stringify(this.suspendDataStore);\r\n    this.scorm.setSuspendData(dataAsString);\r\n  }\r\n\r\n  getCustomStates() {\r\n    const isSuspendDataStoreEmpty = _.isEmpty(this.suspendDataStore);\r\n    if (!isSuspendDataStoreEmpty && this.suspendDataRestored) {\r\n      return _.clone(this.suspendDataStore);\r\n    }\r\n\r\n    const dataAsString = this.scorm.getSuspendData();\r\n    if (dataAsString === '' || dataAsString === ' ' || dataAsString === undefined) {\r\n      return {};\r\n    }\r\n\r\n    const dataAsJSON = JSON.parse(dataAsString);\r\n    if (!isSuspendDataStoreEmpty && !this.suspendDataRestored) {\r\n      Object.assign(dataAsJSON, this.suspendDataStore);\r\n    }\r\n    return dataAsJSON;\r\n  }\r\n\r\n  getCustomState(name) {\r\n    const dataAsJSON = this.getCustomStates();\r\n    return dataAsJSON[name];\r\n  }\r\n\r\n  useTemporaryStore() {\r\n    const cfg = Adapt.config.get('_spoor');\r\n\r\n    if (!this.scorm.lmsConnected || (cfg?._isEnabled === false)) return true;\r\n    return false;\r\n  }\r\n\r\n  /**\r\n   * Returns an object with the properties:\r\n   * - id (cmi.core.student_id)\r\n   * - name (cmi.core.student_name - which is usually in the format\r\n   *    'Lastname, Firstname' or 'Firstname Lastname' - but it sometimes doesn't\r\n   *    have the space after the comma\r\n   *   )\r\n   * - firstname\r\n   * - lastname\r\n   */\r\n  getLearnerInfo() {\r\n    const id = this.scorm.getStudentId();\r\n\r\n    let name = this.scorm.getStudentName();\r\n    let firstname = '';\r\n    let lastname = '';\r\n\r\n    let hasName = (name && name !== 'undefined');\r\n    const isNameCommaSeparated = hasName && name.includes(',');\r\n    const isNameSpaceSeparated = hasName && name.includes(' ');\r\n\r\n    // Name must have either a comma or a space\r\n    hasName = hasName && (isNameCommaSeparated || isNameSpaceSeparated);\r\n\r\n    if (!hasName) {\r\n      console.log('SPOOR: LMS learner_name not in \\'lastname, firstname\\' or \\'firstname lastname\\' format');\r\n      return { id, name, firstname, lastname };\r\n    }\r\n\r\n    const separator = isNameCommaSeparated ? ',' : ' ';\r\n    const nameParts = name.split(separator);\r\n    if (isNameCommaSeparated) {\r\n      // Assume lastname appears before the comma\r\n      nameParts.reverse();\r\n    }\r\n    [ firstname, lastname ] = nameParts.map(part => part.trim());\r\n    name = `${firstname} ${lastname}`;\r\n    return { id, name, firstname, lastname };\r\n  }\r\n\r\n}\r\n","import Adapt from 'core/js/adapt';\r\nimport ScormWrapper from './scorm/wrapper';\r\nimport StatefulSession from './adapt-stateful-session';\r\nimport OfflineStorage from './adapt-offlineStorage-scorm';\r\nimport offlineStorage from 'core/js/offlineStorage';\r\n\r\nclass Spoor extends Backbone.Controller {\r\n\r\n  initialize() {\r\n    this.config = null;\r\n    this.scorm = ScormWrapper.getInstance();\r\n    this.listenToOnce(Adapt, 'offlineStorage:prepare', this._prepare);\r\n  }\r\n\r\n  _prepare() {\r\n    this.config = Adapt.config.get('_spoor');\r\n    if (!this.isEnabled) {\r\n      offlineStorage.setReadyStatus();\r\n      return;\r\n    }\r\n    this.statefulSession = new StatefulSession();\r\n    this.offlineStorage = new OfflineStorage(this.statefulSession);\r\n    // force offlineStorage-scorm to initialise suspendDataStore - this allows\r\n    // us to do things like store the user's chosen language before the rest\r\n    // of the course data loads\r\n    offlineStorage.get();\r\n    offlineStorage.setReadyStatus();\r\n    // setup debug window keyboard shortcut\r\n    require(['libraries/jquery.keycombo'], () => {\r\n      // listen for user holding 'd', 'e', 'v' keys together\r\n      $.onKeyCombo([68, 69, 86], () => {\r\n        Adapt.spoor.scorm.showDebugWindow();\r\n      });\r\n    });\r\n  }\r\n\r\n  get isEnabled() {\r\n    return (this.config && this.config._isEnabled);\r\n  }\r\n\r\n}\r\n\r\nAdapt.spoor = new Spoor();\r\n\r\nexport default Adapt.spoor;\r\n","import Adapt from 'core/js/adapt';\r\nimport components from 'core/js/components';\r\nimport data from 'core/js/data';\r\nimport logging from 'core/js/logging';\r\nimport ContentObjectModel from 'core/js/models/contentObjectModel';\r\nimport CourseModel from 'core/js/models/courseModel';\r\n\r\n/**\r\n * Utility function for applying deep defaults\r\n * @param {Object} original\r\n * @param  {...Object} defaultObjects\r\n * @returns {Object} Returns original\r\n */\r\nexport function _deepDefaults(original, ...defaultObjects) {\r\n  defaultObjects.reverse();\r\n  defaultObjects.forEach(defaults => {\r\n    const keyValuePairs = Object.entries(defaults);\r\n    keyValuePairs.forEach(([ key, defaultValue ]) => {\r\n      const isRecursiveObject = (typeof defaultValue === 'object' && !Array.isArray(defaultValue) && defaultValue !== null);\r\n      if (isRecursiveObject) {\r\n        original[key] = _deepDefaults(original[key] || {}, defaultValue);\r\n        return;\r\n      }\r\n      const isValueAlreadySet = Object.prototype.hasOwnProperty.call(original, key);\r\n      if (isValueAlreadySet) return;\r\n      original[key] = defaultValue;\r\n    });\r\n  });\r\n  return original;\r\n}\r\n\r\nexport const configDefaults = {\r\n  _isEnabled: false,\r\n  _isInherited: false,\r\n  _autoScroll: true,\r\n  _scrollTo: '@block +1',\r\n  _onChildren: false,\r\n  _button: {\r\n    _isEnabled: true,\r\n    _isFullWidth: true,\r\n    _autoHide: false,\r\n    _hasIcon: false,\r\n    _styleBeforeCompletion: 'hidden',\r\n    _styleAfterClick: 'hidden',\r\n    _component: 'trickle-button',\r\n    _className: '',\r\n    text: 'Continue',\r\n    ariaLabel: '',\r\n    startText: '',\r\n    startAriaLabel: '',\r\n    finalText: '',\r\n    finalAriaLabel: ''\r\n  },\r\n  _stepLocking: {\r\n    _isEnabled: true,\r\n    _isCompletionRequired: true,\r\n    _isLockedOnRevisit: false\r\n  }\r\n};\r\n\r\n/**\r\n * @param {Backbone.Model} model\r\n * @returns {Boolean}\r\n */\r\nexport function isModelArticleWithOnChildren(model) {\r\n  const type = model.get('_type');\r\n  const trickleConfig = model.get('_trickle');\r\n  return (type === 'article' && trickleConfig?._onChildren !== false);\r\n}\r\n\r\n/**\r\n * @param {Backbone.Model} model\r\n * @returns {Boolean}\r\n */\r\nexport function isModelBlockWithArticleNotChildren(model) {\r\n  const type = model.get('_type');\r\n  const parentTrickleConfig = model.getParent()?.get('_trickle');\r\n  return (type === 'block' && parentTrickleConfig?._isEnabled === true && parentTrickleConfig?._onChildren === false);\r\n}\r\n\r\n/**\r\n * Get the default trickle configuration for the given model\r\n * @param {Backbone.Model} model\r\n */\r\nexport function getModelConfigDefaults(model) {\r\n  const type = model.get('_type');\r\n  const config = {};\r\n  // Setup default legacy article behaviour, onChildren === isArticle if omitted\r\n  _deepDefaults(config, configDefaults, {\r\n    _onChildren: (type === 'article')\r\n  });\r\n  // Default startText and finalText when _onChildren: true\r\n  if (config._onChildren) {\r\n    config._button.startText = config._button.startText ?? 'Begin';\r\n    config._button.startAriaLabel = config._button.startAriaLabel ?? '';\r\n    config._button.finalText = config._button.finalText ?? 'Finish';\r\n    config._button.finalAriaLabel = config._button.finalAriaLabel ?? '';\r\n  }\r\n  // Force step locking for _isFullWidth buttons\r\n  if (config._button._isFullWidth) {\r\n    config._stepLocking._isEnabled = true;\r\n  }\r\n  return config;\r\n}\r\n\r\n/**\r\n * Returns an array of models from which to derive a trickle config or null\r\n * @param {Backbone.Model} configModel\r\n * @returns {[Backbone.Model]|null}\r\n */\r\nexport function getModelInheritanceChain(configModel) {\r\n  if (!data.isReady) throw new Error('Trickle cannot resolve inheritance chains until data is ready');\r\n  const type = configModel.get('_type');\r\n  if (type === 'block') {\r\n    const parentModel = configModel.getParent();\r\n    const parentConfig = parentModel.get('_trickle');\r\n    const blockConfig = configModel.get('_trickle');\r\n    const isParentEnabledNotOnChildren = (parentConfig?._isEnabled && parentConfig._onChildren === false);\r\n    const isNoChildConfig = (!blockConfig?._isEnabled);\r\n    if (isParentEnabledNotOnChildren && isNoChildConfig) {\r\n      return null;\r\n    }\r\n    return [ configModel, parentModel ].filter(ancestor => {\r\n      const config = ancestor.get('_trickle');\r\n      // Remove models with no config and models which explicitly require inheritance\r\n      return (config && !config._isInherited);\r\n    });\r\n  }\r\n  if (type === 'article') {\r\n    return [ configModel ];\r\n  }\r\n  return null;\r\n};\r\n\r\n/**\r\n * Returns the derived trickle configuration for the given model\r\n * @param {Backbone.Model} model\r\n * @returns {Object}\r\n */\r\nexport function getModelConfig(model) {\r\n  const inheritance = getModelInheritanceChain(model);\r\n  if (!inheritance?.length || isModelArticleWithOnChildren(model) || isModelBlockWithArticleNotChildren(model)) return null;\r\n  const config = $.extend(true, {}, ...inheritance.reverse().map((inheritModel, index, arr) => {\r\n    const isLast = (index === arr.length - 1);\r\n    const defaults = isLast ? getModelConfigDefaults(inheritModel) : null;\r\n    return $.extend(true, {}, defaults, inheritModel.get('_trickle'));\r\n  }));\r\n  if (!config._isEnabled) return null;\r\n  return config;\r\n}\r\n\r\n/**\r\n * Returns the first model in the inheritance chain with _onChildren: true\r\n * @param {Backbone.Model} model\r\n * @returns {Backbone.Model}\r\n */\r\nexport function getModelContainer(model) {\r\n  const inheritance = getModelInheritanceChain(model);\r\n  return inheritance?.find(inheritModel => {\r\n    const defaults = getModelConfigDefaults(inheritModel);\r\n    const config = $.extend(true, {}, defaults, inheritModel.get('_trickle'));\r\n    return config._onChildren;\r\n  });\r\n}\r\n\r\n/**\r\n * Fetch the defined or default completion attribute on which trickle should\r\n * listen for completion\r\n * @return {string}\r\n */\r\nexport function getCompletionAttribute(model = null) {\r\n  return getModelConfig(model)?._completionAttribute || Adapt.config.get('_trickle')?._completionAttribute || '_isComplete';\r\n}\r\n\r\n/**\r\n * Reapply trickle locks if the completion attribute has changed on the given model\r\n * @param {Backbone.Model} model\r\n */\r\nexport function checkApplyLocks(model) {\r\n  if (!data.isReady) return;\r\n  const completionAttribute = getCompletionAttribute(model);\r\n  const hasCompletionChanged = Object.prototype.hasOwnProperty.call(model.changed, completionAttribute);\r\n  const hasAvailabilityChanged = Object.prototype.hasOwnProperty.call(model.changed, '_isAvailable');\r\n  if (!hasCompletionChanged && !hasAvailabilityChanged) return;\r\n  // Apply the locks lazily\r\n  debouncedApplyLocks();\r\n}\r\n\r\n/**\r\n * Calculates and applies the new locking state for each sub-page model according\r\n * to each trickle configuration\r\n */\r\nexport function applyLocks() {\r\n  if (!data.isReady) return;\r\n  const locks = {};\r\n  const modelsById = {};\r\n  // Fetch the component model from the store incase it needs overriding by another extension\r\n  const TrickleButtonModel = components.getModelClass('trickle-button');\r\n  // Check all models for trickle potential\r\n  Adapt.course.getAllDescendantModels(true).filter(model => model.get('_isAvailable')).forEach(siteModel => {\r\n    const trickleConfig = getModelConfig(siteModel);\r\n    if (!isEnabled(siteModel, { trickleConfig })) return;\r\n    const isModelLocked = isLocked(siteModel, { trickleConfig });\r\n    const id = siteModel.get('_id');\r\n    modelsById[id] = siteModel;\r\n    locks[id] = locks[id] || false;\r\n    // Apply lock to all subsequent models\r\n    const subsequentLockingModels = _getAncestorNextSiblings(siteModel);\r\n    subsequentLockingModels.forEach((model, index) => {\r\n      const id = model.get('_id');\r\n      const isButtonModel = (model instanceof TrickleButtonModel);\r\n      // Do not stop at TrickleButtonModels\r\n      model.set('_isTrickled', !isButtonModel);\r\n      // Store the new locking state of each model in the locks variable\r\n      // Don't unlock anything that was locked in a previous group\r\n      modelsById[id] = model;\r\n      locks[id] = locks[id] || isModelLocked;\r\n      // Don't modify the children if they are managed by another locking mechanism\r\n      if (model.get('_lockType')) return;\r\n      // Cascade inherited locks through the hierarchyd\r\n      model.getAllDescendantModels().forEach(descendant => {\r\n        const descendantId = descendant.get('_id');\r\n        modelsById[descendantId] = descendant;\r\n        locks[descendantId] = locks[id];\r\n      });\r\n    });\r\n  });\r\n  // Apply only changed locking states\r\n  Object.entries(locks).forEach(([ id, isModelLocked ]) => {\r\n    const model = modelsById[id];\r\n    const wasLocked = model.get('_isLocked');\r\n    if (wasLocked === isModelLocked) return;\r\n    model.set('_isLocked', isModelLocked);\r\n  });\r\n  logTrickleState();\r\n}\r\n\r\nexport function isEnabled(model, { trickleConfig = getModelConfig(model) } = {}) {\r\n  return (trickleConfig?._isEnabled === true);\r\n}\r\n\r\nexport function isLocked(model, { trickleConfig = getModelConfig(model) } = {}) {\r\n  const isStepLocked = Boolean(trickleConfig?._stepLocking?._isEnabled);\r\n  if (!isStepLocked) return false;\r\n  const isCompletionRequired = Boolean(trickleConfig?._stepLocking?._isCompletionRequired);\r\n  const completionAttribute = getCompletionAttribute(model);\r\n  if (!isCompletionRequired) {\r\n    const TrickleModel = components.getModelClass('trickle-button');\r\n    const trickleButton = model.getAvailableChildModels().find(model => model instanceof TrickleModel);\r\n    const isTrickleButtonComplete = Boolean(trickleButton?.get(completionAttribute));\r\n    return !isTrickleButtonComplete;\r\n  }\r\n  const isModelLocked = !model?.get(completionAttribute) &&\r\n    !model?.get('_isOptional');\r\n  return isModelLocked;\r\n}\r\n\r\nexport const debouncedApplyLocks = _.debounce(applyLocks, 1);\r\n\r\n/**\r\n * Returns all of the contentobject descendant models directly subsequent to the\r\n * given model through each ancestor\r\n * If fromModel is a block; its block next siblings and article next siblings\r\n * @param {Backbone.Model} child\r\n * @returns {Array<Backbone.Model>}\r\n */\r\nexport function _getAncestorNextSiblings(fromModel) {\r\n  if (!fromModel) return [];\r\n  // Fetch all subsequent siblings\r\n  const allSiblings = fromModel.getParent().getAvailableChildModels();\r\n  const subsequentSiblings = allSiblings.slice(allSiblings.findIndex(sibling => sibling === fromModel) + 1);\r\n  // Fetch all ancestors between the page and the child\r\n  const allAncestors = fromModel.getAncestorModels();\r\n  const inPageAncestors = allAncestors.slice(0, allAncestors.findIndex(parent => parent instanceof ContentObjectModel) + 1);\r\n  // Move from the next ancestor down as we already have the parent's children (fromModel siblings)\r\n  // Collect all subsequent in-page ancestor siblings\r\n  const subsequentInPageAncestors = [];\r\n  inPageAncestors.slice(1).forEach((grandParent, previousIndex) => {\r\n    const parent = inPageAncestors[previousIndex];\r\n    const allGrandParentChildren = grandParent.getAvailableChildModels();\r\n    const subsequentAncestorSiblings = allGrandParentChildren.slice(allGrandParentChildren.findIndex(child => child === parent) + 1);\r\n    subsequentInPageAncestors.push(...subsequentAncestorSiblings);\r\n  });\r\n  // Combine and return entire set\r\n  const subsequentContentObjectDescendantModels = subsequentSiblings.concat(subsequentInPageAncestors);\r\n  return subsequentContentObjectDescendantModels;\r\n}\r\n\r\n/**\r\n * Adds trickle button components in their relevant places throughout the course\r\n */\r\nexport function addButtonComponents() {\r\n  // Fetch the component model from the store incase it needs overriding by another extension\r\n  const TrickleButtonModel = components.getModelClass('trickle-button');\r\n  let uid = 0;\r\n  data.forEach(buttonModelSite => {\r\n    if (buttonModelSite instanceof CourseModel) return;\r\n    const trickleConfig = getModelConfig(buttonModelSite);\r\n    if (!trickleConfig || !trickleConfig?._isEnabled || buttonModelSite.get('_isTrickleSiteConfigured')) return;\r\n    buttonModelSite.set('_isTrickleSiteConfigured', true);\r\n    const parentId = buttonModelSite.get('_id');\r\n    const trickleButtonModel = new TrickleButtonModel({\r\n      _id: `trickle-${uid++}`,\r\n      _type: 'component',\r\n      _component: 'trickle-button',\r\n      _parentId: parentId,\r\n      _isAvailable: true,\r\n      _layout: 'full',\r\n      _trickle: { _isEnabled: true },\r\n      _renderPosition: 'outer-append',\r\n      _isTrackable: false\r\n    });\r\n    trickleButtonModel.setupModel();\r\n    // This line would usually append a trickle button to an article or block\r\n    buttonModelSite.getChildren().add(trickleButtonModel);\r\n  });\r\n}\r\n\r\n/**\r\n * Pretty print locking state for current page\r\n */\r\nexport function logTrickleState() {\r\n  if (logging._config?._level !== 'debug') return;\r\n  if (!Adapt.parentView?.model?.isTypeGroup('page')) {\r\n    logging.debug('TRICKLE GLOBAL STATE');\r\n    Adapt.course.getAllDescendantModels(true).filter(model => model.get('_isAvailable')).forEach(model => {\r\n      const isLocked = model.get('_isLocked');\r\n      const isTrickled = model.get('_isTrickled');\r\n      logging.debug(`${' '.repeat(model.getAncestorModels().length)}${model.get('_type')} ${model.get('_id')} isLocked: ${isLocked} isTrickled: ${isTrickled}`);\r\n    });\r\n    return;\r\n  }\r\n  logging.debug('TRICKLE STATE');\r\n  Adapt.parentView.model.getAllDescendantModels(true).filter(model => model.get('_isAvailable')).forEach(model => {\r\n    const isLocked = model.get('_isLocked');\r\n    const isTrickled = model.get('_isTrickled');\r\n    logging.debug(`${' '.repeat(model.getAncestorModels().length)}${model.get('_type')} ${model.get('_id')} isLocked: ${isLocked} isTrickled: ${isTrickled}`);\r\n  });\r\n}\r\n\r\n/**\r\n * Utility functions for trickle model operations\r\n */\r\nexport default {\r\n  _deepDefaults,\r\n  configDefaults,\r\n  getModelConfigDefaults,\r\n  getModelInheritanceChain,\r\n  getModelConfig,\r\n  getModelContainer,\r\n  getCompletionAttribute,\r\n  checkApplyLocks,\r\n  applyLocks,\r\n  debouncedApplyLocks,\r\n  _getAncestorNextSiblings,\r\n  addButtonComponents,\r\n  logTrickleState\r\n};\r\n","import Adapt from 'core/js/adapt';\r\nimport wait from 'core/js/wait';\r\nimport components from 'core/js/components';\r\nimport data from 'core/js/data';\r\nimport a11y from 'core/js/a11y';\r\nimport {\r\n  checkApplyLocks,\r\n  addButtonComponents,\r\n  applyLocks,\r\n  debouncedApplyLocks,\r\n  getModelConfig,\r\n  isModelArticleWithOnChildren\r\n} from './models';\r\nimport router from 'core/js/router';\r\n\r\n/** @typedef {import('core/js/childEvent').default} ChildEvent  */\r\n\r\nclass TrickleController extends Backbone.Controller {\r\n\r\n  initialize() {\r\n    this.checkIsFinished = _.debounce(this.checkIsFinished, 1);\r\n\r\n    this.listenTo(data, {\r\n      ready: this.onDataReady\r\n    });\r\n  }\r\n\r\n   async onDataReady() {\r\n    const trickleConfig = Adapt.config.get('_trickle');\r\n    if (trickleConfig?._isEnabled === false) return;\r\n\r\n    this.setUpEventListeners();\r\n\r\n    wait.for(done => {\r\n      addButtonComponents();\r\n      applyLocks();\r\n      done();\r\n    });\r\n  }\r\n\r\n  setUpEventListeners() {\r\n    this.listenTo(data, {\r\n      // Check that the locking is accurate after any completion, this happens asynchronously\r\n      'change:_isInteractionComplete change:_isComplete change:_isAvailable add remove': checkApplyLocks,\r\n      // Check whether trickle is finished after any locking changes\r\n      'change:_isLocked': this.checkIsFinished\r\n    });\r\n\r\n    this.listenTo(Adapt, {\r\n      // Reapply locks after assessment reset, this happens asynchronously where possible\r\n      'assessments:reset': this.onAssessmentReset,\r\n      // Reset trickle's global state when changing content objects\r\n      'contentObjectView:preRender': this.reset,\r\n      // Stop rendering where necessary before a child is rendered\r\n      'view:addChild': this.onAddChildView,\r\n      // Temporarily remove trickle from the current content object\r\n      'trickle:kill': this.kill\r\n    });\r\n  }\r\n\r\n  onAssessmentReset() {\r\n    // If mid render then apply locks immediately\r\n    const isMidRender = !Adapt.parentView?.model.get('_isReady');\r\n    if (isMidRender) return applyLocks();\r\n    // Otherwise apply them lazily\r\n    debouncedApplyLocks();\r\n  }\r\n\r\n  /**\r\n   * Returns true if the current page is or was locked by trickle\r\n   */\r\n  get isStarted() {\r\n    return Boolean(Adapt.parentView?.model.get('_isTrickleStarted'));\r\n  }\r\n\r\n  set isStarted(value) {\r\n    if (!Adapt.parentView) return;\r\n    Adapt.parentView.model.set('_isTrickleStarted', value);\r\n    if (!value) return;\r\n    Adapt.trigger('trickle:started');\r\n  }\r\n\r\n  /**\r\n   * When each child view is added to its parent, check to see if trickle should\r\n   * stop the render at this child according to the locking state\r\n   * @param {ChildEvent} event\r\n   */\r\n  onAddChildView(event) {\r\n    if (this.isKilled) return;\r\n    if (event.hasRequestChild) applyLocks();\r\n    const isManagedByTrickleAndLocked = (event.model.get('_isTrickled') && event.model.get('_isLocked'));\r\n    if (!isManagedByTrickleAndLocked) return;\r\n    event.stop();\r\n  }\r\n\r\n  /**\r\n   * Returns true if the current page is locked by trickle\r\n   */\r\n  get isTrickling() {\r\n    const isTrickling = Adapt.parentView.model.getAllDescendantModels().some(model => {\r\n      return model.get('_isAvailable') && model.get('_isTrickled') && model.get('_isLocked');\r\n    });\r\n    return isTrickling;\r\n  }\r\n\r\n  /**\r\n   * Make the framework try to render the next set of children\r\n   */\r\n  async continue() {\r\n    applyLocks();\r\n    await Adapt.parentView.addChildren();\r\n    await Adapt.parentView.whenReady();\r\n  }\r\n\r\n  /**\r\n   * Scroll to the next section as defined by the trickle configuration on the\r\n   * specified model\r\n   * @param {Backbone.Model} fromModel\r\n   */\r\n  async scroll(fromModel) {\r\n    const trickleConfig = getModelConfig(fromModel);\r\n    if (!trickleConfig?._isEnabled) return false;\r\n\r\n    if (isModelArticleWithOnChildren(fromModel)) return false;\r\n\r\n    const isAutoScrollOff = !trickleConfig._autoScroll;\r\n    const hasTrickleButton = trickleConfig._button._isEnabled;\r\n    if (isAutoScrollOff && !hasTrickleButton) {\r\n      return;\r\n    }\r\n\r\n    const getScrollToId = () => {\r\n      const scrollTo = trickleConfig._scrollTo;\r\n      const firstCharacter = scrollTo.substr(0, 1);\r\n      switch (firstCharacter) {\r\n        case '@': {\r\n          // NAVIGATE BY RELATIVE TYPE\r\n          // Allows trickle to scroll to a sibling / cousin component\r\n          // relative to the current trickle item\r\n          const relativeModel = fromModel.findRelativeModel(scrollTo, {\r\n            filter: model => model.get('_isAvailable')\r\n          });\r\n          if (relativeModel === undefined) return;\r\n          return relativeModel.get('_id');\r\n        }\r\n        case '.':\r\n          // NAVIGATE BY CLASS\r\n          return scrollTo.substr(1, scrollTo.length - 1);\r\n        default:\r\n          return scrollTo;\r\n      }\r\n    };\r\n\r\n    let scrollToId = getScrollToId();\r\n    if (scrollToId === '') return;\r\n\r\n    const isDescendant = Adapt.parentView.model.getAllDescendantModels().some(model => {\r\n      return model.get('_id') === scrollToId;\r\n    });\r\n    if (!isDescendant) {\r\n      applyLocks();\r\n      // Navigate to another content object\r\n      const model = data.findById(scrollToId);\r\n      const contentObject = model.isTypeGroup('contentobject') ? model : model.findAncestor('contentobject');\r\n      await router.navigateToElement(contentObject.get('_id'));\r\n      // Recalculate the relative id after the page is ready as it may change\r\n      scrollToId = getScrollToId();\r\n      await router.navigateToElement(scrollToId);\r\n      return;\r\n    }\r\n\r\n    await Adapt.parentView.renderTo(scrollToId);\r\n\r\n    if (hasTrickleButton) {\r\n      // Only set focus if there is a trickle button - see https://github.com/adaptlearning/adapt_framework/issues/2813\r\n      a11y.focusFirst($('.' + scrollToId), { preventScroll: true });\r\n    }\r\n\r\n    if (isAutoScrollOff) return false;\r\n\r\n    const duration = trickleConfig._scrollDuration || 500;\r\n    router.navigateToElement('.' + scrollToId, { duration });\r\n  }\r\n\r\n  /**\r\n   * Returns true if the current page was locked by trickle and is now finished\r\n   */\r\n  get isFinished() {\r\n    if (!Adapt.parentView) return false;\r\n    return Boolean(!this.isStarted || Adapt.parentView.model.get('_isTrickleFinished') || this.isKilled);\r\n  }\r\n\r\n  set isFinished(value) {\r\n    if (!Adapt.parentView) return;\r\n    Adapt.parentView.model.set('_isTrickleFinished', value);\r\n    if (!value) return;\r\n    Adapt.trigger('trickle:finished');\r\n  }\r\n\r\n  checkIsFinished() {\r\n    if (!this.isStarted) return;\r\n    if (this.isKilled || this.isFinished) return;\r\n    if (this.isTrickling) return;\r\n    this.isFinished = true;\r\n  }\r\n\r\n  /**\r\n   * Turn off all trickle locking, continue rendering and set the page model state as killed\r\n   */\r\n  async kill() {\r\n    // Fetch the component model from the store incase it needs overriding by another extension\r\n    const TrickleModel = components.getModelClass('trickle-button');\r\n    this.isKilled = true;\r\n    Adapt.parentView.model.getAllDescendantModels().forEach(model => {\r\n      const isButtonModel = (model instanceof TrickleModel);\r\n      if (isButtonModel) {\r\n        model.setCompletionStatus();\r\n      }\r\n      if (!model.get('_isTrickled')) return;\r\n      model.set('_isLocked', false);\r\n    });\r\n    await this.continue();\r\n  }\r\n\r\n  /**\r\n   * Returns true if the current page was locked by trickle and is now killed\r\n   */\r\n  get isKilled() {\r\n    if (!Adapt.parentView) return false;\r\n    return !this.isStarted || Adapt.parentView.model.get('_isTrickleKilled');\r\n  }\r\n\r\n  set isKilled(value) {\r\n    if (!Adapt.parentView) return;\r\n    Adapt.parentView.model.set('_isTrickleKilled', value);\r\n    if (!value) return;\r\n    Adapt.trigger('trickle:killed');\r\n  }\r\n\r\n  /**\r\n   * Reset the page trickle state\r\n   */\r\n  reset() {\r\n    this.isKilled = false;\r\n    if (!this.isTrickling) {\r\n      this.isStarted = false;\r\n      this.isFinished = false;\r\n      return;\r\n    }\r\n    this.isStarted = true;\r\n    this.isFinished = false;\r\n  }\r\n\r\n}\r\n\r\nexport default new TrickleController();\r\n","import Adapt from 'core/js/adapt';\r\nimport a11y from 'core/js/a11y';\r\nimport ComponentView from 'core/js/views/componentView';\r\nimport controller from './controller';\r\nimport {\r\n  getModelConfig,\r\n  getCompletionAttribute\r\n} from './models';\r\n\r\n/** @typedef {import('core/js/modelEvent').default} ModelEvent  */\r\n\r\nclass TrickleButtonView extends ComponentView {\r\n\r\n  className() {\r\n    const config = getModelConfig(this.model.getParent());\r\n    return [\r\n      'trickle',\r\n      this.model.get('_id'),\r\n      config._button._component,\r\n      config._button._isFullWidth && 'is-full-width',\r\n      config._button._className\r\n    ].filter(Boolean).join(' ');\r\n  }\r\n\r\n  events() {\r\n    return {\r\n      'click .js-trickle-btn': 'onButtonClick'\r\n    };\r\n  }\r\n\r\n  initialize() {\r\n    this.openPopupCount = 0;\r\n    this.isAwaitingPopupClose = false;\r\n    this.wasButtonClicked = false;\r\n    this.model.calculateButtonText();\r\n    this.calculateButtonState();\r\n    this.setupEventListeners();\r\n    this.render();\r\n    if (!this.model.isEnabled()) {\r\n      this.setCompletionStatus();\r\n    }\r\n    _.defer(this.setReadyStatus.bind(this));\r\n  }\r\n\r\n  /**\r\n   * Taking account of open popups, recalculate the button visible and enabled states\r\n   */\r\n  calculateButtonState() {\r\n    const isDisabledByPopups = (this.openPopupCount > 0);\r\n    this.model.calculateButtonState(isDisabledByPopups, this.wasButtonClicked);\r\n  }\r\n\r\n  render() {\r\n    const data = this.model.toJSON();\r\n    data._globals = Adapt.course.get('_globals');\r\n    data._trickle = getModelConfig(this.model.getParent());\r\n    this.$el.html(Handlebars.templates[TrickleButtonView.template](data));\r\n  }\r\n\r\n  setupEventListeners() {\r\n    this.tryButtonAutoHide = this.tryButtonAutoHide.bind(this);\r\n    // Add async delay on each call to onParent complete\r\n    // to wait for autoscroll question feedback notify to appear\r\n    const onParentComplete = this.onParentComplete.bind(this);\r\n    this.onParentComplete = (...args) => _.delay(() => onParentComplete(...args), 100);\r\n    this.listenTo(Adapt.parentView, 'postRemove', this.onRemove);\r\n    this.listenTo(Adapt, 'trickle:killed', this.updateButtonState);\r\n    if (this.model.isStepUnlocked() && this.model.isFinished()) {\r\n      // Already complete, no need to listen to anything else\r\n      return;\r\n    }\r\n    this.$el.on('onscreen', this.tryButtonAutoHide);\r\n    this.listenTo(Adapt, {\r\n      'popup:opened': this.onPopupOpened,\r\n      'popup:closed': this.onPopupClosed\r\n    });\r\n    const parentModel = this.model.getParent();\r\n    const completionAttribute = getCompletionAttribute(parentModel);\r\n    this.listenTo(parentModel, {\r\n      'change:_requireCompletionOf': this.onStepUnlocked,\r\n      [`bubble:change:${completionAttribute}`]: this.onStepUnlocked,\r\n      [`change:${completionAttribute}`]: this.onParentComplete\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Keep count of the number of open popups\r\n   */\r\n  onPopupOpened() {\r\n    this.openPopupCount++;\r\n    const shouldUserInteractWithButton = (this.model.isStepUnlocked() && !this.model.isFinished());\r\n    if (!shouldUserInteractWithButton) return;\r\n    this.updateButtonState();\r\n  }\r\n\r\n  /**\r\n   * Keep count of the number of open popups\r\n   */\r\n  async onPopupClosed() {\r\n    this.openPopupCount--;\r\n    if (this.openPopupCount) return;\r\n    if (this.isAwaitingPopupClose) {\r\n      // Had completed with an open popup, perform final part of finishing\r\n      return this.finish();\r\n    }\r\n    const shouldUserInteractWithButton = (this.model.isStepUnlocked() && !this.model.isFinished());\r\n    if (!shouldUserInteractWithButton) return;\r\n    this.updateButtonState();\r\n    await Adapt.parentView.addChildren();\r\n  }\r\n\r\n  /**\r\n   * Modify the DOM according to the current button states\r\n   */\r\n  updateButtonState() {\r\n    this.calculateButtonState();\r\n    const isButtonHidden = !(this.model.get('_isButtonVisible') && !this.model.get('_isButtonAutoHidden'));\r\n    this.$('.js-trickle-btn-container').toggleClass('u-display-none', isButtonHidden);\r\n    const isButtonDisabled = this.model.get('_isButtonDisabled');\r\n    const $button = this.$('.js-trickle-btn');\r\n    const $ariaLabel = this.$('.aria-label');\r\n    a11y.toggleEnabled($button, !isButtonDisabled);\r\n    if (!isButtonDisabled) {\r\n      // move focus forward if it's on the aria-label\r\n      if (document.activeElement instanceof HTMLElement && document.activeElement.isSameNode($ariaLabel[0])) {\r\n        a11y.focusNext($ariaLabel);\r\n      }\r\n      // make label unfocusable as it is no longer needed\r\n      a11y.toggleAccessibleEnabled($ariaLabel, false);\r\n    }\r\n    const $buttonText = this.$('.js-trickle-btn-text');\r\n    const text = this.model.get('buttonText');\r\n    const ariaLabel = this.model.get('buttonAriaLabel');\r\n    $buttonText.html(text);\r\n    $button.attr('aria-label', ariaLabel);\r\n  }\r\n\r\n  /**\r\n   * Update the button state when any completion changes occur in the trickle button\r\n   * parent or descendants\r\n   * @param {ModelEvent} event\r\n   */\r\n  async onStepUnlocked(event) {\r\n    if (event.value === false) return;\r\n    // Defer to allow for a feedback notify to open\r\n    _.defer(this.updateButtonState.bind(this));\r\n  }\r\n\r\n  async onButtonClick() {\r\n    const wasComplete = this.model.get('_isComplete');\r\n    // Assuming step locking completion is required, setting this model as complete\r\n    // will cause onParentComplete to fire\r\n    this.model.setCompletionStatus();\r\n    this.wasButtonClicked = true;\r\n    const isStepLockingCompletionRequired = this.model.isStepLockingCompletionRequired();\r\n    if (isStepLockingCompletionRequired && !wasComplete) return;\r\n    // Assuming step locking completion is NOT required, continue and scroll\r\n    await this.continue();\r\n  }\r\n\r\n  /**\r\n   * Fires when all children in the button parent are complete, including the button\r\n   */\r\n  async onParentComplete(model, value) {\r\n    if (!value) return;\r\n    const parentModel = this.model.getParent();\r\n    const completionAttribute = getCompletionAttribute(parentModel);\r\n    this.stopListening(parentModel, {\r\n      [`bubble:change:${completionAttribute}`]: this.onStepUnlocked,\r\n      [`change:${completionAttribute}`]: this.onParentComplete\r\n    });\r\n    if (controller.isKilled) return;\r\n    if (this.openPopupCount > 0) {\r\n      // Has completed with an open popup, defer finish until popup closed\r\n      this.isAwaitingPopupClose = true;\r\n      return;\r\n    }\r\n    await this.finish();\r\n  }\r\n\r\n  /**\r\n   * Stop listening, update the button and continue if required\r\n   */\r\n  async finish() {\r\n    this.stopListening(Adapt, {\r\n      'popup:opened': this.onPopupOpened,\r\n      'popup:closed': this.onPopupClosed\r\n    });\r\n    this.updateButtonState();\r\n    const isStepLockingCompletionRequired = this.model.isStepLockingCompletionRequired();\r\n    if (!isStepLockingCompletionRequired) return;\r\n    // Continue and scroll only if steplocking completion is required\r\n    await this.continue();\r\n  }\r\n\r\n  /**\r\n   * Causes Adapt to attempt to render more children and scroll to the next content\r\n   * element if required\r\n   */\r\n  async continue() {\r\n    const parent = this.model.getParent();\r\n    await controller.continue();\r\n    await controller.scroll(parent);\r\n  }\r\n\r\n  tryButtonAutoHide() {\r\n    if (!this.model.get('_isButtonVisible')) return;\r\n    const trickleConfig = getModelConfig(this.model.getParent());\r\n    if (!trickleConfig._button._autoHide) {\r\n      this.model.set('_isButtonAutoHidden', false);\r\n      return;\r\n    }\r\n    const measurements = this.$el.onscreen();\r\n    // This is to fix common miscalculation issues\r\n    const isJustOffscreen = (measurements.bottom > -100);\r\n    const isButtonAutoHidden = !measurements.onscreen && !isJustOffscreen;\r\n    this.model.set('_isButtonAutoHidden', isButtonAutoHidden);\r\n    this.updateButtonState();\r\n  }\r\n\r\n  onRemove() {\r\n    this.$el.off('onscreen', this.tryButtonAutoHide);\r\n    this.remove();\r\n  }\r\n\r\n}\r\n\r\nTrickleButtonView.template = 'trickle-button';\r\n\r\nexport default TrickleButtonView;\r\n","import controller from './controller';\r\nimport ComponentModel from 'core/js/models/componentModel';\r\nimport {\r\n  getModelContainer,\r\n  getModelConfig,\r\n  getCompletionAttribute,\r\n  applyLocks\r\n} from './models';\r\n\r\nexport default class TrickleButtonModel extends ComponentModel {\r\n\r\n  init() {\r\n    super.init();\r\n    if (!this.isStepComplete()) return;\r\n    this.setCompletionStatus();\r\n  }\r\n\r\n  /**\r\n   * @returns {boolean} true if the button is enabled in its trickle configuration\r\n   */\r\n  isEnabled() {\r\n    const trickleConfig = getModelConfig(this.getParent());\r\n    const isEnabled = trickleConfig._isEnabled && trickleConfig._button?._isEnabled;\r\n    return isEnabled;\r\n  }\r\n\r\n  /**\r\n   * @return {boolean} true if page truncation (step locking) is active\r\n   */\r\n  isStepLocking() {\r\n    const config = getModelConfig(this.getParent());\r\n    const isStepLocking = config._stepLocking?._isEnabled;\r\n    return isStepLocking;\r\n  }\r\n\r\n  /**\r\n   * @return {boolean} true if completion is required to unlock this step\r\n   */\r\n  isStepLockingCompletionRequired() {\r\n    const config = getModelConfig(this.getParent());\r\n    const isStepLockingCompletionRequired = config._stepLocking &&\r\n      config._stepLocking._isEnabled &&\r\n      config._stepLocking._isCompletionRequired;\r\n    return isStepLockingCompletionRequired;\r\n  }\r\n\r\n  /**\r\n   * @returns {boolean} true if all available siblings are complete, optional or not available\r\n   */\r\n  isStepUnlocked() {\r\n    const parentModel = this.getParent();\r\n    const completionAttribute = getCompletionAttribute(parentModel);\r\n    // Check if completion is blocked by another extension\r\n    const isCompletionBlocked = (parentModel.get('_requireCompletionOf') === Number.POSITIVE_INFINITY);\r\n    if (isCompletionBlocked) return;\r\n    return this.getSiblings().every(sibling => {\r\n      if (sibling === this) {\r\n        return true;\r\n      }\r\n      return sibling.get(completionAttribute) ||\r\n        sibling.get('_isOptional') ||\r\n        !sibling.get('_isAvailable');\r\n    });\r\n  }\r\n\r\n  /**\r\n   * @returns {boolean} true if the parent container is already complete\r\n   */\r\n  isStepComplete() {\r\n    const parentModel = this.getParent();\r\n    const completionAttribute = getCompletionAttribute(parentModel);\r\n    const isParentComplete = parentModel.get(completionAttribute);\r\n    return isParentComplete;\r\n  }\r\n\r\n  /**\r\n   * @returns {boolean} true if this button should always be locked on revisit\r\n   */\r\n  isStepLockedOnRevisit() {\r\n    const trickleConfig = getModelConfig(this.getParent());\r\n    return Boolean(trickleConfig._stepLocking._isLockedOnRevisit);\r\n  }\r\n\r\n  /**\r\n   * @return {boolean} true if completion is not required or if completion has been fulfilled\r\n   * and the button has been clicked\r\n   */\r\n  isFinished() {\r\n    const isStepUnlocked = this.isStepUnlocked();\r\n    const isStepLockingCompletionRequired = this.isStepLockingCompletionRequired();\r\n    const isButtonComplete = this.get('_isComplete');\r\n    const isFinished = ((isStepUnlocked || !isStepLockingCompletionRequired) && isButtonComplete);\r\n    return isFinished;\r\n  }\r\n\r\n  isLastInContentObject() {\r\n    const contentObject = this.findAncestor('contentobject');\r\n    const allDescendants = contentObject.getAllDescendantModels(true);\r\n    const lastDescendant = allDescendants[allDescendants.length - 1];\r\n    return (this === lastDescendant);\r\n  }\r\n\r\n  /**\r\n   * Apply start and final text amongst the current siblings\r\n   * Siblings in assessments can be randomised so this must be derived at runtime\r\n   */\r\n  calculateButtonText() {\r\n    const parentModel = this.getParent();\r\n    const trickleConfig = getModelConfig(parentModel);\r\n    let isStart = false;\r\n    let isFinal = false;\r\n    if (trickleConfig._onChildren) {\r\n      const parentId = parentModel.get('_id');\r\n      const trickleParent = getModelContainer(parentModel);\r\n      const trickleSiblings = trickleParent.getAllDescendantModels(true).filter(model => {\r\n        return model.get('_isAvailable') && model.get('_isTrickled');\r\n      });\r\n      const index = trickleSiblings.findIndex(model => model.get('_id') === parentId);\r\n      isStart = (index === 0);\r\n      isFinal = (index === trickleSiblings.length - 1 && !trickleParent.get('_canRequestChild'));\r\n    }\r\n    const text = (isStart && trickleConfig._button.startText) ?\r\n      trickleConfig._button.startText :\r\n      (isFinal && trickleConfig._button.finalText) ?\r\n        trickleConfig._button.finalText :\r\n        trickleConfig._button.text;\r\n    const ariaLabel = (isStart && trickleConfig._button.startAriaLabel) ?\r\n      trickleConfig._button.startAriaLabel :\r\n      (isFinal && trickleConfig._button.finalAriaLabel) ?\r\n        trickleConfig._button.finalAriaLabel :\r\n        trickleConfig._button.ariaLabel;\r\n    this.set({\r\n      buttonText: text,\r\n      buttonAriaLabel: ariaLabel\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Will reset this button if the step has been unlocked and should be relocked\r\n   * on revisit\r\n   */\r\n  checkIfResetOnRevisit() {\r\n    if (this.isFinished() && !this.isStepLockedOnRevisit()) return;\r\n    this.set({\r\n      _isComplete: false,\r\n      _isInteractionComplete: false\r\n    });\r\n    applyLocks();\r\n  }\r\n\r\n  /**\r\n   * Calculate the current button visible and enabled states\r\n   * @param {boolean} isButtonDisableForced Set to true to signify that the button must not be enabled\r\n   * @param {boolean} isButtonHiddenForced Set to true to signify that the button must not be visible\r\n   */\r\n  calculateButtonState(isButtonDisableForced = false, isButtonHiddenForced = false) {\r\n    if (!this.isEnabled()) {\r\n      this.set({\r\n        _isButtonVisible: false,\r\n        _isButtonDisabled: !this.isStepUnlocked()\r\n      });\r\n      return;\r\n    };\r\n\r\n    const trickleConfig = getModelConfig(this.getParent());\r\n    if (this.isLastInContentObject() && trickleConfig._button._showEndOfPage === false) {\r\n      return this.set({\r\n        _isButtonVisible: false,\r\n        _isButtonDisabled: true\r\n      });\r\n    }\r\n\r\n    const isTrickleKilled = controller.isKilled;\r\n    const isStepUnlocked = this.isStepUnlocked() || isTrickleKilled;\r\n    const isFinished = this.isFinished() || isTrickleKilled;\r\n    const isButtonVisibleBeforeCompletion = (trickleConfig._button._styleBeforeCompletion !== 'hidden');\r\n    // Force button to be hidden after completion if _isFullWidth, otherwise absolutely positioned buttons will stack\r\n    const isButtonVisibleAfterCompletion = (trickleConfig._button._styleAfterClick !== 'hidden') && !trickleConfig._button._isFullWidth;\r\n\r\n    const isStepLockingCompletionRequired = this.isStepLockingCompletionRequired();\r\n\r\n    const isNoCompletionRequiredAndLockedVisible = (!isStepLockingCompletionRequired && !isFinished && isButtonVisibleBeforeCompletion);\r\n    const isNoCompletionRequiredAndUnlockedVisible = (!isStepLockingCompletionRequired && isStepUnlocked && !isFinished);\r\n    const isNoCompletionRequiredAndFinishedVisible = (!isStepLockingCompletionRequired && isFinished && isButtonVisibleAfterCompletion);\r\n    const isStepLockedAndVisibleBeforeCompletion = (isStepLockingCompletionRequired && !isStepUnlocked && isButtonVisibleBeforeCompletion && !isButtonHiddenForced);\r\n    const isFinishedAndVisibleAfterCompletion = (isStepLockingCompletionRequired && isFinished && isButtonVisibleAfterCompletion);\r\n    const isStepUnlockedAndButtonIncomplete = (isStepLockingCompletionRequired && isStepUnlocked && !isFinished);\r\n\r\n    const isButtonVisible = isNoCompletionRequiredAndLockedVisible ||\r\n      isNoCompletionRequiredAndUnlockedVisible ||\r\n      isNoCompletionRequiredAndFinishedVisible ||\r\n      isStepLockedAndVisibleBeforeCompletion ||\r\n      isFinishedAndVisibleAfterCompletion ||\r\n      isStepUnlockedAndButtonIncomplete;\r\n\r\n    const isButtonEnabledBeforeCompletion = (trickleConfig._button._styleBeforeCompletion !== 'disabled');\r\n    const isButtonEnabledAfterCompletion = (trickleConfig._button._styleAfterClick !== 'disabled');\r\n\r\n    const isNoCompletionRequiredAndLockedEnabled = (!isStepLockingCompletionRequired && !isFinished && isButtonEnabledBeforeCompletion);\r\n    const isNoCompletionRequiredAndUnlockedEnabled = (!isStepLockingCompletionRequired && isStepUnlocked && !isFinished);\r\n    const isNoCompletionRequiredAndFinishedEnabled = (!isStepLockingCompletionRequired && isFinished && isButtonEnabledAfterCompletion);\r\n    const isStepUnlockedAndButtonIncompleteWithoutButtonDisabledForced = (isStepLockingCompletionRequired && isStepUnlockedAndButtonIncomplete && !isButtonDisableForced);\r\n    const isFinishedAndEnabledAfterCompletion = (isStepLockingCompletionRequired && isFinished && isButtonEnabledAfterCompletion);\r\n\r\n    const isButtonEnabled = isNoCompletionRequiredAndLockedEnabled ||\r\n      isNoCompletionRequiredAndUnlockedEnabled ||\r\n      isNoCompletionRequiredAndFinishedEnabled ||\r\n      isStepUnlockedAndButtonIncompleteWithoutButtonDisabledForced ||\r\n      isFinishedAndEnabledAfterCompletion ||\r\n      false;\r\n\r\n    this.set({\r\n      _isButtonVisible: isButtonVisible,\r\n      _isButtonDisabled: !isButtonEnabled\r\n    });\r\n  }\r\n\r\n}\r\n","import components from 'core/js/components';\r\nimport TrickleButtonView from './TrickleButtonView';\r\nimport TrickleButtonModel from './TrickleButtonModel';\r\n\r\nexport default components.register('trickle-button', {\r\n  view: TrickleButtonView,\r\n  model: TrickleButtonModel\r\n});\r\n","import Adapt from 'core/js/adapt';\r\nimport controller from './controller';\r\nimport models from './models';\r\nimport trickleButton from './trickleButton';\r\nimport TrickleButtonModel from './TrickleButtonModel';\r\nimport TrickleButtonView from './TrickleButtonView';\r\n\r\n// Export main API\r\nexport default (Adapt.trickle = controller);\r\n\r\n// Export everything\r\nexport {\r\n  controller,\r\n  models,\r\n  trickleButton,\r\n  TrickleButtonModel,\r\n  TrickleButtonView\r\n};\r\n","import Adapt from 'core/js/adapt';\r\n\r\nexport default class LogoView extends Backbone.View {\r\n\r\n  className() {\r\n    return 'logo '+this.model.get('_position');\r\n  }\r\n\r\n  events() {\r\n    return {\r\n      'click .js-nav-logo-btn': 'onClick'\r\n    };\r\n  }\r\n\r\n  initialize() {\r\n    this.listenTo(Adapt.config, 'change:_activeLanguage', this.remove);\r\n    this.listenTo(Adapt, 'device:changed', this.setupLogo);\r\n    this.render();\r\n  }\r\n\r\n  render() {\r\n    const data = this.model.toJSON();\r\n    const template = Handlebars.templates['logo'];\r\n    this.$el.html(template(data));\r\n\r\n    this.image = \"\";\r\n    this.title = \"\";\r\n\r\n    this.setupLogo();\r\n  }\r\n\r\n  setupLogo() {\r\n    this.deviceSize = Adapt.device.screenSize;\r\n    this.image = \"\";\r\n    this.title = \"\";\r\n\r\n    // Add image if enabled\r\n    if (this.model.get('_graphic')._isEnabled) {\r\n      // Check device size\r\n      switch (this.deviceSize) {\r\n      case \"large\":\r\n        this.image = this.model.get('_graphic')._large;\r\n        break;\r\n      case \"medium\":\r\n        this.image = this.model.get('_graphic')._medium;\r\n        break;\r\n      default:\r\n        // If \"small\"\r\n        this.image = this.model.get('_graphic')._small;\r\n      }\r\n      // Add image\r\n      this.$('img').attr('src', this.image);\r\n    }\r\n    // add title if enabled\r\n    if (this.model.get('_title')._isEnabled) {\r\n      // Check device size\r\n      switch (this.deviceSize) {\r\n      case \"large\":\r\n        this.title = this.model.get('_title').large;\r\n        break;\r\n      case \"medium\":\r\n        this.title = this.model.get('_title').medium;\r\n        break;\r\n      default:\r\n        // If \"small\"\r\n        this.title = this.model.get('_title').small;\r\n      }\r\n      // Add title\r\n      this.$('.logo__title').html(this.title);\r\n    }\r\n\r\n    // Hide elements if they are empty\r\n    if (this.image == \"\") {\r\n      this.$('.logo__image').hide();\r\n    } else {\r\n      this.$('.logo__image').show();\r\n    }\r\n\r\n    if (this.title == \"\") {\r\n      this.$('.logo__title').hide();\r\n    } else {\r\n      this.$('.logo__title').show();\r\n    }\r\n  }\r\n\r\n  onClick(event) {\r\n    const currentId = Adapt.location._currentId;\r\n    const parentId = Adapt.contentObjects.findWhere({ _id: currentId }).get('_parentId');\r\n\r\n    // Don't continue if the page is in the root of the course\r\n    if (parentId === \"course\") return;\r\n\r\n    if (this.model.get('_link')._parentPage) {\r\n      Adapt.router.navigateToParent();\r\n    }\r\n  }\r\n}\r\n","import Adapt from 'core/js/adapt';\r\nimport LogoView from './logoView';\r\n\r\nclass Logo extends Backbone.Controller {\r\n\r\n  initialize() {\r\n    this.listenToOnce(Adapt, 'app:dataReady', this.onAppDataReady);\r\n  }\r\n\r\n  onAppDataReady() {\r\n    this.listenTo(Adapt.config, 'change:_activeLanguage', this.onLangChange);\r\n\r\n    if (!Adapt.course.get('_logo')) return;\r\n\r\n    if (Adapt.course.get('_logo')._isEnabled) {\r\n      this.setupLogo();\r\n      this.setupListeners();\r\n    }\r\n  }\r\n\r\n  onLangChange() {\r\n    this.removeListeners();\r\n    this.listenToOnce(Adapt, 'app:dataReady', this.onAppDataReady);\r\n  }\r\n\r\n  setupLogo() {\r\n    this.config = Adapt.course.get('_logo');\r\n  }\r\n\r\n  setupListeners() {\r\n    this.listenTo(Adapt, 'navigationView:postRender', this.renderLogoView);\r\n  }\r\n\r\n  removeListeners() {\r\n    this.stopListening(Adapt, 'navigationView:postRender', this.renderLogoView);\r\n    this.stopListening(Adapt.config, 'change:_activeLanguage', this.onLangChange);\r\n  }\r\n\r\n  renderLogoView() {\r\n    const logoModel = new Backbone.Model(this.config);\r\n\r\n    // Check position\r\n    if (this.config._position == \"left\" || this.config._position == \"right\") {\r\n      $('.nav__inner').prepend(new LogoView({\r\n        model: logoModel\r\n      }).$el);\r\n    } else {\r\n      $('.nav__inner').append(new LogoView({\r\n        model: logoModel\r\n      }).$el);\r\n    }\r\n  }\r\n}\r\n\r\nexport default Adapt.logo = new Logo();\r\n","\r\nimport React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport { templates } from 'core/js/reactHelpers';\r\n\r\nclass ScrollTopView extends Backbone.View {\r\n\r\n  className() {\r\n    return 'scrolltop';\r\n  }\r\n\r\n  initialize() {\r\n    this.render();\r\n  }\r\n\r\n  render() {\r\n    ReactDOM.render(<templates.scrollTop {...this.model.toJSON()} />, this.el);\r\n  }\r\n\r\n};\r\n\r\nexport default ScrollTopView;\r\n","import Adapt from 'core/js/adapt';\r\nimport ScrollTopView from './ScrollTopView';\r\n\r\nclass ScrollTop extends Backbone.Controller {\r\n\r\n  initialize() {\r\n    this.listenTo(Adapt, 'pageView:postRender menuView:postRender', this.onPageRender);\r\n  }\r\n\r\n  onPageRender(view) {\r\n    if (this.scrollTop) this.scrollTop.remove();\r\n\r\n    const config = Adapt.course.get('_scrollTop');\r\n    if (!config || !config._isEnabled) return;\r\n\r\n    const model = new Backbone.Model(config);\r\n    this.scrollTop = new ScrollTopView({ model });\r\n\r\n    this.scrollTop.$el.insertAfter(view.$el);\r\n  }\r\n};\r\nexport default new ScrollTop();\r\n","define([\r\n    'core/js/adapt'\r\n], function (Adapt) {\r\n    var SplashScreenView = Backbone.View.extend({\r\n        tagName: \"div\",\r\n\r\n        // className: 'splashScreen-scroll',\r\n\r\n        events: {\r\n            'click .splashScreen-start': 'removeView'\r\n        },\r\n        initialize: function () {\r\n            this.render();\r\n        },\r\n\r\n        render: function () {\r\n            $('html').addClass('onSplashScreen');\r\n            var template = Handlebars.templates[this.constructor.template];\r\n            this.$el.html(template(this.model));\r\n        },\r\n\r\n        removeView: function () {\r\n            Adapt.offlineStorage.set('_splashScreen', true);\r\n            $('html').removeClass('onSplashScreen');\r\n            // _.delay(function () {\r\n            this.remove();\r\n            // }.bind(this), 500);\r\n        }\r\n    }, {\r\n        template: 'splashScreen'\r\n    });\r\n    return SplashScreenView;\r\n\r\n});","define([\r\n  'core/js/adapt',\r\n  './splashScreenView'\r\n], function (Adapt, SplashScreenView) {\r\n\r\n\r\n  function createDrawer() {\r\n    if (!!Adapt.offlineStorage.get('_splashScreen')) return;\r\n    var splashScreen = Adapt.course.get('_splashScreen');\r\n    if (!splashScreen || !splashScreen._isEnabled) return;\r\n    var splashScreenView = new SplashScreenView({ model: { _classes: splashScreen._classes, _title: splashScreen._title, _body: splashScreen._body, _button: splashScreen._button,_graphic:splashScreen._graphic, _images:splashScreen._images } });\r\n    $(\"body\").append(splashScreenView.$el);\r\n  }\r\n  Adapt.once('adapt:start', createDrawer);\r\n});\r\n","import AdaptView from 'core/js/views/adaptView';\r\n\r\nclass MenuItemView extends AdaptView {\r\n\r\n  attributes() {\r\n    return AdaptView.resultExtend('attributes', {\r\n      'role': 'listitem',\r\n      'aria-labelledby': this.model.get('_id') + '-heading'\r\n    }, this);\r\n  }\r\n\r\n  className() {\r\n    return [\r\n      'menu-item',\r\n      this.constructor.className,\r\n      this.model.get('_id'),\r\n      this.model.get('_classes'),\r\n      this.setVisibility(),\r\n      this.setHidden(),\r\n      (this.model.get('_isVisited') ? 'is-visited' : ''),\r\n      (this.model.get('_isComplete') ? 'is-complete' : ''),\r\n      (this.model.get('_isLocked') ? 'is-locked' : ''),\r\n      (this.model.get('_isOptional') ? 'is-optional' : '')\r\n    ].join(' ');\r\n  }\r\n\r\n  preRender() {\r\n    this.model.checkCompletionStatus();\r\n    this.model.checkInteractionCompletionStatus();\r\n  }\r\n\r\n  postRender() {\r\n    this.$el.imageready(this.setReadyStatus.bind(this));\r\n  }\r\n\r\n}\r\n\r\nMenuItemView.type = 'menuItem';\r\n\r\nexport default MenuItemView;\r\n","import ContentObjectView from 'core/js/views/contentObjectView';\r\nimport MenuItemView from 'core/js/views/menuItemView';\r\n\r\nclass MenuView extends ContentObjectView {}\r\n\r\nObject.assign(MenuView, {\r\n  /**\r\n   * TODO:\r\n   * child view here should not be fixed to the MenuItemView\r\n   * menus may currently rely on this\r\n   */\r\n  childContainer: '.js-children',\r\n  childView: MenuItemView,\r\n  type: 'menu',\r\n  template: 'menu'\r\n});\r\n\r\nexport default MenuView;\r\n","import MenuItemView from 'core/js/views/menuItemView';\r\nimport router from 'core/js/router';\r\n\r\nclass BoxMenuItemView extends MenuItemView {\r\n\r\n  className() {\r\n    return `${super.className()} boxmenu-item`;\r\n  }\r\n\r\n  events() {\r\n    return {\r\n      'click .js-btn-click': 'onClickMenuItemButton'\r\n    };\r\n  }\r\n\r\n  onClickMenuItemButton(event) {\r\n    if (event && event.preventDefault) event.preventDefault();\r\n    if (this.model.get('_isLocked')) return;\r\n    router.navigateToElement(this.model.get('_id'));\r\n  }\r\n}\r\n\r\nBoxMenuItemView.template = 'boxMenuItem';\r\n\r\nexport default BoxMenuItemView;\r\n","import MenuItemView from 'core/js/views/menuItemView';\r\nimport BoxMenuItemView from './BoxMenuItemView';\r\n\r\nclass BoxMenuGroupView extends MenuItemView {\r\n\r\n  className() {\r\n    return `${super.className()} boxmenu-group`;\r\n  }\r\n\r\n  postRender() {\r\n    _.defer(this.addChildren.bind(this));\r\n    this.$el.imageready(this.setReadyStatus.bind(this));\r\n    this.$el.parents('.boxmenu__item-container').addClass('has-groups');\r\n  }\r\n}\r\n\r\nBoxMenuGroupView.template = 'boxMenuGroup';\r\nBoxMenuGroupView.childContainer = '.js-group-children';\r\nBoxMenuGroupView.childView = BoxMenuItemView;\r\n\r\nexport default BoxMenuGroupView;\r\n","import Adapt from 'core/js/adapt';\r\nimport MenuView from 'core/js/views/menuView';\r\nimport BoxMenuItemView from './BoxMenuItemView';\r\nimport BoxMenuGroupView from './BoxMenuGroupView';\r\n\r\nclass BoxMenuView extends MenuView {\r\n\r\n  className() {\r\n    return `${super.className()} boxmenu`;\r\n  }\r\n\r\n  initialize() {\r\n    super.initialize();\r\n    this.setStyles();\r\n\r\n    this.listenTo(Adapt, 'device:changed', this.onDeviceResize);\r\n  }\r\n\r\n  onDeviceResize() {\r\n    this.setStyles();\r\n  }\r\n\r\n  addChildren() {\r\n    let nthChild = 0;\r\n    const models = this.model.getChildren().models;\r\n    const childViews = [];\r\n    models.forEach(model => {\r\n      if (!model.get('_isAvailable')) return;\r\n\r\n      if (model.get('_isHidden')) {\r\n        model.set('_isReady', true);\r\n        return;\r\n      }\r\n\r\n      nthChild++;\r\n      model.set('_nthChild', nthChild);\r\n\r\n      const ChildView = (model.get('_type') === 'menu' && model.get('_boxMenu') && model.get('_boxMenu')._renderAsGroup) ?\r\n        BoxMenuGroupView :\r\n        BoxMenuItemView;\r\n\r\n      const $parentContainer = this.$(this.constructor.childContainer);\r\n      const childView = new ChildView({ model });\r\n\r\n      childViews.push(childView);\r\n\r\n      $parentContainer.append(childView.$el);\r\n    });\r\n\r\n    this.setChildViews(childViews);\r\n  }\r\n\r\n  setStyles() {\r\n    this.addBackgroundLayer();\r\n    this.setBackgroundImage();\r\n    this.setBackgroundStyles();\r\n    this.processHeader();\r\n  }\r\n\r\n  addBackgroundLayer() {\r\n    if (this.$el.find(' > .background').length) return;\r\n    this.$background = $('<div class=\"background\" aria-hidden=\"true\"></div>')\r\n      .prependTo(this.$el);\r\n  }\r\n\r\n  setBackgroundImage() {\r\n    const config = this.model.get('_boxMenu');\r\n    const backgroundImages = config?._backgroundImage;\r\n    if (!backgroundImages) return;\r\n    const backgroundImage = backgroundImages[`_${Adapt.device.screenSize}`] ?? backgroundImages._small;\r\n    this.$el.toggleClass('has-bg-image', Boolean(backgroundImage));\r\n    this.$background\r\n      .css('background-image', backgroundImage ? 'url(' + backgroundImage + ')' : '');\r\n  }\r\n\r\n  setBackgroundStyles() {\r\n    const config = this.model.get('_boxMenu');\r\n    const styles = config?._backgroundStyles;\r\n    if (!styles) return;\r\n    this.$background.css({\r\n      'background-repeat': styles._backgroundRepeat,\r\n      'background-size': styles._backgroundSize,\r\n      'background-position': styles._backgroundPosition\r\n    });\r\n  }\r\n\r\n  processHeader() {\r\n    const config = this.model.get('_boxMenu');\r\n    const header = config?._menuHeader;\r\n    if (!header) return;\r\n    const $header = this.$('.menu__header');\r\n    this.addHeaderBackgroundLayer($header);\r\n    this.setHeaderBackgroundImage(header, $header);\r\n    this.setHeaderBackgroundStyles(header, $header);\r\n    this.setHeaderMinimumHeight(header, $header);\r\n  }\r\n\r\n  addHeaderBackgroundLayer($header) {\r\n    if ($header.find(' > .background').length) return;\r\n    this.$headerBackground = $('<div class=\"background\" aria-hidden=\"true\"></div>')\r\n      .prependTo($header);\r\n  }\r\n\r\n  setHeaderBackgroundImage(config, $header) {\r\n    const backgroundImages = config._backgroundImage;\r\n    if (!backgroundImages) return;\r\n    const backgroundImage = backgroundImages[`_${Adapt.device.screenSize}`] ?? backgroundImages._small;\r\n    $header.toggleClass('has-bg-image', Boolean(backgroundImage));\r\n    this.$headerBackground.css('background-image', backgroundImage ? 'url(' + backgroundImage + ')' : '');\r\n  }\r\n\r\n  setHeaderBackgroundStyles(config, $header) {\r\n    const styles = config._backgroundStyles;\r\n    if (!styles) return;\r\n    this.$headerBackground.css({\r\n      'background-repeat': styles._backgroundRepeat,\r\n      'background-size': styles._backgroundSize,\r\n      'background-position': styles._backgroundPosition\r\n    });\r\n  }\r\n\r\n  setHeaderMinimumHeight(config, $header) {\r\n    const minimumHeights = config._minimumHeights;\r\n    if (!minimumHeights) return;\r\n    const minimumHeight = minimumHeights[`_${Adapt.device.screenSize}`] ?? minimumHeights._small;\r\n    $header\r\n      .toggleClass('has-min-height', Boolean(minimumHeight))\r\n      .css('min-height', minimumHeight ? minimumHeight + 'px' : '');\r\n  }\r\n\r\n}\r\n\r\nBoxMenuView.template = 'boxMenu';\r\n\r\nexport default BoxMenuView;\r\n","import Adapt from 'core/js/adapt';\r\nimport MenuModel from 'core/js/models/menuModel';\r\nimport BoxMenuView from './BoxMenuView';\r\n\r\n// Use as default \"_type\": \"course\" or \"_type\": \"menu\" view.\r\n// Note: This is necessary to maintain legacy behaviour in the AAT where\r\n// only one menu is usable per course and the course / menu is assumed to be\r\n// a core model and use the only installed MenuView.\r\nAdapt.register('course menu', {\r\n  view: BoxMenuView\r\n});\r\n\r\n// Use for \"_component\": \"boxMenu\", or \"_view\": \"boxMenu\" and \"_model\": \"boxMenu\"\r\nAdapt.register('boxMenu', {\r\n  view: BoxMenuView,\r\n  model: MenuModel.extend({})\r\n});\r\n","import Adapt from 'core/js/adapt';\r\nimport device from 'core/js/device';\r\n\r\nexport default class ThemeView extends Backbone.View {\r\n\r\n  className() {}\r\n\r\n  initialize() {\r\n    this.setStyles();\r\n\r\n    this.listenTo(Adapt, {\r\n      'device:changed': this.onDeviceResize,\r\n      remove: this.remove\r\n    });\r\n  }\r\n\r\n  onDeviceResize() {\r\n    this.setStyles();\r\n  }\r\n\r\n  remove() {\r\n    super.remove();\r\n\r\n    this.onRemove();\r\n  }\r\n\r\n  setStyles() {\r\n    this.setClasses();\r\n    this.addBackgroundLayer();\r\n    this.setBackgroundImage();\r\n    this.setBackgroundStyles();\r\n    this.setMinimumHeight();\r\n    this.setResponsiveClasses();\r\n    this.setCustomStyles();\r\n  }\r\n\r\n  setClasses() {\r\n    this.$el.addClass(this.className());\r\n  }\r\n\r\n  addBackgroundLayer() {\r\n    if (this.$el.find(' > .background').length) return;\r\n    this.$background = $('<div class=\"background\" aria-hidden=\"true\"></div>')\r\n      .prependTo(this.$el);\r\n  }\r\n\r\n  setBackgroundImage() {\r\n    const backgroundImages = this.model.get('_backgroundImage');\r\n\r\n    if (!backgroundImages) return;\r\n\r\n    let backgroundImage;\r\n\r\n    switch (device.screenSize) {\r\n      case 'large':\r\n        backgroundImage = backgroundImages._large;\r\n        break;\r\n      case 'medium':\r\n        backgroundImage = backgroundImages._medium;\r\n        break;\r\n      default:\r\n        backgroundImage = backgroundImages._small;\r\n    }\r\n\r\n    if (backgroundImage) {\r\n      this.$el.addClass('has-bg-image');\r\n      this.$background\r\n        .css('background-image', 'url(' + backgroundImage + ')');\r\n      return;\r\n    }\r\n\r\n    this.$el.removeClass('has-bg-image');\r\n    this.$background.css('background-image', '');\r\n  }\r\n\r\n  setBackgroundStyles() {\r\n    const styles = this.model.get('_backgroundStyles');\r\n    if (!styles) return;\r\n    this.$background\r\n      .css({\r\n        'background-repeat': styles._backgroundRepeat,\r\n        'background-size': styles._backgroundSize,\r\n        'background-position': styles._backgroundPosition\r\n      });\r\n  }\r\n\r\n  setMinimumHeight() {\r\n    const minimumHeights = this.model.get('_minimumHeights');\r\n\r\n    if (!minimumHeights) return;\r\n\r\n    let minimumHeight;\r\n\r\n    switch (Adapt.device.screenSize) {\r\n      case 'large':\r\n        minimumHeight = minimumHeights._large;\r\n        break;\r\n      case 'medium':\r\n        minimumHeight = minimumHeights._medium;\r\n        break;\r\n      default:\r\n        minimumHeight = minimumHeights._small;\r\n    }\r\n\r\n    if (minimumHeight) {\r\n      this.$el\r\n        .addClass('has-min-height')\r\n        .css('min-height', minimumHeight + 'px');\r\n      return;\r\n    }\r\n\r\n    this.$el\r\n      .removeClass('has-min-height')\r\n      .css('min-height', '');\r\n  }\r\n\r\n  setResponsiveClasses() {\r\n    const responsiveClasses = this.model.get('_responsiveClasses');\r\n    if (!responsiveClasses) return;\r\n\r\n    this.$el\r\n      .removeClass(Object.values(responsiveClasses))\r\n      .addClass(responsiveClasses[`_${Adapt.device.screenSize}`]);\r\n  }\r\n\r\n  setCustomStyles() {}\r\n\r\n  onRemove() {}\r\n\r\n}\r\n","import ThemeView from './themeView';\r\nimport Adapt from 'core/js/adapt';\r\n\r\nexport default class ThemePageView extends ThemeView {\r\n\r\n  className() {}\r\n\r\n  setCustomStyles() {\r\n    this.processHeader();\r\n  }\r\n\r\n  processHeader() {\r\n    const header = this.model.get('_pageHeader');\r\n\r\n    if (!header) return;\r\n\r\n    const $header = this.$('.page__header');\r\n\r\n    this.addHeaderBackgroundLayer($header);\r\n    this.setHeaderBackgroundImage(header, $header);\r\n    this.setHeaderBackgroundStyles(header, $header);\r\n    this.setHeaderMinimumHeight(header, $header);\r\n  }\r\n\r\n  addHeaderBackgroundLayer($header) {\r\n    if ($header.find(' > .background').length) return;\r\n    this.$headerBackground = $('<div class=\"background\" aria-hidden=\"true\"></div>')\r\n      .prependTo($header);\r\n  }\r\n\r\n  setHeaderBackgroundImage(config, $header) {\r\n    const backgroundImages = config._backgroundImage;\r\n\r\n    if (!backgroundImages) return;\r\n\r\n    let backgroundImage;\r\n\r\n    switch (Adapt.device.screenSize) {\r\n      case 'large':\r\n        backgroundImage = backgroundImages._large;\r\n        break;\r\n      case 'medium':\r\n        backgroundImage = backgroundImages._medium;\r\n        break;\r\n      default:\r\n        backgroundImage = backgroundImages._small;\r\n    }\r\n\r\n    if (backgroundImage) {\r\n      $header.addClass('has-bg-image');\r\n      this.$headerBackground\r\n        .css('background-image', 'url(' + backgroundImage + ')');\r\n      return;\r\n    }\r\n\r\n    $header.removeClass('has-bg-image');\r\n    this.$headerBackground.css('background-image', '');\r\n  }\r\n\r\n  setHeaderBackgroundStyles(config, $header) {\r\n    const styles = config._backgroundStyles;\r\n    if (!styles) return;\r\n    this.$headerBackground\r\n      .css({\r\n        'background-repeat': styles._backgroundRepeat,\r\n        'background-size': styles._backgroundSize,\r\n        'background-position': styles._backgroundPosition\r\n      });\r\n  }\r\n\r\n  setHeaderMinimumHeight(config, $header) {\r\n    const minimumHeights = config._minimumHeights;\r\n\r\n    if (!minimumHeights) return;\r\n\r\n    let minimumHeight;\r\n\r\n    switch (Adapt.device.screenSize) {\r\n      case 'large':\r\n        minimumHeight = minimumHeights._large;\r\n        break;\r\n      case 'medium':\r\n        minimumHeight = minimumHeights._medium;\r\n        break;\r\n      default:\r\n        minimumHeight = minimumHeights._small;\r\n    }\r\n\r\n    if (minimumHeight) {\r\n      $header\r\n        .addClass('has-min-height')\r\n        .css('min-height', minimumHeight + 'px');\r\n      return;\r\n    }\r\n\r\n    $header\r\n      .removeClass('has-min-height')\r\n      .css('min-height', '');\r\n  }\r\n\r\n  onRemove() {}\r\n\r\n}\r\n","import ThemeView from './themeView';\r\n\r\nexport default class ThemeArticleView extends ThemeView {\r\n\r\n  className() {}\r\n\r\n  setCustomStyles() {}\r\n\r\n  onRemove() {}\r\n\r\n}\r\n","import ThemeView from './themeView';\r\n\r\nexport default class ThemeBlockView extends ThemeView {\r\n\r\n  className() {\r\n    return this.model.get('_isDividerBlock') ? 'is-divider-block' : '';\r\n  }\r\n\r\n  setCustomStyles() {}\r\n\r\n  onRemove() {}\r\n\r\n}\r\n","import Adapt from 'core/js/adapt';\r\nimport ThemePageView from './themePageView';\r\nimport ThemeArticleView from './themeArticleView';\r\nimport ThemeBlockView from './themeBlockView';\r\nimport ThemeView from './themeView';\r\n\r\nclass Theme extends Backbone.Controller {\r\n\r\n  initialize() {\r\n    this.listenTo(Adapt, {\r\n      'app:dataReady': this.onDataReady,\r\n      'pageView:postRender articleView:postRender blockView:postRender': this.onPostRender\r\n    });\r\n  }\r\n\r\n  onDataReady() {\r\n    $('html').addClass(Adapt.course.get('_courseStyle'));\r\n  }\r\n\r\n  onPostRender(view) {\r\n    const viewModel = view.model;\r\n    const theme = viewModel.get('_vanilla');\r\n    if (!theme) return;\r\n    const model = new Backbone.Model(theme);\r\n    const el = view.$el;\r\n    switch (viewModel.get('_type')) {\r\n      case 'page':\r\n        new ThemePageView({ model, el });\r\n        break;\r\n      case 'article':\r\n        new ThemeArticleView({ model, el });\r\n        break;\r\n      case 'block':\r\n        new ThemeBlockView({ model, el });\r\n        break;\r\n      default:\r\n        new ThemeView({ model, el });\r\n    }\r\n  }\r\n\r\n}\r\n\r\nexport default new Theme();\r\n","import Adapt from 'core/js/adapt';\r\nimport device from 'core/js/device';\r\nimport React, { useRef } from 'react';\r\nimport { prefixClasses, compile } from 'core/js/reactHelpers';\r\n\r\n/**\r\n * Content header for displayTitle, body, instruction text, etc.\r\n * instruction and mobileInstruction will switch automatically\r\n * @param {Object} props\r\n * @param {string} [props.displayTitle]\r\n * @param {string} [props.body]\r\n * @param {string} [props.instruction]\r\n * @param {string} [props.mobileInstruction]\r\n * @param {string} [props._type]\r\n * @param {string} [props._component]\r\n * @param {string} [props._disableAccessibilityState]\r\n */\r\nexport default function Header(props) {\r\n  // Create references to un-controlled view containers\r\n  const jsxHeading = useRef(null);\r\n  const {\r\n    _id,\r\n    displayTitle,\r\n    body,\r\n    instruction,\r\n    mobileInstruction,\r\n    _type,\r\n    _component,\r\n    _disableAccessibilityState,\r\n    _isA11yComponentDescriptionEnabled,\r\n    classNamePrefixes = [\r\n      _type && _type.toLowerCase(),\r\n      _component && _component.toLowerCase()\r\n    ].filter(Boolean)\r\n  } = props;\r\n  const sizedInstruction = (mobileInstruction && device.screenSize !== 'large') ?\r\n    mobileInstruction :\r\n    instruction;\r\n  const _globals = Adapt.course.get('_globals');\r\n  const ariaRegion = _globals?._components?.[`_${_component}`]?.ariaRegion;\r\n  const isSet = (displayTitle || body || sizedInstruction);\r\n  if (!isSet && _isA11yComponentDescriptionEnabled && ariaRegion) {\r\n    // If no title, displaytitle, body or instruction is specified\r\n    // Output only the component description\r\n    return (\r\n      <div className=\"aria-label\" dangerouslySetInnerHTML={{ __html: compile(ariaRegion) }}>\r\n      </div>\r\n    );\r\n  }\r\n  if (!isSet) return null;\r\n  return (\r\n    <div id={`${_id}-header`} className={prefixClasses(classNamePrefixes, ['__header'])}>\r\n      <div className={prefixClasses(classNamePrefixes, ['__header-inner'])}>\r\n        {displayTitle &&\r\n        <div className={prefixClasses(classNamePrefixes, ['__title'])}>\r\n\r\n          {!_disableAccessibilityState &&\r\n          <div className=\"js-heading\" ref={jsxHeading}></div>\r\n          }\r\n\r\n          <div className={prefixClasses(classNamePrefixes, ['__title-inner'])} aria-hidden={!_disableAccessibilityState} dangerouslySetInnerHTML={{ __html: compile(displayTitle, props) }} >\r\n          </div>\r\n\r\n        </div>\r\n        }\r\n\r\n        {_isA11yComponentDescriptionEnabled && ariaRegion &&\r\n        <div className=\"aria-label\" dangerouslySetInnerHTML={{ __html: compile(ariaRegion, props) }}>\r\n        </div>\r\n        }\r\n\r\n        {body &&\r\n        <div className={prefixClasses(classNamePrefixes, ['__body'])}>\r\n          <div className={prefixClasses(classNamePrefixes, ['__body-inner'])} dangerouslySetInnerHTML={{ __html: compile(body, props) }}>\r\n          </div>\r\n        </div>\r\n        }\r\n\r\n        {sizedInstruction &&\r\n        <div className={prefixClasses(classNamePrefixes, ['__instruction'])}>\r\n          <div className={prefixClasses(classNamePrefixes, ['__instruction-inner'])} dangerouslySetInnerHTML={{ __html: compile(sizedInstruction, props) }}>\r\n          </div>\r\n        </div>\r\n        }\r\n\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n","import device from 'core/js/device';\r\nimport a11y from 'core/js/a11y';\r\nimport React from 'react';\r\nimport { html, classes, prefixClasses } from 'core/js/reactHelpers';\r\n\r\n/**\r\n * Size switching content image\r\n * @param {Object} props\r\n * @param {Array} props.classNamePrefixes\r\n * @param {Array} [props.attributionClassNamePrefixes]\r\n */\r\nexport default function Image(props) {\r\n  const hasMediumSetting = (Object.prototype.hasOwnProperty.call(props, '_medium') || Object.prototype.hasOwnProperty.call(props, 'medium'));\r\n  const screenSize = hasMediumSetting\r\n    ? device.screenSize\r\n    : (device.screenSize === 'large' ? 'large' : 'small');\r\n  const src = (\r\n    props[`_${screenSize}`] ||\r\n    props[`${screenSize}`] ||\r\n    props._src ||\r\n    props.src\r\n  );\r\n  const hasSource = Boolean(src);\r\n  if (!hasSource) return null;\r\n  const attributionClassNamePrefixes = (props.attributionClassNamePrefixes || props.classNamePrefixes);\r\n  return (\r\n    <span\r\n      id={props.id}\r\n      className={classes([\r\n        prefixClasses(props.classNamePrefixes, ['__image-container']),\r\n        props.classes,\r\n        props.attribution && 'has-attribution'\r\n      ])}\r\n    >\r\n\r\n      <img\r\n        className={prefixClasses(props.classNamePrefixes, ['__image'])}\r\n        src={src}\r\n        aria-label={a11y.normalize(props.alt)}\r\n        aria-hidden={!props.alt}\r\n        loading='eager'\r\n        aria-describedby={props.longdescription ? props.longDescriptionId : undefined}\r\n      />\r\n\r\n      {props.attribution &&\r\n      <span className={prefixClasses(attributionClassNamePrefixes, ['__attribution'])}>\r\n        <span className={prefixClasses(attributionClassNamePrefixes, ['__attribution-inner'])}>\r\n          {html(props.attribution)}\r\n        </span>\r\n      </span>\r\n      }\r\n\r\n    </span>\r\n  );\r\n}\r\n","import Adapt from 'core/js/adapt';\r\nimport React from 'react';\r\nimport { html, classes, compile, templates } from 'core/js/reactHelpers';\r\n\r\nexport default function Cards (props) {\r\n  const {\r\n    _hasClickButton,\r\n    _columns,\r\n    _itemMinHeight,\r\n    onKeyDown,\r\n    onClick\r\n  } = props;\r\n  const hasColumns = _columns > 1;\r\n  const hasMinHeight = Number(_itemMinHeight) > 0;\r\n  return (\r\n\r\n    <div className=\"component__inner cards__inner\">\r\n\r\n      <templates.header {...props} />\r\n\r\n      <div className={classes([\r\n        'component__widget', 'cards__widget',\r\n        hasColumns && 'has-columns'])}>\r\n\r\n        {props._items.map(({ title, body, description, _graphic, _classes, _hasAction, _buttons, _index, _isVisited, _isActive, _isAnimated }) =>\r\n          <div\r\n\r\n            className={classes([\r\n              'cards__item',\r\n              _isVisited && 'is-visited',\r\n              _isActive && 'is-active',\r\n              _isAnimated && 'is-animating',\r\n              _graphic.src && 'has-image',\r\n              !_hasClickButton && 'is-clickable',\r\n              !_hasClickButton && _hasAction && 'has-action',\r\n              _classes\r\n            ])}\r\n            key={_index}\r\n            data-index={_index}\r\n            onClick={!_hasClickButton && _hasAction ? onClick : null}\r\n            style={(hasColumns && Adapt.device.screenSize === 'large' && { width: `${100 / _columns}%` }) || null }\r\n          >\r\n            <div className=\"cards__item-inner\" style={(hasMinHeight && { minHeight: _itemMinHeight + 'px' }) || null}>\r\n              <div className=\"cards__item-container\" >\r\n                { _graphic.src &&\r\n              <templates.image {..._graphic}\r\n                classNamePrefixes={['cards__item']}\r\n                attributionClassNamePrefixes={['cards']}\r\n              />\r\n                }\r\n                {title &&\r\n              <div className=\"cards__item-title\">\r\n                {html(compile(title))}\r\n              </div>\r\n                }\r\n                {body &&\r\n              <div className=\"cards__item-body\">\r\n                {html(compile(body))}\r\n              </div>\r\n                }\r\n              </div>\r\n\r\n              <div className=\"cards__item-toolbar\">\r\n\r\n                <div className=\"cards__item-description\">\r\n                  { description._graphic.src &&\r\n                  <templates.image {...description._graphic}\r\n                    classNamePrefixes={['cards__item-description']}\r\n                    attributionClassNamePrefixes={['cards']}\r\n                  />\r\n                  }\r\n                  {description.title &&\r\n                <div className=\"cards__item-description-title\">\r\n                  {html(compile(description.title))}\r\n                </div>\r\n                  }\r\n                  {description.body &&\r\n                <div className=\"cards__item-description-body\">\r\n                  {html(compile(description.body))}\r\n                </div>\r\n                  }\r\n                </div>\r\n\r\n                {_hasAction && _hasClickButton && <div className=\"cards__item-actions\">\r\n                  <button\r\n                    onClick={_hasClickButton ? onClick : null}\r\n                    onKeyDown={onKeyDown}\r\n                    className=\"btn-text\" aria-label={_isActive ? _buttons._close.ariaLabel : _buttons._open.ariaLabel}>\r\n                    {html(compile(_isActive ? _buttons._close.buttonText : _buttons._open.buttonText))}\r\n                  </button>\r\n                </div>\r\n                }\r\n                <div className=\"cards__item-state\">\r\n                  <div className=\"icon\"></div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        )}\r\n\r\n      </div>\r\n\r\n    </div>\r\n  );\r\n}\r\n","import Adapt from 'core/js/adapt';\r\nimport React from 'react';\r\nimport { templates, classes, html, compile } from 'core/js/reactHelpers';\r\n\r\nexport default function Choose(props) {\r\n  const ariaLabels = Adapt.course.get('_globals')._accessibility._ariaLabels;\r\n\r\n  const {\r\n    _id,\r\n    _isEnabled,\r\n    _isInteractionComplete,\r\n    _isCorrect,\r\n    _canShowMarking,\r\n    displayTitle,\r\n    body,\r\n    instruction,\r\n    onKeyPress,\r\n    onItemOptionSelect,\r\n    _isCorrectAnswerShown,\r\n    isInteractive\r\n  } = props;\r\n\r\n  const shouldShowMarking = isInteractive() && _canShowMarking;\r\n\r\n  return (\r\n    <div className='component__inner choose__inner'>\r\n      <templates.header {...props} />\r\n\r\n      <div\r\n        className={classes([\r\n          'component__widget',\r\n          'choose__widget',\r\n          !_isEnabled && 'is-disabled',\r\n          _isInteractionComplete && 'is-complete is-submitted show-user-answer',\r\n          _isCorrect && 'is-correct'\r\n        ])}\r\n        role='radiogroup'\r\n        aria-labelledby={\r\n          (displayTitle || body || instruction) && `${_id}-header`\r\n        }\r\n      >\r\n\r\n        {props._items.map(({ text, _graphic, _options, _index, _isCorrect, _selected }, index) => (\r\n          <div\r\n            className={classes([\r\n              `choose__item item-${index}`,\r\n              _selected && 'is-selected',\r\n              _selected && `selected-option-${_selected._index}`,\r\n              _isInteractionComplete && _isCorrect && 'is-correct',\r\n              _isInteractionComplete && !_isCorrect && 'is-incorrect'\r\n            ])}\r\n            key={_index}\r\n            data-index={_index}>\r\n            <div\r\n              className={classes([\r\n                'choose__item-state',\r\n                _isInteractionComplete && _isCorrect && 'choose__item-correct-icon',\r\n                _isInteractionComplete && !_isCorrect && 'choose__item-incorrect-icon'\r\n              ])}\r\n            >\r\n              <div className='icon'></div>\r\n            </div>\r\n            <div className='choose__item-text'>\r\n              {html(compile(text))}\r\n            </div>\r\n            <templates.image {..._graphic}\r\n              classNamePrefixes={['choose__item']}\r\n              attributionClassNamePrefixes={['component', 'choose']}\r\n            />\r\n            <div className='choose__item-choices'>\r\n              {_options.map((option) => (\r\n                <div\r\n                  className={classes([\r\n                    'choose__item-choice',\r\n                    option._isSelected && 'is-selected',\r\n                    _isCorrectAnswerShown && option._isCorrect && 'is-correct',\r\n                    _isCorrectAnswerShown && !option._isCorrect && 'is-incorrect'\r\n                  ])}\r\n                  key={option._index}\r\n                >\r\n                  <label\r\n                    aria-hidden={true}\r\n                    htmlFor={`input-${_id}-${_index}-${option._index}`}\r\n                    data-adapt-index={_index}\r\n                  >\r\n\r\n                    <div className='choose__item-choice-text'>\r\n                      {html(compile(option.text))}\r\n                    </div>\r\n\r\n                    <templates.image {...option._graphic}\r\n                      classNamePrefixes={['choose__item-choice']}\r\n                      attributionClassNamePrefixes={['component', 'choose']}\r\n                    />\r\n\r\n                    <div className='choose__item-icon'>\r\n                      <div className='icon'></div>\r\n                    </div>\r\n                  </label>\r\n                  <input\r\n                    type='radio'\r\n                    name={`choices-${_id}-${_index}`}\r\n                    id={`input-${_id}-${_index}-${option._index}`}\r\n                    value={option._index}\r\n                    disabled={!_isEnabled}\r\n                    aria-label={\r\n                      !shouldShowMarking\r\n                        ? `${\r\n                          _isCorrect\r\n                            ? ariaLabels.correct\r\n                            : ariaLabels.incorrect\r\n                        }, ${Adapt.a11y.normalize(text)}`\r\n                        : `${Adapt.a11y.normalize(text)}`\r\n                    }\r\n                    data-adapt-index={_index}\r\n                    onKeyPress={onKeyPress}\r\n                    onChange={onItemOptionSelect}\r\n                  />\r\n                </div>\r\n              ))}\r\n            </div>\r\n          </div>\r\n        )\r\n        )}\r\n      </div>\r\n\r\n      <div className='btn__container'></div>\r\n    </div>\r\n  );\r\n}\r\n","import Adapt from 'core/js/adapt';\r\nimport React from 'react';\r\nimport a11y from 'core/js/a11y';\r\nimport { classes, compile, templates } from 'core/js/reactHelpers';\r\n\r\nexport default function Accordion (props) {\r\n  const visited = Adapt.course.get('_globals')?._accessibility?._ariaLabels.visited;\r\n  const {\r\n    _id,\r\n    _ariaLevel,\r\n    onClick\r\n  } = props;\r\n  const itemAriaLevel = _.isNumber(_ariaLevel) ? _ariaLevel + 1 : _ariaLevel;\r\n  return (\r\n    <div className=\"component__inner accordion__inner\">\r\n\r\n      <templates.header {...props} />\r\n\r\n      <div className=\"component__widget accordion__widget\">\r\n\r\n        {props._items.map(({ _graphic, _classes, title, body, _index, _isVisited, _isActive, _ariaLevel }, index) =>\r\n\r\n          <div\r\n            className={classes([\r\n              'accordion-item',\r\n              'js-accordion-item',\r\n              _graphic?.src && 'has-image',\r\n              _classes\r\n            ])}\r\n            key={_index}\r\n            data-index={_index}\r\n          >\r\n\r\n            <div role=\"heading\" aria-level={a11y.ariaLevel({ id: _id, level: 'componentItem', override: _ariaLevel ?? itemAriaLevel })} >\r\n              <button\r\n                id={`${_id}-${index}-accordion-button`}\r\n                className={classes([\r\n                  'accordion-item__btn',\r\n                  'js-toggle-item',\r\n                  _isVisited && 'is-visited',\r\n                  _isActive ? 'is-open is-selected' : 'is-closed'\r\n                ])}\r\n                onClick={onClick}\r\n                aria-expanded={_isActive.toString()}\r\n                aria-controls={`${_id}-${index}-accordion-button-panel`}\r\n              >\r\n\r\n                <span className=\"accordion-item__btn-inner\">\r\n\r\n                  <span className=\"accordion-item__icon\">\r\n                    <span className=\"icon\" aria-hidden=\"true\"></span>\r\n                  </span>\r\n\r\n                  <span className=\"accordion-item__title\">\r\n                    <span className=\"aria-label\">{`${_isVisited ? visited + '. ' : ''}${compile(title)}`}</span>\r\n                    <span className=\"accordion-item__title-inner\" aria-hidden=\"true\" dangerouslySetInnerHTML={{ __html: compile(title) }}>\r\n                    </span>\r\n                  </span>\r\n\r\n                </span>\r\n\r\n              </button>\r\n            </div>\r\n\r\n            <div\r\n              id={`${_id}-${index}-accordion-button-panel`}\r\n              className=\"accordion-item__content js-accordion-item-content\"\r\n              role=\"region\"\r\n              aria-labelledby={`${_id}-${index}-accordion-button`}\r\n            >\r\n\r\n              <div className=\"accordion-item__content-inner\">\r\n\r\n                {body &&\r\n                <div className=\"accordion-item__body\">\r\n                  <div className=\"accordion-item__body-inner\" dangerouslySetInnerHTML={{ __html: compile(body) }}>\r\n                  </div>\r\n                </div>\r\n                }\r\n\r\n                <templates.image {..._graphic}\r\n                  classNamePrefixes={['component-item', 'accordion-item']}\r\n                  attributionClassNamePrefixes={['component', 'accordion']}\r\n                />\r\n\r\n              </div>\r\n            </div>\r\n\r\n          </div>\r\n        )}\r\n\r\n      </div>\r\n\r\n    </div>\r\n  );\r\n}\r\n","import Adapt from 'core/js/adapt';\r\nimport a11y from 'core/js/a11y';\r\nimport device from 'core/js/device';\r\nimport React from 'react';\r\nimport { templates, classes, compile } from 'core/js/reactHelpers';\r\n\r\nexport default function Gmcq(props) {\r\n  const ariaLabels = Adapt.course.get('_globals')._accessibility._ariaLabels;\r\n\r\n  const {\r\n    _id,\r\n    _isEnabled,\r\n    _isInteractionComplete,\r\n    _isCorrect,\r\n    _isCorrectAnswerShown,\r\n    _shouldShowMarking,\r\n    _isRadio,\r\n    _columns,\r\n    displayTitle,\r\n    body,\r\n    instruction,\r\n    ariaQuestion,\r\n    onKeyPress,\r\n    onItemSelect,\r\n    onItemFocus,\r\n    onItemBlur\r\n  } = props;\r\n\r\n  const screenSize = device.screenSize;\r\n\r\n  return (\r\n    <div className='component__inner gmcq__inner'>\r\n\r\n      <templates.header {...props} />\r\n\r\n      <div\r\n        className={classes([\r\n          'component__widget',\r\n          'gmcq__widget',\r\n          !_isEnabled && 'is-disabled',\r\n          _isInteractionComplete && 'is-complete is-submitted show-user-answer',\r\n          _isCorrect && 'is-correct',\r\n          _columns && screenSize === 'large' && 'has-column-layout'\r\n        ])}\r\n        role={_isRadio ? 'radiogroup' : 'group'}\r\n        aria-labelledby={ariaQuestion ? null : (displayTitle || body || instruction) && `${_id}-header`}\r\n        aria-label={ariaQuestion || null}\r\n      >\r\n\r\n        {props._items.map(({ text, _index, _isActive, _shouldBeSelected, _graphic }, index) =>\r\n\r\n          <div\r\n            className={classes([\r\n              `gmcq-item item-${index}`,\r\n              (_shouldShowMarking && _shouldBeSelected) ? 'is-correct' : null,\r\n              (_shouldShowMarking && !_shouldBeSelected) ? 'is-incorrect' : null\r\n            ])}\r\n            style={(_columns && screenSize === 'large') ?\r\n              { width: `${100 / _columns}%` } :\r\n              null}\r\n            key={_index}\r\n          >\r\n\r\n            <input\r\n              className='gmcq-item__input'\r\n              id={`${_id}-${index}-input`}\r\n              name={_isRadio ? `${_id}-item` : null}\r\n              type={_isRadio ? 'radio' : 'checkbox'}\r\n              disabled={!_isEnabled}\r\n              defaultChecked={_isActive}\r\n              aria-label={!_shouldShowMarking ?\r\n                `${a11y.normalize(text)} ${_graphic?.alt || ''}` :\r\n                `${_shouldBeSelected ? ariaLabels.correct : ariaLabels.incorrect}, ${_isActive ? ariaLabels.selectedAnswer : ariaLabels.unselectedAnswer}. ${a11y.normalize(text)} ${_graphic?.alt || ''}`}\r\n              data-adapt-index={_index}\r\n              onKeyPress={onKeyPress}\r\n              onChange={onItemSelect}\r\n              onFocus={onItemFocus}\r\n              onBlur={onItemBlur}\r\n            />\r\n\r\n            <label\r\n              className={classes([\r\n                'gmcq-item__label',\r\n                'js-item-label',\r\n                !_isEnabled && 'is-disabled',\r\n                (_isCorrectAnswerShown ? _shouldBeSelected : _isActive) && 'is-selected'\r\n              ])}\r\n              aria-hidden={true}\r\n              htmlFor={`${_id}-${index}-input`}\r\n              data-adapt-index={_index}\r\n            >\r\n\r\n              <templates.image {..._graphic}\r\n                classNamePrefixes={['gmcq-item']}\r\n                attributionClassNamePrefixes={['component', 'gmcq']}\r\n              />\r\n\r\n              <span className='gmcq-item__option'>\r\n\r\n                <span className='gmcq-item__state'>\r\n                  <span\r\n                    className={classes([\r\n                      'gmcq-item__icon',\r\n                      'gmcq-item__answer-icon',\r\n                      _isRadio ? 'is-radio' : 'is-checkbox'\r\n                    ])}\r\n                  >\r\n\r\n                    <span className='icon'></span>\r\n\r\n                  </span>\r\n\r\n                  <span className='gmcq-item__icon gmcq-item__correct-icon'>\r\n                    <span className='icon'></span>\r\n                  </span>\r\n\r\n                  <span className='gmcq-item__icon gmcq-item__incorrect-icon'>\r\n                    <span className='icon'></span>\r\n                  </span>\r\n                </span>\r\n\r\n                {text &&\r\n                <span className='gmcq-item__text'>\r\n                  <span className='gmcq-item__text-inner' dangerouslySetInnerHTML={{ __html: compile(text) }}>\r\n                  </span>\r\n                </span>\r\n                }\r\n\r\n              </span>\r\n\r\n            </label>\r\n\r\n          </div>\r\n        )}\r\n\r\n      </div>\r\n\r\n      <div className='btn__container'></div>\r\n\r\n    </div>\r\n  );\r\n}\r\n","import React from 'react';\r\nimport { templates } from 'core/js/reactHelpers';\r\n\r\nconst LinkWrapper = ({ href, children, target, className, role }) =>\r\n  href\r\n    ? <a href={href} target={target} className={className} role={role}>{children}</a>\r\n    : children;\r\n\r\nexport default function Graphic(props) {\r\n  const {\r\n    _graphic\r\n  } = props;\r\n  return (\r\n    <div className='component__inner graphic__inner'>\r\n\r\n      <templates.header {...props} />\r\n\r\n      <div className='component__widget graphic__widget'>\r\n\r\n        <LinkWrapper\r\n          href = {_graphic._url}\r\n          target = {_graphic._target}\r\n          className = 'graphic__link js-graphic-link'\r\n          role = 'link'\r\n        >\r\n\r\n          <templates.image {..._graphic}\r\n            classNamePrefixes={[\r\n              'component',\r\n              'graphic'\r\n            ]}\r\n          />\r\n\r\n        </LinkWrapper>\r\n\r\n      </div>\r\n\r\n    </div>\r\n  );\r\n}\r\n","import React from 'react';\r\nimport { templates, classes } from 'core/js/reactHelpers';\r\n\r\nexport default function Matching(props) {\r\n  const {\r\n    _isEnabled,\r\n    _isInteractionComplete,\r\n    _isCorrect,\r\n    _shouldShowMarking,\r\n    _isCorrectAnswerShown,\r\n    _items,\r\n    _options\r\n  } = props;\r\n\r\n  const displayAsCorrect = (_isInteractionComplete && (_isCorrectAnswerShown || _isCorrect));\r\n\r\n  return (\r\n    <div className=\"component__inner matching__inner\">\r\n\r\n      <templates.header {...props} />\r\n\r\n      <div className={classes([\r\n        'component__widget matching__widget',\r\n        !_isEnabled && 'is-disabled',\r\n        _isInteractionComplete && 'is-complete is-submitted show-user-answer',\r\n        displayAsCorrect && 'is-correct'\r\n      ])}>\r\n\r\n        {_items.map(({\r\n          text,\r\n          _index\r\n        }, index) => {\r\n          const activeOption = _options.find(option => (option._itemIndex === _index) && option._isActive);\r\n          const displayItemAsCorrect = (!_isEnabled && _shouldShowMarking && (_isCorrectAnswerShown || activeOption?._shouldBeSelected));\r\n          return (\r\n            <div key={_index} className={classes([\r\n              'matching-item',\r\n              'item',\r\n              `item-${index}`,\r\n              'js-matching-item',\r\n              _shouldShowMarking && (displayItemAsCorrect ? 'is-correct' : 'is-incorrect')\r\n            ])}>\r\n\r\n              {text &&\r\n              <div className=\"matching-item__title\">\r\n                <div className=\"matching-item__title_inner\" dangerouslySetInnerHTML={{ __html: text }}>\r\n                </div>\r\n              </div>\r\n              }\r\n\r\n              <div className=\"matching-item__select-container js-matching-item-select-container\">\r\n\r\n                <templates.matchingDropDown {...props} _itemIndex={_index} />\r\n\r\n                <div className=\"matching-item__select-state\">\r\n                  <div className=\"matching-item__select-icon matching-item__select-correct-icon\">\r\n                    <div className=\"icon\"></div>\r\n                  </div>\r\n                  <div className=\"matching-item__select-icon matching-item__select-incorrect-icon\">\r\n                    <div className=\"icon\"></div>\r\n                  </div>\r\n                </div>\r\n\r\n              </div>\r\n\r\n            </div>\r\n          );\r\n        })}\r\n\r\n      </div>\r\n\r\n      <div className=\"btn__container\"></div>\r\n\r\n    </div>\r\n  );\r\n}\r\n","import React, { useRef, useState, useEffect } from 'react';\r\nimport { classes } from 'core/js/reactHelpers';\r\n\r\nexport default function MatchingDropDown(props) {\r\n  const button = useRef(null);\r\n  const list = useRef(null);\r\n\r\n  const [ wasOpen, setWasOpen ] = useState(false);\r\n  const [ isOpen, setIsOpen ] = useState(false);\r\n  const [ isShown, setIsShown ] = useState(false);\r\n  const [ blurTimeoutHandle, setBlurTimeoutHandle ] = useState(null);\r\n  const [ isListOffScreen, setIsListOffScreen ] = useState(false);\r\n  const [ listHeight, setListHeight ] = useState(null);\r\n  const [ buttonWidth, setButtonWidth ] = useState(null);\r\n  const [ buttonOffsetLeft, setButtonOffsetLeft ] = useState(null);\r\n\r\n  const onStartInteraction = () => setWasOpen(isOpen);\r\n\r\n  const onButtonClick = () => {\r\n    if (wasOpen || isOpen) {\r\n      // Click toggle list:\r\n      // If the list is open and the button is clicked\r\n      // the blur event will fire first closing the list.\r\n      // this code is to prevent the list from reopening\r\n      // in that situation\r\n      setIsOpen(false);\r\n      return;\r\n    }\r\n    if (blurTimeoutHandle) {\r\n      clearTimeout(blurTimeoutHandle);\r\n      setBlurTimeoutHandle(null);\r\n    }\r\n    setIsShown(false);\r\n    setIsOpen(true);\r\n    setTimeout(() => {\r\n      const offset = list?.current.getBoundingClientRect();\r\n      const height = $(list?.current).height();\r\n      const windowHeight = $(window).height();\r\n      setIsListOffScreen(offset.top + height > windowHeight);\r\n      setListHeight(height);\r\n      setButtonOffsetLeft(button?.current.offsetLeft);\r\n      setButtonWidth($(button?.current).outerWidth());\r\n      setIsShown(true);\r\n      list?.current.focus();\r\n      scrollToHighlightedListItem();\r\n    }, 100);\r\n  };\r\n\r\n  const scrollToHighlightedListItem = () => {\r\n    if (!list?.current) return;\r\n    const highlighted = $('li[aria-selected]', list.current)[0];\r\n    if (!highlighted) return;\r\n    const height = list.current.clientHeight;\r\n    const pos = highlighted.offsetTop - (height / 2);\r\n    list.current.scrollTop = pos;\r\n  };\r\n\r\n  const onOptionClicked = event => {\r\n    const li = $(event.target).closest('li');\r\n    const optionIndex = $(li).val();\r\n    const option = options.find(option => option._index === optionIndex);\r\n    chooseOption(option);\r\n  };\r\n\r\n  const chooseOption = option => {\r\n    setActiveOption(option._index);\r\n    button?.current.focus();\r\n  };\r\n\r\n  const onListBlur = () => {\r\n    if (!isOpen) return;\r\n    // IE11: Allow option click handler to execute before blur and close list\r\n    const handleBlur = () => {\r\n      setIsShown(false);\r\n      setIsOpen(false);\r\n    };\r\n    setBlurTimeoutHandle(setTimeout(handleBlur, 100));\r\n  };\r\n\r\n  /** Force blur if focus is lost from the list without triggering onListBlur */\r\n  const onDocumentClick = event => {\r\n    if (!isOpen) return;\r\n    const parents = [document.activeElement, ...$(document.activeElement).parents().toArray()];\r\n    if (parents.includes(list?.current)) return;\r\n    onListBlur(event);\r\n  };\r\n\r\n  /** Accessibility keyboard controls */\r\n  const KEYCODE = {\r\n    UP: 38,\r\n    DOWN: 40,\r\n    ENTER: 13,\r\n    SPACE: 32,\r\n    ESCAPE: 27\r\n  };\r\n  const validKeyCodes = Object.values(KEYCODE);\r\n  const onDocumentKeyDown = event => {\r\n    if (!isOpen || !validKeyCodes.includes(event.keyCode)) return;\r\n    switch (event.keyCode) {\r\n      case KEYCODE.UP: {\r\n        event.preventDefault();\r\n        const option = getPreviousOption() || getLastOption();\r\n        highlightOption(option);\r\n        break;\r\n      }\r\n      case KEYCODE.DOWN: {\r\n        event.preventDefault();\r\n        const option = getNextOption() || getFirstOption();\r\n        highlightOption(option);\r\n        break;\r\n      }\r\n      case KEYCODE.ENTER:\r\n      case KEYCODE.SPACE:\r\n        event.preventDefault();\r\n        chooseOption(highlightedOption);\r\n        break;\r\n      case KEYCODE.ESCAPE:\r\n        event.preventDefault();\r\n        button?.current.focus();\r\n    }\r\n  };\r\n\r\n  const getCurrentOptionIndex = () => options.findIndex(option => option === highlightedOption);\r\n  const getPreviousOption = () => options[getCurrentOptionIndex() - 1];\r\n  const getLastOption = () => options[options.length - 1];\r\n  const getNextOption = () => options[getCurrentOptionIndex() + 1];\r\n  const getFirstOption = () => options[0];\r\n\r\n  const highlightOption = option => {\r\n    setHighlightedOption(option._index);\r\n    scrollToHighlightedListItem();\r\n  };\r\n\r\n  /** Document event attachment for click and keydown */\r\n  useEffect(() => {\r\n    document.addEventListener('click', onDocumentClick, { capture: true });\r\n    document.addEventListener('keydown', onDocumentKeyDown);\r\n    return () => {\r\n      document.removeEventListener('click', onDocumentClick, { capture: true });\r\n      document.removeEventListener('keydown', onDocumentKeyDown);\r\n    };\r\n  }, [onDocumentKeyDown, onDocumentClick]);\r\n\r\n  const {\r\n    _id,\r\n    _isEnabled,\r\n    placeholder,\r\n    _itemIndex,\r\n    _options,\r\n    _isCorrectAnswerShown,\r\n    setActiveOption,\r\n    setHighlightedOption\r\n  } = props;\r\n\r\n  const options = _options.filter(({ _itemIndex: itemIndex }) => (itemIndex === _itemIndex) || (itemIndex === -1));\r\n  const activeOption = options.find(option => (option._itemIndex === _itemIndex) && option._isActive) || { text: placeholder };\r\n  const highlightedOption = options.find(option => (option._itemIndex === _itemIndex) && option._isHighlighted) || { text: placeholder };\r\n\r\n  const correctActiveOption = activeOption?._shouldBeSelected\r\n    ? activeOption\r\n    : options.find(option => option._shouldBeSelected);\r\n\r\n  const displayActiveOption = _isCorrectAnswerShown\r\n    ? correctActiveOption\r\n    : activeOption;\r\n\r\n  return (\r\n    <div className=\"dropdown\" disabled={!_isEnabled}>\r\n\r\n      <button\r\n        disabled={!_isEnabled}\r\n        className={classes([\r\n          'dropdown__btn js-dropdown-btn',\r\n          !_isEnabled && 'is-disabled'\r\n        ])}\r\n        aria-haspopup=\"listbox\"\r\n        aria-expanded={isOpen}\r\n        onMouseDown={onStartInteraction}\r\n        onTouchStart={onStartInteraction}\r\n        onClick={onButtonClick}\r\n        ref={button}>\r\n\r\n        <span className=\"dropdown__inner js-dropdown-inner\" dangerouslySetInnerHTML={{ __html: displayActiveOption?.text }}>\r\n        </span>\r\n\r\n        <span className=\"dropdown__icon\">\r\n          <span className=\"icon\"></span>\r\n        </span>\r\n\r\n      </button>\r\n\r\n      <ul\r\n        className={classes([\r\n          'dropdown__list js-dropdown-list',\r\n          !isOpen && 'u-display-none',\r\n          isOpen && !isShown && 'u-visibility-hidden'\r\n        ])}\r\n        style={{\r\n          top: (!isShown || !isListOffScreen) ? '' : -listHeight,\r\n          left: buttonOffsetLeft,\r\n          width: buttonWidth\r\n        }}\r\n        role=\"listbox\"\r\n        tabIndex=\"-1\"\r\n        onBlur={onListBlur}\r\n        ref={list}\r\n        disabled={!_isEnabled}\r\n        aria-activedescendant={highlightedOption && `dropdown__item__${_id}__${_itemIndex}__${highlightedOption._index}`}\r\n      >\r\n\r\n        {options.map(({\r\n          displayText,\r\n          text,\r\n          _index,\r\n          _isHighlighted\r\n        }) => {\r\n          return <li\r\n            key={_index}\r\n            id={`dropdown__item__${_id}__${_itemIndex}__${_index}`}\r\n            className=\"dropdown-item js-dropdown-list-item\"\r\n            role=\"option\"\r\n            text={text}\r\n            value={_index}\r\n            aria-selected={_isHighlighted || null}\r\n            selected={_isHighlighted || null}\r\n            onClick={onOptionClicked}\r\n          >\r\n            <div className=\"dropdown-item__inner js-dropdown-list-item-inner\" dangerouslySetInnerHTML={{ __html: displayText || text }}>\r\n            </div>\r\n          </li>;\r\n        })}\r\n\r\n      </ul>\r\n\r\n    </div>\r\n  );\r\n\r\n}\r\n","import Adapt from 'core/js/adapt';\r\nimport a11y from 'core/js/a11y';\r\nimport React from 'react';\r\nimport { templates, classes, compile } from 'core/js/reactHelpers';\r\n\r\nexport default function Mcq(props) {\r\n  const ariaLabels = Adapt.course.get('_globals')._accessibility._ariaLabels;\r\n\r\n  const {\r\n    _id,\r\n    _isEnabled,\r\n    _isInteractionComplete,\r\n    _isCorrect,\r\n    _isCorrectAnswerShown,\r\n    _shouldShowMarking,\r\n    _isRadio,\r\n    displayTitle,\r\n    body,\r\n    instruction,\r\n    ariaQuestion,\r\n    onKeyPress,\r\n    onItemSelect,\r\n    onItemFocus,\r\n    onItemBlur\r\n  } = props;\r\n\r\n  return (\r\n    <div className='component__inner mcq__inner'>\r\n\r\n      <templates.header {...props} />\r\n\r\n      <div\r\n        className={classes([\r\n          'component__widget',\r\n          'mcq__widget',\r\n          !_isEnabled && 'is-disabled',\r\n          _isInteractionComplete && 'is-complete is-submitted show-user-answer',\r\n          _isCorrect && 'is-correct'\r\n        ])}\r\n        role={_isRadio ? 'radiogroup' : 'group'}\r\n        aria-labelledby={ariaQuestion ? null : (displayTitle || body || instruction) && `${_id}-header`}\r\n        aria-label={ariaQuestion || null}\r\n      >\r\n\r\n        {props._items.map(({ text, _index, _isActive, _shouldBeSelected, _isHighlighted }, index) =>\r\n\r\n          <div\r\n            className={classes([\r\n              `mcq-item item-${index}`,\r\n              _shouldShowMarking && _shouldBeSelected && 'is-correct',\r\n              _shouldShowMarking && !_shouldBeSelected && 'is-incorrect'\r\n            ])}\r\n            key={_index}\r\n          >\r\n\r\n            <input\r\n              className='mcq-item__input'\r\n              id={`${_id}-${index}-input`}\r\n              name={_isRadio ? `${_id}-item` : null}\r\n              type={_isRadio ? 'radio' : 'checkbox'}\r\n              disabled={!_isEnabled}\r\n              defaultChecked={_isActive}\r\n              aria-label={!_shouldShowMarking ?\r\n                a11y.normalize(text) :\r\n                `${_shouldBeSelected ? ariaLabels.correct : ariaLabels.incorrect}, ${_isActive ? ariaLabels.selectedAnswer : ariaLabels.unselectedAnswer}. ${a11y.normalize(text)}`}\r\n              data-adapt-index={_index}\r\n              onKeyPress={onKeyPress}\r\n              onChange={onItemSelect}\r\n              onFocus={onItemFocus}\r\n              onBlur={onItemBlur}\r\n            />\r\n\r\n            <label\r\n              className={classes([\r\n                'mcq-item__label',\r\n                !_isEnabled && 'is-disabled',\r\n                _isHighlighted && 'is-highlighted',\r\n                (_isCorrectAnswerShown ? _shouldBeSelected : _isActive) && 'is-selected'\r\n              ])}\r\n              aria-hidden={true}\r\n              htmlFor={`${_id}-${index}-input`}\r\n              data-adapt-index={_index}\r\n            >\r\n\r\n              <span className='mcq-item__state'>\r\n                <span\r\n                  className={classes([\r\n                    'mcq-item__icon',\r\n                    'mcq-item__answer-icon',\r\n                    _isRadio ? 'is-radio' : 'is-checkbox'\r\n                  ])}\r\n                >\r\n\r\n                  <span className='icon'></span>\r\n\r\n                </span>\r\n\r\n                <span className='mcq-item__icon mcq-item__correct-icon'>\r\n                  <span className='icon'></span>\r\n                </span>\r\n\r\n                <span className='mcq-item__icon mcq-item__incorrect-icon'>\r\n                  <span className='icon'></span>\r\n                </span>\r\n              </span>\r\n\r\n              <span className='mcq-item__text'>\r\n                <span className='mcq-item__text-inner' dangerouslySetInnerHTML={{ __html: compile(text) }}>\r\n                </span>\r\n              </span>\r\n\r\n            </label>\r\n\r\n          </div>\r\n        )}\r\n\r\n      </div>\r\n\r\n      <div className='btn__container'></div>\r\n\r\n    </div>\r\n  );\r\n}\r\n","import React from 'react';\r\nimport { templates } from 'core/js/reactHelpers';\r\n\r\nexport default function Text(props) {\r\n  return (\r\n    <div className=\"component__inner text__inner\">\r\n      <templates.header {...props} />\r\n    </div>\r\n  );\r\n}\r\n","import React from 'react';\r\nimport { compile, classes, templates, html } from 'core/js/reactHelpers';\r\n\r\nexport default function TextInput (props) {\r\n  const {\r\n    _isInteractionComplete,\r\n    _id,\r\n    _isEnabled,\r\n    _isCorrect,\r\n    _shouldShowMarking\r\n  } = props;\r\n\r\n  return (\r\n    <div className=\"component__inner textinput__inner\">\r\n\r\n      <templates.header {...props} />\r\n\r\n      {/* complex unless and if combination to set the correct classes for CSS to use in showing marking and disabled states */}\r\n      <div className={classes([\r\n        'component__widget textinput__widget',\r\n        !_isEnabled && 'is-disabled',\r\n        _isInteractionComplete && 'is-complete is-submitted show-user-answer',\r\n        _isCorrect && 'is-correct'\r\n      ])}>\r\n\r\n        {props._items.map(({ prefix, _index, input, placeholder, userAnswer, suffix }, index) =>\r\n\r\n          <div\r\n            className={classes([\r\n              'textinput-item js-textinput-item',\r\n              _shouldShowMarking && _isCorrect && 'is-correct',\r\n              _shouldShowMarking && !_isCorrect && 'is-incorrect'\r\n            ])}\r\n            key={_index}>\r\n            {prefix &&\r\n              <div className=\"textinput-item__prefix-container\">\r\n                <label\r\n                  className=\"textinput-item__prefix\"\r\n                  id={`${_id}-${index}-aria`}\r\n                  htmlFor={`${_id}-${index}`}\r\n                  aria-label={prefix}>\r\n                  {html(compile(prefix))}\r\n                </label>\r\n              </div>\r\n            }\r\n\r\n            <div className=\"textinput-item__textbox-container\">\r\n              <input\r\n                className=\"textinput-item__textbox js-textinput-textbox\"\r\n                type=\"text\"\r\n                placeholder={placeholder}\r\n                data-id={`${input}-${index}`}\r\n                id={`${_id}-${index}`}\r\n                aria-labelledby={prefix && `${_id}-${index}-aria`}\r\n                aria-label={placeholder}\r\n                defaultValue={userAnswer}\r\n                disabled={!_isEnabled}\r\n              />\r\n              <div className=\"textinput-item__state\">\r\n                <div className=\"textinput-item__icon textinput-item__correct-icon\">\r\n                  <div className=\"icon\" />\r\n                </div>\r\n                <div className=\"textinput-item__icon textinput-item__incorrect-icon\">\r\n                  <div className=\"icon\" />\r\n                </div>\r\n              </div>\r\n            </div>\r\n\r\n            {suffix &&\r\n              <div className=\"textinput-item__suffix-container\">\r\n                <label\r\n                  className=\"textinput-item__suffix\"\r\n                  id={`${_id}-${index}-aria`}\r\n                  htmlFor={`${_id}-${index}`}\r\n                  aria-label={suffix}>\r\n                  {html(compile(suffix))}\r\n                </label>\r\n              </div>\r\n            }\r\n\r\n          </div>\r\n        )}\r\n\r\n      </div>\r\n      <div className=\"btn__container\" />\r\n    </div>\r\n  );\r\n\r\n}\r\n","import Adapt from 'core/js/adapt';\r\nimport React from 'react';\r\nimport a11y from 'core/js/a11y';\r\nimport { classes, compile, templates } from 'core/js/reactHelpers';\r\n\r\nexport default function Flex (props) {\r\n  const visited = Adapt.course.get('_globals')?._accessibility?._ariaLabels.visited;\r\n  const {\r\n    _id,\r\n    _ariaLevel,\r\n    onClick,\r\n    onMouseOver\r\n  } = props;\r\n  const itemAriaLevel = _.isNumber(_ariaLevel) && _ariaLevel !== 0 ? _ariaLevel + 1 : _ariaLevel;\r\n  return (\r\n    <div className=\"component__inner flex__inner\">\r\n\r\n      <templates.header {...props} />\r\n\r\n      <div className=\"component__widget flex__widget\">\r\n\r\n        {props._items.map(({ _graphic, _classes, title, body, _index, _isVisited, _isActive, _ariaLevel }, index) =>\r\n\r\n          <div\r\n            className={classes([\r\n              'flex-item',\r\n              'js-flex-item',\r\n\r\n              _isActive && 'is-active',\r\n              _classes\r\n            ])}\r\n            key={_index}\r\n            data-index={_index}\r\n            style={{\r\n              backgroundImage: _graphic && _graphic.src ? `url(${_graphic.src})` : 'none',\r\n              flex: _isActive ? props._items.length : 1\r\n            }}\r\n          >\r\n\r\n            <div role=\"heading\" aria-level={a11y.ariaLevel({ id: _id, level: 'componentItem', override: _ariaLevel ?? itemAriaLevel })} >\r\n              <button\r\n                id={`${_id}-${index}-flex-button`}\r\n                className={classes([\r\n                  'flex-item__btn',\r\n                  'js-toggle-item',\r\n                  _isVisited && 'is-visited',\r\n                  _isActive ? 'is-open is-selected' : 'is-closed'\r\n                ])}\r\n                onClick={onClick}\r\n                onMouseOver={onMouseOver}\r\n                aria-expanded={_isActive.toString()}\r\n                aria-controls={`${_id}-${index}-flex-button-panel`}\r\n              >\r\n\r\n                <span className=\"flex-item__btn-inner\">\r\n\r\n                  <span className=\"flex-item__icon\">\r\n                    <span className=\"icon\" aria-hidden=\"true\"></span>\r\n                  </span>\r\n\r\n                  <span className=\"flex-item__title\">\r\n                    <span className=\"aria-label\">{`${_isVisited ? visited + '. ' : ''}${compile(title)}`}</span>\r\n                    <span className=\"flex-item__title-inner\" aria-hidden=\"true\" dangerouslySetInnerHTML={{ __html: compile(title) }}>\r\n                    </span>\r\n                  </span>\r\n\r\n                </span>\r\n\r\n              </button>\r\n            </div>\r\n\r\n            <div\r\n              id={`${_id}-${index}-flex-button-panel`}\r\n              className=\"flex-item__content js-flex-item-content\"\r\n              role=\"region\"\r\n              aria-labelledby={`${_id}-${index}-flex-button`}\r\n            >\r\n\r\n              <div className=\"flex-item__content-inner\">\r\n                <span className=\"flex-item__title\">\r\n                  <span className=\"flex-item__title-inner\" aria-hidden=\"true\" dangerouslySetInnerHTML={{ __html: compile(title) }}></span>\r\n                </span>\r\n                {body &&\r\n                <div className=\"flex-item__body\">\r\n                  <div className=\"flex-item__body-inner\" dangerouslySetInnerHTML={{ __html: compile(body) }}>\r\n                  </div>\r\n                </div>\r\n                }\r\n\r\n              </div>\r\n            </div>\r\n\r\n          </div>\r\n        )}\r\n\r\n      </div>\r\n\r\n    </div>\r\n  );\r\n}\r\n","import React, { useRef } from 'react';\r\nimport { templates, compile } from 'core/js/reactHelpers';\r\nimport a11y from 'core/js/a11y';\r\n\r\nexport default function GraphicCompare(props) {\r\n  const {\r\n    _id,\r\n    _graphic1,\r\n    _graphic2,\r\n    _value,\r\n    onChange,\r\n    _globals\r\n  } = props;\r\n  const widgetEl = useRef(null);\r\n\r\n  return (\r\n    <div className=\"component__inner graphiccompare__inner\">\r\n      <templates.header {...props} />\r\n      <div className=\"component__widget graphiccompare__widget\" ref={widgetEl} >\r\n\r\n        <div className='graphiccompare__container'>\r\n          <div className='u-visibility-hidden'>\r\n            <img\r\n              className='u-visibility-hidden'\r\n              src={_graphic1.src}\r\n              aria-label=\"hidden graphic\"\r\n              aria-hidden=\"true\"\r\n              loading='eager'\r\n            />\r\n          </div>\r\n          <div className='graphiccompare__image graphiccompare__image-1'>\r\n            <img\r\n              src={_graphic1.src}\r\n              aria-label={a11y.normalize(_graphic1.alt)}\r\n              aria-hidden={!_graphic1.alt}\r\n              loading='eager'\r\n            />\r\n          </div>\r\n          <div className='graphiccompare__image graphiccompare__image-2' style={{ width: _value + '%' }}>\r\n            <img\r\n              style={{ maxWidth: widgetEl.current ? widgetEl.current.offsetWidth : '100%' }}\r\n              src={_graphic2.src}\r\n              aria-label={a11y.normalize(_graphic2.alt)}\r\n              aria-hidden={!_graphic2.alt}\r\n              loading='eager'\r\n            />\r\n          </div>\r\n          <label>\r\n            <span className=\"aria-label\">{compile(_globals._components?._graphicCompare?.ariaLabel)}</span>\r\n            <input id={`graphiccompare-input-${_id}`}\r\n              type=\"range\"\r\n              value={_value}\r\n              aria-valuenow={_value}\r\n              aria-valuetext={`${_value}%`}\r\n              min=\"0\"\r\n              max=\"100\"\r\n              step=\"1\"\r\n              readOnly={true}\r\n              onChange={onChange}/>\r\n          </label>\r\n        </div>\r\n\r\n      </div>\r\n    </div>\r\n\r\n  );\r\n}\r\n","import React from 'react';\r\nimport { html, templates } from 'core/js/reactHelpers';\r\n\r\nexport default function LottieInteractivity(props) {\r\n  const { lottieplayer, description, failed } = props;\r\n  return (\r\n    <div className=\"component__inner lottieinteractivity__inner\">\r\n      <templates.header {...props} />\r\n      {failed && <p className=\"lottieinteractivity__error\">{failed}</p>}\r\n      <div className='component__widget lottieinteractivity__widget'>\r\n        <div dangerouslySetInnerHTML={{ __html: lottieplayer }} />\r\n      </div>\r\n      <div className='lottieinteractivity__description'>\r\n        {html(description)}\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n","import Adapt from 'core/js/adapt';\r\nimport React from 'react';\r\nimport { templates, classes, html, compile } from 'core/js/reactHelpers';\r\n\r\nexport default function SelectChoice(props) {\r\n  const ariaLabels = Adapt.course.get('_globals')._accessibility._ariaLabels;\r\n\r\n  const {\r\n    _id,\r\n    _isEnabled,\r\n    _isInteractionComplete,\r\n    _isCorrect,\r\n    _canShowMarking,\r\n    displayTitle,\r\n    body,\r\n    instruction,\r\n    onKeyPress,\r\n    onItemOptionSelect,\r\n    _isCorrectAnswerShown,\r\n    isInteractive\r\n  } = props;\r\n\r\n  const shouldShowMarking = isInteractive() && _canShowMarking;\r\n\r\n  return (\r\n    <div className='component__inner selectchoice__inner'>\r\n      <templates.header {...props} />\r\n\r\n      <div\r\n        className={classes([\r\n          'component__widget',\r\n          'selectchoice__widget',\r\n          !_isEnabled && 'is-disabled',\r\n          _isInteractionComplete && 'is-complete is-submitted show-user-answer',\r\n          _isCorrect && 'is-correct'\r\n        ])}\r\n        role='radiogroup'\r\n        aria-labelledby={\r\n          (displayTitle || body || instruction) && `${_id}-header`\r\n        }\r\n      >\r\n        <div className='selectchoice__item-head selectchoice__item'>\r\n          <div className='selectchoice__item-text'></div>\r\n          <div className='selectchoice__item-choices'>\r\n            {props._choices.map((option) => (\r\n              <div className='selectchoice__item-choice' key={option._value}>\r\n                <label aria-hidden={true}>\r\n                  <div className='selectchoice__item-choice-text'>\r\n                    {html(compile(option.text))}\r\n                  </div>\r\n                  {option._graphic.large &&\r\n                    <templates.image {...option._graphic}\r\n                      classNamePrefixes={['selectchoice__item-choice']}\r\n                      attributionClassNamePrefixes={['component', 'selectchoice']}\r\n                    />\r\n                  }\r\n                </label>\r\n              </div>\r\n            ))}\r\n          </div>\r\n        </div>\r\n        {props._items.map(({ text, _graphic, _options, _index, _isCorrect, _selected, _shouldBeSelected }, index) => (\r\n          <div\r\n            className={classes([\r\n              `selectchoice__item item-${index}`,\r\n              _selected && 'is-selected',\r\n              _selected && `selected-option-${_selected._value}`,\r\n              _isInteractionComplete && _isCorrect && 'is-correct',\r\n              _isInteractionComplete && !_isCorrect && 'is-incorrect'\r\n            ])}\r\n            key={_index}>\r\n            <div\r\n              className={classes([\r\n                'selectchoice__item-state',\r\n                _isInteractionComplete && _isCorrect && 'selectchoice__item-correct-icon',\r\n                _isInteractionComplete && !_isCorrect && 'selectchoice__item-incorrect-icon'\r\n              ])}\r\n            >\r\n              <div className='icon'></div>\r\n            </div>\r\n            <div className='selectchoice__item-text'>\r\n              {html(compile(text))}\r\n            </div>\r\n            <templates.image {..._graphic}\r\n              classNamePrefixes={['selectchoice__item']}\r\n              attributionClassNamePrefixes={['component', 'selectchoice']}\r\n            />\r\n            <div className='selectchoice__item-choices'>\r\n              {_options.map((option) => (\r\n                <div\r\n                  className='selectchoice__item-choice'\r\n                  key={option._index}\r\n                >\r\n                  <label\r\n                    aria-hidden={true}\r\n                    htmlFor={`input-${_id}-${_index}-${option._value}`}\r\n                    data-adapt-index={_index}\r\n                  >\r\n\r\n                    <div className='selectchoice__item-choice-text'>\r\n                      {html(compile(option.text))}\r\n                    </div>\r\n                    {option._graphic.large &&\r\n                      <templates.image {...option._graphic}\r\n                        classNamePrefixes={['selectchoice__item-choice']}\r\n                        attributionClassNamePrefixes={['component', 'selectchoice']}\r\n                      />\r\n                    }\r\n                    <div\r\n                      className={classes([\r\n                        'selectchoice__item-icon',\r\n\r\n                        _selected &&\r\n                          (_isCorrectAnswerShown\r\n                            ? _shouldBeSelected === option._value\r\n                            : _selected._value === option._value)\r\n                          ? 'is-selected'\r\n                          : ''\r\n                      ])}\r\n                    >\r\n                      <div className='icon'></div>\r\n                    </div>\r\n                  </label>\r\n                  <input\r\n                    type='radio'\r\n                    name={`choices-${_id}-${_index}`}\r\n                    id={`input-${_id}-${_index}-${option._value}`}\r\n                    value={option._value}\r\n                    disabled={!_isEnabled}\r\n                    aria-label={\r\n                      !shouldShowMarking\r\n                        ? `${\r\n                          _isCorrect\r\n                            ? ariaLabels.correct\r\n                            : ariaLabels.incorrect\r\n                        }, ${Adapt.a11y.normalize(text)}`\r\n                        : `${Adapt.a11y.normalize(text)}`\r\n                    }\r\n                    data-adapt-index={_index}\r\n                    onKeyPress={onKeyPress}\r\n                    onChange={onItemOptionSelect}\r\n                  />\r\n                </div>\r\n              ))}\r\n            </div>\r\n          </div>\r\n        )\r\n        )}\r\n      </div>\r\n\r\n      <div className='btn__container'></div>\r\n    </div>\r\n  );\r\n}\r\n","import a11y from 'core/js/a11y';\r\nimport React from 'react';\r\nimport { templates, classes, compile } from 'core/js/reactHelpers';\r\n\r\nexport default function Tabs(props) {\r\n  const {\r\n    _id,\r\n    _items,\r\n    _minHeight,\r\n    _globals,\r\n    onTabItemClicked,\r\n    onTabItemKeyUp,\r\n    itemWidth\r\n  } = props;\r\n\r\n  return (\r\n    <div className=\"tabs__inner component__inner\">\r\n\r\n      <templates.header {...props} />\r\n\r\n      <div className=\"tabs__widget component__widget clearfix\">\r\n\r\n        <div className=\"tabs__nav\">\r\n          <div className=\"tabs__nav-inner\" role=\"tablist\">\r\n\r\n            {_items.map(({\r\n              tabTitle,\r\n              _isActive,\r\n              _index,\r\n              _isVisited\r\n            }, index) =>\r\n\r\n              <button\r\n                key={_index}\r\n                role=\"tab\"\r\n                aria-selected={_isActive}\r\n                aria-controls={`${_id}-${index}-tabpanel`}\r\n                aria-label={`${tabTitle}.${_isVisited ? ` ${_globals._accessibility._ariaLabels.visited}` : ''}`}\r\n                className={classes([\r\n                  'tabs__nav-item-btn',\r\n                  'js-tabs-nav-item-btn-click',\r\n                  _isVisited && 'is-visited',\r\n                  _isActive && 'is-selected'\r\n                ])}\r\n                tabIndex={_isActive ? 0 : -1}\r\n                onClick={onTabItemClicked}\r\n                onKeyUp={onTabItemKeyUp}\r\n                style={{ width: itemWidth }}\r\n                data-index={_index}>\r\n\r\n                <div id={`${_id}-${index}-tabtitle`} className=\"tabs__nav-item-btn-inner\">{tabTitle}</div>\r\n              </button>\r\n\r\n            )}\r\n\r\n          </div>\r\n        </div>\r\n\r\n        <div className=\"tabs__content\" style={{ minHeight: _minHeight }}>\r\n          <div className=\"tabs__content-inner\">\r\n\r\n            {_items.map(({\r\n              _isActive,\r\n              _classes,\r\n              _index,\r\n              title,\r\n              body,\r\n              _graphic\r\n            }, index) =>\r\n              <div\r\n                key={_index}\r\n                id={`${_id}-${index}-tabpanel`}\r\n                role=\"tabpanel\"\r\n                aria-hidden={!_isActive || null}\r\n                aria-labelledby={`${_id}-${index}-tabtitle`}\r\n                tabIndex={_isActive ? 0 : -1}\r\n                data-index={_index}\r\n                className={classes([\r\n                  'tabs__content-item',\r\n                  `item-${index}`,\r\n                  _classes,\r\n                  _isActive && 'is-active'\r\n                ])}\r\n              >\r\n                 <templates.image {..._graphic}\r\n                    classNamePrefixes={['component__item', 'tabs__content-item']}\r\n                    attributionClassNamePrefixes={['component', 'tabs__content-item']}\r\n                  />\r\n\r\n                <div className=\"tabs__content-item-inner\">\r\n\r\n                  {title &&\r\n                    <div className=\"tabs__content-item-title\">\r\n                      <div className=\"tabs__content-item-title-inner\" role=\"heading\" aria-level={a11y.ariaLevel({ id: _id, level: 'componentItem' })} dangerouslySetInnerHTML={{ __html: compile(title) }}>\r\n                      </div>\r\n                    </div>\r\n                  }\r\n\r\n                  {body &&\r\n                    <div className=\"tabs__content-item-body\">\r\n                      <div className=\"tabs__content-item-body-inner\" dangerouslySetInnerHTML={{ __html: compile(body) }}>\r\n                      </div>\r\n                    </div>\r\n                  }\r\n\r\n                 \r\n\r\n                </div>\r\n              </div>\r\n            )}\r\n\r\n          </div>\r\n        </div>\r\n\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n","import React, { useEffect, useRef, useState } from 'react';\r\nimport { html, compile, classes, templates } from 'core/js/reactHelpers';\r\n\r\nexport default function Talk(props) {\r\n  const {\r\n    el,\r\n    _items\r\n  } = props;\r\n  const hasObserver = ('IntersectionObserver' in window);\r\n  const useObserver = function(options) {\r\n    const [elements, setElements] = useState([]);\r\n    const [entries, setEntries] = useState([]);\r\n    const observer = hasObserver\r\n      ? useRef(new IntersectionObserver(observedEntries => {\r\n        setEntries(observedEntries);\r\n      }, options))\r\n      : null;\r\n\r\n    useEffect(function() {\r\n      if (!observer) return;\r\n\r\n      const { current: currentObserver } = observer;\r\n      currentObserver.disconnect();\r\n      if (elements.length) {\r\n        elements.forEach(element => currentObserver.observe(element));\r\n      }\r\n      return function cleanUp() {\r\n        if (currentObserver) {\r\n          currentObserver.disconnect();\r\n        }\r\n      };\r\n    }, [elements]);\r\n\r\n    return [observer?.current, setElements, entries];\r\n  };\r\n  const [observer, setElements, entries] = useObserver({\r\n    threshold: 1.0,\r\n    root: null,\r\n    rootMargin: '60px'\r\n  });\r\n\r\n  useEffect(() => {\r\n    entries.forEach(entry => {\r\n      if (entry.isIntersecting) {\r\n        const chatEntry = entry.target;\r\n        chatEntry.classList.add('is-visited');\r\n        observer.unobserve(chatEntry);\r\n      }\r\n    });\r\n  }, [entries, observer]);\r\n\r\n  useEffect(() => {\r\n    if (!observer) return;\r\n\r\n    const chatElements = el.querySelectorAll('.talk__chat');\r\n    setElements(chatElements);\r\n  }, [setElements, _items]);\r\n\r\n  return (\r\n    <div className='component__inner talk__inner'>\r\n      <templates.header {...props} />\r\n      <div className='component__widget talk__widget'>\r\n\r\n        <div className='talk__container-items' role='feed'>\r\n\r\n          {_items.map(({ _character, _graphic, text, _classes }, _index) => (\r\n            <div key={_index}\r\n              role='article'\r\n              className={classes([\r\n                'talk__chat',\r\n                `talk__chat-character-${_character._index}`,\r\n                !hasObserver && 'is-visited',\r\n                _classes\r\n              ])}\r\n              aria-posinset={_index + 1}\r\n              tabIndex=\"0\"\r\n              aria-labelledby={`talk__chat-container-${_index}`}\r\n              aria-setsize={el.querySelectorAll('.talk__chat.is-visited').length + 1}\r\n              data-index={_index}>\r\n              <div className={classes(['talk__chat-status'])}></div>\r\n              <div className=\"talk__chat-container\" id={`talk__chat-container-${_index}`}>\r\n                <div className={classes(['talk__chat__character', _character._classes])}>\r\n                  {_character?._graphic && (\r\n                    <templates.image\r\n                      {..._character._graphic}\r\n                      classNamePrefixes={['component', 'talk__character']}\r\n                    />\r\n                  )}\r\n                  {_character?.name && (\r\n                    <div className=\"talk__chat__character-title\">\r\n                      {html(compile(_character.name))}\r\n                    </div>\r\n                  )}\r\n                </div>\r\n                <div className=\"talk__chat__message\">\r\n                  {_graphic && (\r\n                    <templates.image\r\n                      {..._graphic}\r\n                      classNamePrefixes={['component', 'talk__message']}\r\n                    />\r\n                  )}\r\n                  {text && <div className=\"talk__chat__message-text\">{html(compile(text))}</div>}\r\n                </div>\r\n              </div>\r\n            </div>\r\n\r\n          ))}\r\n        </div>\r\n\r\n      </div>\r\n\r\n    </div>\r\n  );\r\n}\r\n","import React from 'react';\r\nimport { templates, classes, html, compile } from 'core/js/reactHelpers';\r\n\r\nexport default function VerticalItems({\r\n  top,\r\n  _items,\r\n  bottom,\r\n  ...props\r\n}) {\r\n  return (\r\n    <div className='component__inner verticalitems__inner'>\r\n      <templates.header {...props} />\r\n      <div className='component__widget verticalitems__widget'>\r\n        {top && (\r\n          <div className='verticalitems__top u-clearfix'>\r\n            <div className='verticalitems__top-inner'>{html(compile(top))}\r\n            </div>\r\n          </div>\r\n        )}\r\n        <div className='verticalitems__container' role='list'>\r\n          {_items.map(({ title, body, _icon, _graphic, _isVisited, _classes }, _index) => (\r\n            <div\r\n              className={classes([\r\n                'verticalitems__item',\r\n                'u-clearfix',\r\n                _isVisited && 'is-visited',\r\n                _graphic.src && 'has-image',\r\n                _classes\r\n              ])}\r\n              key={_index}\r\n              data-index={_index}\r\n              role=\"listitem\"\r\n            >\r\n\r\n              <div className={classes(['verticalitems__item-icon', _isVisited ? 'anim' : 'is-hidden'])}>\r\n\r\n                <div className={classes([\r\n                  'icon',\r\n                  _icon._classes\r\n                ])}>\r\n                  {_icon.src && (\r\n                    <img src={_icon.src} alt={_icon.alt} />\r\n                  )}\r\n                </div>\r\n\r\n              </div>\r\n              <div className={classes(['verticalitems__item__content', _isVisited ? 'anim' : 'is-hidden'])}>\r\n\r\n                {title && (\r\n                  <div className='verticalitems__item__content-title'>\r\n                    {html(compile(title))}\r\n                  </div>\r\n                )}\r\n                {body && (\r\n                  <div className='verticalitems__item__content-body'>\r\n                    {html(compile(body))}\r\n                  </div>\r\n                )}\r\n                {_graphic.src && (\r\n                  <div className='verticalitems__item__content-graphic'>\r\n                    <img src={_graphic.src} alt={_graphic.alt} />\r\n                  </div>\r\n                )}\r\n              </div>\r\n            </div>\r\n          ))}\r\n        </div>\r\n        {bottom && (\r\n          <div className='verticalitems__bottom u-clearfix'>\r\n            <div className='verticalitems__bottom-inner'>{html(compile(bottom))}</div>\r\n          </div>\r\n        )}\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n","import React from 'react';\r\n\r\nexport default function BackgroundVideo(props) {\r\n  const { _backgroundVideo, _screenSize } = props;\r\n\r\n  function UseVideo() {\r\n    return <video\r\n      preload=\"auto\"\r\n      loop\r\n      autoPlay\r\n      muted\r\n      poster={_backgroundVideo._graphic}\r\n    >\r\n      <source\r\n        src={_backgroundVideo._mp4 !== '' ? _backgroundVideo._mp4 : _backgroundVideo._webm}\r\n        type={_backgroundVideo._mp4 !== '' ? 'video/mp4' : 'video/webm'}\r\n      ></source>\r\n    </video>;\r\n  }\r\n\r\n  function UseGraphic() {\r\n    if (_backgroundVideo._graphic) {\r\n      return <img src={_backgroundVideo._graphic}/>;\r\n    }\r\n    return null;\r\n  }\r\n\r\n  if (_screenSize !== 'small') {\r\n    return <UseVideo />;\r\n  }\r\n  return <UseGraphic />;\r\n}\r\n","import React, { useEffect, useState } from 'react';\r\nimport { classes } from 'core/js/reactHelpers';\r\n\r\nexport default function NavigationLogo(props) {\r\n  const { _button } = props;\r\n  const [isVisible, setVisible] = useState(false);\r\n  const target = document.querySelector('.page__header') || document.querySelector('.menu__header');\r\n\r\n  useEffect(() => {\r\n    const observer = new IntersectionObserver((entries, observer) => {\r\n      const entry = entries[0];\r\n      if (!entry.isIntersecting) {\r\n        setVisible(true);\r\n      } else {\r\n        setVisible(false);\r\n      }\r\n    });\r\n    if (!target) return;\r\n    observer.observe(target);\r\n\r\n  }, [target]);\r\n\r\n  const scrollToTop = () => window.scrollTo({ top: 0, behavior: 'smooth' });\r\n\r\n  return (\r\n    <button\r\n      className={classes(['btn-icon', 'scrolltop__btn', !isVisible && 'u-display-none'])}\r\n      aria-label={_button.ariaLabel}\r\n      onClick={() => scrollToTop()}>\r\n      <span className='icon icon-controls-up' />\r\n    </button>\r\n  );\r\n}\r\n","import Adapt from 'core/js/adapt';\r\nimport 'core/js/wait';\r\nimport 'core/js/deprecated.js';\r\nimport 'core/js/components';\r\nimport 'core/js/location';\r\nimport 'core/js/templates';\r\nimport 'core/js/fixes';\r\nimport data from 'core/js/data';\r\nimport 'core/js/offlineStorage';\r\nimport logging from 'core/js/logging';\r\nimport 'core/js/tracking';\r\nimport 'core/js/device';\r\nimport 'core/js/drawer';\r\nimport 'core/js/notify';\r\nimport 'core/js/router';\r\nimport 'core/js/models/lockingModel';\r\nimport 'core/js/mpabc';\r\nimport 'core/js/helpers';\r\nimport 'core/js/scrolling';\r\nimport 'core/js/headings';\r\nimport 'core/js/navigation';\r\nimport 'core/js/startController';\r\nimport 'plugins';\r\n\r\n$('body').append(Handlebars.templates.loading());\r\n\r\ndata.on('ready', () => {\r\n  logging.debug('Calling Adapt.init');\r\n  Adapt.init();\r\n  Adapt.off('adaptCollection:dataLoaded courseModel:dataLoaded');\r\n}).init();\r\n"],"names":["Wait","Backbone","Controller","initialize","_waitCount","_callbackHandle","being","begin","bind","end","isWaiting","trigger","clearTimeout","setTimeout","queue","callback","Promise","resolve","once","for","_","defer","wait","LockingModel","Model","set","attrName","attrVal","options","stopProcessing","isLocking","arguments","isSettingValueForSpecificPlugin","pluginName","console","error","defaults","undefined","_lockedAttributes","lockingValue","isAttemptingToLock","setLockState","skipcheck","totalLockValue","getLockCount","setLocking","defaultLockValue","unsetLocking","_lockedAttributesValues","Object","keys","length","isCheckingGeneralLockingState","isUsingLockedAttributes","Boolean","lockedAttributes","result","isAttributeALockingAttribute","hasOwnProperty","isLocked","shouldSkipCheck","isGettingValueForSpecificPlugin","lockingAttributeValues","values","lockingAttributeValuesSum","reduce","sum","value","AdaptSingleton","loadScript","window","__loadScript","_canScroll","_outstandingCompletionChecks","_pluginWaitCount","_isStarted","_shouldDestroyContentObjects","init","addDirection","disableAnimation","deferUntilCompletionChecked","History","started","history","start","checkingCompletion","outstandingChecks","get","checkedCompletion","checkIfAnyChecksOutstanding","model","off","on","isWaitingForPlugins","log","deprecated","checkPluginsReady","parseRelativeString","relativeString","splitIndex","search","type","slice","replace","offset","parseInt","trim","defaultDirection","config","$","addClass","attr","disableAnimationArray","i","l","is","toggleClass","remove","currentView","parentView","setOnChildren","_isReady","_isRendered","destroy","a11y","componentStore","data","device","drawer","location","notify","offlineStorage","router","scrolling","startController","store","tracking","navigateToElement","scrollTo","register","name","object","getViewName","getViewClass","getModelName","getModelClass","findById","findViewByModelId","findByTrackingPosition","Adapt","OfflineStorage","handler","ready","_handler","hasHandler","save","serialize","JSON","stringify","deserialize","parse","clear","setReadyStatus","Device","bindAll","bowser","Bowser","navigator","userAgent","$html","$window","touch","Modernizr","touchevents","screenWidth","getScreenWidth","screenHeight","getScreenHeight","browser","toLowerCase","version","OS","getOperatingSystem","osVersion","os","renderingEngine","getRenderingEngine","listenTo","onConfigDataLoaded","browserString","getAppleDeviceType","pixelDensity","orientation","aspectRatio","screenSize","checkScreenSize","onWindowResize","screenSizeConfig","screensizeEmThreshold","baseFontSize","mediumEmBreakpoint","medium","smallEmBreakpoint","small","fontSize","parseFloat","css","screenSizeEmWidth","innerWidth","isAppleDevice","getAppleScreenWidth","width","getAppleScreenHeight","innerHeight","height","platform","match","engine","hasWindowResized","requestAnimationFrame","calculateResize","previousWidth","previousHeight","newScreenSize","test","MSStream","maxTouchPoints","shouldReportInvertedAppleScreenSize","windowRatio","screenRatio","screen","isWindowPortrait","isScreenPortrait","isDeviceBadlyReportingScreenOrientation","platformType","browserName","isIPhone","isIPad","devicePixelRatio","Location","_previousId","_previousContentType","_previousModel","_previousClasses","_lastVisitedType","_lastVisitedMenu","_lastVisitedPage","_currentId","_currentModel","_currentLocation","_contentType","BrowserFocus","_onBlur","_onClick","$body","_attachEventListeners","addEventListener","event","_isEnabled","_options","_isFocusNextOnDisabled","$element","target","removeAttr","currentTarget","focusNext","isAriaDisabled","closest","preventDefault","stopImmediatePropagation","_isFocusOnClickEnabled","$stack","toArray","parents","$focusable","filter","_tabbableElements","focus","FocusOptions","constructor","preventScroll","KeyboardFocusOutline","_onKeyDown","showOnKeys","document","_start","_isFocusOutlineDisabled","_isFocusOutlineKeyboardOnlyEnabled","keyCode","_focusOutlineKeyboardOnlyIgnore","removeClass","LOG_LEVEL","ENUM","Logging","_config","_level","INFO","asLowerCase","_console","_warnFirstOnly","_warned","listenToOnce","onLoadConfigData","loadConfig","debug","has","checkQueryStringOverride","matches","override","toUpperCase","args","_log","DEBUG","info","warn","WARN","ERROR","fatal","FATAL","removed","concat","warnOnce","_hasWarned","level","isEnabled","configLevel","isLogLevelAllowed","_logToConsole","shouldLogToConsole","asUpperCase","push","hash","map","String","join","logging","Log","_canWarn","_warn","Scroll","_onTouchStart","_onTouchEnd","_onScrollEvent","_scrollDisabledElements","_preventScrollOnKeys","_ignoreKeysOnElementsMatching","_isRunning","_touchStartEventObject","disable","$elements","add","_checkRunning","enable","not","_stop","passive","fix","_preventScroll","$target","isGesture","touches","scrollingParent","_getScrollingParent","scroll","isTouchEvent","hasTouchStartEvent","originalEvent","directionY","_getScrollDirection","$parent","_isScrollable","_isScrolling","scrollType","pointerEvents","scrollTop","Math","ceil","outerHeight","scrollHeight","hasScrollingSpace","deltaY","_getScrollDelta","startOriginalEvent","currentY","pageY","previousY","hasDeltaY","wheelDeltaY","wheelDelta","removeEventListener","WrapFocus","_focusguard","_onWrapAround","_isPopupWrapFocusEnabled","stopPropagation","focusFirst","Popup","_floorStack","_focusStack","_tabIndexes","_ariaHiddens","_elementUIDIndex","ignoreInternalTrigger","opened","closed","$popupElement","silent","activeElement","_addPopupLayer","_isPopupManagementEnabled","_tabbableElementsExcludes","$branch","$siblings","siblings","each","index","item","$item","a11y_uid","elementUID","tabindex","ariaHidden","_isPopupTabIndexManagementEnabled","_isPopupAriaHiddenManagementEnabled","$items","find","_ariaHiddenExcludes","$focusElement","$previousFocusElement","_removeLastPopupLayer","pop","previousTabIndex","previousAriaHidden","setCloseTo","$original","_menu","_menuGroup","_menuItem","_page","_article","_block","_component","_componentItem","_notify","assign","fn","isFixedPostion","a11y_aria_label","limitedScrollTo","a11y_text","a11y_selected","a11y_on","isOn","$tabbable","findTabbable","toggleAccessible","a11y_only","scrollDisable","_isScrollDisableEnabled","scrollEnable","a11y_popup","popupOpened","a11y_cntrl","withDisabled","toggleEnabled","a11y_cntrl_enabled","toggleAccessibleEnabled","isReadable","findForward","selector","_findFirstForward","findWalk","_findFindForwardDescendant","focusNoScroll","returnOnly","findFirstReadable","focusOrNext","a11y_focus","dontDefer","a11y_alert","a11y_update","text","toggleHidden","a11y_popdown","$focusTarget","popupClosed","a11y_normalize","html","normalize","a11y_remove_breaks","removeBreaks","Components","_register","Array","isArray","forEach","split","view","View","template","isModelSetAndInvalid","prototype","Function","Error","isViewSetAndInvalid","nameModelViewOrData","toJSON","foundName","entries","key","entry","names","_view","_type","isBackboneView","nameModelOrData","isViewOnlyQuestion","_isQuestionType","_model","isBackboneModel","components","AdaptCollection","Collection","models","loadedData","BuildModel","jsonext","attrs","url","fetch","success","isLoaded","isFrameworkVersion","semver","satisfies","includePrerelease","isPluginInstalled","plugin","whenReady","ConfigModel","large","_forceRouteLocking","_canLoadData","_disableAnimation","setValuesFromURLParams","paramMappings","dir","lang","params","URLSearchParams","passedVal","build","includes","loadData","Data","json","ModelClass","onAdded","onRemoved","reset","_byAdaptID","loadConfigData","onLoadCourseData","onLanguageChange","onDirectionChange","direction","loadCourseData","language","newLanguage","courseFolder","loadManifestFiles","triggerDataLoaded","triggerDataReady","triggerInit","getJSON","path","reject","__path__","fail","languagePath","manifestPath","manifest","err","allFileData","all","filePath","allModelData","fileData","datum","__index__","course","modelData","call","checkData","setupModel","e","isReady","hasId","id","idPathToView","currentLocationId","currentLocationModel","getAncestorModels","modelId","unshift","foundView","currentId","childViews","getChildViews","trackingPosition","trackingId","indexInTrackingIdDescendants","trackingIdModel","trackingIdDescendants","getAllDescendantModels","isTypeGroup","trackingIdAncestors","ancestorDistance","abs","logReadyError","notReadyDescendants","reverse","checkIds","checkTrackingIds","items","idIndex","indexBy","idGroups","groupBy","parentIdGroups","orphanedIds","emptyIds","duplicateIds","missingIds","o","isCourseType","isComponentType","_id","_parentId","hasErrored","number","trackingIdType","trackingIdCounts","missingTrackingIds","_trackingId","duplicateTrackingIds","group","A11y","_isFocusAssignmentEnabled","_isAriaHiddenManagementEnabled","_focusableElements","_readableElements","_focusForwardElementsExcludes","_wrapStyleElements","isFocusable","isTabbable","_htmlCharRegex","_browserFocus","_keyboardFocusOutline","_wrapFocus","_popup","_scroll","_removeLegacyElements","_onConfigDataLoaded","_setupNoSelect","_onNavigationStart","_onNavigationEnd","_isActive","_addFocuserDiv","_disableTextSelectOnClasses","classes","isMatch","some","className","append","$legacyElements","children","$navigationElements","isActive","ariaLevel","ariaLevels","_ariaLevels","defaultAriaLevels","calculateLevel","isNumber","isNaN","isTypeName","relativeDescriptor","nextLevel","hasModelId","nextModel","findAncestor","nextModelId","hasNextTitle","nextModelOverride","accumulatedOffset","resolvedLevel","isHidden","isAccessibleEnabled","toggleTabbableDescendants","element","isAdaptTabHidden","adaptPreviousTabIndex","findFirstTabbable","first","findFirstFocusable","findReadable","findFocusable","checkParents","isNotVisible","hasReadableContent","hasNativeFocusOrIsScreenReadable","childNodes","c","cl","childNode","isTextNode","nodeType","isOnlyWhiteSpace","nodeValue","iterator","$tag","$found","_findFirstForwardDescendant","nextAll","sibling","$sibling","parent","$notFound","stack","stackIndexPosition","childIndexPosition","stackEntry","$stackItem","splice","perform","y","htmls","isString","$div","stackIndex","outputs","nodes","usable","node","isStyleElement","apply","rtnText","outerHTML","textContent","setPopupCloseTo","DrawerItemView","attributes","role","render","events","Handlebars","templates","el","appendTo","onDrawerItemClicked","eventCallback","DrawerView","_isVisible","drawerDir","drawerDuration","_duration","setupEventListeners","toggleDrawer","openCustomView","onCloseDrawer","onRemove","onKeyUp","setupEscapeKey","which","_globals","prependTo","shadowTemplate","shadow","postRender","checkIfDrawerIsAvailable","hasBackButton","_hasBackButton","_isCustomViewVisible","showDrawer","isEmptyDrawer","collection","onBackButtonClicked","onCloseClicked","hideDrawer","$toElement","emptyDrawer","$el","renderItems","hideDrawerBackButton","complete","addShadowEvent","velocity","opacity","duration","easing","_showEasing","empty","isList","_hideEasing","removeShadowEvent","one","childContainer","childView","DrawerCollection","comparator","Drawer","addItem","drawerObject","triggerCustomView","AdaptSubsetCollection","loadSubset","ModelEvent","canBubble","deepPath","timeStamp","addPath","AdaptModel","_children","_parent","extend","_canShowFeedback","_classes","_canReset","_canRequestChild","_isComplete","_isInteractionComplete","_isA11yRegionEnabled","_isA11yCompletionDescriptionEnabled","_requireCompletionOf","_isResetOnRevisit","_isAvailable","_isOptional","_isVisited","_isLocked","_isHidden","firstDescendant","nearestTrackingIdModel","findIndex","descendant","ancestor","trackable","trackableType","bubblingEvents","hasManagedChildren","setupChildListeners","checkCompletionStatus","checkInteractionCompletionStatus","checkLocking","checkVisitedStatus","setupTrackables","originalTrackableStateFunction","triggerTrackableState","compose","isQueued","debounce","changed","trackablePropertyNames","changedPropertyNames","isTrackable","getChildren","onAll","bubble","checkReadyStatus","onIsComplete","getTrackableState","resultExtend","pick","setTrackableState","state","canReset","getAvailableChildModels","child","isVisited","setVisitedStatus","setCompletionStatus","checkCompletionStatusFor","completionAttribute","completed","requireCompletionOf","every","getTypeGroup","typeGroup","hasUpperCase","isPluralized","lowerCased","singular","singularLowerCased","pluralizedLowerCaseTypes","typeGroups","getTypeGroups","intersection","_typeGroups","parentClass","getPrototypeOf","uniq","s","ancestorType","getParent","findDescendantModels","descendants","allDescendantsModels","returnedDescendants","where","property","isParentFirst","subDescendants","findRelativeModel","rootModel","limitParentId","searchBackwards","moveBy","movementCount","hasDescendantsOfType","pageDescendants","modelIndex","pageDescendant","isFilterFunction","loop","totalOfType","count","isSelf","_childrenCollection","childrenCollection","sort","setChildren","_parentModel","parentId","setParent","shouldIncludeChild","context","getSiblings","passSiblingsAndIncludeSelf","_hasSiblingsAndSelf","siblingsCollection","setOptional","lockType","setSequentialLocking","setUnlockFirstLocking","setLockLastLocking","setCustomLocking","previousChild","isLockedByPreviousChild","firstChild","shift","isLockedByFirstChild","lastChild","isLockedByChildren","shouldLock","lockedBy","anotherModel","checkIfResetOnRevisit","isResetOnRevisit","deepClone","modifier","clonedModel","clonedId","shouldAssignUniqueId","cid","uniqueId","cidPrefix","clone","ContentObjectModel","isParentCourse","_siblings","ArticleModel","BlockModel","ComponentModel","_isA11yComponentDescriptionEnabled","_shouldStoreAttempts","_userAnswer","_attemptStates","onAdaptInitialize","restoreUserAnswers","storeUserAnswer","resetUserAnswer","wasReset","getAttemptState","trackables","types","n","booleans","v","numbers","Number","arrays","getAttemptObject","setAttemptObject","addAttemptObject","attemptStates","getAttemptObjects","states","MenuModel","CourseModel","PageModel","ChildEvent","isForced","isStoppedImmediate","isStoppedNext","hasRequestChild","force","stop","immediate","stopNext","close","TemplateRenderEvent","mode","component","preRenderEvent","postRenderEvent","original","React","createElement","__html","compile","output","flatten","prefixClasses","prefixes","prefixed","prefix","AdaptView","toggleVisibility","onIsCompleteChange","isJSX","_classSet","Set","_isRemoved","preRender","setupOnScreenHandler","addChildren","eventName","startsWith","props","Template","updateViewProperties","ReactDOM","classesToAdd","classesToRemove","delete","_setAttributes","onscreen","m","minVerticalInview","_percentInviewVertical","percentInviewVertical","nthChild","addedCount","addDescendants","_getAddChildEvent","subsequentModels","_nthChild","ChildView","addChildView","setChildViews","$parentContainer","addedDescendantCount","onReadyChange","stopListening","isRequestChild","canRequestChild","findDescendantViews","resetCompletionStatus","descendantComponents","preRemove","unmountComponentAtNode","setVisibility","setHidden","isComplete","_childViews","ContentObjectView","inview","lock","_loadingErrorTimeout","isReact","_isTriggeredReady","performIsReady","hide","unlock","styleOptions","renderTo","isRenderToSelf","ids","forceUntilId","addingId","PageView","$pageLabel","ArticleView","BlockView","MPABC","loading","waitForDataLoaded","loaded","onDataLoaded","setupSubsetCollections","contentObjects","articles","blocks","mpabc","NotifyPushView","updateIndexPosition","updatePushPosition","hasBeenRemoved","notifyPush","delay","closePush","triggerEvent","elementHeight","navigationHeight","currentIndex","flippedIndex","positionLowerPush","NotifyModel","_showIcon","_timeout","NotifyPushCollection","onPushAdded","onRemovePush","checkPushCanShow","canShowPush","showPush","availablePushNotifications","inactivePushNotifications","NotifyPopupView","isOpen","hasOpened","closeNotify","resetNotifySize","cancelNotify","notifyPopup","showNotify","onAlertButtonClicked","onPromptButtonClicked","onCloseButtonClicked","onShadowClicked","resizeNotify","windowHeight","notifyHeight","isFullWindow","top","addSubView","$previousActiveElement","imageready","onLoaded","onOpened","subView","check","stackItem","onCloseReady","removeSubView","views","NotifyView","_stack","notifyPushes","_deprecated","notifyObject","create","notifyTemplate","_shouldRenderId","_isCancellable","_showCloseButton","_closeOnShadowClick","popup","alert","prompt","RouterModel","_canNavigate","_shouldNavigateFocus","Router","routes","_isBackward","_navigationRoot","_isCircularNavigationInProgress","showLoading","$wrapper","setDocumentTitle","navigateToArguments","show","hideLoading","currentModel","hasSubTitle","title","escapedTitle","navigate","handleRoute","handleId","handlePluginRouter","action","pluginLocation","updateLocation","isContentObject","navigateToId","isRoot","_isMenuDisabled","navigateBack","isCourse","newLocation","handleNavigationFocus","ViewClass","isMenu","invoke","isScrolling","currentLocation","setGlobalClasses","htmlClasses","currentClasses","back","navigateToCurrentRoute","route","navigateToPreviousRoute","previousModel","navigateToParent","parentModel","navigateToHomeRoute","settings","currentModelId","isSelectorAnId","contentObject","contentObjectId","isNotInCurrentContentObject","shouldReplace","isElementUnavailable","disableScrollToAnimation","offsetTop","hasClass","left","axis","Scrolling","isLegacyScrolling","_loadConfig","limitTo","_limitToSelector","isIncluded","_windowScrollFix","_addStyling","_updateScrollbarWidth","$tester","scrollBarWidth","outerWidth","documentStyle","documentElement","style","setProperty","body","scrollY","scrollX","scrollLeft","scrollWidth","defineProperties","pageYOffset","pageXOffset","isObject","MouseEvent","pageX","clientX","clientY","StartController","setStartLocation","replaceState","getStartHash","returnToStartLocation","startIds","startId","_skipIfComplete","alwaysForce","getStartId","isRouteSpecified","href","indexOf","shouldForceStartId","shouldNavigateToStartId","_className","skipIfComplete","done","COMPLETION_STATE","Tracking","_requireContentCompleted","_requireAssessmentCompleted","_shouldSubmitScore","_assessmentState","onAssessmentComplete","onAssessmentRestored","checkCompletion","assessmentState","submitScore","isPercentageBased","scoreAsPercent","score","minScore","maxScore","completionData","getCompletionData","status","INCOMPLETE","canRetry","assessment","FAILED","isPass","PASSED","COMPLETED","newShouldSubmitScore","legacyShouldSubmitScore","_tracking","beginWait","endWait","isEventListening","_events","accessibility","onRender","cb","intercept","partials","_imgLazyLoad","applyImgLoadingFix","findImgTag","hasLoadingAttr","imgTagsFound","img","_jsxReactHelpersHTML","applyReactHelpersHTML","tagName","hasSomeUnsafeConversions","hasManyChildren","HTMLReactParser","dangerouslySetInnerHTML","helpers","lowercase","capitalise","charAt","inc","dec","odd","equals","block","compare","operator","inverse","math","lvalue","rvalue","any","specified","none","toString","root","compile_a11y_text","compile_a11y_normalize","compile_a11y_remove_breaks","import_globals","import_adapt","adapt","directImport","indexedImport","importArray","importIndex","i1","l1","component_description","isNotDefined","_components","hasOverride","description","ariaRegion","SafeString","a11y_aria_label_relative","a11y_aria_image","texts","a11y_wrap_focus","cfg","a11y_attrs_heading","from","lastItem","_ariaLevel","a11y_aria_level","a11y_attrs_tabbable","a11y_alt_text","visible","alternatives","if_value_equals","lowerCase","registerHelper","HeadingView","updateAria","customHeadingType","$rendered","Headings","onViewRender","$headingSeats","NavigationView","sortNavigationButtons","onNavigate","_accessibility","insertBefore","currentEvent","skipNavigation","hideNavigationButton","shouldHide","container","a","b","appendChild","showNavigationButton","NavigationController","addNavigationBar","adaptConfig","_isDefaultNavigationDisabled","navigation","ItemModel","_score","toggleActive","toggleVisited","ItemsComponentModel","_items","setUpItems","booleanArray","_index","getItem","findWhere","getVisitedItems","getActiveItems","getActiveItem","areAllItemsCompleted","resetActiveItems","setActiveItem","activeItem","CardsModel","_animateItems","_transitionSpeed","toggleItemsState","ComponentView","renderState","setupInviewCompletion","inviewElementSelector","$inviewElement","inviewCallback","onInview","removeInviewListener","visiblePartX","visiblePartY","hasSeenTop","hasSeenBottom","CardsView","onClick","onKeyDown","setHeight","checkIfOnScreen","setupItems","$collection","maxHeight","getMaxScrollHeight","max","animateItems","itemIndex","BUTTON_STATE","textPropertyName","SUBMIT","CORRECT","INCORRECT","SHOW_CORRECT_ANSWER","HIDE_CORRECT_ANSWER","SHOW_FEEDBACK","RESET","ButtonsView","onButtonStateChanged","onFeedbackMessageChanged","onAttemptsChanged","onCanSubmitChange","buttons","refresh","checkResetSubmittedState","isSubmitted","onActionClicked","buttonState","correctAnswer","getCorrectAnswerAsText","updateAnswerLiveRegion","userAnswer","getUserAnswerAsText","onFeedbackClicked","changedAttribute","updateAttemptsCount","$buttonsAction","propertyName","asString","ariaLabel","buttonText","checkFeedbackState","canShowFeedback","isInteractionComplete","attemptsLeft","shouldDisplayAttempts","attemptsString","remainingAttemptText","remainingAttemptsText","showMarking","answer","shouldShowMarking","isCorrect","ariaLabels","_ariaLabels","$marking","$ariaLabel","hasSpanAriaLabel","answeredCorrectly","answeredIncorrectly","QuestionModel","_shouldDisplayAttempts","_shouldShowMarking","_canShowModelAnswer","_canShowMarking","_canSubmit","_isSubmitted","_isCorrectAnswerShown","_questionWeight","_hasItemScoring","setupDefaultSettings","updateRawScore","setupWeightSettings","setupButtonSettings","globalButtons","componentButtons","canSubmit","checkCanSubmit","updateAttempts","setQuestionAsSubmitted","markQuestion","setScore","questionWeight","_rawScore","_maxScore","_minScore","checkQuestionCompletion","updateButtons","canShowModelAnswer","setupFeedback","setupCorrectFeedback","isPartlyCorrect","setupPartlyCorrectFeedback","setupIncorrectFeedback","feedbackTitle","getFeedbackTitle","feedbackMessage","correct","feedback","_partlyCorrect","final","setAttemptSpecificFeedback","_incorrect","notFinal","isInteractive","attempts","_attemptsLeft","_isCorrect","_buttonState","setQuestionAsReset","resetQuestion","getButtonState","getInteractionObject","getResponse","getResponseType","onSubmitted","QuestionView","onEnabledChanged","ensureLegacyLifecycleState","_runModelCompatibleFunction","setupQuestion","disableQuestion","enableQuestion","resetQuestionOnRevisit","onHideCorrectAnswerClicked","onResetClicked","addButtonsView","onQuestionRendered","buttonsView","onButtonStateUpdate","onSubmitClicked","onShowCorrectAnswerClicked","showFeedback","showInstructionError","onCannotSubmit","recordInteraction","resize","setQuestionAsShowCorrect","showCorrectAnswer","setQuestionAsHideCorrect","hideCorrectAnswer","getLatency","lookForViewOnlyFunction","ViewOnlyQuestionViewCompatibilityLayer","_isInViewOnlyCompatibleMode","checkForFunction","hasCompatibleVersion","usingCompatibleVersion","ChooseView","onKeyPress","onItemOptionSelect","setupRandomisation","_spaceSize","_spaces","_choose","updateItem","_selected","getChoose","_hasGraphic","_graphic","selected","getItemElement","_text","$input","optionIndex","val","setOptionSelected","replaceWith","option","_isSelected","ChooseModel","setupQuestionItemIndexes","choice","shuffle","isSelected","numberOfCorrectAnswers","itemLength","interactions","correctResponsesPattern","source","questionIndex","flat","Infinity","responses","correctAnswerTemplate","ariaCorrectAnswer","ariaAnswer","correctOption","itemText","userAnswerTemplate","ariaUserAnswer","answerArray","AccordionModel","_shouldCollapseItems","_shouldExpandFirstItem","_toggleSpeed","checkExpandFirstItem","previousActiveItem","AccordionView","onItemsActiveChange","toggleItem","shouldExpand","slideUp","slideDown","AssessmentResultsModel","onAssessmentReset","checkIfAssessmentComplete","assessmentModel","getState","allowResetIfPassed","_state","attemptsSpent","setFeedbackBand","checkRetryEnabled","setFeedbackText","scoreProp","bands","sortBy","isScoreInBandRange","canResetInPage","feedbackBand","isRetryEnabled","_allowRetry","isAttemptsLeft","showRetry","_isRetryEnabled","retryFeedback","isAttemptInProgress","attemptInProgress","isVisibleBeforeCompletion","isVisible","resetType","_feedbackBand","AssessmentResultsView","reviewAnswer","fristQuestion","questions","article","addClassesToArticle","onRetryClicked","_routeToAssessment","articleId","BlankView","Flipcard","reRender","testProp","imageHeight","eq","onClickFlipItem","$selectedElement","flipType","performAllFlip","performSingleFlip","$frontflipcard","$backflipcard","flipTime","fadeOut","fadeIn","flipcardElementIndex","setVisited","flipcardContainer","frontflipcard","backflipcard","visibleflipcardBack","McqView","onItemSelect","onItemFocus","onItemBlur","itemModel","shouldSelect","isSingleSelect","isAtActiveLimit","getLastActiveItem","resetItems","GmcqView","BlendedItemsComponentQuestionModel","getOwnPropertyNames","defineProperty","ItemsQuestionModel","itemModels","activeItems","allChildren","activeChildren","isItemCorrect","isItemPartlyCorrect","isItemIncorrect","list","predicate","_numberOfRequiredAnswers","_numberOfCorrectAnswers","_numberOfPartlyCorrectAnswers","_numberOfIncorrectAnswers","_isAtLeastOneCorrectSelection","numberOfSelectableAnswers","hasSelectableCorrectAnswers","hasAllCorrectAnswers","hasCorrectAnswers","hasIncorrectAnswers","hasPartlyCorrectAnswers","scores","setupIndividualFeedback","selectedItem","selectedItems","choices","correctItems","activeIndexes","globals","ariaCorrectAnswers","correctOptions","_shouldBeSelected","ariaUserAnswers","McqModel","GmcqModel","GraphicView","_url","_target","isNewWindow","open","isRouterNavigation","substr","GraphicModel","HotgraphicPopupView","onControlClick","onItemsVisitedChange","applyNavigationClasses","updatePageCount","handleTabs","itemCount","canCycleThroughPagination","shouldEnableBack","shouldEnableNext","$controls","_hotgraphic","popupPagination","labelText","itemNumber","totalItems","applyItemClasses","handleFocus","closePopup","getNextIndex","setItemState","lastIndex","nextItem","HotGraphicView","setUpViewData","setUpModelData","setUpEventListeners","popupView","_isPopupOpen","replaceWithNarrative","NarrativeView","prepareNarrativeModel","newNarrative","$container","_wasHotgraphic","originalBody","originalInstruction","$pin","visitedLabel","visited","innerHTML","onPinClicked","openPopup","_attributes","onPopupClosed","HotgraphicView","MatchingView","preinitialize","setActiveOption","setHighlightedOption","setupInitialHighlighted","MatchingItemModel","_isHighlighted","toggleHighlighted","isHighlighted","MatchingModel","itemOptions","_optionIndex","_itemIndex","_selectable","selectOption","getActiveItemOption","getFirstItemOption","resetHighlightedItems","activeCount","getItemOptions","getCorrectItemOption","activeOption","unsetDuplicateOptions","allowOnlyUniqueAnswers","activeItemOption","activeItemOptionText","otherActiveOptions","optionText","hasMatchingText","maxItemScores","optionScores","minItemScores","itemPosition","optionPosition","_matching","mepPrototype","mejs","MediaElementPlayer","detectFullscreenMode","vendorPrefix","getVendorPrefix","fsEventName","fullScreenEventHandler","elementName","MepDefaults","keyActions","defaultSeekForwardInterval","defaultSeekBackwardInterval","purge","d","i18n","locale","strings","ariaLabelMappings","playText","pauseText","stopText","audioPlayerText","videoPlayerText","tracksText","timeSliderText","muteText","unmuteStatusText","muteStatusText","volumeSliderText","fullscreenText","goFullscreenText","turnOffFullscreenText","noneText","skipBackText","allyVolumeControlText","progessHelpText","dynamicLabels","fixedDefaults","_media","k","MediaView","playerOptions","toggleCaptionsButtonWhenOnlyOne","onScreenSizeChanged","onDeviceChanged","onMediaStop","_isMediaEnded","_isMediaPlaying","media","protocol","setupPlayer","addMejsButtonClass","modelOptions","pluginPath","flashName","flashScriptAccess","features","onPlayerReady","startLanguage","checkForSupportedCCLanguage","alwaysShowControls","hideVideoControlsOnLoad","addMediaTypeClass","addThirdPartyFixes","mediaelementplayer","cleanUpPlayer","mp3","mp4","ogv","webm","typeClass","ogg","froogaloopAdded","getScript","containerLabel","completionEvent","mediaElement","seeking","onMediaElementSeeking","timeupdate","onMediaElementTimeUpdate","play","onMediaElementPlay","pause","onMediaElementPause","ended","onMediaElementEnded","listenForCaptionsChange","srclang","player","selectedTrack","onCaptionsChanged","setTrack","$inputs","prop","cc","queueGlobalEvent","onWidgetInview","isInView","paused","maxViewed","currentTime","setupPlayPauseToggle","clickToPlayPause","onOverlayClick","onMediaElementClick","isPaused","isRemoved","playerId","players","src","pluginElement","domObject","hasTouch","MediaFeatures","addThirdPartyAfterFixes","cleanUpPlayerAfter","setVolume","onSkipToTranscript","onToggleInlineTranscript","$transcriptBodyContainer","$button","$buttonText","inlineTranscriptButton","inlineTranscriptCloseButton","_setCompletionOnView","onExternalTranscriptClicked","eventType","time","Date","now","lastEvent","timeSinceLastEvent","debounceTime","eventTimeout","triggerGlobalEvent","eventObj","pluginType","isVideo","NarrativeModel","_isInitial","renderMode","calculateWidths","isTextBelowImage","setStage","setFocus","$straplineHeaderElm","hasStraplineTransition","isLargeMode","focusOnNarrativeElement","dataIndexAttr","$elementToFocus","calculateMode","MODE","LARGE","SMALL","setupNarrative","replaceInstructions","_totalWidth","_itemWidth","resizeControl","previousMode","evaluateNavigation","replaceWithHotgraphic","evaluateCompletion","prepareHotgraphicModel","newHotgraphic","instruction","moveSliderToIndex","cssValue","$sliderElm","indexSelector","$slideGraphics","$narrativeItems","$narrativeStraplineButtons","shouldShowInstructionError","active","isAtStart","isAtEnd","$left","$right","ariaLabelsGlobals","narrativeGlobals","_narrative","ariaLabelPrevious","previous","ariaLabelNext","next","prevTitle","nextTitle","currentItem","onNavigationClicked","$btn","onSwipeLeft","onSwipeRight","onProgressClicked","prevItemIndex","SliderView","selectItem","getIndexFromValue","setupRangeslider","$sliderScaleMarker","$slider","step","rangeslider","polyfill","onSlide","handleSlide","oldValue","_deferEnable","setAllItemsEnabled","position","pixels","mapIndexToPixels","animateToPosition","setScalePositions","showScaleMarker","newPosition","mobileHA","itemValue","scaleStart","scaleEnd","round","mapValue","$widthObject","numberOfItems","mapPixelsToIndex","normalise","low","high","range","inputLow","inputHigh","outputLow","outputHigh","normal","onHandleFocus","onHandleBlur","newItemIndex","min","setSliderValue","getValueFromIndex","onNumberSelected","resetControlStyles","animate","change","normalisedPosition","showScale","$markers","$scaler","showScaleNumbers","$numbers","scaleWidth","$number","newLeft","showLabels","remapSliderBar","answers","getCorrectAnswers","middleAnswer","floor","showModelAnswers","correctAnswerArray","$parentDiv","startingLeft","userAnswerIndex","deselectAllItems","showNumber","$scaleMarker","SliderModel","setupModelItems","selectDefaultItem","getDecimalPlaces","num","dp","toFixed","_bottom","_top","_marginDir","answerSingle","answerMultiple","bottom","_slider","ariaCorrectAnswerRange","answerTemplate","TextView","setupInview","gsapTest","getInviewElementSelector","gsap","registerPlugin","ScrollTrigger","to","scrollTrigger","scrub","x","autoAlpha","ease","Power4","easeOut","utils","ele","TextModel","TextInputView","$itemInput","clearValidationError","showValidationError","correctAnswers","_answers","onInputChanged","setItemUserAnswer","TextInputModel","genericAnswerIndexOffset","_answerIndex","genericAnswers","answerIndex","markGenericAnswers","markSpecificAnswers","usedAnswerIndexes","answerGroup","checkAnswerIsCorrect","cleanupUserAnswer","possibleAnswers","uAnswer","answerIsCorrect","cAnswer","FlexModel","FlexView","onMouseOver","Flipper","locked","onImageReady","setItemVisibility","setItemHeights","hMax","h","stage","rx","setLock","numItems","$flipper","flipper","GraphicCompareView","onChange","initialValue","GraphicCompareModel","_value","LottieInteractivityView","lottieModel","lottieplayerEl","controls","setAttribute","autoplay","speed","renderer","background","preserveAspectRatio","lottieplayer","failed","interactivity","LottieInteractivity","LottieInteractivityModel","getNavigationData","buttonTypeModels","_returnToPreviousLocation","getReturnToPreviousLocation","getCurrentPage","_up","getCurrentMenu","_root","_next","getNextPage","_previous","getPrevPage","_sibling","getSiblingPages","_close","order","currentPageComplete","buttonConfig","buttonModel","_lockUntilPageComplete","_customRouteId","orderedData","getParents","currentMenu","siblingModels","currentPage","currentPageId","pages","getPages","hasFoundCurrentPage","page","isNotAvailable","loopStyle","Tooltip","removeOtherTooltips","setupData","tooltip","checkPosition","buttonPosition","buttonWidth","buttonHalfWidth","buttonCenterLeft","tooltipWidth","tooltipHalfWidth","tooltipCenter","$offsetParent","offsetParent","parentWidth","overflowRight","overflowLeft","isOverflowingRight","isOverflowingLeft","leftOffset","onBodyMouseOver","getAttributes","$node","attribute","onContentObjectComplete","checkButtonStates","checkButtonState","button","$buttonRendered","renderedAttrs","renderedAttrNames","attrNames","removeAttrNames","difference","onButtonClick","execute","navigateTo","onButtonTooltip","isCurrentTooltip","SelectChoiceView","SelectChoiceModel","_selectchoice","TabsView","layout","setItemWidth","onTabItemClicked","onTabItemKeyUp","firstItem","itemWidth","$tabPanel","$tabs","tab","TalkModel","characters","character","_character","TalkView","VerticalItemsModel","VerticalItemsView","onInviewItem","percentInview","isOffScreen","AnimateMenuView","notifyOpened","notifyClosed","firstRun","notifyIsOpen","elementIsInView","modelID","titleEnabled","bodyEnabled","customEnabled","customItems","_title","titleEffect","_effect","titleDelay","_delay","_body","bodyEffect","bodyDelay","_custom","customElement","_element","customEffect","customDelay","animateElements","animateItem","AnimateArticleView","removeInViewListeners","instructionEnabled","instructionDelay","_instruction","instructionEffect","addClasses","_isVisibleTop","_isVisibleBottom","AnimateBlockView","AnimateComponentView","completeElementEnabled","completeElementDelay","_completeElement","completeElementEffect","Animate","onAppDataReady","onLangChange","setupAnimate","setupListeners","removeListeners","onMenuReady","onArticleReady","onBlockReady","onComponentReady","animateArticleEnabled","animateBlockEnabled","animateComponentEnabled","BackgroundSwitcherBlockView","_src","video","_poster","togglePoster","showPoster","backgroundSwitcher","lowBandwidth","visua11y","noAnimations","rewind","blockView","onTimeUpdate","onBlockInView","renderVideo","renderImage","videoTag","getVideoTag","playsinline","preload","_preload","muted","isMuted","load","posterTag","imgTag","addRecord","activeDirection","showBackground","activate","deactivate","forceDeactivate","removeForceDeactivate","updateAttributes","currentActiveView","findRecord","record","currentDeactiveView","removeClasses","setDirection","releaseVideoTag","clearRecords","records","measurement","recordView","current","getCurrent","getPrevious","threshold","_inviewThreshold","onScreens","percentFromTop","percentFromBottom","percentFromRight","percentFromLeft","lowestPostivePercentFromBottom","BackgroundSwitcherPageView","addToBody","onBlockViewPostRender","onLowBandwidthChange","prepend","backgroundSwitcherBlockView","BackgroundSwitcher","onBadMediaEvent","onDataReady","onPageViewPostRender","onVisua11yChanged","_videoTags","_availableVideoTags","_isMuted","_lowBandwidth","hasBackgroundSwitcher","disableSmoothScrolling","createVideoTags","preloadImages","setUpClickJack","applyMute","applyNoAnimation","tag","noBackgroundImages","maxVideos","memo","contentobject","videoBlocks","images","$cache","onloaded","image","Image","isSeated","playsInline","firstClick","pauseAll","click","touchend","shouldDisableSmoothScrolling","wd","csp","BackgroundVideoView","BackgroundVideo","_onDataReady","onPostRender","viewModel","checkIsEnabled","backgroundVideoModel","backgroundVideoView","_selector","isEmpty","minHeight","_backgroundVideoModel","certConfig","date","toLocaleDateString","scormName","getName","domain","origin","message","learnerName","learnerID","postMessage","scormname","pipwerks","SCORM","API","LMSGetValue","replaceAll","nameID","scorm","LearnerName","AssessmentView","AdaptArticleView","isAssessmentEnabled","_setupEventListeners","getConfig","_questions","_onAssessmentComplete","_onAssessmentReset","_onRemove","_removeEventListeners","QuestionBank","quizBankId","_bankId","_articleId","_unusedQuestionBlocks","_count","calculateAvailableQuestionBlocks","articleModel","_availableQuestionBlocks","blockModel","_quizBankID","availableQuestionBlockIds","unusedQuestionBlockIds","haveBlocksChanged","getRandomQuestionBlocks","questionBlocks","nextBlock","unusedQuestionBlocks","hasUnusedQuestion","givenIdCount","assessmentConfigDefaults","_resetType","_suppressMarking","_isPercentageBased","_scoreToPass","_correctToPass","_includeInTotalScore","_assessmentWeight","_reloadPageOnReset","_attempts","_allowResetIfPassed","AssessmentModel","_getCurrentQuestionComponents","_getAllQuestionComponents","_postInitialize","assessmentConfig","_originalChildModels","_questionBanks","_forceResetOnRevisit","_assessmentCompleteInSession","_attemptInProgress","_isAssessmentComplete","_numberOfQuestionsAnswered","_lastAttemptScoreAsPercent","_attemptsSpent","setupCurrentQuestionComponents","_setAssessmentOwnershipOnChildrenModels","_updateQuestionsState","assessmentQuestionsConfig","childConfig","_isPartOfAssessment","_assessmentId","_setupAssessmentData","hasAttemptsLeft","isFirstAttempt","shouldResetOnRevisit","shouldResetAssessment","shouldResetQuestions","quizModels","_banks","_split","_setupBankedAssessment","_randomisation","_setupRandomisedAssessment","_resetQuestions","_overrideQuestionComponentSettings","_setupQuestionListeners","_checkNumberOfQuestionsAnswered","saveState","_setupBanks","questionModels","flatMap","questionBank","bankSplits","hasBankSplitsChanged","bankId","randomisationModel","blockModels","_blockCount","newSettings","_getMarkingSettings","questionConfig","questionComponents","_removeQuestionListeners","_onCompletionEvent","numberOfQuestionsAnswered","_onBlockCompleted","_onQuestionCompleted","questionModel","_checkAssessmentComplete","question","allQuestionsAdded","POSITIVE_INFINITY","allQuestionsAnswered","wasAttemptInProgess","_spendAttempt","_scoreAsPercent","_getScoreAsPercent","_getScore","_getMaxScore","_getMinScore","_correctCount","_getCorrectCount","_correctAsPercent","_getCorrectAsPercent","_questionCount","_getQuestionCount","_checkIsPass","_isMarkingSuppressionEnabled","_isAttemptsLeft","_isPassed","_overrideMarkingSettings","_refreshQuestions","scoreToPass","correctToPass","correctAsPercent","correctCount","markingSettings","_shouldSuppressMarking","newMarkingSettings","questionCount","_getLastAttemptScoreAsPercent","_checkReloadPage","_reloadPage","_scrollToOnReset","_setCompletionStatus","_checkIfQuestionsWereRestored","wereQuestionsRestored","isPageReload","getSaveState","banksActive","randomisationActive","blockTrackingPositions","blockCompletion","blockData","dataPackage","setRestoreState","restoreState","nonBlockChildren","blockIndex","blockQuestions","pageId","includeInTotalScore","assessmentWeight","lastAttemptScoreAsPercent","assessmentsConfigDefaults","_isDefaultsLoaded","Assessment","_assessments","_byPageId","_byAssessmentId","_onAssessmentsComplete","_checkResetAssessmentsOnRevisit","_handleRoute","assessmentId","_getStateByAssessmentId","_setPageProgress","_checkAssessmentsComplete","_restoreModelState","_saveStateModel","toObject","pageAssessmentModels","_getAssessmentByPageId","resetAllAssessments","allAssessmentHaveReset","numberOfAssessments","numberOfResetAssessments","forceAssessmentReset","haveAllModelsReset","_restoredCount","allAssessmentsComplete","assessmentToPostBack","_getStatesByAssessmentId","assessmentStates","_setupSingleAssessmentConfiguration","assessmentsConfig","assessments","assessmentsTotal","assessmentsPassed","pageModel","_subProgressTotal","_subProgressComplete","_addToAssessmentIdMap","_setupQuestionNumbering","getRelatedQuestions","currentAssessmentId","currentAssessment","getQuestionNumber","related","pluck","getTotalQuestions","assessmentsComplete","scoreRange","isFailed","ArticleViewInitialize","AdaptAssessmentArticleView","ArticleModelInitialize","AdaptAssessmentArticleModel","returnValue","Bookmarking","bookmarkLevel","restoredLocationID","currentLocationID","checkCourseIsEnabled","checkRestoreLocation","courseBookmarkModel","_onScroll","checkLocation","setupMenu","setupPage","restoreLocation","isAlreadyOnScreen","_showPrompt","navigateToPrevious","showPrompt","locationOnscreen","isLocationOnscreen","isLocationFullyInview","_buttons","yes","no","navigateCancel","_prompts","promptText","_callbackEvent","isSinglePage","resetLocationID","setLocationID","menuView","menuModel","getBookmarkLevel","defaultLevel","bookmarkModel","isInherit","pageView","pageBookmarkModel","releaseViews","contentObjectBookmarkModel","possibleViewIds","desc","highestOnscreen","highestOnscreenLocation","measurements","setupHelpers","LanguagePickerView","initializeNavigation","onLanguageClick","destroyNavigation","setLanguage","navigationView","LanguagePickerDrawerView","promptObject","getPromptObject","onDrawerClosed","onPopupOpened","onDoChangeLanguage","onDontChangeLanguage","$finishFocus","setTrackedData","getLanguageDetails","_direction","warningTitle","warningMessage","LanguagePickerNavView","classNames","customClass","LanguagePickerModel","trackedData","locationId","displayTitle","_languages","markLanguageAsSelected","_language","_activeLanguage","_defaultDirection","checkResetOnLanguageChange","shouldReset","hasOfflineStorageClear","isTrackedDataEmpty","isEqual","stateObject","restoreModel","LanguagePicker","onConfigLoaded","languagePickerModel","setupNavigationView","paramLang","onOfflineStorageReady","storedLanguage","showLanguagePickerView","languagePickerView","courseGlobals","_extensions","navigationBarLabel","_languagePicker","languagePickerNavView","Completion","subProgressCompleted","subProgressTotal","nonAssessmentCompleted","nonAssessmentTotal","assessmentCompleted","assessmentTotal","calculateCompletion","contentObjectModel","completion","viewType","availableChildren","filterAvailableChildren","getPageLevelProgressEnabledModels","nonAssessmentComponents","getNonAssessmentComponents","getComponentsCompleted","assessmentComponents","getAssessmentComponents","getComponentsInteractionCompleted","_excludeAssessments","showPageCompletionCourse","_showPageCompletion","showPageCompletionPage","completionObject","unavailableInHierarchy","calculatePercentageComplete","total","percentageComplete","PageLevelProgressIndicatorView","calculatePercentage","setPercentageComplete","checkAria","getRenderData","percentage","PageLevelProgressItemView","addIndicator","PageLevelProgressView","scrollToPageElement","currentComponentSelector","pageLevelProgress","$children","PageLevelProgressNavigationView","_pageLevelProgress","_navOrder","deferredUpdate","updateProgressBar","refreshProgressBar","pageLevelProgressNavigation","indicatorView","_getPageCompletionPercentage","pageLevelProgressIndicatorBar","completionCalculations","repopulate","PageLevelProgressCollection","_pageModel","allDescendants","currentPageItems","availableItems","enabledProgressItems","PageLevelProgress","getCourseConfig","coursePLPConfig","headerIndicatorTypes","headerIndicatorEventNames","renderHeaderIndicatorView","renderMenuItemIndicatorView","renderNavigationView","onCompletionChange","completionState","hasChanged","_previousCompletionState","_isCompletionIndicatorEnabled","pageConfig","$headings","insertAfter","_getMenuItemCompletionPercentage","pageLevelProgressMenuBar","_isShownInNavigationBar","pagePLPConfig","after","ResourcesView","resources","onFilterClicked","$resources","$clickedButton","clickedTabId","resources_has_type","hasType","matcher","resources_has_multiple_types","allSameType","resources_get_column_count","resources_force_download","resource","_forceDownload","filename","Resources","initResources","courseResources","drawerOrder","_drawerOrder","setupResources","resourcesData","Logger","logArr","registeredViews","getInstance","instance","getEntries","getLastEntry","str","LOG_TYPE_INFO","updateViews","LOG_TYPE_WARN","LOG_TYPE_ERROR","LOG_TYPE_DEBUG","registerView","unregisterView","update","ScormError","CLIENT_COULD_NOT_CONNECT","SERVER_STATUS_UNSUPPORTED","CLIENT_STATUS_UNSUPPORTED","CLIENT_COULD_NOT_COMMIT","CLIENT_NOT_CONNECTED","CLIENT_COULD_NOT_FINISH","CLIENT_COULD_NOT_GET_PROPERTY","CLIENT_COULD_NOT_SET_PROPERTY","CLIENT_INVALID_CHOICE_VALUE","defaultMessages","pressOk","ScormWrapper","setCompletedWhenFailed","commitOnStatusChange","commitOnAnyChange","timedCommitFrequency","maxCommitRetries","commitRetryDelay","commitRetryPending","commitRetries","lastCommitSuccessTime","exitStateIfIncomplete","exitStateIfComplete","timedCommitIntervalID","retryCommitTimeoutID","logOutputWin","startTime","endTime","lmsConnected","finishCalled","logger","handleExitMode","suppressErrors","debouncedCommit","commit","__debug","showDebugWindow","__offlineAPIWrapper","API_1484_11","getVersion","setVersion","handleError","initTimedCommit","isFirstSession","getValue","isSCORM2004","setIncomplete","setValue","setCompleted","setPassed","setFailed","getStatus","setStatus","getScore","scaledScore","isSupported","getLessonLocation","setLessonLocation","getSuspendData","setSuspendData","getStudentName","getStudentId","initRetryCommit","errorCode","getCode","errorInfo","getInfo","diagnosticInfo","getDiagnosticInfo","finish","clearInterval","convertToSCORM2004Time","getTime","getExitState","convertToSCORM12Time","quit","response","latency","recordInteractionMultipleChoice","recordInteractionMatching","recordInteractionScorm2004","recordInteractionScorm12","recordInteractionFillIn","setInterval","doRetryCommit","messages","_messages","confirm","getInteractionCount","cmiPrefix","getCMITime","getISO8601Timestamp","checkResponse","scormRecordInteraction","maxLength","msConvert","msPerSec","msPerMin","msPerHour","ms","secs","mins","hrs","padWithZeroes","csConvert","csPerSec","csPerMin","csPerHour","csPerDay","days","hours","cs","seconds","hms","getHours","getMinutes","sec","getSeconds","toISOString","numToPad","padBy","len","responseType","self","checkIdentifier","r","identifiers","completionStatus","isIncomplete","exitState","LZMAWorker","LZMAFactory","ZeroString","makeZeroString","zeroPadRightToLength","string","padLength","zeroPadLeftToLength","zeroPadRightToMultiple","multiple","binaryToUnsignedInteger","binary","binaryLength","integer","shiftUnsignedIntegerFromBinary","shiftBinary","shifted","unsignedIntegerToBinary","byteArrayToString","array","arrayLength","fromCharCode","stringToByteArray","stringLength","charCodeAt","BYTE_BIT_LENGTH","binaryToBase64","bytesCount","charCodes","base64","btoa","base64ToBinary","atob","logs","usedTypes","typeLengths","binarySamples","AbstractValueType","binaryTypeLength","binaryType","FixedIntegerType","esType","valueBinaryLength","minValue","maxValue","pow","valueToBinary","logStats","shiftValueFromBinary","FixedBooleanType","bool","LengthAndValueBinary","bitSizes","maxValues","sizeBinaryLength","parentName","sizeIndex","sizeBinary","valueLength","integerBinary","VariableIntegerType","isNegative","integerBitSizes","VariableArrayType","valueType","findValueTypeFromValues","shiftValueTypeFromBinary","VariableSignedIntegerType","signBinary","VariableDecimalType","isFloat","decimal","decimalBitSizes","float","parts","higherInteger","lowerInteger","integerValueBinary","decimalValueBinary","arrayType","booleanType","integerTypes","decimalTypes","ValueTypes","nameIndex","esTypeOf","findValueTypeFromName","findValueTypeFromValue","isInteger","isValueInValueTypeRange","esTypes","uniqESTypes","isRangeInValueTypeRange","convertValuesToNumbers","Converter","getInvalidTypeError","typeName","clearLog","hasInitialType","printLog","valueFromBinary","serializeAsync","isLargeArray","compress","compressedBase64","isCompressedSmaller","isLZMACompressed","LZMA","decompress","SCORMSuspendData","ComponentSerializer","shouldCompress","shouldStoreResponses","shouldStoreAttempts","isContainer","modelState","hasUserAnswer","isUserAnswerArray","hasAttemptStates","trackingIdMap","attemptObject","StatefulSession","debouncedSaveSession","saveSessionState","_trackingIdType","_componentSerializer","_shouldCompress","_shouldStoreResponses","_shouldRecordInteractions","beginSession","restoreSession","spoor","_advancedSettings","_showDebugWindow","_scormVersion","isBoolean","_suppressErrors","_commitOnStatusChange","_commitOnAnyChange","isFinite","_timedCommitFrequency","_maxCommitRetries","_commitRetryDelay","_exitStateIfIncomplete","_exitStateIfComplete","setupLearnerInfo","restoreSessionState","_learnerInfo","sessionPairs","hasNoPairs","_isAssessmentPassed","q","removeEventListeners","onLanguageChanged","onQuestionRecordInteraction","onTrackingComplete","advancedSettings","shouldCommitOnVisibilityChange","_commitOnVisibilityChangeHidden","onVisibilityChange","endSession","isMidRender","courseState","componentStates","printCompletionInformation","suspendData","courseComplete","assessmentPassed","trackingIdModels","trackingIds","completionString","markers","mark","_reporting","_resetStatusOnLanguageChange","visibilityState","questionView","_onTrackingCriteriaMet","_onAssessmentFailure","OfflineStorageScorm","statefulSession","temporaryStore","suspendDataStore","suspendDataRestored","useTemporaryStore","getCustomStates","student","learnerInfo","getLearnerInfo","getCustomState","stateArray","_isCourseComplete","questionsState","dataAsString","isSuspendDataStoreEmpty","dataAsJSON","firstname","lastname","hasName","isNameCommaSeparated","isNameSpaceSeparated","separator","nameParts","part","Spoor","_prepare","require","onKeyCombo","_deepDefaults","defaultObjects","keyValuePairs","defaultValue","isRecursiveObject","isValueAlreadySet","configDefaults","_isInherited","_autoScroll","_scrollTo","_onChildren","_button","_isFullWidth","_autoHide","_hasIcon","_styleBeforeCompletion","_styleAfterClick","startText","startAriaLabel","finalText","finalAriaLabel","_stepLocking","_isCompletionRequired","_isLockedOnRevisit","isModelArticleWithOnChildren","trickleConfig","isModelBlockWithArticleNotChildren","parentTrickleConfig","getModelConfigDefaults","getModelInheritanceChain","configModel","parentConfig","blockConfig","isParentEnabledNotOnChildren","isNoChildConfig","getModelConfig","inheritance","inheritModel","arr","isLast","getModelContainer","getCompletionAttribute","_completionAttribute","checkApplyLocks","hasCompletionChanged","hasAvailabilityChanged","debouncedApplyLocks","applyLocks","locks","modelsById","TrickleButtonModel","siteModel","isModelLocked","subsequentLockingModels","_getAncestorNextSiblings","isButtonModel","descendantId","wasLocked","logTrickleState","isStepLocked","isCompletionRequired","TrickleModel","trickleButton","isTrickleButtonComplete","fromModel","allSiblings","subsequentSiblings","allAncestors","inPageAncestors","subsequentInPageAncestors","grandParent","previousIndex","allGrandParentChildren","subsequentAncestorSiblings","subsequentContentObjectDescendantModels","addButtonComponents","uid","buttonModelSite","trickleButtonModel","_layout","_trickle","_renderPosition","_isTrackable","isTrickled","repeat","TrickleController","checkIsFinished","onAddChildView","kill","isStarted","isKilled","isManagedByTrickleAndLocked","isTrickling","continue","isAutoScrollOff","hasTrickleButton","getScrollToId","firstCharacter","relativeModel","scrollToId","isDescendant","_scrollDuration","isFinished","TrickleButtonView","openPopupCount","isAwaitingPopupClose","wasButtonClicked","calculateButtonText","calculateButtonState","isDisabledByPopups","tryButtonAutoHide","onParentComplete","updateButtonState","isStepUnlocked","onStepUnlocked","shouldUserInteractWithButton","isButtonHidden","isButtonDisabled","HTMLElement","isSameNode","wasComplete","isStepLockingCompletionRequired","controller","isJustOffscreen","isButtonAutoHidden","isStepComplete","isStepLocking","isCompletionBlocked","isParentComplete","isStepLockedOnRevisit","isButtonComplete","isLastInContentObject","lastDescendant","isStart","isFinal","trickleParent","trickleSiblings","buttonAriaLabel","isButtonDisableForced","isButtonHiddenForced","_isButtonVisible","_isButtonDisabled","_showEndOfPage","isTrickleKilled","isButtonVisibleBeforeCompletion","isButtonVisibleAfterCompletion","isNoCompletionRequiredAndLockedVisible","isNoCompletionRequiredAndUnlockedVisible","isNoCompletionRequiredAndFinishedVisible","isStepLockedAndVisibleBeforeCompletion","isFinishedAndVisibleAfterCompletion","isStepUnlockedAndButtonIncomplete","isButtonVisible","isButtonEnabledBeforeCompletion","isButtonEnabledAfterCompletion","isNoCompletionRequiredAndLockedEnabled","isNoCompletionRequiredAndUnlockedEnabled","isNoCompletionRequiredAndFinishedEnabled","isStepUnlockedAndButtonIncompleteWithoutButtonDisabledForced","isFinishedAndEnabledAfterCompletion","isButtonEnabled","trickle","LogoView","setupLogo","deviceSize","_large","_medium","_small","_parentPage","Logo","renderLogoView","logoModel","_position","logo","ScrollTopView","ScrollTop","onPageRender","SplashScreenView","removeView","createDrawer","splashScreen","splashScreenView","_images","MenuItemView","MenuView","BoxMenuItemView","onClickMenuItemButton","BoxMenuGroupView","BoxMenuView","setStyles","onDeviceResize","_renderAsGroup","addBackgroundLayer","setBackgroundImage","setBackgroundStyles","processHeader","$background","backgroundImages","_backgroundImage","backgroundImage","styles","_backgroundStyles","_backgroundRepeat","_backgroundSize","_backgroundPosition","header","_menuHeader","$header","addHeaderBackgroundLayer","setHeaderBackgroundImage","setHeaderBackgroundStyles","setHeaderMinimumHeight","$headerBackground","minimumHeights","_minimumHeights","minimumHeight","ThemeView","setClasses","setMinimumHeight","setResponsiveClasses","setCustomStyles","responsiveClasses","ThemePageView","ThemeArticleView","ThemeBlockView","Theme","theme","Header","jsxHeading","useRef","mobileInstruction","_disableAccessibilityState","classNamePrefixes","sizedInstruction","isSet","hasMediumSetting","hasSource","attributionClassNamePrefixes","attribution","alt","longdescription","longDescriptionId","Cards","_hasClickButton","_columns","_itemMinHeight","hasColumns","hasMinHeight","_hasAction","_isAnimated","_open","Choose","incorrect","Accordion","itemAriaLevel","Gmcq","_isRadio","ariaQuestion","selectedAnswer","unselectedAnswer","LinkWrapper","Graphic","Matching","displayAsCorrect","displayItemAsCorrect","MatchingDropDown","wasOpen","setWasOpen","useState","setIsOpen","isShown","setIsShown","blurTimeoutHandle","setBlurTimeoutHandle","isListOffScreen","setIsListOffScreen","listHeight","setListHeight","setButtonWidth","buttonOffsetLeft","setButtonOffsetLeft","onStartInteraction","getBoundingClientRect","offsetLeft","scrollToHighlightedListItem","highlighted","clientHeight","pos","onOptionClicked","li","chooseOption","onListBlur","handleBlur","onDocumentClick","KEYCODE","UP","DOWN","ENTER","SPACE","ESCAPE","validKeyCodes","onDocumentKeyDown","getPreviousOption","getLastOption","highlightOption","getNextOption","getFirstOption","highlightedOption","getCurrentOptionIndex","useEffect","capture","placeholder","correctActiveOption","displayActiveOption","displayText","Mcq","Text","TextInput","input","suffix","Flex","flex","GraphicCompare","_graphic1","_graphic2","widgetEl","maxWidth","offsetWidth","_graphicCompare","SelectChoice","_choices","Tabs","_minHeight","tabTitle","Talk","hasObserver","useObserver","elements","setElements","setEntries","observer","IntersectionObserver","observedEntries","currentObserver","disconnect","observe","cleanUp","rootMargin","isIntersecting","chatEntry","classList","unobserve","chatElements","querySelectorAll","VerticalItems","_icon","_backgroundVideo","_screenSize","UseVideo","_mp4","_webm","UseGraphic","NavigationLogo","setVisible","querySelector","scrollToTop","behavior"],"mappings":"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"}